import{b as Kl,e as dl,r as le,w as Ae,c as fe,m as Se,f as z,g as F,i as o,j as yt,n as Xe,d as ze,u as Ne,a as We,o as Ge,k as Pe,l as Ke,t as E,p as ce,q as a,v as be,T as tt,F as Te,x as $e,y as De,z as ye,A as Ce,B as ul,C as Le,D as xe,E as wt,G as Je,H as ct,I as it,J as ft,K as Rt,L as Yl,M as Xl}from"./vendor-57TSdUMR.js";import{c as dt,g as _t,C as Zl}from"./canvg-0PdlMh_v.js";import{v as He,r as Jl}from"./utils-CRAcIz2K.js";import{r as Ql,E as ei}from"./pdf-DGXcMhCb.js";import{V as cl}from"./monaco-De8iDoMI.js";import{r as ti,a as ri}from"./barcode-BoWGE6Vo.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))s(n);new MutationObserver(n=>{for(const l of n)if(l.type==="childList")for(const i of l.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&s(i)}).observe(document,{childList:!0,subtree:!0});function t(n){const l={};return n.integrity&&(l.integrity=n.integrity),n.referrerPolicy&&(l.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?l.credentials="include":n.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function s(n){if(n.ep)return;n.ep=!0;const l=t(n);fetch(n.href,l)}})();const ni={common:{save:"Save",cancel:"Cancel",confirm:"Confirm",close:"Close",delete:"Delete",edit:"Edit",copy:"Copy",cut:"Cut",paste:"Paste",undo:"Undo",redo:"Redo",rename:"Rename",loading:"Loading...",success:"Success",input:"Input",actions:"Actions",width:"Width",height:"Height",mm:"mm",px:"px",pt:"pt",rotate:"Rotate",lock:"Lock",unlock:"Unlock",appTitle:"Print Designer",testData:"Test Data",invalidJson:"Invalid JSON. Changes were not saved.",testDataKeyChanged:"Test data keys cannot be changed. Please only edit values."},template:{select:"Select Template",noTemplates:"No templates yet",new:"New Template",rename:"Rename Template",confirmDelete:'Are you sure you want to delete "{name}"?'},editor:{preview:"Print Preview",exportPdf:"Export PDF",exportImage:"Export Image",print:"Print",viewJson:"View JSON",viewBlob:"View Blob",viewImageBlob:"View Image Blob",viewPdfBlob:"View PDF Blob",zoomIn:"Zoom In",zoomOut:"Zoom Out",zoomLevel:"Zoom Level",zoomSettings:"Zoom Settings",unit:"Unit",advancedSettings:"Advanced Settings",watermark:"Watermark",watermarkEnable:"Enable",watermarkText:"Text",watermarkTextPlaceholder:"Enter watermark text",watermarkAngle:"Angle",watermarkColor:"Color",watermarkOpacity:"Opacity (%)",watermarkSize:"Size",watermarkDensity:"Density",template:"Template",newTemplate:"New Template",saveTemplate:"Save Template",saveAsTemplate:"Save As Template",templates:"Templates",shortcuts:"Shortcuts",help:"Help",about:"About",paperSettings:"Paper Settings",sizePreset:"Size Preset",custom:"Custom",spacingX:"Horizontal Margin",spacingY:"Vertical Margin",showCornerMarkers:"Show Corner Markers",showGrid:"Show Grid",showMinimap:"Show Minimap",headerFooter:"Header & Footer",headerLine:"Header Line",footerLine:"Footer Line",addNewPage:"Add New Page",fonts:{default:"Default",arial:"Arial",timesNewRoman:"Times New Roman",courierNew:"Courier New",simSun:"SimSun (宋体)",simHei:"SimHei (黑体)"},bold:"Bold",italic:"Italic",underline:"Underline",verticalText:"Vertical Text",textColor:"Text Color",backgroundColor:"Background Color",resetRotation:"Reset Rotation",alignLeft:"Align Left",alignCenter:"Align Center",alignRight:"Align Right",alignTop:"Align Top",alignMiddle:"Align Middle",alignBottom:"Align Bottom",group:"Group",lock:"Lock",unlock:"Unlock",fontFamily:"Font Family",settings:"Settings"},canvas:{addPage:"Add Page",copyPage:"Copy Page",pastePage:"Paste Page",deletePage:"Delete Page",newText:"New Text",headerLabel:"Header",footerLabel:"Footer",defaultTableHeaders:{id:"ID",name:"Name",qty:"Qty",price:"Price",total:"Total"},defaultTableData:{item:"Item",pageSum:"Page Sum",total:"Total",inWords:"In Words"}},sidebar:{elements:"Elements",dragToCanvas:"Drag elements to the canvas",standard:"Standard",custom:"Custom",general:"General",dataCodes:"Data & Codes",shapes:"Shapes",text:"Text",image:"Image",pagination:"Pagination",table:"Table",barcode:"Barcode",qrcode:"QR Code",line:"Line",rect:"Rect",circle:"Circle",noCustomElements:"No custom elements saved yet.",moreOptions:"More options",editElement:"Edit Element",rename:"Rename",copy:"Copy",delete:"Delete",renameModalTitle:"Rename Custom Element",enterNamePlaceholder:"Enter element name...",confirmDelete:'Are you sure you want to delete "{name}"?',confirmSwitchEdit:'Exit current edit for "{name}"?',confirmExitEdit:"You have unsaved changes. Exit anyway?",editingElement:"Editing custom element: {name}",saveEdit:"Save",saveAs:"Save As",exitEdit:"Exit",saveAsCustomElement:"Save as Custom Element",editSaveFailed:"Nothing to save. Please select an element."},elements:{text:"Text",image:"Image",table:"Table",line:"Line",rect:"Rect",circle:"Circle",barcode:"Barcode",qrcode:"QR Code",pageNumber:"Page Number",custom:"Custom",layers:"Layers"},properties:{title:"Properties",subtitle:"Edit element properties",locked:"Locked",multiSelectMode:"Multi-select mode",selectedElements:"{n} elements selected",deleteSelected:"Delete Selected Elements",tab:{properties:"Properties",style:"Style",advanced:"Advanced"},section:{positionSize:"Position & Size",dataBehavior:"Data & Behavior",layoutDimensions:"Layout & Dimensions",headerStyle:"Header Style",footerStyle:"Footer Style",cellOperations:"Cell Operations",appearance:"Appearance",elementInfo:"Element Info",content:"Content",typography:"Typography",border:"Border",barcodeSettings:"Barcode Settings",qrSettings:"QR Settings",labelContent:"Label Content",paginationTypography:"Pagination Typography",labelStyle:"Label Style",frameBorder:"Frame Border",lineStyle:"Line Style",imageSource:"Image Source"},action:{mergeCells:"Merge Cells",splitCells:"Split Cells",copyId:"Copy ID",copied:"Copied!",saveCustom:"Save as Custom Element",deleteElement:"Delete Current Element",saveCustomModal:"Save Custom Element"},empty:{noSelection:"No Selection",selectInstruction:"Select an element to edit properties"},label:{type:"Type",x:"X",y:"Y",width:"Width",height:"Height",content:"Content",variable:"Variable",writingMode:"Writing Mode",fontSize:"Font Size",color:"Color",textAlign:"Text Align",fontFamily:"Font Family",fontWeight:"Font Weight",borderStyle:"Border Style",borderWidth:"Border Width",borderColor:"Border Color",backgroundColor:"Background Color",imageSource:"Image Source",format:"Format",showText:"Show Text",lineWidth:"Line Width",barcodeHeight:"Height",margin:"Margin",textPosition:"Text Position",errorCorrection:"Error Correction",thickness:"Thickness",cornerRadius:"Corner Radius",background:"Background",autoPaginate:"Auto Paginate",repeatFooter:"Repeat Footer",showFooter:"Show Footer",columns:"Columns (JSON)",data:"Data (JSON)",footerData:"Footer Data (JSON)",customScript:"Custom Script",headerHeight:"Header Height",rowHeight:"Row Height",footerHeight:"Footer Height",textColor:"Text Color",editCell:"Edit Cell",editColumn:"Edit Column",headerText:"Header Text",fieldKey:"Field Key",variableField:"Variable Field",headerNamePlaceholder:"Header Name",displayTextPlaceholder:"Display Text (e.g. Total:)",dataFieldPlaceholder:"Data Field (e.g. {#amount})",id:"ID",labelBorderColor:"Label Border Color",barcodeContentPlaceholder:"Barcode Value",qrContentPlaceholder:"QR Code Value",textContentPlaceholder:"Enter text content",variablePlaceholder:"Variable Name (e.g. @name)",labelText:"Label Text",labelPosition:"Label Position",labelFontSize:"Label Font Size",labelColor:"Label Color",labelFontFamily:"Label Font Family",labelFontWeight:"Label Font Weight",labelBackgroundColor:"Label Background Color",labelBorderStyle:"Label Border Style",labelBorderWidth:"Label Border Width",pageFormat:"Page Format",labelTextPlaceholder:"e.g. Page",columnsPlaceholder:'[{ "field": "name", "header": "Name", "width": 100 }]',dataPlaceholder:"[{...}]",footerDataPlaceholder:'[{ "id": { "value": "Total" }, "amount": { "value": "Total:", "field": "{#sum}" } }]',customScriptPlaceholder:"return { data: ... };",fontStyle:"Font Style",padding:"Padding (px)"},option:{horizontal:"Horizontal",vertical:"Vertical",default:"Default",left:"Left",center:"Center",right:"Right",normal:"Normal",medium:"Medium",bold:"Bold",none:"None",solid:"Solid",dashed:"Dashed",dotted:"Dotted",yes:"Yes",no:"No",top:"Top",bottom:"Bottom",before:"Before",after:"After",eccLow:"Low (7%)",eccMedium:"Medium (15%)",eccQuartile:"Quartile (25%)",eccHigh:"High (30%)",arial:"Arial",timesNewRoman:"Times New Roman",courierNew:"Courier New",simSun:"SimSun (宋体)",simHei:"SimHei (黑体)",page1:"Page 1",oneTotal:"1/Total",code128:"CODE128",ean13:"EAN-13",upc:"UPC",code39:"CODE39",itf14:"ITF-14",msi:"MSI",pharmacode:"Pharmacode",numberOnly:"Number (1)"},image:{urlPlaceholder:"https://... or data:image/...",uploadBtn:"Upload Image",uploadTip:"Max 2MB, converts to Base64",sizeError:"Image size must be less than 2MB",readError:"Failed to read file"}},shortcuts:{title:"Shortcuts",keyboardShortcuts:"Keyboard Shortcuts",general:"General",editing:"Editing",manipulation:"Manipulation",newTemplate:"New Template",openSettings:"Open Settings",openHelp:"Open Help",zoom:"Zoom In/Out",closeModal:"Close Modal",selectAll:"Select All",multiSelect:"Multi-select",move:"Move",fastMove:"Fast Move",snapRotate:"Snap Rotate",resize:"Proportional Resize",saveAsTemplate:"Save As Template",customEditSave:"Save Custom Edit",customEditSaveAs:"Save Custom Edit As",customEditExit:"Exit Custom Edit",ctrl:"Ctrl",shift:"Shift",alt:"Alt",esc:"Esc",del:"Delete",enter:"Enter",arrow:"Arrow Keys",drag:"Drag",click:"Click",wheel:"Wheel"},help:{title:"Help Center",about:"About",aboutProject:"About {name}",github:"Project URL",dependencies:"Open Source Dependencies",package:"Package",version:"Version"},colorPicker:{clear:"Clear",transparent:"Transparent"},settings:{title:"Settings",basic:"Basic",language:"Language",connection:"Connections",themeColor:"Theme Color",themeColorDesc:"Pick a preset theme color and apply instantly.",themePresetDefault:"Blue",themePresetEmerald:"Emerald",themePresetAmber:"Amber",themePresetRose:"Rose",themePresetCustom:"Custom",theme:"Theme",themeSystem:"Follow System",themeLight:"Light",themeDark:"Dark",themeDesc:"Defaults to following system; you can force Light or Dark.",autoSave:"Auto Save",autoSaveDesc:"Automatically save changes (saved templates only).",exportImageMerged:"Export Image As Single",exportImageMergedDesc:"When off, export each page as a separate image inside a ZIP file.",languageDesc:"Choose the interface language.",connectionDesc:"Connection settings placeholder.",printMode:"Print Mode",printModeLocal:"Local Client",printModeRemote:"Remote Cloud",printModeBrowser:"Browser",printModeDesc:"Local and remote options require a successful connection test.",silentPrint:"Silent Print",silentPrintDesc:"When enabled, skip the custom print dialog; browser print still uses the browser dialog.",localConnection:"Local Client Print",remoteConnection:"Remote Cloud Print",host:"Host",port:"Port",wsPath:"WS Path",protocol:"Protocol",wsAddress:"WS Address",wsAddressPlaceholder:"ws://host:port/ws/request",localWsAddressPlaceholder:"ws://host:port/ws",secretKey:"Secret Key",connectionUrl:"Connection URL",connect:"Connect",disconnect:"Disconnect",connecting:"Connecting...",connectionTesting:"Testing connection...",connectionOk:"Connection OK",connectionOkWithUser:"Connection OK (User: {userId})",connectionFailed:"Connection failed",connectionTimeout:"Connection timeout",connectionMissingFields:"Please fill in API URL, username, and password.",connectionMissingToken:"Login succeeded but token is missing.",apiBaseUrl:"Login URL",apiBasePlaceholder:"http://host:port/api/login",username:"Username",password:"Password",remoteLoginTitle:"Login (HTTP)",remoteLoginDesc:"Used to obtain the JWT token. Enter the full login URL.",remoteWsTitle:"WebSocket (Print Relay)",remoteWsDesc:"Used for printing and client/printer queries. Token is appended to the WS URL.",localClientTitle:"Local Client",localClientDesc:"Configure the local client WebSocket and secret key for on-device printing.",remoteClient:"Default Client",remoteClientPlaceholder:"Select a client",remoteAuthHint:"Remote WS URL appends ?token=JWT for browser WebSocket authentication.",status:{connected:"Connected",connecting:"Connecting",disconnected:"Disconnected",error:"Error"},retrying:"Retrying ({count}/{max})",cancelRetry:"Cancel Retry",selectLanguage:"Select Language",zhLabel:"Chinese",enLabel:"English"},printDialog:{title:"Print Options",titleLocal:"Local Client Print Options",titleRemote:"Remote Cloud Print Options",sectionBasic:"Basic",sectionAdvanced:"Advanced",printer:"Printer",printerSelect:"Select printer",printerEmpty:"No printers found.",remoteClient:"Client",remoteClientPlaceholder:"Select client",remoteClientEmpty:"No clients found.",remotePrinterInfo:"Type: {type} | Paper: {paper} | Formats: {format}",printerPlaceholder:"Printer name",jobName:"Job Name",jobNamePlaceholder:"Optional job name",copies:"Copies",intervalMs:"Interval (ms)",pageRange:"Page Range",pageRangePlaceholder:"e.g. 1-3,5",pageSet:"Page Set",pageSetAll:"All",pageSetOdd:"Odd",pageSetEven:"Even",scale:"Scale",scaleNo:"No Scale",scaleShrink:"Shrink",scaleFit:"Fit",orientation:"Orientation",portrait:"Portrait",landscape:"Landscape",colorMode:"Color Mode",color:"Color",monochrome:"Monochrome",sidesMode:"Duplex",simplex:"Simplex",duplex:"Duplex",duplexShort:"Duplex (Short Edge)",duplexLong:"Duplex (Long Edge)",paperSize:"Paper Size",paperSizePlaceholder:"e.g. A4",trayBin:"Tray",trayBinPlaceholder:"e.g. 2 or Manual",confirm:"Print"},preview:{title:"Print Preview",templateJson:"Template JSON",zoomIn:"Zoom In",zoomOut:"Zoom Out"},input:{title:"Input",placeholder:"Enter value..."}},oi={common:{save:"保存",cancel:"取消",confirm:"确认",close:"关闭",delete:"删除",edit:"编辑",copy:"复制",cut:"剪切",paste:"粘贴",undo:"撤销",redo:"重做",rename:"重命名",loading:"加载中...",success:"成功",input:"输入",actions:"操作",width:"宽度",height:"高度",mm:"毫米",px:"像素",pt:"磅",rotate:"旋转",lock:"锁定",unlock:"解锁",appTitle:"打印设计器",testData:"测试数据",invalidJson:"JSON 无效，未保存更改。",testDataKeyChanged:"测试数据的键不允许修改，请仅编辑值。"},template:{select:"选择模版",noTemplates:"暂无模版",new:"新建模版",rename:"重命名模版",confirmDelete:'确定要删除 "{name}" 吗？'},editor:{preview:"打印预览",exportPdf:"导出 PDF",exportImage:"导出图片",print:"打印",viewJson:"查看 JSON",viewBlob:"查看 Blob",viewImageBlob:"查看图片 Blob",viewPdfBlob:"查看 PDF Blob",zoomIn:"放大",zoomOut:"缩小",zoomLevel:"缩放级别",zoomSettings:"缩放设置",unit:"单位",advancedSettings:"高级设置",watermark:"水印",watermarkEnable:"启用",watermarkText:"文字",watermarkTextPlaceholder:"请输入水印文字",watermarkAngle:"方向",watermarkColor:"颜色",watermarkOpacity:"透明度（%）",watermarkSize:"大小",watermarkDensity:"密度",template:"模版",newTemplate:"新建模版",saveTemplate:"保存模版",saveAsTemplate:"另存为模版",templates:"模版列表",shortcuts:"快捷键",help:"帮助",about:"关于",paperSettings:"页面设置",sizePreset:"纸张尺寸",custom:"自定义",spacingX:"水平边距",spacingY:"垂直边距",showCornerMarkers:"显示角标",showGrid:"显示网格",showMinimap:"显示缩略图",headerFooter:"页眉页脚",headerLine:"页眉线",footerLine:"页脚线",addNewPage:"添加新页",fonts:{default:"默认",arial:"Arial",timesNewRoman:"Times New Roman",courierNew:"Courier New",simSun:"宋体",simHei:"黑体"},bold:"加粗",italic:"斜体",underline:"下划线",verticalText:"竖排文本",textColor:"文本颜色",backgroundColor:"背景颜色",resetRotation:"重置旋转",alignLeft:"左对齐",alignCenter:"水平居中",alignRight:"右对齐",alignTop:"顶部对齐",alignMiddle:"垂直居中",alignBottom:"底部对齐",group:"组合",lock:"锁定",unlock:"解锁",fontFamily:"字体",settings:"设置"},canvas:{addPage:"添加页",copyPage:"复制页",pastePage:"粘贴页",deletePage:"删除页",newText:"新文本",headerLabel:"页眉",footerLabel:"页脚",defaultTableHeaders:{id:"ID",name:"名称",qty:"数量",price:"单价",total:"合计"},defaultTableData:{item:"商品",pageSum:"本页合计",total:"总计",inWords:"大写金额"}},sidebar:{custom:"自定义",elements:"组件库",dragToCanvas:"拖拽组件到画布",standard:"标准组件",general:"通用",dataCodes:"数据 & 条码",shapes:"图形",text:"文本",image:"图片",pagination:"页码",table:"表格",barcode:"条形码",qrcode:"二维码",line:"直线",rect:"矩形",circle:"圆形",noCustomElements:"暂无自定义组件",moreOptions:"更多选项",editElement:"编辑元素",rename:"重命名",copy:"复制",delete:"删除",renameModalTitle:"重命名自定义组件",enterNamePlaceholder:"输入组件名称...",confirmDelete:'确定要删除 "{name}" 吗？',confirmSwitchEdit:'退出当前对 "{name}" 的编辑？',confirmExitEdit:"存在未保存的更改，确定退出吗？",editingElement:"正在编辑自定义元素：{name}",saveEdit:"保存",saveAs:"另存为",exitEdit:"退出",saveAsCustomElement:"另存为自定义元素",editSaveFailed:"没有可保存的元素，请先选中一个元素。"},elements:{text:"文本",image:"图片",table:"表格",line:"直线",rect:"矩形",circle:"圆形",barcode:"条形码",qrcode:"二维码",pageNumber:"页码",custom:"自定义",layers:"图层"},properties:{title:"属性面板",subtitle:"编辑组件属性",locked:"已锁定",multiSelectMode:"多选模式",selectedElements:"已选择 {n} 个组件",deleteSelected:"删除选中组件",tab:{properties:"属性",style:"样式",advanced:"高级"},section:{positionSize:"位置 & 尺寸",dataBehavior:"数据 & 行为",layoutDimensions:"布局 & 尺寸",headerStyle:"表头样式",footerStyle:"表脚样式",cellOperations:"单元格操作",appearance:"外观",elementInfo:"组件信息",content:"内容",typography:"排版",border:"边框",barcodeSettings:"条形码设置",qrSettings:"二维码设置",labelContent:"标签内容",paginationTypography:"页码排版",labelStyle:"标签样式",frameBorder:"框架边框",lineStyle:"线条样式",imageSource:"图片来源"},action:{mergeCells:"合并单元格",splitCells:"拆分单元格",copyId:"复制 ID",copied:"已复制!",saveCustom:"保存为自定义组件",deleteElement:"删除当前组件",saveCustomModal:"保存自定义组件"},empty:{noSelection:"未选择",selectInstruction:"选择一个组件以编辑属性"},label:{type:"类型",x:"X",y:"Y",width:"宽度",height:"高度",content:"内容",variable:"变量",writingMode:"书写模式",fontSize:"字号",color:"颜色",textAlign:"对齐方式",fontFamily:"字体",fontWeight:"字重",borderStyle:"边框样式",borderWidth:"边框宽度",borderColor:"边框颜色",backgroundColor:"背景颜色",imageSource:"图片来源",format:"格式",showText:"显示文本",lineWidth:"线宽",barcodeHeight:"高度",margin:"边距",textPosition:"文本位置",errorCorrection:"纠错等级",thickness:"粗细",cornerRadius:"圆角半径",background:"背景",autoPaginate:"自动分页",repeatFooter:"重复表脚",showFooter:"显示表脚",columns:"列定义 (JSON)",data:"数据 (JSON)",footerData:"表脚数据 (JSON)",customScript:"自定义脚本",headerHeight:"表头高度",rowHeight:"行高",footerHeight:"表脚高度",textColor:"文本颜色",editCell:"编辑单元格",editColumn:"编辑列",headerText:"表头文本",fieldKey:"字段键",variableField:"变量字段",headerNamePlaceholder:"表头名称",displayTextPlaceholder:"显示文本 (如: 合计:)",dataFieldPlaceholder:"数据字段 (如: {#amount})",id:"ID",labelBorderColor:"标签边框颜色",barcodeContentPlaceholder:"条码内容",qrContentPlaceholder:"二维码内容",textContentPlaceholder:"请输入文本内容",variablePlaceholder:"变量名 (例如 @name)",labelText:"标签文本",labelPosition:"标签位置",labelFontSize:"标签字号",labelColor:"标签颜色",labelFontFamily:"标签字体",labelFontWeight:"标签字重",labelBackgroundColor:"标签背景颜色",labelBorderStyle:"标签边框样式",labelBorderWidth:"标签边框宽度",pageFormat:"页码格式",labelTextPlaceholder:"例如：第",columnsPlaceholder:'[{ "field": "name", "header": "姓名", "width": 100 }]',dataPlaceholder:"[{...}]",footerDataPlaceholder:'[{ "id": { "value": "合计" }, "amount": { "value": "合计:", "field": "{#sum}" } }]',customScriptPlaceholder:"return { data: ... };",fontStyle:"字体样式",padding:"内边距 (px)"},option:{horizontal:"水平",vertical:"垂直",default:"默认",left:"左对齐",center:"居中",right:"右对齐",normal:"常规",medium:"中等",bold:"加粗",none:"无",solid:"实线",dashed:"虚线",dotted:"点线",yes:"是",no:"否",top:"顶部",bottom:"底部",before:"之前",after:"之后",eccLow:"低 (7%)",eccMedium:"中 (15%)",eccQuartile:"四分 (25%)",eccHigh:"高 (30%)",arial:"Arial",timesNewRoman:"Times New Roman",courierNew:"Courier New",simSun:"宋体",simHei:"黑体",page1:"第 1 页",oneTotal:"1/共几页",code128:"CODE128",ean13:"EAN-13",upc:"UPC",code39:"CODE39",itf14:"ITF-14",msi:"MSI",pharmacode:"Pharmacode",numberOnly:"数字 (1)"},image:{urlPlaceholder:"请输入图片地址或 Base64...",uploadBtn:"上传图片",uploadTip:"最大 2MB，自动转换为 Base64",sizeError:"图片大小不能超过 2MB",readError:"读取文件失败"}},shortcuts:{title:"快捷键",keyboardShortcuts:"键盘快捷键",general:"通用",editing:"编辑",manipulation:"操作",themeColor:"主题色",themeColorDesc:"选择一个预设主题色，立即生效。",themePresetDefault:"蓝色",themePresetEmerald:"绿色",themePresetAmber:"橙色",themePresetRose:"玫红",themePresetCustom:"自定义",newTemplate:"新建模版",openSettings:"打开设置",openHelp:"打开帮助",zoom:"缩放",closeModal:"关闭弹窗",selectAll:"全选",multiSelect:"多选",move:"移动",fastMove:"快速移动",snapRotate:"吸附旋转",resize:"等比缩放",saveAsTemplate:"另存为模版",customEditSave:"保存自定义编辑",customEditSaveAs:"另存自定义编辑",customEditExit:"退出自定义编辑",ctrl:"Ctrl",shift:"Shift",alt:"Alt",esc:"Esc",del:"Delete",enter:"Enter",arrow:"方向键",drag:"拖拽",click:"点击",wheel:"滚轮"},help:{title:"帮助中心",about:"关于",aboutProject:"关于 {name}",github:"项目地址",dependencies:"开源依赖",package:"依赖包",version:"版本"},colorPicker:{clear:"清除",transparent:"透明"},settings:{title:"设置",basic:"基础",language:"语言",connection:"连接",themeColor:"主题色",themeColorDesc:"选择一个预设主题色，立即生效。",themePresetDefault:"蓝色",themePresetEmerald:"绿色",themePresetAmber:"橙色",themePresetRose:"玫红",themePresetCustom:"自定义",theme:"主题",themeSystem:"跟随系统",themeLight:"亮色",themeDark:"暗色",themeDesc:"默认跟随系统；可手动切换为亮色或暗色。",autoSave:"自动保存",autoSaveDesc:"当模版发生变更时自动保存（仅对已保存过的模版生效）。",exportImageMerged:"导出为整张图片",exportImageMergedDesc:"关闭后将每一页导出为单张图片，并打包为 ZIP。",languageDesc:"选择界面的显示语言。",connectionDesc:"连接设置占位内容。",printMode:"打印方式",printModeLocal:"本地客户端打印",printModeRemote:"远程云打印",printModeBrowser:"浏览器打印",printModeDesc:"本地/远程需连接测试成功后才能启用。",silentPrint:"静默打印",silentPrintDesc:"开启后跳过自定义打印对话框；浏览器打印仍会弹出浏览器打印设置。",localConnection:"本地客户端打印",remoteConnection:"远程云打印",host:"主机",port:"端口",wsPath:"WS 路径",protocol:"协议",wsAddress:"WS 地址",wsAddressPlaceholder:"ws://host:port/ws/request",localWsAddressPlaceholder:"ws://host:port/ws",secretKey:"密钥",connectionUrl:"连接地址",connect:"连接",disconnect:"断开",connecting:"连接中...",connectionTesting:"正在测试连接...",connectionOk:"连接成功",connectionOkWithUser:"连接成功（用户：{userId}）",connectionFailed:"连接失败",connectionTimeout:"连接超时",connectionMissingFields:"请填写 API 地址、用户名和密码。",connectionMissingToken:"登录成功但未返回 Token。",apiBaseUrl:"登录地址",apiBasePlaceholder:"http://host:port/api/login",username:"用户名",password:"密码",remoteLoginTitle:"登录（HTTP）",remoteLoginDesc:"用于获取 JWT，请填写完整的登录地址。",remoteWsTitle:"WebSocket（打印中转）",remoteWsDesc:"用于打印与查询客户端/打印机，Token 会拼到 WS 地址。",localClientTitle:"本地客户端",localClientDesc:"配置本地客户端的 WebSocket 与密钥，用于本机打印。",remoteClient:"默认客户端",remoteClientPlaceholder:"请选择客户端",remoteAuthHint:"远程 WS 地址会附加 ?token=JWT 以便浏览器鉴权。",status:{connected:"已连接",connecting:"连接中",disconnected:"未连接",error:"错误"},retrying:"重试中（{count}/{max}）",cancelRetry:"停止重试",selectLanguage:"选择语言",zhLabel:"中文",enLabel:"English"},printDialog:{title:"打印参数",titleLocal:"本地客户端打印参数",titleRemote:"远程云打印参数",sectionBasic:"基础",sectionAdvanced:"高级",printer:"打印机",printerSelect:"请选择打印机",printerEmpty:"未获取到打印机。",remoteClient:"客户端",remoteClientPlaceholder:"请选择客户端",remoteClientEmpty:"未获取到客户端。",remotePrinterInfo:"类型：{type} | 纸张：{paper} | 格式：{format}",printerPlaceholder:"打印机名称",jobName:"任务名称",jobNamePlaceholder:"可选任务名称",copies:"打印份数",intervalMs:"份数间隔(ms)",pageRange:"页码范围",pageRangePlaceholder:"如 1-3,5",pageSet:"奇偶页",pageSetAll:"全部",pageSetOdd:"奇数页",pageSetEven:"偶数页",scale:"缩放",scaleNo:"不缩放",scaleShrink:"缩小",scaleFit:"适应",orientation:"方向",portrait:"纵向",landscape:"横向",colorMode:"颜色模式",color:"彩色",monochrome:"黑白",sidesMode:"单双面",simplex:"单面",duplex:"双面",duplexShort:"双面（短边翻转）",duplexLong:"双面（长边翻转）",paperSize:"纸张",paperSizePlaceholder:"如 A4",trayBin:"纸盒",trayBinPlaceholder:"如 2 或 Manual",confirm:"打印"},preview:{title:"打印预览",templateJson:"模版 JSON",zoomIn:"放大",zoomOut:"缩小"},input:{title:"输入",placeholder:"请输入..."}},si={en:ni,zh:oi},ai=()=>{const r=localStorage.getItem("print-designer-language");return r&&(r==="zh"||r==="en")?r:navigator.language.toLowerCase().startsWith("zh")?"zh":"en"},li=Kl({legacy:!1,locale:ai(),fallbackLocale:"en",messages:si});var rr,Po;function ii(){if(Po)return rr;Po=1;function r(){this.__data__=[],this.size=0}return rr=r,rr}var nr,Lo;function hl(){if(Lo)return nr;Lo=1;function r(e,t){return e===t||e!==e&&t!==t}return nr=r,nr}var or,Mo;function Gt(){if(Mo)return or;Mo=1;var r=hl();function e(t,s){for(var n=t.length;n--;)if(r(t[n][0],s))return n;return-1}return or=e,or}var sr,Ro;function di(){if(Ro)return sr;Ro=1;var r=Gt(),e=Array.prototype,t=e.splice;function s(n){var l=this.__data__,i=r(l,n);if(i<0)return!1;var d=l.length-1;return i==d?l.pop():t.call(l,i,1),--this.size,!0}return sr=s,sr}var ar,Do;function ui(){if(Do)return ar;Do=1;var r=Gt();function e(t){var s=this.__data__,n=r(s,t);return n<0?void 0:s[n][1]}return ar=e,ar}var lr,Bo;function ci(){if(Bo)return lr;Bo=1;var r=Gt();function e(t){return r(this.__data__,t)>-1}return lr=e,lr}var ir,Oo;function hi(){if(Oo)return ir;Oo=1;var r=Gt();function e(t,s){var n=this.__data__,l=r(n,t);return l<0?(++this.size,n.push([t,s])):n[l][1]=s,this}return ir=e,ir}var dr,qo;function Kt(){if(qo)return dr;qo=1;var r=ii(),e=di(),t=ui(),s=ci(),n=hi();function l(i){var d=-1,c=i==null?0:i.length;for(this.clear();++d<c;){var g=i[d];this.set(g[0],g[1])}}return l.prototype.clear=r,l.prototype.delete=e,l.prototype.get=t,l.prototype.has=s,l.prototype.set=n,dr=l,dr}var ur,Fo;function pi(){if(Fo)return ur;Fo=1;var r=Kt();function e(){this.__data__=new r,this.size=0}return ur=e,ur}var cr,No;function fi(){if(No)return cr;No=1;function r(e){var t=this.__data__,s=t.delete(e);return this.size=t.size,s}return cr=r,cr}var hr,jo;function mi(){if(jo)return hr;jo=1;function r(e){return this.__data__.get(e)}return hr=r,hr}var pr,Ho;function gi(){if(Ho)return pr;Ho=1;function r(e){return this.__data__.has(e)}return pr=r,pr}var fr,Uo;function pl(){if(Uo)return fr;Uo=1;var r=typeof dt=="object"&&dt&&dt.Object===Object&&dt;return fr=r,fr}var mr,Vo;function rt(){if(Vo)return mr;Vo=1;var r=pl(),e=typeof self=="object"&&self&&self.Object===Object&&self,t=r||e||Function("return this")();return mr=t,mr}var gr,Wo;function fo(){if(Wo)return gr;Wo=1;var r=rt(),e=r.Symbol;return gr=e,gr}var vr,Go;function vi(){if(Go)return vr;Go=1;var r=fo(),e=Object.prototype,t=e.hasOwnProperty,s=e.toString,n=r?r.toStringTag:void 0;function l(i){var d=t.call(i,n),c=i[n];try{i[n]=void 0;var g=!0}catch{}var w=s.call(i);return g&&(d?i[n]=c:delete i[n]),w}return vr=l,vr}var br,Ko;function bi(){if(Ko)return br;Ko=1;var r=Object.prototype,e=r.toString;function t(s){return e.call(s)}return br=t,br}var yr,Yo;function Bt(){if(Yo)return yr;Yo=1;var r=fo(),e=vi(),t=bi(),s="[object Null]",n="[object Undefined]",l=r?r.toStringTag:void 0;function i(d){return d==null?d===void 0?n:s:l&&l in Object(d)?e(d):t(d)}return yr=i,yr}var wr,Xo;function mt(){if(Xo)return wr;Xo=1;function r(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}return wr=r,wr}var xr,Zo;function fl(){if(Zo)return xr;Zo=1;var r=Bt(),e=mt(),t="[object AsyncFunction]",s="[object Function]",n="[object GeneratorFunction]",l="[object Proxy]";function i(d){if(!e(d))return!1;var c=r(d);return c==s||c==n||c==t||c==l}return xr=i,xr}var _r,Jo;function yi(){if(Jo)return _r;Jo=1;var r=rt(),e=r["__core-js_shared__"];return _r=e,_r}var kr,Qo;function wi(){if(Qo)return kr;Qo=1;var r=yi(),e=(function(){var s=/[^.]+$/.exec(r&&r.keys&&r.keys.IE_PROTO||"");return s?"Symbol(src)_1."+s:""})();function t(s){return!!e&&e in s}return kr=t,kr}var Sr,es;function ml(){if(es)return Sr;es=1;var r=Function.prototype,e=r.toString;function t(s){if(s!=null){try{return e.call(s)}catch{}try{return s+""}catch{}}return""}return Sr=t,Sr}var Cr,ts;function xi(){if(ts)return Cr;ts=1;var r=fl(),e=wi(),t=mt(),s=ml(),n=/[\\^$.*+?()[\]{}|]/g,l=/^\[object .+?Constructor\]$/,i=Function.prototype,d=Object.prototype,c=i.toString,g=d.hasOwnProperty,w=RegExp("^"+c.call(g).replace(n,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function m(_){if(!t(_)||e(_))return!1;var p=r(_)?w:l;return p.test(s(_))}return Cr=m,Cr}var Er,rs;function _i(){if(rs)return Er;rs=1;function r(e,t){return e==null?void 0:e[t]}return Er=r,Er}var Tr,ns;function gt(){if(ns)return Tr;ns=1;var r=xi(),e=_i();function t(s,n){var l=e(s,n);return r(l)?l:void 0}return Tr=t,Tr}var $r,os;function mo(){if(os)return $r;os=1;var r=gt(),e=rt(),t=r(e,"Map");return $r=t,$r}var Ir,ss;function Yt(){if(ss)return Ir;ss=1;var r=gt(),e=r(Object,"create");return Ir=e,Ir}var Ar,as;function ki(){if(as)return Ar;as=1;var r=Yt();function e(){this.__data__=r?r(null):{},this.size=0}return Ar=e,Ar}var zr,ls;function Si(){if(ls)return zr;ls=1;function r(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}return zr=r,zr}var Pr,is;function Ci(){if(is)return Pr;is=1;var r=Yt(),e="__lodash_hash_undefined__",t=Object.prototype,s=t.hasOwnProperty;function n(l){var i=this.__data__;if(r){var d=i[l];return d===e?void 0:d}return s.call(i,l)?i[l]:void 0}return Pr=n,Pr}var Lr,ds;function Ei(){if(ds)return Lr;ds=1;var r=Yt(),e=Object.prototype,t=e.hasOwnProperty;function s(n){var l=this.__data__;return r?l[n]!==void 0:t.call(l,n)}return Lr=s,Lr}var Mr,us;function Ti(){if(us)return Mr;us=1;var r=Yt(),e="__lodash_hash_undefined__";function t(s,n){var l=this.__data__;return this.size+=this.has(s)?0:1,l[s]=r&&n===void 0?e:n,this}return Mr=t,Mr}var Rr,cs;function $i(){if(cs)return Rr;cs=1;var r=ki(),e=Si(),t=Ci(),s=Ei(),n=Ti();function l(i){var d=-1,c=i==null?0:i.length;for(this.clear();++d<c;){var g=i[d];this.set(g[0],g[1])}}return l.prototype.clear=r,l.prototype.delete=e,l.prototype.get=t,l.prototype.has=s,l.prototype.set=n,Rr=l,Rr}var Dr,hs;function Ii(){if(hs)return Dr;hs=1;var r=$i(),e=Kt(),t=mo();function s(){this.size=0,this.__data__={hash:new r,map:new(t||e),string:new r}}return Dr=s,Dr}var Br,ps;function Ai(){if(ps)return Br;ps=1;function r(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}return Br=r,Br}var Or,fs;function Xt(){if(fs)return Or;fs=1;var r=Ai();function e(t,s){var n=t.__data__;return r(s)?n[typeof s=="string"?"string":"hash"]:n.map}return Or=e,Or}var qr,ms;function zi(){if(ms)return qr;ms=1;var r=Xt();function e(t){var s=r(this,t).delete(t);return this.size-=s?1:0,s}return qr=e,qr}var Fr,gs;function Pi(){if(gs)return Fr;gs=1;var r=Xt();function e(t){return r(this,t).get(t)}return Fr=e,Fr}var Nr,vs;function Li(){if(vs)return Nr;vs=1;var r=Xt();function e(t){return r(this,t).has(t)}return Nr=e,Nr}var jr,bs;function Mi(){if(bs)return jr;bs=1;var r=Xt();function e(t,s){var n=r(this,t),l=n.size;return n.set(t,s),this.size+=n.size==l?0:1,this}return jr=e,jr}var Hr,ys;function Ri(){if(ys)return Hr;ys=1;var r=Ii(),e=zi(),t=Pi(),s=Li(),n=Mi();function l(i){var d=-1,c=i==null?0:i.length;for(this.clear();++d<c;){var g=i[d];this.set(g[0],g[1])}}return l.prototype.clear=r,l.prototype.delete=e,l.prototype.get=t,l.prototype.has=s,l.prototype.set=n,Hr=l,Hr}var Ur,ws;function Di(){if(ws)return Ur;ws=1;var r=Kt(),e=mo(),t=Ri(),s=200;function n(l,i){var d=this.__data__;if(d instanceof r){var c=d.__data__;if(!e||c.length<s-1)return c.push([l,i]),this.size=++d.size,this;d=this.__data__=new t(c)}return d.set(l,i),this.size=d.size,this}return Ur=n,Ur}var Vr,xs;function Bi(){if(xs)return Vr;xs=1;var r=Kt(),e=pi(),t=fi(),s=mi(),n=gi(),l=Di();function i(d){var c=this.__data__=new r(d);this.size=c.size}return i.prototype.clear=e,i.prototype.delete=t,i.prototype.get=s,i.prototype.has=n,i.prototype.set=l,Vr=i,Vr}var Wr,_s;function Oi(){if(_s)return Wr;_s=1;function r(e,t){for(var s=-1,n=e==null?0:e.length;++s<n&&t(e[s],s,e)!==!1;);return e}return Wr=r,Wr}var Gr,ks;function qi(){if(ks)return Gr;ks=1;var r=gt(),e=(function(){try{var t=r(Object,"defineProperty");return t({},"",{}),t}catch{}})();return Gr=e,Gr}var Kr,Ss;function gl(){if(Ss)return Kr;Ss=1;var r=qi();function e(t,s,n){s=="__proto__"&&r?r(t,s,{configurable:!0,enumerable:!0,value:n,writable:!0}):t[s]=n}return Kr=e,Kr}var Yr,Cs;function vl(){if(Cs)return Yr;Cs=1;var r=gl(),e=hl(),t=Object.prototype,s=t.hasOwnProperty;function n(l,i,d){var c=l[i];(!(s.call(l,i)&&e(c,d))||d===void 0&&!(i in l))&&r(l,i,d)}return Yr=n,Yr}var Xr,Es;function Zt(){if(Es)return Xr;Es=1;var r=vl(),e=gl();function t(s,n,l,i){var d=!l;l||(l={});for(var c=-1,g=n.length;++c<g;){var w=n[c],m=i?i(l[w],s[w],w,l,s):void 0;m===void 0&&(m=s[w]),d?e(l,w,m):r(l,w,m)}return l}return Xr=t,Xr}var Zr,Ts;function Fi(){if(Ts)return Zr;Ts=1;function r(e,t){for(var s=-1,n=Array(e);++s<e;)n[s]=t(s);return n}return Zr=r,Zr}var Jr,$s;function kt(){if($s)return Jr;$s=1;function r(e){return e!=null&&typeof e=="object"}return Jr=r,Jr}var Qr,Is;function Ni(){if(Is)return Qr;Is=1;var r=Bt(),e=kt(),t="[object Arguments]";function s(n){return e(n)&&r(n)==t}return Qr=s,Qr}var en,As;function ji(){if(As)return en;As=1;var r=Ni(),e=kt(),t=Object.prototype,s=t.hasOwnProperty,n=t.propertyIsEnumerable,l=r((function(){return arguments})())?r:function(i){return e(i)&&s.call(i,"callee")&&!n.call(i,"callee")};return en=l,en}var tn,zs;function go(){if(zs)return tn;zs=1;var r=Array.isArray;return tn=r,tn}var It={exports:{}},rn,Ps;function Hi(){if(Ps)return rn;Ps=1;function r(){return!1}return rn=r,rn}It.exports;var Ls;function bl(){return Ls||(Ls=1,(function(r,e){var t=rt(),s=Hi(),n=e&&!e.nodeType&&e,l=n&&!0&&r&&!r.nodeType&&r,i=l&&l.exports===n,d=i?t.Buffer:void 0,c=d?d.isBuffer:void 0,g=c||s;r.exports=g})(It,It.exports)),It.exports}var nn,Ms;function Ui(){if(Ms)return nn;Ms=1;var r=9007199254740991,e=/^(?:0|[1-9]\d*)$/;function t(s,n){var l=typeof s;return n=n??r,!!n&&(l=="number"||l!="symbol"&&e.test(s))&&s>-1&&s%1==0&&s<n}return nn=t,nn}var on,Rs;function yl(){if(Rs)return on;Rs=1;var r=9007199254740991;function e(t){return typeof t=="number"&&t>-1&&t%1==0&&t<=r}return on=e,on}var sn,Ds;function Vi(){if(Ds)return sn;Ds=1;var r=Bt(),e=yl(),t=kt(),s="[object Arguments]",n="[object Array]",l="[object Boolean]",i="[object Date]",d="[object Error]",c="[object Function]",g="[object Map]",w="[object Number]",m="[object Object]",_="[object RegExp]",p="[object Set]",S="[object String]",v="[object WeakMap]",k="[object ArrayBuffer]",b="[object DataView]",f="[object Float32Array]",T="[object Float64Array]",D="[object Int8Array]",j="[object Int16Array]",B="[object Int32Array]",A="[object Uint8Array]",V="[object Uint8ClampedArray]",Y="[object Uint16Array]",se="[object Uint32Array]",G={};G[f]=G[T]=G[D]=G[j]=G[B]=G[A]=G[V]=G[Y]=G[se]=!0,G[s]=G[n]=G[k]=G[l]=G[b]=G[i]=G[d]=G[c]=G[g]=G[w]=G[m]=G[_]=G[p]=G[S]=G[v]=!1;function I(q){return t(q)&&e(q.length)&&!!G[r(q)]}return sn=I,sn}var an,Bs;function vo(){if(Bs)return an;Bs=1;function r(e){return function(t){return e(t)}}return an=r,an}var At={exports:{}};At.exports;var Os;function bo(){return Os||(Os=1,(function(r,e){var t=pl(),s=e&&!e.nodeType&&e,n=s&&!0&&r&&!r.nodeType&&r,l=n&&n.exports===s,i=l&&t.process,d=(function(){try{var c=n&&n.require&&n.require("util").types;return c||i&&i.binding&&i.binding("util")}catch{}})();r.exports=d})(At,At.exports)),At.exports}var ln,qs;function Wi(){if(qs)return ln;qs=1;var r=Vi(),e=vo(),t=bo(),s=t&&t.isTypedArray,n=s?e(s):r;return ln=n,ln}var dn,Fs;function wl(){if(Fs)return dn;Fs=1;var r=Fi(),e=ji(),t=go(),s=bl(),n=Ui(),l=Wi(),i=Object.prototype,d=i.hasOwnProperty;function c(g,w){var m=t(g),_=!m&&e(g),p=!m&&!_&&s(g),S=!m&&!_&&!p&&l(g),v=m||_||p||S,k=v?r(g.length,String):[],b=k.length;for(var f in g)(w||d.call(g,f))&&!(v&&(f=="length"||p&&(f=="offset"||f=="parent")||S&&(f=="buffer"||f=="byteLength"||f=="byteOffset")||n(f,b)))&&k.push(f);return k}return dn=c,dn}var un,Ns;function yo(){if(Ns)return un;Ns=1;var r=Object.prototype;function e(t){var s=t&&t.constructor,n=typeof s=="function"&&s.prototype||r;return t===n}return un=e,un}var cn,js;function xl(){if(js)return cn;js=1;function r(e,t){return function(s){return e(t(s))}}return cn=r,cn}var hn,Hs;function Gi(){if(Hs)return hn;Hs=1;var r=xl(),e=r(Object.keys,Object);return hn=e,hn}var pn,Us;function Ki(){if(Us)return pn;Us=1;var r=yo(),e=Gi(),t=Object.prototype,s=t.hasOwnProperty;function n(l){if(!r(l))return e(l);var i=[];for(var d in Object(l))s.call(l,d)&&d!="constructor"&&i.push(d);return i}return pn=n,pn}var fn,Vs;function _l(){if(Vs)return fn;Vs=1;var r=fl(),e=yl();function t(s){return s!=null&&e(s.length)&&!r(s)}return fn=t,fn}var mn,Ws;function wo(){if(Ws)return mn;Ws=1;var r=wl(),e=Ki(),t=_l();function s(n){return t(n)?r(n):e(n)}return mn=s,mn}var gn,Gs;function Yi(){if(Gs)return gn;Gs=1;var r=Zt(),e=wo();function t(s,n){return s&&r(n,e(n),s)}return gn=t,gn}var vn,Ks;function Xi(){if(Ks)return vn;Ks=1;function r(e){var t=[];if(e!=null)for(var s in Object(e))t.push(s);return t}return vn=r,vn}var bn,Ys;function Zi(){if(Ys)return bn;Ys=1;var r=mt(),e=yo(),t=Xi(),s=Object.prototype,n=s.hasOwnProperty;function l(i){if(!r(i))return t(i);var d=e(i),c=[];for(var g in i)g=="constructor"&&(d||!n.call(i,g))||c.push(g);return c}return bn=l,bn}var yn,Xs;function xo(){if(Xs)return yn;Xs=1;var r=wl(),e=Zi(),t=_l();function s(n){return t(n)?r(n,!0):e(n)}return yn=s,yn}var wn,Zs;function Ji(){if(Zs)return wn;Zs=1;var r=Zt(),e=xo();function t(s,n){return s&&r(n,e(n),s)}return wn=t,wn}var zt={exports:{}};zt.exports;var Js;function Qi(){return Js||(Js=1,(function(r,e){var t=rt(),s=e&&!e.nodeType&&e,n=s&&!0&&r&&!r.nodeType&&r,l=n&&n.exports===s,i=l?t.Buffer:void 0,d=i?i.allocUnsafe:void 0;function c(g,w){if(w)return g.slice();var m=g.length,_=d?d(m):new g.constructor(m);return g.copy(_),_}r.exports=c})(zt,zt.exports)),zt.exports}var xn,Qs;function ed(){if(Qs)return xn;Qs=1;function r(e,t){var s=-1,n=e.length;for(t||(t=Array(n));++s<n;)t[s]=e[s];return t}return xn=r,xn}var _n,ea;function td(){if(ea)return _n;ea=1;function r(e,t){for(var s=-1,n=e==null?0:e.length,l=0,i=[];++s<n;){var d=e[s];t(d,s,e)&&(i[l++]=d)}return i}return _n=r,_n}var kn,ta;function kl(){if(ta)return kn;ta=1;function r(){return[]}return kn=r,kn}var Sn,ra;function _o(){if(ra)return Sn;ra=1;var r=td(),e=kl(),t=Object.prototype,s=t.propertyIsEnumerable,n=Object.getOwnPropertySymbols,l=n?function(i){return i==null?[]:(i=Object(i),r(n(i),function(d){return s.call(i,d)}))}:e;return Sn=l,Sn}var Cn,na;function rd(){if(na)return Cn;na=1;var r=Zt(),e=_o();function t(s,n){return r(s,e(s),n)}return Cn=t,Cn}var En,oa;function Sl(){if(oa)return En;oa=1;function r(e,t){for(var s=-1,n=t.length,l=e.length;++s<n;)e[l+s]=t[s];return e}return En=r,En}var Tn,sa;function Cl(){if(sa)return Tn;sa=1;var r=xl(),e=r(Object.getPrototypeOf,Object);return Tn=e,Tn}var $n,aa;function El(){if(aa)return $n;aa=1;var r=Sl(),e=Cl(),t=_o(),s=kl(),n=Object.getOwnPropertySymbols,l=n?function(i){for(var d=[];i;)r(d,t(i)),i=e(i);return d}:s;return $n=l,$n}var In,la;function nd(){if(la)return In;la=1;var r=Zt(),e=El();function t(s,n){return r(s,e(s),n)}return In=t,In}var An,ia;function Tl(){if(ia)return An;ia=1;var r=Sl(),e=go();function t(s,n,l){var i=n(s);return e(s)?i:r(i,l(s))}return An=t,An}var zn,da;function od(){if(da)return zn;da=1;var r=Tl(),e=_o(),t=wo();function s(n){return r(n,t,e)}return zn=s,zn}var Pn,ua;function sd(){if(ua)return Pn;ua=1;var r=Tl(),e=El(),t=xo();function s(n){return r(n,t,e)}return Pn=s,Pn}var Ln,ca;function ad(){if(ca)return Ln;ca=1;var r=gt(),e=rt(),t=r(e,"DataView");return Ln=t,Ln}var Mn,ha;function ld(){if(ha)return Mn;ha=1;var r=gt(),e=rt(),t=r(e,"Promise");return Mn=t,Mn}var Rn,pa;function id(){if(pa)return Rn;pa=1;var r=gt(),e=rt(),t=r(e,"Set");return Rn=t,Rn}var Dn,fa;function dd(){if(fa)return Dn;fa=1;var r=gt(),e=rt(),t=r(e,"WeakMap");return Dn=t,Dn}var Bn,ma;function ko(){if(ma)return Bn;ma=1;var r=ad(),e=mo(),t=ld(),s=id(),n=dd(),l=Bt(),i=ml(),d="[object Map]",c="[object Object]",g="[object Promise]",w="[object Set]",m="[object WeakMap]",_="[object DataView]",p=i(r),S=i(e),v=i(t),k=i(s),b=i(n),f=l;return(r&&f(new r(new ArrayBuffer(1)))!=_||e&&f(new e)!=d||t&&f(t.resolve())!=g||s&&f(new s)!=w||n&&f(new n)!=m)&&(f=function(T){var D=l(T),j=D==c?T.constructor:void 0,B=j?i(j):"";if(B)switch(B){case p:return _;case S:return d;case v:return g;case k:return w;case b:return m}return D}),Bn=f,Bn}var On,ga;function ud(){if(ga)return On;ga=1;var r=Object.prototype,e=r.hasOwnProperty;function t(s){var n=s.length,l=new s.constructor(n);return n&&typeof s[0]=="string"&&e.call(s,"index")&&(l.index=s.index,l.input=s.input),l}return On=t,On}var qn,va;function cd(){if(va)return qn;va=1;var r=rt(),e=r.Uint8Array;return qn=e,qn}var Fn,ba;function So(){if(ba)return Fn;ba=1;var r=cd();function e(t){var s=new t.constructor(t.byteLength);return new r(s).set(new r(t)),s}return Fn=e,Fn}var Nn,ya;function hd(){if(ya)return Nn;ya=1;var r=So();function e(t,s){var n=s?r(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.byteLength)}return Nn=e,Nn}var jn,wa;function pd(){if(wa)return jn;wa=1;var r=/\w*$/;function e(t){var s=new t.constructor(t.source,r.exec(t));return s.lastIndex=t.lastIndex,s}return jn=e,jn}var Hn,xa;function fd(){if(xa)return Hn;xa=1;var r=fo(),e=r?r.prototype:void 0,t=e?e.valueOf:void 0;function s(n){return t?Object(t.call(n)):{}}return Hn=s,Hn}var Un,_a;function md(){if(_a)return Un;_a=1;var r=So();function e(t,s){var n=s?r(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.length)}return Un=e,Un}var Vn,ka;function gd(){if(ka)return Vn;ka=1;var r=So(),e=hd(),t=pd(),s=fd(),n=md(),l="[object Boolean]",i="[object Date]",d="[object Map]",c="[object Number]",g="[object RegExp]",w="[object Set]",m="[object String]",_="[object Symbol]",p="[object ArrayBuffer]",S="[object DataView]",v="[object Float32Array]",k="[object Float64Array]",b="[object Int8Array]",f="[object Int16Array]",T="[object Int32Array]",D="[object Uint8Array]",j="[object Uint8ClampedArray]",B="[object Uint16Array]",A="[object Uint32Array]";function V(Y,se,G){var I=Y.constructor;switch(se){case p:return r(Y);case l:case i:return new I(+Y);case S:return e(Y,G);case v:case k:case b:case f:case T:case D:case j:case B:case A:return n(Y,G);case d:return new I;case c:case m:return new I(Y);case g:return t(Y);case w:return new I;case _:return s(Y)}}return Vn=V,Vn}var Wn,Sa;function vd(){if(Sa)return Wn;Sa=1;var r=mt(),e=Object.create,t=(function(){function s(){}return function(n){if(!r(n))return{};if(e)return e(n);s.prototype=n;var l=new s;return s.prototype=void 0,l}})();return Wn=t,Wn}var Gn,Ca;function bd(){if(Ca)return Gn;Ca=1;var r=vd(),e=Cl(),t=yo();function s(n){return typeof n.constructor=="function"&&!t(n)?r(e(n)):{}}return Gn=s,Gn}var Kn,Ea;function yd(){if(Ea)return Kn;Ea=1;var r=ko(),e=kt(),t="[object Map]";function s(n){return e(n)&&r(n)==t}return Kn=s,Kn}var Yn,Ta;function wd(){if(Ta)return Yn;Ta=1;var r=yd(),e=vo(),t=bo(),s=t&&t.isMap,n=s?e(s):r;return Yn=n,Yn}var Xn,$a;function xd(){if($a)return Xn;$a=1;var r=ko(),e=kt(),t="[object Set]";function s(n){return e(n)&&r(n)==t}return Xn=s,Xn}var Zn,Ia;function _d(){if(Ia)return Zn;Ia=1;var r=xd(),e=vo(),t=bo(),s=t&&t.isSet,n=s?e(s):r;return Zn=n,Zn}var Jn,Aa;function kd(){if(Aa)return Jn;Aa=1;var r=Bi(),e=Oi(),t=vl(),s=Yi(),n=Ji(),l=Qi(),i=ed(),d=rd(),c=nd(),g=od(),w=sd(),m=ko(),_=ud(),p=gd(),S=bd(),v=go(),k=bl(),b=wd(),f=mt(),T=_d(),D=wo(),j=xo(),B=1,A=2,V=4,Y="[object Arguments]",se="[object Array]",G="[object Boolean]",I="[object Date]",q="[object Error]",h="[object Function]",y="[object GeneratorFunction]",ee="[object Map]",K="[object Number]",te="[object Object]",$="[object RegExp]",W="[object Set]",L="[object String]",O="[object Symbol]",re="[object WeakMap]",Z="[object ArrayBuffer]",ne="[object DataView]",ve="[object Float32Array]",we="[object Float64Array]",ie="[object Int8Array]",ke="[object Int16Array]",_e="[object Int32Array]",oe="[object Uint8Array]",ue="[object Uint8ClampedArray]",J="[object Uint16Array]",u="[object Uint32Array]",U={};U[Y]=U[se]=U[Z]=U[ne]=U[G]=U[I]=U[ve]=U[we]=U[ie]=U[ke]=U[_e]=U[ee]=U[K]=U[te]=U[$]=U[W]=U[L]=U[O]=U[oe]=U[ue]=U[J]=U[u]=!0,U[q]=U[h]=U[re]=!1;function P(x,C,N,M,X,R){var ae,he=C&B,de=C&A,pe=C&V;if(N&&(ae=X?N(x,M,X,R):N(x)),ae!==void 0)return ae;if(!f(x))return x;var Q=v(x);if(Q){if(ae=_(x),!he)return i(x,ae)}else{var H=m(x),me=H==h||H==y;if(k(x))return l(x,he);if(H==te||H==Y||me&&!X){if(ae=de||me?{}:S(x),!he)return de?c(x,n(ae,x)):d(x,s(ae,x))}else{if(!U[H])return X?x:{};ae=p(x,H,he)}}R||(R=new r);var Oe=R.get(x);if(Oe)return Oe;R.set(x,ae),T(x)?x.forEach(function(Ie){ae.add(P(Ie,C,N,Ie,x,R))}):b(x)&&x.forEach(function(Ie,Fe){ae.set(Fe,P(Ie,C,N,Fe,x,R))});var Be=pe?de?w:g:de?j:D,Ue=Q?void 0:Be(x);return e(Ue||x,function(Ie,Fe){Ue&&(Fe=Ie,Ie=x[Fe]),t(ae,Fe,P(Ie,C,N,Fe,x,R))}),ae}return Jn=P,Jn}var Qn,za;function Sd(){if(za)return Qn;za=1;var r=kd(),e=1,t=4;function s(n){return r(n,e|t)}return Qn=s,Qn}var Cd=Sd();const Ee=_t(Cd);var ge=(r=>(r.TEXT="text",r.IMAGE="image",r.TABLE="table",r.PAGE_NUMBER="pageNumber",r.BARCODE="barcode",r.QRCODE="qrcode",r.LINE="line",r.RECT="rect",r.CIRCLE="circle",r))(ge||{});const Ed={mode:"local",endpoints:{baseUrl:"",templates:{list:"/api/print/templates",get:"/api/print/templates/{id}",upsert:"/api/print/templates",delete:"/api/print/templates/{id}"},customElements:{list:"/api/print/custom-elements",get:"/api/print/custom-elements/{id}",upsert:"/api/print/custom-elements",delete:"/api/print/custom-elements/{id}"}},headers:{"Content-Type":"application/json"}};let Pt={...Ed};const Td=(r,e)=>({...r}),Qe=()=>({mode:Pt.mode,endpoints:Td(Pt.endpoints),headers:{...Pt.headers||{}},fetcher:Pt.fetcher}),$d=r=>{const e=Pt.endpoints.baseUrl||"";return r?/^https?:\/\//i.test(r)||!e?r:r.startsWith("/")?`${e.replace(/\/+$/,"")}${r}`:`${e.replace(/\/+$/,"")}/${r}`:e||""},et=(r,e)=>{const t=r||"",s=e?t.replace("{id}",e):t;return $d(s)},Lt={enabled:!1,text:"",angle:-30,color:"#000000",opacity:.1,size:24,density:160},Id={title:"",logoUrl:"",showTitle:!0,showLogo:!0},Ad=()=>{const r=localStorage.getItem("print-designer-watermark");if(!r)return{...Lt};try{return{...Lt,...JSON.parse(r)}}catch{return{...Lt}}},Re=dl("designer",{state:()=>({unit:localStorage.getItem("print-designer-unit")||"mm",watermark:Ad(),branding:{...Id},pages:[{id:He(),elements:[]}],currentPageIndex:0,customElements:JSON.parse(localStorage.getItem("print-designer-custom-elements")||"[]"),testData:{},editingCustomElementId:null,customElementEditSnapshot:null,selectedElementId:null,selectedElementIds:[],selectedGuideId:null,highlightedGuideId:null,highlightedEdge:null,canvasSize:{width:794,height:1123},zoom:1,isDragging:!1,showGrid:!0,showCornerMarkers:!0,headerHeight:100,footerHeight:100,showHeaderLine:!1,showFooterLine:!1,showMinimap:!1,showHelp:!1,showSettings:!1,canvasBackground:"#ffffff",pageSpacingX:32,pageSpacingY:32,guides:[],historyPast:[],historyFuture:[],clipboard:[],copiedPage:null,isExporting:!1,disableGlobalShortcuts:!1,disableShortcutsCount:0,tableSelection:null}),actions:{setBranding(r){if(!r||typeof r!="object")return;const e={...this.branding,...r};r.showTitle!==void 0&&(e.showTitle=!!r.showTitle),r.showLogo!==void 0&&(e.showLogo=!!r.showLogo),this.branding=e},setWatermark(r){this.watermark={...this.watermark||Lt,...r},localStorage.setItem("print-designer-watermark",JSON.stringify(this.watermark))},setUnit(r){this.unit=r,localStorage.setItem("print-designer-unit",r)},setDragging(r){this.isDragging=r},setDisableGlobalShortcuts(r){const e=this.disableShortcutsCount||0;r?this.disableShortcutsCount=e+1:this.disableShortcutsCount=Math.max(0,e-1),this.disableGlobalShortcuts=this.disableShortcutsCount>0},setIsExporting(r){this.isExporting=r},setPageSpacingX(r){this.pageSpacingX=Math.max(0,Math.round(r))},setPageSpacingY(r){this.pageSpacingY=Math.max(0,Math.round(r))},resetCanvas(){this.watermark={...Lt},localStorage.setItem("print-designer-watermark",JSON.stringify(this.watermark)),this.pages=[{id:He(),elements:[]}],this.currentPageIndex=0,this.testData={},this.selectedElementId=null,this.selectedElementIds=[],this.selectedGuideId=null,this.guides=[],this.historyPast=[],this.historyFuture=[],this.headerHeight=100,this.footerHeight=100,this.showHeaderLine=!1,this.showFooterLine=!1,this.canvasBackground="#ffffff",this.pageSpacingX=32,this.pageSpacingY=32,this.canvasSize={width:794,height:1123},this.zoom=1,this.showGrid=!0,this.showCornerMarkers=!0,this.showMinimap=!1,this.showHelp=!1,this.showSettings=!1,this.copiedPage=null},startCustomElementEdit(r){const e=this.customElements.find(s=>s.id===r);if(!e)return;this.customElementEditSnapshot||(this.customElementEditSnapshot={pages:Ee(this.pages),historyPast:Ee(this.historyPast),historyFuture:Ee(this.historyFuture),canvasSize:Ee(this.canvasSize),guides:Ee(this.guides),zoom:this.zoom,showGrid:this.showGrid,headerHeight:this.headerHeight,footerHeight:this.footerHeight,showHeaderLine:this.showHeaderLine,showFooterLine:this.showFooterLine,showMinimap:this.showMinimap,canvasBackground:this.canvasBackground,pageSpacingX:this.pageSpacingX,pageSpacingY:this.pageSpacingY,unit:this.unit,watermark:Ee(this.watermark),testData:Ee(this.testData),currentPageIndex:this.currentPageIndex,selectedElementId:this.selectedElementId,selectedElementIds:Ee(this.selectedElementIds),selectedGuideId:this.selectedGuideId,highlightedGuideId:this.highlightedGuideId,highlightedEdge:this.highlightedEdge}),this.editingCustomElementId=r,this.resetCanvas();const t=Ee(e.element);t.id=He(),this.pages=[{id:He(),elements:[t]}],this.currentPageIndex=0,this.selectedElementId=t.id,this.selectedElementIds=[t.id],this.historyPast=[],this.historyFuture=[],this.guides=[],this.tableSelection=null},cancelCustomElementEdit(){const r=this.customElementEditSnapshot;this.editingCustomElementId=null,this.customElementEditSnapshot=null,r&&(this.pages=r.pages,this.historyPast=r.historyPast||[],this.historyFuture=r.historyFuture||[],this.canvasSize=r.canvasSize,this.guides=r.guides,this.zoom=r.zoom,this.showGrid=r.showGrid,this.headerHeight=r.headerHeight,this.footerHeight=r.footerHeight,this.showHeaderLine=r.showHeaderLine,this.showFooterLine=r.showFooterLine,this.showMinimap=r.showMinimap,this.canvasBackground=r.canvasBackground,this.pageSpacingX=r.pageSpacingX??this.pageSpacingX,this.pageSpacingY=r.pageSpacingY??this.pageSpacingY,this.unit=r.unit||this.unit,r.unit&&localStorage.setItem("print-designer-unit",r.unit),r.watermark&&(this.watermark=Ee(r.watermark),localStorage.setItem("print-designer-watermark",JSON.stringify(this.watermark))),this.testData=r.testData||{},this.currentPageIndex=r.currentPageIndex,this.selectedElementId=r.selectedElementId,this.selectedElementIds=r.selectedElementIds,this.selectedGuideId=r.selectedGuideId,this.highlightedGuideId=r.highlightedGuideId,this.highlightedEdge=r.highlightedEdge,this.tableSelection=null)},commitCustomElementEdit(){var t;if(!this.editingCustomElementId)return!1;const r=this.customElements.find(s=>s.id===this.editingCustomElementId);if(!r)return!1;const e=this.selectedElement||((t=this.pages[0])==null?void 0:t.elements[0]);return e?(r.element=Ee(e),this.saveCustomElements(),!0):!1},saveCustomElementEditAs(r){var t;const e=this.selectedElement||((t=this.pages[0])==null?void 0:t.elements[0]);return e?(this.addCustomElement(r,e),!0):!1},copyPage(r){const e=this.pages[r];e&&(this.copiedPage=Ee(e))},pastePage(r){if(!this.copiedPage)return;this.snapshot();const e=Ee(this.copiedPage);e.id=He(),e.elements.forEach(t=>{t.id=He()}),this.pages.splice(r+1,0,e),this.currentPageIndex=r+1},addPage(){this.snapshot(),this.pages.push({id:He(),elements:[]}),this.currentPageIndex=this.pages.length-1},removePage(r){this.pages.length<=1||(this.snapshot(),this.pages.splice(r,1),this.currentPageIndex>=this.pages.length&&(this.currentPageIndex=this.pages.length-1))},setTableSelection(r,e,t){if(this.tableSelection&&this.tableSelection.elementId!==r){this.tableSelection={elementId:r,cells:[e]};return}if(!this.tableSelection){this.tableSelection={elementId:r,cells:[e]};return}if(t){const s=this.tableSelection.cells.findIndex(n=>n.rowIndex===e.rowIndex&&n.colField===e.colField&&n.section===e.section);s>=0?(this.tableSelection.cells.splice(s,1),this.tableSelection.cells.length===0&&(this.tableSelection=null)):this.tableSelection.cells.length>0&&this.tableSelection.cells[0].section!==e.section?this.tableSelection={elementId:r,cells:[e]}:this.tableSelection.cells.push(e)}else this.tableSelection={elementId:r,cells:[e]}},setTableSelectionCells(r,e){this.tableSelection={elementId:r,cells:e}},clearTableSelection(){this.tableSelection=null},mergeSelectedCells(){if(!this.tableSelection||this.tableSelection.cells.length<2)return;const{elementId:r,cells:e}=this.tableSelection,t=e[0].section||"body";let s=null,n=-1,l=-1;for(let b=0;b<this.pages.length;b++){const f=this.pages[b].elements.findIndex(T=>T.id===r);if(f!==-1){s=this.pages[b].elements[f],n=b,l=f;break}}if(!s||!s.columns)return;const i=t==="footer"?"footerData":"data";if(!s[i])return;const d=e.map(b=>b.rowIndex),c=Math.min(...d),g=Math.max(...d),w=s.columns.map(b=>b.field),m=e.map(b=>w.indexOf(b.colField)).filter(b=>b!==-1);if(m.length!==e.length)return;const _=Math.min(...m),p=Math.max(...m),S=g-c+1,v=p-_+1;this.snapshot();const k=Ee(s[i]);for(let b=c;b<=g;b++)for(let f=_;f<=p;f++){const T=w[f],D=k[b];D&&(typeof D[T]!="object"||D[T]===null?D[T]={value:D[T]}:"value"in D[T],b===c&&f===_?(D[T].rowSpan=S,D[T].colSpan=v):(D[T].rowSpan=0,D[T].colSpan=0,D[T].value=""))}this.pages[n].elements[l]={...s,[i]:k},this.tableSelection=null},splitSelectedCells(){if(!this.tableSelection||this.tableSelection.cells.length!==1)return;const{elementId:r,cells:e}=this.tableSelection,t=e[0],s=t.section||"body";let n=null,l=-1,i=-1;for(let v=0;v<this.pages.length;v++){const k=this.pages[v].elements.findIndex(b=>b.id===r);if(k!==-1){n=this.pages[v].elements[k],l=v,i=k;break}}if(!n||!n.columns)return;const d=s==="footer"?"footerData":"data";if(!n[d])return;const c=n[d][t.rowIndex];if(!c)return;const g=c[t.colField];if(!g||typeof g!="object"||!g.rowSpan&&!g.colSpan)return;const w=g.rowSpan||1,m=g.colSpan||1;if(w<=1&&m<=1)return;this.snapshot();const _=Ee(n[d]),p=n.columns.map(v=>v.field),S=p.indexOf(t.colField);for(let v=t.rowIndex;v<t.rowIndex+w;v++)for(let k=S;k<S+m;k++){const b=p[k],f=_[v];f&&f[b]&&typeof f[b]=="object"&&(f[b].rowSpan=1,f[b].colSpan=1)}this.pages[l].elements[i]={...n,[d]:_},this.tableSelection=null},setHeaderHeight(r){this.headerHeight=r},setFooterHeight(r){this.footerHeight=r},setShowHeaderLine(r){this.showHeaderLine=r},setShowFooterLine(r){this.showFooterLine=r},setShowMinimap(r){this.showMinimap=r},setShowHelp(r){this.showHelp=r},setShowSettings(r){this.showSettings=r},setCanvasBackground(r){this.canvasBackground=r},snapshot(){this.historyPast.length>=20&&this.historyPast.shift(),this.historyPast.push(Ee(this.pages)),this.historyFuture=[]},undo(){if(this.historyPast.length===0)return;const r=this.historyPast.pop();this.historyFuture.push(Ee(this.pages)),this.pages=Ee(r),this.selectedElementId&&(this.pages.some(t=>t.elements.some(s=>s.id===this.selectedElementId))||(this.selectedElementId=null,this.selectedElementIds=[])),this.selectedElementIds=this.selectedElementIds.filter(e=>this.pages.some(t=>t.elements.some(s=>s.id===e))),this.currentPageIndex>=this.pages.length&&(this.currentPageIndex=Math.max(0,this.pages.length-1))},redo(){if(this.historyFuture.length===0)return;const r=this.historyFuture.pop();this.historyPast.push(Ee(this.pages)),this.pages=Ee(r),this.currentPageIndex>=this.pages.length&&(this.currentPageIndex=Math.max(0,this.pages.length-1))},addGuide(r){this.guides.push({...r,id:He()})},updateGuide(r,e){const t=this.guides.find(s=>s.id===r);t&&(t.position=e)},removeGuide(r){const e=this.guides.findIndex(t=>t.id===r);e!==-1&&(this.guides.splice(e,1),this.selectedGuideId===r&&(this.selectedGuideId=null))},clearGuides(){this.guides=[]},selectGuide(r){this.selectedGuideId=r,r&&(this.selectedElementId=null,this.selectedElementIds=[],this.tableSelection=null)},setHighlightedGuide(r){this.highlightedGuideId=r},setHighlightedEdge(r){this.highlightedEdge=r},setShowCornerMarkers(r){this.showCornerMarkers=r},getSnapPosition(r,e,t,s=!1,n=!0,l=-1){let d=e,c=t,g=null,w=null;const m=(f,T,D)=>{const j=Math.abs(f-D);if(j>5)return!1;if(s){const B=Math.abs(T-D);return j<B}return!0},_=Math.max(0,this.canvasSize.width-r.width),p=Math.max(0,this.canvasSize.height-r.height);m(d,r.x,0)?(d=0,w="left"):m(d+r.width,r.x+r.width,this.canvasSize.width)&&(d=_,w="right"),m(c,r.y,0)?(c=0,w=w||"top"):m(c+r.height,r.y+r.height,this.canvasSize.height)&&(c=p,w=w||"bottom");for(const f of this.guides)f.type==="vertical"?m(d,r.x,f.position)?(d=f.position,g=f.id):m(d+r.width,r.x+r.width,f.position)&&(d=f.position-r.width,g=f.id):m(c,r.y,f.position)?(c=f.position,g=f.id):m(c+r.height,r.y+r.height,f.position)&&(c=f.position-r.height,g=f.id);let S=n,v=n,k=!1,b=!1;return n||(this.pages.length<=1?(S=!0,v=!0):(S=!0,l===0&&(k=!0),l===this.pages.length-1&&(b=!0))),S&&(d=Math.min(Math.max(0,d),_)),v?c=Math.min(Math.max(0,c),p):(k&&(c=Math.max(0,c)),b&&(c=Math.min(c,p))),{x:d,y:c,highlightedGuideId:g,highlightedEdge:w}},moveElementWithSnap(r,e,t,s=!0,n=!0){for(let l=0;l<this.pages.length;l++){const i=this.pages[l],d=i.elements.findIndex(c=>c.id===r);if(d!==-1){const c=i.elements[d];if(c.locked)return;const g=this.getSnapPosition(c,e,t,!1,n,l);this.setHighlightedGuide(g.highlightedGuideId||null),this.setHighlightedEdge(g.highlightedEdge||null),this.updateElement(r,{x:g.x,y:g.y},s);return}}},moveSelectedElements(r,e,t,s=!0,n=!0){s&&this.snapshot();let l=null,i=-1;const d=[],c=new Set(this.selectedElementIds);for(let S=0;S<this.pages.length;S++){const v=this.pages[S];for(let k=0;k<v.elements.length;k++){const b=v.elements[k];b.id===r&&(l=b,i=S),c.has(b.id)&&!b.locked&&d.push({pageIndex:S,elementIndex:k,element:b})}}if(!l||l.locked)return;const g=this.getSnapPosition(l,e,t,!1,n,i);this.setHighlightedGuide(g.highlightedGuideId||null),this.setHighlightedEdge(g.highlightedEdge||null);let w=g.x-l.x,m=g.y-l.y;if(w===0&&m===0)return;let _=n,p=n;if(n||(this.pages.length<=1?(_=!0,p=!0):(_=!0,p=!1)),_||p||!p&&this.pages.length>1)for(const S of d){const v=S.element,k=S.pageIndex;if(_)if(w>0){const b=this.canvasSize.width-v.width;v.x+w>b&&(w=b-v.x)}else w<0&&v.x+w<0&&(w=-v.x);if(p)if(m>0){const b=this.canvasSize.height-v.height;v.y+m>b&&(m=b-v.y)}else m<0&&v.y+m<0&&(m=-v.y);else if(k===0&&m<0&&v.y+m<0&&(m=-v.y),k===this.pages.length-1&&m>0){const b=this.canvasSize.height-v.height;v.y+m>b&&(m=b-v.y)}}if(!(w===0&&m===0))for(const S of d){const{pageIndex:v,elementIndex:k,element:b}=S;this.pages[v].elements[k]={...b,x:b.x+w,y:b.y+m}}},nudgeSelectedElements(r,e){if(this.selectedElementIds.length===0)return;const t=this.selectedElementIds.filter(w=>{for(const m of this.pages){const _=m.elements.find(p=>p.id===w);if(_&&!_.locked)return!0}return!1});if(t.length===0)return;this.snapshot();let s=this.selectedElementId;(!s||!t.includes(s))&&(s=t[0]);let n=null;for(const w of this.pages){const m=w.elements.find(_=>_.id===s);if(m){n=m;break}}if(!n)return;const l=n.x+r,i=n.y+e,d=this.getSnapPosition(n,l,i,!0);this.setHighlightedGuide(d.highlightedGuideId||null),this.setHighlightedEdge(d.highlightedEdge||null);let c=d.x-n.x,g=d.y-n.y;for(const w of t)for(const m of this.pages){const _=m.elements.find(p=>p.id===w);if(_){if(c>0){const p=this.canvasSize.width-_.width;_.x+c>p&&(c=p-_.x)}else c<0&&_.x+c<0&&(c=-_.x);if(g>0){const p=this.canvasSize.height-_.height;_.y+g>p&&(g=p-_.y)}else g<0&&_.y+g<0&&(g=-_.y)}}if(!(c===0&&g===0))for(const w of t)for(const m of this.pages){const _=m.elements.findIndex(p=>p.id===w);if(_!==-1){const p=m.elements[_];m.elements[_]={...p,x:p.x+c,y:p.y+g};break}}},addElement(r,e){this.snapshot();const t={...r,id:He()},s=e!==void 0&&e>=0&&e<this.pages.length?e:this.currentPageIndex;this.pages[s].elements.push(t),this.selectedElementId=t.id,this.currentPageIndex=s},moveElementToPage(r,e,t,s){this.snapshot();let n=-1,l=-1,i;for(let d=0;d<this.pages.length;d++){const c=this.pages[d].elements.findIndex(g=>g.id===r);if(c!==-1){n=d,l=c,i=this.pages[d].elements[c];break}}!i||n===-1||(this.pages[n].elements.splice(l,1),i.x=t,i.y=s,e>=0&&e<this.pages.length?(this.pages[e].elements.push(i),this.currentPageIndex=e):this.pages[n].elements.push(i))},updateElement(r,e,t=!0){t&&this.snapshot();for(const s of this.pages){const n=s.elements.findIndex(l=>l.id===r);if(n!==-1){if(s.elements[n].locked&&e.locked===void 0)return;s.elements[n]={...s.elements[n],...e};return}}},removeElement(r){for(const e of this.pages){const t=e.elements.find(s=>s.id===r);if(t&&t.locked)return}this.snapshot();for(const e of this.pages){const t=e.elements.findIndex(s=>s.id===r);if(t!==-1){e.elements.splice(t,1),this.selectedElementId===r&&(this.selectedElementId=null),this.tableSelection&&this.tableSelection.elementId===r&&(this.tableSelection=null);const s=this.selectedElementIds.indexOf(r);s!==-1&&this.selectedElementIds.splice(s,1);return}}},selectElement(r,e=!1){if(r&&(this.selectedGuideId=null),this.tableSelection&&(this.tableSelection=null),e&&r){if(this.selectedElementIds.includes(r)){const t=this.selectedElementIds.indexOf(r);this.selectedElementIds.splice(t,1)}else this.selectedElementIds.push(r);this.selectedElementId=this.selectedElementIds.length>0?this.selectedElementIds[this.selectedElementIds.length-1]:null}else this.selectedElementId=r,this.selectedElementIds=r?[r]:[];if(r){const t=this.pages.findIndex(s=>s.elements.some(n=>n.id===r));t!==-1&&(this.currentPageIndex=t)}},clearSelection(){this.selectedElementId=null,this.selectedElementIds=[],this.tableSelection=null},setSelection(r){if(this.tableSelection=null,r.length>0&&(this.selectedGuideId=null),this.selectedElementIds=r,this.selectedElementId=r.length>0?r[r.length-1]:null,r.length>0){const e=this.pages.findIndex(t=>t.elements.some(s=>s.id===this.selectedElementId));e!==-1&&(this.currentPageIndex=e)}},removeSelectedElements(){if(this.selectedElementIds.length===0)return;const r=this.selectedElementIds.filter(e=>{for(const t of this.pages){const s=t.elements.find(n=>n.id===e);if(s&&!s.locked)return!0}return!1});if(r.length!==0){this.snapshot();for(const e of r)for(const t of this.pages){const s=t.elements.findIndex(n=>n.id===e);if(s!==-1){t.elements.splice(s,1);break}}this.selectedElementId=null,this.selectedElementIds=[],this.tableSelection=null}},alignSelectedElements(r){if(this.selectedElementIds.length===0)return;const e=[];for(const t of this.selectedElementIds)for(const s of this.pages){const n=s.elements.find(l=>l.id===t);if(n&&!n.locked){e.push(n);break}}if(e.length!==0)if(this.snapshot(),e.length===1){const t=e[0],s=this.canvasSize.width,n=this.canvasSize.height;switch(r){case"left":t.x=0;break;case"center":t.x=(s-t.width)/2;break;case"right":t.x=s-t.width;break;case"top":t.y=0;break;case"middle":t.y=(n-t.height)/2;break;case"bottom":t.y=n-t.height;break}}else{const t=Math.min(...e.map(c=>c.x)),s=Math.max(...e.map(c=>c.x+c.width)),n=Math.min(...e.map(c=>c.y)),l=Math.max(...e.map(c=>c.y+c.height)),i=(t+s)/2,d=(n+l)/2;e.forEach(c=>{switch(r){case"left":c.x=t;break;case"center":c.x=i-c.width/2;break;case"right":c.x=s-c.width;break;case"top":c.y=n;break;case"middle":c.y=d-c.height/2;break;case"bottom":c.y=l-c.height;break}})}},resizeSelectedElements(r,e){if(this.selectedElementIds.length===0)return;const t=this.selectedElementIds.filter(s=>{for(const n of this.pages){const l=n.elements.find(i=>i.id===s);if(l&&!l.locked)return!0}return!1});if(t.length!==0){this.snapshot();for(const s of t)for(const n of this.pages){const l=n.elements.findIndex(i=>i.id===s);if(l!==-1){const i=n.elements[l],d=Math.max(10,i.width+r),c=Math.max(10,i.height+e);n.elements[l]={...i,width:d,height:c};break}}}},updateSelectedElementsStyle(r){if(this.selectedElementIds.length===0)return;this.selectedElementIds.some(t=>{for(const s of this.pages){const n=s.elements.find(l=>l.id===t);if(n&&n.locked)return!0}return!1});const e=this.selectedElementIds.filter(t=>{for(const s of this.pages){const n=s.elements.find(l=>l.id===t);if(n&&!n.locked)return!0}return!1});if(e.length!==0){this.snapshot();for(const t of e)for(const s of this.pages){const n=s.elements.findIndex(l=>l.id===t);if(n!==-1){const l=s.elements[n];s.elements[n]={...l,style:{...l.style,...r}};break}}}},toggleLock(){if(this.selectedElementIds.length===0)return;this.snapshot();let r=!0;const e=this.selectedElement;e&&(r=!e.locked);for(const t of this.selectedElementIds)for(const s of this.pages){const n=s.elements.findIndex(l=>l.id===t);if(n!==-1){s.elements[n].locked=r;break}}},setZoom(r){this.zoom=r},setCanvasSize(r,e){this.snapshot(),this.canvasSize={width:r,height:e}},setShowGrid(r){this.showGrid=r},deletePage(r){this.pages.length>1&&(this.snapshot(),this.pages.splice(r,1),this.currentPageIndex>=this.pages.length&&(this.currentPageIndex=this.pages.length-1))},copy(){if(this.selectedElementIds.length===0)return;const r=[];for(const e of this.selectedElementIds)for(const t of this.pages){const s=t.elements.find(n=>n.id===e);if(s&&!s.locked){r.push(Ee(s));break}}this.clipboard=r},cut(){this.selectedElementIds.length!==0&&(this.copy(),this.removeSelectedElements())},paste(r){if(this.clipboard.length===0)return;this.snapshot();const e=[],t=(r==null?void 0:r.pageIndex)??this.currentPageIndex;let s=1/0,n=1/0;if(r)for(const l of this.clipboard)s=Math.min(s,l.x),n=Math.min(n,l.y);for(const l of this.clipboard){const i=Ee(l);if(i.id=He(),r){const d=l.x-s,c=l.y-n;i.x=r.x+d,i.y=r.y+c}else i.x+=20,i.y+=20;i.x+i.width>this.canvasSize.width&&(i.x=Math.max(0,this.canvasSize.width-i.width)),i.y+i.height>this.canvasSize.height&&(i.y=Math.max(0,this.canvasSize.height-i.height)),i.x=Math.max(0,i.x),i.y=Math.max(0,i.y),this.pages[t]?this.pages[t].elements.push(i):this.pages[this.currentPageIndex].elements.push(i),e.push(i.id)}t!==this.currentPageIndex&&this.pages[t]&&(this.currentPageIndex=t),this.setSelection(e)},paginateTable(r){this.snapshot();let e=-1,t;for(let v=0;v<this.pages.length;v++){const k=this.pages[v].elements.findIndex(b=>b.id===r);if(k!==-1){e=v,t=this.pages[v].elements[k];break}}if(!t||t.type!==ge.TABLE||!t.data)return;const s=this.canvasSize.height,n=50,l=t.style.headerHeight||40,i=t.style.rowHeight||30,d=t.y,g=s-d-n-l,w=Math.floor(Math.max(0,g)/i);if(w>=t.data.length)return;const m=t.data.slice(0,w),_=t.data.slice(w);this.updateElement(t.id,{data:m,height:l+m.length*i});const p=e+1;p>=this.pages.length&&this.addPage();const S={...Ee(t),id:He(),y:50,data:_,height:l+_.length*i};this.pages[p].elements.push(S),this.paginateTable(S.id)},groupSelectedElements(){this.selectedElementIds.length<2||(console.log("Group selected elements:",this.selectedElementIds),alert("Grouping feature is under development"))},async loadCustomElements(){var n;const{mode:r,endpoints:e,headers:t,fetcher:s}=Qe();if(r==="remote")try{const l=et(((n=e.customElements)==null?void 0:n.list)||""),d=await(await(s||fetch)(l,{headers:t})).json(),c=Array.isArray(d)?d:(d==null?void 0:d.customElements)||[];this.customElements=c.filter(g=>g&&typeof g.id=="string"&&typeof g.name=="string"&&g.element).map(g=>({id:g.id,name:g.name,element:Ee(g.element)}))}catch(l){console.error("Failed to load custom elements",l)}},async addCustomElement(r,e){var d;const{mode:t,endpoints:s,headers:n,fetcher:l}=Qe(),i={id:He(),name:r,element:Ee(e)};if(t==="remote")try{const c=et(((d=s.customElements)==null?void 0:d.upsert)||""),w=await(await(l||fetch)(c,{method:"POST",headers:n,body:JSON.stringify(i)})).json();i.id=(w==null?void 0:w.id)||i.id}catch(c){console.error("Failed to add custom element",c)}this.customElements.push(i),t!=="remote"&&this.saveCustomElements()},async removeCustomElement(r){var i;const{mode:e,endpoints:t,headers:s,fetcher:n}=Qe(),l=this.customElements.findIndex(d=>d.id===r);if(l!==-1){if(this.customElements.splice(l,1),e==="remote"){try{const d=et(((i=t.customElements)==null?void 0:i.delete)||"",r);await(n||fetch)(d,{method:"DELETE",headers:s})}catch(d){console.error("Failed to remove custom element",d)}return}this.saveCustomElements()}},async renameCustomElement(r,e){var d;const{mode:t,endpoints:s,headers:n,fetcher:l}=Qe(),i=this.customElements.find(c=>c.id===r);if(i){if(i.name=e,t==="remote"){try{const c=et(((d=s.customElements)==null?void 0:d.upsert)||"");await(l||fetch)(c,{method:"POST",headers:n,body:JSON.stringify(i)})}catch(c){console.error("Failed to rename custom element",c)}return}this.saveCustomElements()}},saveCustomElements(){localStorage.setItem("print-designer-custom-elements",JSON.stringify(this.customElements))}},getters:{selectedElement:r=>{if(!r.selectedElementId)return null;for(const e of r.pages){const t=e.elements.find(s=>s.id===r.selectedElementId);if(t)return t}return null},currentPage:r=>r.pages[r.currentPageIndex],editingCustomElement:r=>r.editingCustomElementId&&r.customElements.find(e=>e.id===r.editingCustomElementId)||null}}),Jt=dl("templates",{state:()=>({templates:[],currentTemplateId:null,isSaving:!1}),actions:{async loadTemplates(){var l;const{mode:r,endpoints:e,headers:t,fetcher:s}=Qe();if(r==="remote")try{const i=et(((l=e.templates)==null?void 0:l.list)||""),c=await(await(s||fetch)(i,{headers:t})).json(),g=Array.isArray(c)?c:(c==null?void 0:c.templates)||[];this.templates=g.filter(w=>w&&typeof w.id=="string"&&typeof w.name=="string").map(w=>({id:w.id,name:w.name,data:w.data||{},updatedAt:w.updatedAt||Date.now()})).sort((w,m)=>m.updatedAt-w.updatedAt);return}catch(i){console.error("Failed to load templates",i)}const n=localStorage.getItem("print-designer-templates");if(n)try{this.templates=JSON.parse(n),this.templates.sort((i,d)=>d.updatedAt-i.updatedAt)}catch(i){console.error("Failed to parse templates",i),this.templates=[]}},saveToLocalStorage(){localStorage.setItem("print-designer-templates",JSON.stringify(this.templates))},async saveCurrentTemplate(r){var c;const{mode:e,endpoints:t,headers:s,fetcher:n}=Qe(),l=Re(),i=this.currentTemplateId,d={pages:Ee(l.pages),canvasSize:Ee(l.canvasSize),guides:Ee(l.guides),zoom:l.zoom,showGrid:l.showGrid,headerHeight:l.headerHeight,footerHeight:l.footerHeight,showHeaderLine:l.showHeaderLine,showFooterLine:l.showFooterLine,showMinimap:l.showMinimap,canvasBackground:l.canvasBackground,pageSpacingX:l.pageSpacingX,pageSpacingY:l.pageSpacingY,unit:l.unit,watermark:Ee(l.watermark),testData:Ee(l.testData||{})};this.isSaving=!0;try{if(e==="remote"){const g={id:i||He(),name:r,data:d,updatedAt:Date.now()},w=et(((c=t.templates)==null?void 0:c.upsert)||""),_=await(await(n||fetch)(w,{method:"POST",headers:s,body:JSON.stringify(g)})).json(),p=(_==null?void 0:_.id)||g.id,S=this.templates.findIndex(k=>k.id===p),v={...g,id:p};S>=0?this.templates[S]=v:this.templates.unshift(v),this.currentTemplateId=p;return}if(i){const g=this.templates.findIndex(w=>w.id===i);g!==-1?(this.templates[g].data=d,this.templates[g].name=r,this.templates[g].updatedAt=Date.now()):this.createTemplate(r,d)}else this.createTemplate(r,d);this.saveToLocalStorage()}finally{this.isSaving=!1}},async createTemplate(r,e){var g;const{mode:t,endpoints:s,headers:n,fetcher:l}=Qe(),i=Re(),d=e||{pages:i.pages,canvasSize:i.canvasSize,pageSpacingX:i.pageSpacingX,pageSpacingY:i.pageSpacingY,unit:i.unit,watermark:i.watermark,testData:Ee(i.testData||{})},c={id:He(),name:r,data:d,updatedAt:Date.now()};if(t==="remote")try{const w=et(((g=s.templates)==null?void 0:g.upsert)||""),_=await(await(l||fetch)(w,{method:"POST",headers:n,body:JSON.stringify(c)})).json(),p=(_==null?void 0:_.id)||c.id;c.id=p}catch(w){console.error("Failed to create template",w)}this.templates.unshift(c),this.currentTemplateId=c.id,t!=="remote"&&this.saveToLocalStorage()},async deleteTemplate(r){var l;const{mode:e,endpoints:t,headers:s,fetcher:n}=Qe();if(this.templates=this.templates.filter(i=>i.id!==r),this.currentTemplateId===r&&(this.currentTemplateId=null),e==="remote"){try{const i=et(((l=t.templates)==null?void 0:l.delete)||"",r);await(n||fetch)(i,{method:"DELETE",headers:s})}catch(i){console.error("Failed to delete template",i)}return}this.saveToLocalStorage()},async renameTemplate(r,e){var d;const{mode:t,endpoints:s,headers:n,fetcher:l}=Qe(),i=this.templates.find(c=>c.id===r);if(i){if(i.name=e,i.updatedAt=Date.now(),t==="remote"){try{const c=et(((d=s.templates)==null?void 0:d.upsert)||"");await(l||fetch)(c,{method:"POST",headers:n,body:JSON.stringify(i)})}catch(c){console.error("Failed to rename template",c)}return}this.saveToLocalStorage()}},async copyTemplate(r){var i;const{mode:e,endpoints:t,headers:s,fetcher:n}=Qe(),l=this.templates.find(d=>d.id===r);if(l){const d={id:He(),name:`${l.name} Copy`,data:JSON.parse(JSON.stringify(l.data)),updatedAt:Date.now()};if(e==="remote")try{const c=et(((i=t.templates)==null?void 0:i.upsert)||""),w=await(await(n||fetch)(c,{method:"POST",headers:s,body:JSON.stringify(d)})).json();d.id=(w==null?void 0:w.id)||d.id}catch(c){console.error("Failed to copy template",c)}this.templates.unshift(d),e!=="remote"&&this.saveToLocalStorage()}},async loadTemplate(r){var i;const{mode:e,endpoints:t,headers:s,fetcher:n}=Qe();if(e==="remote")try{const d=et(((i=t.templates)==null?void 0:i.get)||"",r),g=await(await(n||fetch)(d,{headers:s})).json(),w=(g==null?void 0:g.template)||g;if(!w)return;const m=Re();m.resetCanvas();const _=w.data||{};_.pages&&(m.pages=_.pages),_.canvasSize&&(m.canvasSize=_.canvasSize),_.guides&&(m.guides=_.guides),_.zoom!==void 0&&(m.zoom=_.zoom),_.showGrid!==void 0&&(m.showGrid=_.showGrid),_.headerHeight!==void 0&&(m.headerHeight=_.headerHeight),_.footerHeight!==void 0&&(m.footerHeight=_.footerHeight),_.showHeaderLine!==void 0&&(m.showHeaderLine=_.showHeaderLine),_.showFooterLine!==void 0&&(m.showFooterLine=_.showFooterLine),_.showMinimap!==void 0&&(m.showMinimap=_.showMinimap),_.canvasBackground!==void 0&&(m.canvasBackground=_.canvasBackground),_.pageSpacingX!==void 0&&(m.pageSpacingX=_.pageSpacingX),_.pageSpacingY!==void 0&&(m.pageSpacingY=_.pageSpacingY),_.unit!==void 0&&(m.unit=_.unit),_.watermark!==void 0&&(m.watermark=_.watermark),m.testData=_.testData||{},m.selectedElementId=null,m.selectedGuideId=null,m.historyPast=[],m.historyFuture=[],this.currentTemplateId=w.id||r;return}catch(d){console.error("Failed to load template",d);return}const l=this.templates.find(d=>d.id===r);if(l){const d=Re();d.resetCanvas();const c=l.data;c.pages&&(d.pages=c.pages),c.canvasSize&&(d.canvasSize=c.canvasSize),c.guides&&(d.guides=c.guides),c.zoom!==void 0&&(d.zoom=c.zoom),c.showGrid!==void 0&&(d.showGrid=c.showGrid),c.headerHeight!==void 0&&(d.headerHeight=c.headerHeight),c.footerHeight!==void 0&&(d.footerHeight=c.footerHeight),c.showHeaderLine!==void 0&&(d.showHeaderLine=c.showHeaderLine),c.showFooterLine!==void 0&&(d.showFooterLine=c.showFooterLine),c.showMinimap!==void 0&&(d.showMinimap=c.showMinimap),c.canvasBackground!==void 0&&(d.canvasBackground=c.canvasBackground),c.pageSpacingX!==void 0&&(d.pageSpacingX=c.pageSpacingX),c.pageSpacingY!==void 0&&(d.pageSpacingY=c.pageSpacingY),c.unit!==void 0&&(d.unit=c.unit),c.watermark!==void 0&&(d.watermark=c.watermark),d.testData=c.testData||{},d.selectedElementId=null,d.selectedGuideId=null,d.historyPast=[],d.historyFuture=[],this.currentTemplateId=r}}}}),$l=le(localStorage.getItem("print-designer-autosave")!=="false");Ae($l,r=>{localStorage.setItem("print-designer-autosave",String(r))});function Il(){return{autoSave:$l}}const Ut=le(localStorage.getItem("print-designer-theme")||"system"),Al=le(window.matchMedia("(prefers-color-scheme: dark)").matches),eo=window.matchMedia("(prefers-color-scheme: dark)");var il;(il=eo.addEventListener)==null||il.call(eo,"change",r=>{Al.value=r.matches});const zl=fe(()=>Ut.value==="dark"?!0:Ut.value==="light"?!1:Al.value),zd=r=>{Ut.value=r,localStorage.setItem("print-designer-theme",r)};Ae(zl,r=>{document.documentElement.classList.toggle("dark",r)},{immediate:!0});function Co(){return{theme:Ut,isDark:zl,setTheme:zd}}var to,Pa;function Pd(){if(Pa)return to;Pa=1;var r=rt(),e=function(){return r.Date.now()};return to=e,to}var ro,La;function Ld(){if(La)return ro;La=1;var r=/\s/;function e(t){for(var s=t.length;s--&&r.test(t.charAt(s)););return s}return ro=e,ro}var no,Ma;function Md(){if(Ma)return no;Ma=1;var r=Ld(),e=/^\s+/;function t(s){return s&&s.slice(0,r(s)+1).replace(e,"")}return no=t,no}var oo,Ra;function Rd(){if(Ra)return oo;Ra=1;var r=Bt(),e=kt(),t="[object Symbol]";function s(n){return typeof n=="symbol"||e(n)&&r(n)==t}return oo=s,oo}var so,Da;function Dd(){if(Da)return so;Da=1;var r=Md(),e=mt(),t=Rd(),s=NaN,n=/^[-+]0x[0-9a-f]+$/i,l=/^0b[01]+$/i,i=/^0o[0-7]+$/i,d=parseInt;function c(g){if(typeof g=="number")return g;if(t(g))return s;if(e(g)){var w=typeof g.valueOf=="function"?g.valueOf():g;g=e(w)?w+"":w}if(typeof g!="string")return g===0?g:+g;g=r(g);var m=l.test(g);return m||i.test(g)?d(g.slice(2),m?2:8):n.test(g)?s:+g}return so=c,so}var ao,Ba;function Bd(){if(Ba)return ao;Ba=1;var r=mt(),e=Pd(),t=Dd(),s="Expected a function",n=Math.max,l=Math.min;function i(d,c,g){var w,m,_,p,S,v,k=0,b=!1,f=!1,T=!0;if(typeof d!="function")throw new TypeError(s);c=t(c)||0,r(g)&&(b=!!g.leading,f="maxWait"in g,_=f?n(t(g.maxWait)||0,c):_,T="trailing"in g?!!g.trailing:T);function D(q){var h=w,y=m;return w=m=void 0,k=q,p=d.apply(y,h),p}function j(q){return k=q,S=setTimeout(V,c),b?D(q):p}function B(q){var h=q-v,y=q-k,ee=c-h;return f?l(ee,_-y):ee}function A(q){var h=q-v,y=q-k;return v===void 0||h>=c||h<0||f&&y>=_}function V(){var q=e();if(A(q))return Y(q);S=setTimeout(V,B(q))}function Y(q){return S=void 0,T&&w?D(q):(w=m=void 0,p)}function se(){S!==void 0&&clearTimeout(S),k=0,w=v=m=S=void 0}function G(){return S===void 0?p:Y(e())}function I(){var q=e(),h=A(q);if(w=arguments,m=this,v=q,h){if(S===void 0)return j(v);if(f)return clearTimeout(S),S=setTimeout(V,c),D(v)}return S===void 0&&(S=setTimeout(V,c)),p}return I.cancel=se,I.flush=G,I}return ao=i,ao}var Od=Bd();const qd=_t(Od),Pl=96/25.4,Fd=25.4/96,Ll=96/72,Nd=72/96;function co(r){return Number((r*Fd).toFixed(1))}function jd(r){return Math.round(r*Pl)}function Hd(r){return Number((r*Nd).toFixed(1))}function Ud(r){return Math.round(r*Ll)}function ot(r,e){return e==="mm"?co(r):e==="pt"?Hd(r):Math.round(r)}function Ye(r,e){return e==="mm"?jd(r):e==="pt"?Ud(r):Math.round(r)}function Dt(r,e,t){r=r%360,r<0&&(r+=360),e=Math.max(0,Math.min(1,e)),t=Math.max(0,Math.min(1,t));const s=t*e,n=s*(1-Math.abs(r/60%2-1)),l=t-s;let i=0,d=0,c=0;return r>=0&&r<60?(i=s,d=n,c=0):r>=60&&r<120?(i=n,d=s,c=0):r>=120&&r<180?(i=0,d=s,c=n):r>=180&&r<240?(i=0,d=n,c=s):r>=240&&r<300?(i=n,d=0,c=s):(i=s,d=0,c=n),{r:Math.round((i+l)*255),g:Math.round((d+l)*255),b:Math.round((c+l)*255)}}function Oa(r,e,t){r/=255,e/=255,t/=255;const s=Math.max(r,e,t),n=Math.min(r,e,t),l=s-n;let i=0;const d=s===0?0:l/s,c=s;if(s!==n){switch(s){case r:i=(e-t)/l+(e<t?6:0);break;case e:i=(t-r)/l+2;break;case t:i=(r-e)/l+4;break}i/=6}return{h:i*360,s:d,v:c}}function Mt(r){if(!r)return null;if(r==="transparent")return{h:0,s:0,v:0,a:0};if(r.startsWith("#")){const e=r.slice(1);let t=0,s=0,n=0,l=1;if(e.length===3)t=parseInt(e[0]+e[0],16),s=parseInt(e[1]+e[1],16),n=parseInt(e[2]+e[2],16);else if(e.length===6)t=parseInt(e.substring(0,2),16),s=parseInt(e.substring(2,4),16),n=parseInt(e.substring(4,6),16);else if(e.length===8)t=parseInt(e.substring(0,2),16),s=parseInt(e.substring(2,4),16),n=parseInt(e.substring(4,6),16),l=parseInt(e.substring(6,8),16)/255;else return null;return{...Oa(t,s,n),a:l}}if(r.startsWith("rgb")){const e=r.match(/rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*([\d.]+))?\)/);if(e){const t=parseInt(e[1]),s=parseInt(e[2]),n=parseInt(e[3]),l=e[4]!==void 0?parseFloat(e[4]):1;return{...Oa(t,s,n),a:l}}}return null}function qa(r,e,t,s=1){const{r:n,g:l,b:i}=Dt(r,e,t),d=c=>{const g=Math.round(c).toString(16);return g.length===1?"0"+g:g};if(s>=1)return`#${d(n)}${d(l)}${d(i)}`;{const c=Math.round(s*255);return`#${d(n)}${d(l)}${d(i)}${d(c)}`}}function Vd(r,e,t,s=1){const{r:n,g:l,b:i}=Dt(r,e,t);return`rgba(${n}, ${l}, ${i}, ${parseFloat(s.toFixed(2))})`}const Wd={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function Gd(r,e){return z(),F("svg",Wd,[...e[0]||(e[0]=[o("path",{fill:"currentColor",d:"M18 7H6V3h12zm0 5.5q.425 0 .713-.288T19 11.5t-.288-.712T18 10.5t-.712.288T17 11.5t.288.713t.712.287M16 19v-4H8v4zm2 2H6v-4H2v-6q0-1.275.875-2.137T5 8h14q1.275 0 2.138.863T22 11v6h-4z"},null,-1)])])}const Eo=Se({name:"material-symbols-print",render:Gd}),Kd={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function Yd(r,e){return z(),F("svg",Kd,[...e[0]||(e[0]=[o("path",{fill:"currentColor",d:"M5 21q-.825 0-1.412-.587T3 19V5q0-.825.588-1.412T5 3h14q.825 0 1.413.588T21 5v14q0 .825-.587 1.413T19 21zm0-2h14V7H5zm7-2q-2.05 0-3.662-1.112T6 13q.725-1.775 2.338-2.887T12 9t3.663 1.113T18 13q-.725 1.775-2.337 2.888T12 17m0-2.5q-.625 0-1.062-.437T10.5 13t.438-1.062T12 11.5t1.063.438T13.5 13t-.437 1.063T12 14.5m0 1q1.05 0 1.775-.725T14.5 13t-.725-1.775T12 10.5t-1.775.725T9.5 13t.725 1.775T12 15.5"},null,-1)])])}const Xd=Se({name:"material-symbols-preview",render:Yd}),Zd={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function Jd(r,e){return z(),F("svg",Zd,[...e[0]||(e[0]=[o("path",{fill:"currentColor",d:"m12 16l-5-5l1.4-1.45l2.6 2.6V4h2v8.15l2.6-2.6L17 11zm-6 4q-.825 0-1.412-.587T4 18v-3h2v3h12v-3h2v3q0 .825-.587 1.413T18 20z"},null,-1)])])}const Vt=Se({name:"material-symbols-file-download",render:Jd}),Qd={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function eu(r,e){return z(),F("svg",Qd,[...e[0]||(e[0]=[o("path",{fill:"currentColor",d:"M9 12.5h1v-2h1q.425 0 .713-.288T12 9.5v-1q0-.425-.288-.712T11 7.5H9zm1-3v-1h1v1zm3 3h2q.425 0 .713-.288T16 11.5v-3q0-.425-.288-.712T15 7.5h-2zm1-1v-3h1v3zm3 1h1v-2h1v-1h-1v-1h1v-1h-2zM8 18q-.825 0-1.412-.587T6 16V4q0-.825.588-1.412T8 2h12q.825 0 1.413.588T22 4v12q0 .825-.587 1.413T20 18zm-4 4q-.825 0-1.412-.587T2 20V6h2v14h14v2z"},null,-1)])])}Se({name:"material-symbols-picture-as-pdf",render:eu});const tu={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function ru(r,e){return z(),F("svg",tu,[...e[0]||(e[0]=[o("path",{fill:"currentColor",d:"M5 21q-.825 0-1.412-.587T3 19V5q0-.825.588-1.412T5 3h14q.825 0 1.413.588T21 5v14q0 .825-.587 1.413T19 21zm1-4h12l-3.75-5l-3 4L9 13z"},null,-1)])])}const Fa=Se({name:"material-symbols-image",render:ru}),nu={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function ou(r,e){return z(),F("svg",nu,[...e[0]||(e[0]=[o("path",{fill:"currentColor",d:"m19.6 21l-6.3-6.3q-.75.6-1.725.95T9.5 16q-2.725 0-4.612-1.888T3 9.5t1.888-4.612T9.5 3t4.613 1.888T16 9.5q0 1.1-.35 2.075T14.7 13.3l6.3 6.3zM9.5 14q1.875 0 3.188-1.312T14 9.5t-1.312-3.187T9.5 5T6.313 6.313T5 9.5t1.313 3.188T9.5 14m-1-1.5v-2h-2v-2h2v-2h2v2h2v2h-2v2z"},null,-1)])])}const Ml=Se({name:"material-symbols-zoom-in",render:ou}),su={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function au(r,e){return z(),F("svg",su,[...e[0]||(e[0]=[o("path",{fill:"currentColor",d:"m19.6 21l-6.3-6.3q-.75.6-1.725.95T9.5 16q-2.725 0-4.612-1.888T3 9.5t1.888-4.612T9.5 3t4.613 1.888T16 9.5q0 1.1-.35 2.075T14.7 13.3l6.3 6.3zM9.5 14q1.875 0 3.188-1.312T14 9.5t-1.312-3.187T9.5 5T6.313 6.313T5 9.5t1.313 3.188T9.5 14M7 10.5v-2h5v2z"},null,-1)])])}const Rl=Se({name:"material-symbols-zoom-out",render:au}),lu={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function iu(r,e){return z(),F("svg",lu,[...e[0]||(e[0]=[o("path",{fill:"currentColor",d:"m9.25 22l-.4-3.2q-.325-.125-.612-.3t-.563-.375L4.7 19.375l-2.75-4.75l2.575-1.95Q4.5 12.5 4.5 12.338v-.675q0-.163.025-.338L1.95 9.375l2.75-4.75l2.975 1.25q.275-.2.575-.375t.6-.3l.4-3.2h5.5l.4 3.2q.325.125.613.3t.562.375l2.975-1.25l2.75 4.75l-2.575 1.95q.025.175.025.338v.674q0 .163-.05.338l2.575 1.95l-2.75 4.75l-2.95-1.25q-.275.2-.575.375t-.6.3l-.4 3.2zm2.8-6.5q1.45 0 2.475-1.025T15.55 12t-1.025-2.475T12.05 8.5q-1.475 0-2.488 1.025T8.55 12t1.013 2.475T12.05 15.5"},null,-1)])])}const Wt=Se({name:"material-symbols-settings",render:iu}),du={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function uu(r,e){return z(),F("svg",du,[...e[0]||(e[0]=[o("path",{fill:"currentColor",d:"M21 7v12q0 .825-.587 1.413T19 21H5q-.825 0-1.412-.587T3 19V5q0-.825.588-1.412T5 3h12zm-9 11q1.25 0 2.125-.875T15 15t-.875-2.125T12 12t-2.125.875T9 15t.875 2.125T12 18m-6-8h9V6H6z"},null,-1)])])}const To=Se({name:"material-symbols-save",render:uu}),cu={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function hu(r,e){return z(),F("svg",cu,[...e[0]||(e[0]=[o("path",{fill:"currentColor",d:"M13 23v-3.075l5.525-5.5q.225-.225.5-.325t.55-.1q.3 0 .575.113t.5.337l.925.925q.2.225.313.5t.112.55t-.1.563t-.325.512l-5.5 5.5zM6 10h9V6H6zm13.575 7.4l.925-.975l-.925-.925l-.95.95zM11 21H5q-.825 0-1.412-.587T3 19V5q0-.825.588-1.412T5 3h12l4 4v5.3q-.475-.2-.987-.262T19 12.05t-.975.313t-.875.612L15 15.125V15q0-1.25-.875-2.125T12 12t-2.125.875T9 15t.875 2.125T12 18h.1L11 19.1z"},null,-1)])])}const Dl=Se({name:"material-symbols-save-as",render:hu}),pu={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function fu(r,e){return z(),F("svg",pu,[...e[0]||(e[0]=[o("path",{fill:"currentColor",d:"M12 22q-2.05 0-3.875-.788t-3.187-2.15t-2.15-3.187T2 12q0-2.075.788-3.887t2.15-3.175t3.187-2.15T12 2q.425 0 .713.288T13 3t-.288.713T12 4Q8.675 4 6.337 6.338T4 12t2.338 5.663T12 20t5.663-2.337T20 12q0-.425.288-.712T21 11t.713.288T22 12q0 2.05-.788 3.875t-2.15 3.188t-3.175 2.15T12 22"},null,-1)])])}const mu=Se({name:"material-symbols-progress-activity",render:fu}),gu={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function vu(r,e){return z(),F("svg",gu,[...e[0]||(e[0]=[o("path",{fill:"currentColor",d:"M7 19v-2h7.1q1.575 0 2.738-1T18 13.5T16.838 11T14.1 10H7.8l2.6 2.6L9 14L4 9l5-5l1.4 1.4L7.8 8h6.3q2.425 0 4.163 1.575T20 13.5t-1.737 3.925T14.1 19z"},null,-1)])])}const Bl=Se({name:"material-symbols-undo",render:vu}),bu={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function yu(r,e){return z(),F("svg",bu,[...e[0]||(e[0]=[o("path",{fill:"currentColor",d:"M9.9 19q-2.425 0-4.163-1.575T4 13.5t1.738-3.925T9.9 8h6.3l-2.6-2.6L15 4l5 5l-5 5l-1.4-1.4l2.6-2.6H9.9q-1.575 0-2.738 1T6 13.5T7.163 16T9.9 17H17v2z"},null,-1)])])}const Ol=Se({name:"material-symbols-redo",render:yu}),wu={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function xu(r,e){return z(),F("svg",wu,[...e[0]||(e[0]=[o("path",{fill:"currentColor",d:"M7 21q-.825 0-1.412-.587T5 19V6H4V4h5V3h6v1h5v2h-1v13q0 .825-.587 1.413T17 21zm2-4h2V8H9zm4 0h2V8h-2z"},null,-1)])])}const St=Se({name:"material-symbols-delete",render:xu}),_u={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function ku(r,e){return z(),F("svg",_u,[...e[0]||(e[0]=[o("path",{fill:"currentColor",d:"M11.95 18q.525 0 .888-.363t.362-.887t-.362-.888t-.888-.362t-.887.363t-.363.887t.363.888t.887.362m-.9-3.85h1.85q0-.825.188-1.3t1.062-1.3q.65-.65 1.025-1.238T15.55 8.9q0-1.4-1.025-2.15T12.1 6q-1.425 0-2.312.75T8.55 8.55l1.65.65q.125-.45.563-.975T12.1 7.7q.8 0 1.2.438t.4.962q0 .5-.3.938t-.75.812q-1.1.975-1.35 1.475t-.25 1.825M12 22q-2.075 0-3.9-.787t-3.175-2.138T2.788 15.9T2 12t.788-3.9t2.137-3.175T8.1 2.788T12 2t3.9.788t3.175 2.137T21.213 8.1T22 12t-.788 3.9t-2.137 3.175t-3.175 2.138T12 22"},null,-1)])])}const Su=Se({name:"material-symbols-help",render:ku}),Cu={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function Eu(r,e){return z(),F("svg",Cu,[...e[0]||(e[0]=[o("path",{fill:"currentColor",d:"M3 21v-2h18v2zm0-4v-2h12v2zm0-4v-2h18v2zm0-4V7h12v2zm0-4V3h18v2z"},null,-1)])])}const Tu=Se({name:"material-symbols-format-align-left",render:Eu}),$u={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function Iu(r,e){return z(),F("svg",$u,[...e[0]||(e[0]=[o("path",{fill:"currentColor",d:"M3 21v-2h18v2zm4-4v-2h10v2zm-4-4v-2h18v2zm4-4V7h10v2zM3 5V3h18v2z"},null,-1)])])}const Au=Se({name:"material-symbols-format-align-center",render:Iu}),zu={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function Pu(r,e){return z(),F("svg",zu,[...e[0]||(e[0]=[o("path",{fill:"currentColor",d:"M3 5V3h18v2zm6 4V7h12v2zm-6 4v-2h18v2zm6 4v-2h12v2zm-6 4v-2h18v2z"},null,-1)])])}const Lu=Se({name:"material-symbols-format-align-right",render:Pu}),Mu={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function Ru(r,e){return z(),F("svg",Mu,[...e[0]||(e[0]=[o("path",{fill:"currentColor",d:"M4 5V3h16v2zm7 16V10.8l-2.6 2.6L7 12l5-5l5 5l-1.4 1.4l-2.6-2.6V21z"},null,-1)])])}const Du=Se({name:"material-symbols-vertical-align-top",render:Ru}),Bu={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function Ou(r,e){return z(),F("svg",Bu,[...e[0]||(e[0]=[o("path",{fill:"currentColor",d:"M11 22v-4.2l-1.6 1.6L8 18l4-4l4 4l-1.4 1.4l-1.6-1.6V22zm-7-9v-2h16v2zm8-3L8 6l1.4-1.4L11 6.2V2h2v4.2l1.6-1.6L16 6z"},null,-1)])])}const qu=Se({name:"material-symbols-vertical-align-center",render:Ou}),Fu={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function Nu(r,e){return z(),F("svg",Fu,[...e[0]||(e[0]=[o("path",{fill:"currentColor",d:"M4 21v-2h16v2zm8-4l-5-5l1.4-1.4l2.6 2.6V3h2v10.2l2.6-2.6L17 12z"},null,-1)])])}const ju=Se({name:"material-symbols-vertical-align-bottom",render:Nu}),Hu={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function Uu(r,e){return z(),F("svg",Hu,[...e[0]||(e[0]=[o("path",{fill:"currentColor",d:"M6.8 19V5h5.525q1.625 0 3 1T16.7 8.775q0 1.275-.575 1.963t-1.075.987q.625.275 1.388 1.025T17.2 15q0 2.225-1.625 3.113t-3.05.887zm3.025-2.8h2.6q1.2 0 1.463-.612t.262-.888t-.262-.887t-1.538-.613H9.825zm0-5.7h2.325q.825 0 1.2-.425t.375-.95q0-.6-.425-.975t-1.1-.375H9.825z"},null,-1)])])}const Vu=Se({name:"material-symbols-format-bold",render:Uu}),Wu={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function Gu(r,e){return z(),F("svg",Wu,[...e[0]||(e[0]=[o("path",{fill:"currentColor",d:"M5 19v-2.5h4l3-9H8V5h10v2.5h-3.5l-3 9H15V19z"},null,-1)])])}const Ku=Se({name:"material-symbols-format-italic",render:Gu}),Yu={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function Xu(r,e){return z(),F("svg",Yu,[...e[0]||(e[0]=[o("path",{fill:"currentColor",d:"M5 21v-2h14v2zm7-4q-2.525 0-3.925-1.575t-1.4-4.175V3H9.25v8.4q0 1.4.7 2.275t2.05.875t2.05-.875t.7-2.275V3h2.575v8.25q0 2.6-1.4 4.175T12 17"},null,-1)])])}const Zu=Se({name:"material-symbols-format-underlined",render:Xu}),Ju={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function Qu(r,e){return z(),F("svg",Ju,[...e[0]||(e[0]=[o("path",{fill:"currentColor",d:"M10.9 16L15 5h2l4.1 11h-1.9l-1-2.8h-4.4l-1 2.8zm3.45-4.4h3.3l-1.6-4.55h-.1zM6 20l-3.5-3.5l1.4-1.4L5 16.15V3h2v13.15l1.1-1.05l1.4 1.4z"},null,-1)])])}const ec=Se({name:"material-symbols-text-rotate-vertical",render:Qu}),tc={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function rc(r,e){return z(),F("svg",tc,[...e[0]||(e[0]=[o("path",{fill:"currentColor",d:"M11 22q-1.25-.125-2.4-.612T6.4 20.1l1.4-1.45q.725.525 1.538.85t1.662.45zm2 0v-2.05q2.6-.375 4.3-2.337T19 13.05q0-2.925-2.037-4.962T12 6.05h-.2l1.6 1.6l-1.4 1.4l-4-4l4-4l1.4 1.45l-1.55 1.55H12q1.875 0 3.513.713t2.85 1.925t1.925 2.85T21 13.05q0 3.425-2.275 5.963T13 22m-8.05-3.35q-.8-1.05-1.288-2.2t-.612-2.4H5.1q.125.85.45 1.663t.85 1.537zm-1.9-6.6q.15-1.275.625-2.45T4.95 7.45l1.45 1.4q-.525.725-.85 1.538T5.1 12.05z"},null,-1)])])}const nc=Se({name:"material-symbols-rotate-left",render:rc}),oc={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function sc(r,e){return z(),F("svg",oc,[...e[0]||(e[0]=[o("path",{fill:"currentColor",d:"M9 18q-.825 0-1.412-.587T7 16V4q0-.825.588-1.412T9 2h9q.825 0 1.413.588T20 4v12q0 .825-.587 1.413T18 18zm-4 4q-.825 0-1.412-.587T3 20V6h2v14h11v2z"},null,-1)])])}const Ct=Se({name:"material-symbols-content-copy",render:sc}),ac={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function lc(r,e){return z(),F("svg",ac,[...e[0]||(e[0]=[o("path",{fill:"currentColor",d:"M6.4 18h2.1l1.1-3.05h4.8L15.5 18h2.1L13.05 6h-2.1zm3.8-4.8l1.75-4.95h.1l1.75 4.95zM4 22q-.825 0-1.412-.587T2 20V4q0-.825.588-1.412T4 2h16q.825 0 1.413.588T22 4v16q0 .825-.587 1.413T20 22z"},null,-1)])])}const ic=Se({name:"material-symbols-font-download",render:lc}),dc={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function uc(r,e){return z(),F("svg",dc,[...e[0]||(e[0]=[o("path",{fill:"currentColor",d:"M6.175 1.4L7.6 0l8.575 8.575q.575.575.575 1.425t-.575 1.425l-4.75 4.75q-.575.575-1.425.575t-1.425-.575l-4.75-4.75Q3.25 10.85 3.25 10t.575-1.425L8.575 3.8zM10 5.225L5.225 10h9.55zM19 17q-.825 0-1.412-.587T17 15q0-.525.313-1.125T18 12.75q.225-.3.475-.625T19 11.5q.275.3.525.625t.475.625q.375.525.688 1.125T21 15q0 .825-.587 1.413T19 17M2 24v-4h20v4z"},null,-1)])])}const cc=Se({name:"material-symbols-format-color-fill",render:uc}),hc={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function pc(r,e){return z(),F("svg",hc,[...e[0]||(e[0]=[o("path",{fill:"currentColor",d:"M5 21q-.825 0-1.412-.587T3 19V5q0-.825.588-1.412T5 3h4.175q.275-.875 1.075-1.437T12 1q1 0 1.788.563T14.85 3H19q.825 0 1.413.588T21 5v14q0 .825-.587 1.413T19 21zm0-2h14V5h-2v3H7V5H5zm7-14q.425 0 .713-.288T13 4t-.288-.712T12 3t-.712.288T11 4t.288.713T12 5"},null,-1)])])}const $o=Se({name:"material-symbols-content-paste",render:pc}),fc={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function mc(r,e){return z(),F("svg",fc,[...e[0]||(e[0]=[o("path",{fill:"currentColor",d:"M8 16q.825 0 1.413-.587T10 14t-.587-1.412T8 12t-1.412.588T6 14t.588 1.413T8 16m8 0q.825 0 1.413-.587T18 14t-.587-1.412T16 12t-1.412.588T14 14t.588 1.413T16 16m-4-6q.825 0 1.413-.587T14 8t-.587-1.412T12 6t-1.412.588T10 8t.588 1.413T12 10m0 12q-2.075 0-3.9-.788t-3.175-2.137T2.788 15.9T2 12t.788-3.9t2.137-3.175T8.1 2.788T12 2t3.9.788t3.175 2.137T21.213 8.1T22 12t-.788 3.9t-2.137 3.175t-3.175 2.138T12 22"},null,-1)])])}const gc=Se({name:"material-symbols-group-work",render:mc}),vc={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function bc(r,e){return z(),F("svg",vc,[...e[0]||(e[0]=[o("path",{fill:"currentColor",d:"M6 22q-.825 0-1.412-.587T4 20V10q0-.825.588-1.412T6 8h1V6q0-2.075 1.463-3.537T12 1t3.538 1.463T17 6v2h1q.825 0 1.413.588T20 10v10q0 .825-.587 1.413T18 22zm6-5q.825 0 1.413-.587T14 15t-.587-1.412T12 13t-1.412.588T10 15t.588 1.413T12 17M9 8h6V6q0-1.25-.875-2.125T12 3t-2.125.875T9 6z"},null,-1)])])}const Qt=Se({name:"material-symbols-lock",render:bc}),yc={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function wc(r,e){return z(),F("svg",yc,[...e[0]||(e[0]=[o("path",{fill:"currentColor",d:"M6 8h9V6q0-1.25-.875-2.125T12 3t-2.125.875T9 6H7q0-2.075 1.463-3.537T12 1t3.538 1.463T17 6v2h1q.825 0 1.413.588T20 10v10q0 .825-.587 1.413T18 22H6q-.825 0-1.412-.587T4 20V10q0-.825.588-1.412T6 8m6 9q.825 0 1.413-.587T14 15t-.587-1.412T12 13t-1.412.588T10 15t.588 1.413T12 17"},null,-1)])])}const ql=Se({name:"material-symbols-lock-open",render:wc}),xc={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function _c(r,e){return z(),F("svg",xc,[...e[0]||(e[0]=[o("path",{fill:"currentColor",d:"m12 15.375l-6-6l1.4-1.4l4.6 4.6l4.6-4.6l1.4 1.4z"},null,-1)])])}const Io=Se({name:"material-symbols-expand-more",render:_c});var kc=Ql();const Sc=_t(kc);function Nt(r){throw new Error('Could not dynamically require "'+r+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var lo={exports:{}};/*!

JSZip v3.10.1 - A JavaScript class for generating and reading zip files
<http://stuartk.com/jszip>

(c) 2009-2016 Stuart Knightley <stuart [at] stuartk.com>
Dual licenced under the MIT license or GPLv3. See https://raw.github.com/Stuk/jszip/main/LICENSE.markdown.

JSZip uses the library pako released under the MIT license :
https://github.com/nodeca/pako/blob/main/LICENSE
*/var Na;function Cc(){return Na||(Na=1,(function(r,e){(function(t){r.exports=t()})(function(){return(function t(s,n,l){function i(g,w){if(!n[g]){if(!s[g]){var m=typeof Nt=="function"&&Nt;if(!w&&m)return m(g,!0);if(d)return d(g,!0);var _=new Error("Cannot find module '"+g+"'");throw _.code="MODULE_NOT_FOUND",_}var p=n[g]={exports:{}};s[g][0].call(p.exports,function(S){var v=s[g][1][S];return i(v||S)},p,p.exports,t,s,n,l)}return n[g].exports}for(var d=typeof Nt=="function"&&Nt,c=0;c<l.length;c++)i(l[c]);return i})({1:[function(t,s,n){var l=t("./utils"),i=t("./support"),d="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";n.encode=function(c){for(var g,w,m,_,p,S,v,k=[],b=0,f=c.length,T=f,D=l.getTypeOf(c)!=="string";b<c.length;)T=f-b,m=D?(g=c[b++],w=b<f?c[b++]:0,b<f?c[b++]:0):(g=c.charCodeAt(b++),w=b<f?c.charCodeAt(b++):0,b<f?c.charCodeAt(b++):0),_=g>>2,p=(3&g)<<4|w>>4,S=1<T?(15&w)<<2|m>>6:64,v=2<T?63&m:64,k.push(d.charAt(_)+d.charAt(p)+d.charAt(S)+d.charAt(v));return k.join("")},n.decode=function(c){var g,w,m,_,p,S,v=0,k=0,b="data:";if(c.substr(0,b.length)===b)throw new Error("Invalid base64 input, it looks like a data url.");var f,T=3*(c=c.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(c.charAt(c.length-1)===d.charAt(64)&&T--,c.charAt(c.length-2)===d.charAt(64)&&T--,T%1!=0)throw new Error("Invalid base64 input, bad content length.");for(f=i.uint8array?new Uint8Array(0|T):new Array(0|T);v<c.length;)g=d.indexOf(c.charAt(v++))<<2|(_=d.indexOf(c.charAt(v++)))>>4,w=(15&_)<<4|(p=d.indexOf(c.charAt(v++)))>>2,m=(3&p)<<6|(S=d.indexOf(c.charAt(v++))),f[k++]=g,p!==64&&(f[k++]=w),S!==64&&(f[k++]=m);return f}},{"./support":30,"./utils":32}],2:[function(t,s,n){var l=t("./external"),i=t("./stream/DataWorker"),d=t("./stream/Crc32Probe"),c=t("./stream/DataLengthProbe");function g(w,m,_,p,S){this.compressedSize=w,this.uncompressedSize=m,this.crc32=_,this.compression=p,this.compressedContent=S}g.prototype={getContentWorker:function(){var w=new i(l.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new c("data_length")),m=this;return w.on("end",function(){if(this.streamInfo.data_length!==m.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),w},getCompressedWorker:function(){return new i(l.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},g.createWorkerFrom=function(w,m,_){return w.pipe(new d).pipe(new c("uncompressedSize")).pipe(m.compressWorker(_)).pipe(new c("compressedSize")).withStreamInfo("compression",m)},s.exports=g},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(t,s,n){var l=t("./stream/GenericWorker");n.STORE={magic:"\0\0",compressWorker:function(){return new l("STORE compression")},uncompressWorker:function(){return new l("STORE decompression")}},n.DEFLATE=t("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(t,s,n){var l=t("./utils"),i=(function(){for(var d,c=[],g=0;g<256;g++){d=g;for(var w=0;w<8;w++)d=1&d?3988292384^d>>>1:d>>>1;c[g]=d}return c})();s.exports=function(d,c){return d!==void 0&&d.length?l.getTypeOf(d)!=="string"?(function(g,w,m,_){var p=i,S=_+m;g^=-1;for(var v=_;v<S;v++)g=g>>>8^p[255&(g^w[v])];return-1^g})(0|c,d,d.length,0):(function(g,w,m,_){var p=i,S=_+m;g^=-1;for(var v=_;v<S;v++)g=g>>>8^p[255&(g^w.charCodeAt(v))];return-1^g})(0|c,d,d.length,0):0}},{"./utils":32}],5:[function(t,s,n){n.base64=!1,n.binary=!1,n.dir=!1,n.createFolders=!0,n.date=null,n.compression=null,n.compressionOptions=null,n.comment=null,n.unixPermissions=null,n.dosPermissions=null},{}],6:[function(t,s,n){var l=null;l=typeof Promise<"u"?Promise:t("lie"),s.exports={Promise:l}},{lie:37}],7:[function(t,s,n){var l=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",i=t("pako"),d=t("./utils"),c=t("./stream/GenericWorker"),g=l?"uint8array":"array";function w(m,_){c.call(this,"FlateWorker/"+m),this._pako=null,this._pakoAction=m,this._pakoOptions=_,this.meta={}}n.magic="\b\0",d.inherits(w,c),w.prototype.processChunk=function(m){this.meta=m.meta,this._pako===null&&this._createPako(),this._pako.push(d.transformTo(g,m.data),!1)},w.prototype.flush=function(){c.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},w.prototype.cleanUp=function(){c.prototype.cleanUp.call(this),this._pako=null},w.prototype._createPako=function(){this._pako=new i[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var m=this;this._pako.onData=function(_){m.push({data:_,meta:m.meta})}},n.compressWorker=function(m){return new w("Deflate",m)},n.uncompressWorker=function(){return new w("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(t,s,n){function l(p,S){var v,k="";for(v=0;v<S;v++)k+=String.fromCharCode(255&p),p>>>=8;return k}function i(p,S,v,k,b,f){var T,D,j=p.file,B=p.compression,A=f!==g.utf8encode,V=d.transformTo("string",f(j.name)),Y=d.transformTo("string",g.utf8encode(j.name)),se=j.comment,G=d.transformTo("string",f(se)),I=d.transformTo("string",g.utf8encode(se)),q=Y.length!==j.name.length,h=I.length!==se.length,y="",ee="",K="",te=j.dir,$=j.date,W={crc32:0,compressedSize:0,uncompressedSize:0};S&&!v||(W.crc32=p.crc32,W.compressedSize=p.compressedSize,W.uncompressedSize=p.uncompressedSize);var L=0;S&&(L|=8),A||!q&&!h||(L|=2048);var O=0,re=0;te&&(O|=16),b==="UNIX"?(re=798,O|=(function(ne,ve){var we=ne;return ne||(we=ve?16893:33204),(65535&we)<<16})(j.unixPermissions,te)):(re=20,O|=(function(ne){return 63&(ne||0)})(j.dosPermissions)),T=$.getUTCHours(),T<<=6,T|=$.getUTCMinutes(),T<<=5,T|=$.getUTCSeconds()/2,D=$.getUTCFullYear()-1980,D<<=4,D|=$.getUTCMonth()+1,D<<=5,D|=$.getUTCDate(),q&&(ee=l(1,1)+l(w(V),4)+Y,y+="up"+l(ee.length,2)+ee),h&&(K=l(1,1)+l(w(G),4)+I,y+="uc"+l(K.length,2)+K);var Z="";return Z+=`
\0`,Z+=l(L,2),Z+=B.magic,Z+=l(T,2),Z+=l(D,2),Z+=l(W.crc32,4),Z+=l(W.compressedSize,4),Z+=l(W.uncompressedSize,4),Z+=l(V.length,2),Z+=l(y.length,2),{fileRecord:m.LOCAL_FILE_HEADER+Z+V+y,dirRecord:m.CENTRAL_FILE_HEADER+l(re,2)+Z+l(G.length,2)+"\0\0\0\0"+l(O,4)+l(k,4)+V+y+G}}var d=t("../utils"),c=t("../stream/GenericWorker"),g=t("../utf8"),w=t("../crc32"),m=t("../signature");function _(p,S,v,k){c.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=S,this.zipPlatform=v,this.encodeFileName=k,this.streamFiles=p,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}d.inherits(_,c),_.prototype.push=function(p){var S=p.meta.percent||0,v=this.entriesCount,k=this._sources.length;this.accumulate?this.contentBuffer.push(p):(this.bytesWritten+=p.data.length,c.prototype.push.call(this,{data:p.data,meta:{currentFile:this.currentFile,percent:v?(S+100*(v-k-1))/v:100}}))},_.prototype.openedSource=function(p){this.currentSourceOffset=this.bytesWritten,this.currentFile=p.file.name;var S=this.streamFiles&&!p.file.dir;if(S){var v=i(p,S,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:v.fileRecord,meta:{percent:0}})}else this.accumulate=!0},_.prototype.closedSource=function(p){this.accumulate=!1;var S=this.streamFiles&&!p.file.dir,v=i(p,S,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(v.dirRecord),S)this.push({data:(function(k){return m.DATA_DESCRIPTOR+l(k.crc32,4)+l(k.compressedSize,4)+l(k.uncompressedSize,4)})(p),meta:{percent:100}});else for(this.push({data:v.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},_.prototype.flush=function(){for(var p=this.bytesWritten,S=0;S<this.dirRecords.length;S++)this.push({data:this.dirRecords[S],meta:{percent:100}});var v=this.bytesWritten-p,k=(function(b,f,T,D,j){var B=d.transformTo("string",j(D));return m.CENTRAL_DIRECTORY_END+"\0\0\0\0"+l(b,2)+l(b,2)+l(f,4)+l(T,4)+l(B.length,2)+B})(this.dirRecords.length,v,p,this.zipComment,this.encodeFileName);this.push({data:k,meta:{percent:100}})},_.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},_.prototype.registerPrevious=function(p){this._sources.push(p);var S=this;return p.on("data",function(v){S.processChunk(v)}),p.on("end",function(){S.closedSource(S.previous.streamInfo),S._sources.length?S.prepareNextSource():S.end()}),p.on("error",function(v){S.error(v)}),this},_.prototype.resume=function(){return!!c.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},_.prototype.error=function(p){var S=this._sources;if(!c.prototype.error.call(this,p))return!1;for(var v=0;v<S.length;v++)try{S[v].error(p)}catch{}return!0},_.prototype.lock=function(){c.prototype.lock.call(this);for(var p=this._sources,S=0;S<p.length;S++)p[S].lock()},s.exports=_},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(t,s,n){var l=t("../compressions"),i=t("./ZipFileWorker");n.generateWorker=function(d,c,g){var w=new i(c.streamFiles,g,c.platform,c.encodeFileName),m=0;try{d.forEach(function(_,p){m++;var S=(function(f,T){var D=f||T,j=l[D];if(!j)throw new Error(D+" is not a valid compression method !");return j})(p.options.compression,c.compression),v=p.options.compressionOptions||c.compressionOptions||{},k=p.dir,b=p.date;p._compressWorker(S,v).withStreamInfo("file",{name:_,dir:k,date:b,comment:p.comment||"",unixPermissions:p.unixPermissions,dosPermissions:p.dosPermissions}).pipe(w)}),w.entriesCount=m}catch(_){w.error(_)}return w}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(t,s,n){function l(){if(!(this instanceof l))return new l;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var i=new l;for(var d in this)typeof this[d]!="function"&&(i[d]=this[d]);return i}}(l.prototype=t("./object")).loadAsync=t("./load"),l.support=t("./support"),l.defaults=t("./defaults"),l.version="3.10.1",l.loadAsync=function(i,d){return new l().loadAsync(i,d)},l.external=t("./external"),s.exports=l},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(t,s,n){var l=t("./utils"),i=t("./external"),d=t("./utf8"),c=t("./zipEntries"),g=t("./stream/Crc32Probe"),w=t("./nodejsUtils");function m(_){return new i.Promise(function(p,S){var v=_.decompressed.getContentWorker().pipe(new g);v.on("error",function(k){S(k)}).on("end",function(){v.streamInfo.crc32!==_.decompressed.crc32?S(new Error("Corrupted zip : CRC32 mismatch")):p()}).resume()})}s.exports=function(_,p){var S=this;return p=l.extend(p||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:d.utf8decode}),w.isNode&&w.isStream(_)?i.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):l.prepareContent("the loaded zip file",_,!0,p.optimizedBinaryString,p.base64).then(function(v){var k=new c(p);return k.load(v),k}).then(function(v){var k=[i.Promise.resolve(v)],b=v.files;if(p.checkCRC32)for(var f=0;f<b.length;f++)k.push(m(b[f]));return i.Promise.all(k)}).then(function(v){for(var k=v.shift(),b=k.files,f=0;f<b.length;f++){var T=b[f],D=T.fileNameStr,j=l.resolve(T.fileNameStr);S.file(j,T.decompressed,{binary:!0,optimizedBinaryString:!0,date:T.date,dir:T.dir,comment:T.fileCommentStr.length?T.fileCommentStr:null,unixPermissions:T.unixPermissions,dosPermissions:T.dosPermissions,createFolders:p.createFolders}),T.dir||(S.file(j).unsafeOriginalName=D)}return k.zipComment.length&&(S.comment=k.zipComment),S})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(t,s,n){var l=t("../utils"),i=t("../stream/GenericWorker");function d(c,g){i.call(this,"Nodejs stream input adapter for "+c),this._upstreamEnded=!1,this._bindStream(g)}l.inherits(d,i),d.prototype._bindStream=function(c){var g=this;(this._stream=c).pause(),c.on("data",function(w){g.push({data:w,meta:{percent:0}})}).on("error",function(w){g.isPaused?this.generatedError=w:g.error(w)}).on("end",function(){g.isPaused?g._upstreamEnded=!0:g.end()})},d.prototype.pause=function(){return!!i.prototype.pause.call(this)&&(this._stream.pause(),!0)},d.prototype.resume=function(){return!!i.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},s.exports=d},{"../stream/GenericWorker":28,"../utils":32}],13:[function(t,s,n){var l=t("readable-stream").Readable;function i(d,c,g){l.call(this,c),this._helper=d;var w=this;d.on("data",function(m,_){w.push(m)||w._helper.pause(),g&&g(_)}).on("error",function(m){w.emit("error",m)}).on("end",function(){w.push(null)})}t("../utils").inherits(i,l),i.prototype._read=function(){this._helper.resume()},s.exports=i},{"../utils":32,"readable-stream":16}],14:[function(t,s,n){s.exports={isNode:typeof Buffer<"u",newBufferFrom:function(l,i){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(l,i);if(typeof l=="number")throw new Error('The "data" argument must not be a number');return new Buffer(l,i)},allocBuffer:function(l){if(Buffer.alloc)return Buffer.alloc(l);var i=new Buffer(l);return i.fill(0),i},isBuffer:function(l){return Buffer.isBuffer(l)},isStream:function(l){return l&&typeof l.on=="function"&&typeof l.pause=="function"&&typeof l.resume=="function"}}},{}],15:[function(t,s,n){function l(j,B,A){var V,Y=d.getTypeOf(B),se=d.extend(A||{},w);se.date=se.date||new Date,se.compression!==null&&(se.compression=se.compression.toUpperCase()),typeof se.unixPermissions=="string"&&(se.unixPermissions=parseInt(se.unixPermissions,8)),se.unixPermissions&&16384&se.unixPermissions&&(se.dir=!0),se.dosPermissions&&16&se.dosPermissions&&(se.dir=!0),se.dir&&(j=b(j)),se.createFolders&&(V=k(j))&&f.call(this,V,!0);var G=Y==="string"&&se.binary===!1&&se.base64===!1;A&&A.binary!==void 0||(se.binary=!G),(B instanceof m&&B.uncompressedSize===0||se.dir||!B||B.length===0)&&(se.base64=!1,se.binary=!0,B="",se.compression="STORE",Y="string");var I=null;I=B instanceof m||B instanceof c?B:S.isNode&&S.isStream(B)?new v(j,B):d.prepareContent(j,B,se.binary,se.optimizedBinaryString,se.base64);var q=new _(j,I,se);this.files[j]=q}var i=t("./utf8"),d=t("./utils"),c=t("./stream/GenericWorker"),g=t("./stream/StreamHelper"),w=t("./defaults"),m=t("./compressedObject"),_=t("./zipObject"),p=t("./generate"),S=t("./nodejsUtils"),v=t("./nodejs/NodejsStreamInputAdapter"),k=function(j){j.slice(-1)==="/"&&(j=j.substring(0,j.length-1));var B=j.lastIndexOf("/");return 0<B?j.substring(0,B):""},b=function(j){return j.slice(-1)!=="/"&&(j+="/"),j},f=function(j,B){return B=B!==void 0?B:w.createFolders,j=b(j),this.files[j]||l.call(this,j,null,{dir:!0,createFolders:B}),this.files[j]};function T(j){return Object.prototype.toString.call(j)==="[object RegExp]"}var D={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(j){var B,A,V;for(B in this.files)V=this.files[B],(A=B.slice(this.root.length,B.length))&&B.slice(0,this.root.length)===this.root&&j(A,V)},filter:function(j){var B=[];return this.forEach(function(A,V){j(A,V)&&B.push(V)}),B},file:function(j,B,A){if(arguments.length!==1)return j=this.root+j,l.call(this,j,B,A),this;if(T(j)){var V=j;return this.filter(function(se,G){return!G.dir&&V.test(se)})}var Y=this.files[this.root+j];return Y&&!Y.dir?Y:null},folder:function(j){if(!j)return this;if(T(j))return this.filter(function(Y,se){return se.dir&&j.test(Y)});var B=this.root+j,A=f.call(this,B),V=this.clone();return V.root=A.name,V},remove:function(j){j=this.root+j;var B=this.files[j];if(B||(j.slice(-1)!=="/"&&(j+="/"),B=this.files[j]),B&&!B.dir)delete this.files[j];else for(var A=this.filter(function(Y,se){return se.name.slice(0,j.length)===j}),V=0;V<A.length;V++)delete this.files[A[V].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(j){var B,A={};try{if((A=d.extend(j||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:i.utf8encode})).type=A.type.toLowerCase(),A.compression=A.compression.toUpperCase(),A.type==="binarystring"&&(A.type="string"),!A.type)throw new Error("No output type specified.");d.checkSupport(A.type),A.platform!=="darwin"&&A.platform!=="freebsd"&&A.platform!=="linux"&&A.platform!=="sunos"||(A.platform="UNIX"),A.platform==="win32"&&(A.platform="DOS");var V=A.comment||this.comment||"";B=p.generateWorker(this,A,V)}catch(Y){(B=new c("error")).error(Y)}return new g(B,A.type||"string",A.mimeType)},generateAsync:function(j,B){return this.generateInternalStream(j).accumulate(B)},generateNodeStream:function(j,B){return(j=j||{}).type||(j.type="nodebuffer"),this.generateInternalStream(j).toNodejsStream(B)}};s.exports=D},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(t,s,n){s.exports=t("stream")},{stream:void 0}],17:[function(t,s,n){var l=t("./DataReader");function i(d){l.call(this,d);for(var c=0;c<this.data.length;c++)d[c]=255&d[c]}t("../utils").inherits(i,l),i.prototype.byteAt=function(d){return this.data[this.zero+d]},i.prototype.lastIndexOfSignature=function(d){for(var c=d.charCodeAt(0),g=d.charCodeAt(1),w=d.charCodeAt(2),m=d.charCodeAt(3),_=this.length-4;0<=_;--_)if(this.data[_]===c&&this.data[_+1]===g&&this.data[_+2]===w&&this.data[_+3]===m)return _-this.zero;return-1},i.prototype.readAndCheckSignature=function(d){var c=d.charCodeAt(0),g=d.charCodeAt(1),w=d.charCodeAt(2),m=d.charCodeAt(3),_=this.readData(4);return c===_[0]&&g===_[1]&&w===_[2]&&m===_[3]},i.prototype.readData=function(d){if(this.checkOffset(d),d===0)return[];var c=this.data.slice(this.zero+this.index,this.zero+this.index+d);return this.index+=d,c},s.exports=i},{"../utils":32,"./DataReader":18}],18:[function(t,s,n){var l=t("../utils");function i(d){this.data=d,this.length=d.length,this.index=0,this.zero=0}i.prototype={checkOffset:function(d){this.checkIndex(this.index+d)},checkIndex:function(d){if(this.length<this.zero+d||d<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+d+"). Corrupted zip ?")},setIndex:function(d){this.checkIndex(d),this.index=d},skip:function(d){this.setIndex(this.index+d)},byteAt:function(){},readInt:function(d){var c,g=0;for(this.checkOffset(d),c=this.index+d-1;c>=this.index;c--)g=(g<<8)+this.byteAt(c);return this.index+=d,g},readString:function(d){return l.transformTo("string",this.readData(d))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var d=this.readInt(4);return new Date(Date.UTC(1980+(d>>25&127),(d>>21&15)-1,d>>16&31,d>>11&31,d>>5&63,(31&d)<<1))}},s.exports=i},{"../utils":32}],19:[function(t,s,n){var l=t("./Uint8ArrayReader");function i(d){l.call(this,d)}t("../utils").inherits(i,l),i.prototype.readData=function(d){this.checkOffset(d);var c=this.data.slice(this.zero+this.index,this.zero+this.index+d);return this.index+=d,c},s.exports=i},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(t,s,n){var l=t("./DataReader");function i(d){l.call(this,d)}t("../utils").inherits(i,l),i.prototype.byteAt=function(d){return this.data.charCodeAt(this.zero+d)},i.prototype.lastIndexOfSignature=function(d){return this.data.lastIndexOf(d)-this.zero},i.prototype.readAndCheckSignature=function(d){return d===this.readData(4)},i.prototype.readData=function(d){this.checkOffset(d);var c=this.data.slice(this.zero+this.index,this.zero+this.index+d);return this.index+=d,c},s.exports=i},{"../utils":32,"./DataReader":18}],21:[function(t,s,n){var l=t("./ArrayReader");function i(d){l.call(this,d)}t("../utils").inherits(i,l),i.prototype.readData=function(d){if(this.checkOffset(d),d===0)return new Uint8Array(0);var c=this.data.subarray(this.zero+this.index,this.zero+this.index+d);return this.index+=d,c},s.exports=i},{"../utils":32,"./ArrayReader":17}],22:[function(t,s,n){var l=t("../utils"),i=t("../support"),d=t("./ArrayReader"),c=t("./StringReader"),g=t("./NodeBufferReader"),w=t("./Uint8ArrayReader");s.exports=function(m){var _=l.getTypeOf(m);return l.checkSupport(_),_!=="string"||i.uint8array?_==="nodebuffer"?new g(m):i.uint8array?new w(l.transformTo("uint8array",m)):new d(l.transformTo("array",m)):new c(m)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(t,s,n){n.LOCAL_FILE_HEADER="PK",n.CENTRAL_FILE_HEADER="PK",n.CENTRAL_DIRECTORY_END="PK",n.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",n.ZIP64_CENTRAL_DIRECTORY_END="PK",n.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(t,s,n){var l=t("./GenericWorker"),i=t("../utils");function d(c){l.call(this,"ConvertWorker to "+c),this.destType=c}i.inherits(d,l),d.prototype.processChunk=function(c){this.push({data:i.transformTo(this.destType,c.data),meta:c.meta})},s.exports=d},{"../utils":32,"./GenericWorker":28}],25:[function(t,s,n){var l=t("./GenericWorker"),i=t("../crc32");function d(){l.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}t("../utils").inherits(d,l),d.prototype.processChunk=function(c){this.streamInfo.crc32=i(c.data,this.streamInfo.crc32||0),this.push(c)},s.exports=d},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(t,s,n){var l=t("../utils"),i=t("./GenericWorker");function d(c){i.call(this,"DataLengthProbe for "+c),this.propName=c,this.withStreamInfo(c,0)}l.inherits(d,i),d.prototype.processChunk=function(c){if(c){var g=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=g+c.data.length}i.prototype.processChunk.call(this,c)},s.exports=d},{"../utils":32,"./GenericWorker":28}],27:[function(t,s,n){var l=t("../utils"),i=t("./GenericWorker");function d(c){i.call(this,"DataWorker");var g=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,c.then(function(w){g.dataIsReady=!0,g.data=w,g.max=w&&w.length||0,g.type=l.getTypeOf(w),g.isPaused||g._tickAndRepeat()},function(w){g.error(w)})}l.inherits(d,i),d.prototype.cleanUp=function(){i.prototype.cleanUp.call(this),this.data=null},d.prototype.resume=function(){return!!i.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,l.delay(this._tickAndRepeat,[],this)),!0)},d.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(l.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},d.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var c=null,g=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":c=this.data.substring(this.index,g);break;case"uint8array":c=this.data.subarray(this.index,g);break;case"array":case"nodebuffer":c=this.data.slice(this.index,g)}return this.index=g,this.push({data:c,meta:{percent:this.max?this.index/this.max*100:0}})},s.exports=d},{"../utils":32,"./GenericWorker":28}],28:[function(t,s,n){function l(i){this.name=i||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}l.prototype={push:function(i){this.emit("data",i)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(i){this.emit("error",i)}return!0},error:function(i){return!this.isFinished&&(this.isPaused?this.generatedError=i:(this.isFinished=!0,this.emit("error",i),this.previous&&this.previous.error(i),this.cleanUp()),!0)},on:function(i,d){return this._listeners[i].push(d),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(i,d){if(this._listeners[i])for(var c=0;c<this._listeners[i].length;c++)this._listeners[i][c].call(this,d)},pipe:function(i){return i.registerPrevious(this)},registerPrevious:function(i){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=i.streamInfo,this.mergeStreamInfo(),this.previous=i;var d=this;return i.on("data",function(c){d.processChunk(c)}),i.on("end",function(){d.end()}),i.on("error",function(c){d.error(c)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var i=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),i=!0),this.previous&&this.previous.resume(),!i},flush:function(){},processChunk:function(i){this.push(i)},withStreamInfo:function(i,d){return this.extraStreamInfo[i]=d,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var i in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,i)&&(this.streamInfo[i]=this.extraStreamInfo[i])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var i="Worker "+this.name;return this.previous?this.previous+" -> "+i:i}},s.exports=l},{}],29:[function(t,s,n){var l=t("../utils"),i=t("./ConvertWorker"),d=t("./GenericWorker"),c=t("../base64"),g=t("../support"),w=t("../external"),m=null;if(g.nodestream)try{m=t("../nodejs/NodejsStreamOutputAdapter")}catch{}function _(S,v){return new w.Promise(function(k,b){var f=[],T=S._internalType,D=S._outputType,j=S._mimeType;S.on("data",function(B,A){f.push(B),v&&v(A)}).on("error",function(B){f=[],b(B)}).on("end",function(){try{var B=(function(A,V,Y){switch(A){case"blob":return l.newBlob(l.transformTo("arraybuffer",V),Y);case"base64":return c.encode(V);default:return l.transformTo(A,V)}})(D,(function(A,V){var Y,se=0,G=null,I=0;for(Y=0;Y<V.length;Y++)I+=V[Y].length;switch(A){case"string":return V.join("");case"array":return Array.prototype.concat.apply([],V);case"uint8array":for(G=new Uint8Array(I),Y=0;Y<V.length;Y++)G.set(V[Y],se),se+=V[Y].length;return G;case"nodebuffer":return Buffer.concat(V);default:throw new Error("concat : unsupported type '"+A+"'")}})(T,f),j);k(B)}catch(A){b(A)}f=[]}).resume()})}function p(S,v,k){var b=v;switch(v){case"blob":case"arraybuffer":b="uint8array";break;case"base64":b="string"}try{this._internalType=b,this._outputType=v,this._mimeType=k,l.checkSupport(b),this._worker=S.pipe(new i(b)),S.lock()}catch(f){this._worker=new d("error"),this._worker.error(f)}}p.prototype={accumulate:function(S){return _(this,S)},on:function(S,v){var k=this;return S==="data"?this._worker.on(S,function(b){v.call(k,b.data,b.meta)}):this._worker.on(S,function(){l.delay(v,arguments,k)}),this},resume:function(){return l.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(S){if(l.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new m(this,{objectMode:this._outputType!=="nodebuffer"},S)}},s.exports=p},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(t,s,n){if(n.base64=!0,n.array=!0,n.string=!0,n.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",n.nodebuffer=typeof Buffer<"u",n.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")n.blob=!1;else{var l=new ArrayBuffer(0);try{n.blob=new Blob([l],{type:"application/zip"}).size===0}catch{try{var i=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);i.append(l),n.blob=i.getBlob("application/zip").size===0}catch{n.blob=!1}}}try{n.nodestream=!!t("readable-stream").Readable}catch{n.nodestream=!1}},{"readable-stream":16}],31:[function(t,s,n){for(var l=t("./utils"),i=t("./support"),d=t("./nodejsUtils"),c=t("./stream/GenericWorker"),g=new Array(256),w=0;w<256;w++)g[w]=252<=w?6:248<=w?5:240<=w?4:224<=w?3:192<=w?2:1;g[254]=g[254]=1;function m(){c.call(this,"utf-8 decode"),this.leftOver=null}function _(){c.call(this,"utf-8 encode")}n.utf8encode=function(p){return i.nodebuffer?d.newBufferFrom(p,"utf-8"):(function(S){var v,k,b,f,T,D=S.length,j=0;for(f=0;f<D;f++)(64512&(k=S.charCodeAt(f)))==55296&&f+1<D&&(64512&(b=S.charCodeAt(f+1)))==56320&&(k=65536+(k-55296<<10)+(b-56320),f++),j+=k<128?1:k<2048?2:k<65536?3:4;for(v=i.uint8array?new Uint8Array(j):new Array(j),f=T=0;T<j;f++)(64512&(k=S.charCodeAt(f)))==55296&&f+1<D&&(64512&(b=S.charCodeAt(f+1)))==56320&&(k=65536+(k-55296<<10)+(b-56320),f++),k<128?v[T++]=k:(k<2048?v[T++]=192|k>>>6:(k<65536?v[T++]=224|k>>>12:(v[T++]=240|k>>>18,v[T++]=128|k>>>12&63),v[T++]=128|k>>>6&63),v[T++]=128|63&k);return v})(p)},n.utf8decode=function(p){return i.nodebuffer?l.transformTo("nodebuffer",p).toString("utf-8"):(function(S){var v,k,b,f,T=S.length,D=new Array(2*T);for(v=k=0;v<T;)if((b=S[v++])<128)D[k++]=b;else if(4<(f=g[b]))D[k++]=65533,v+=f-1;else{for(b&=f===2?31:f===3?15:7;1<f&&v<T;)b=b<<6|63&S[v++],f--;1<f?D[k++]=65533:b<65536?D[k++]=b:(b-=65536,D[k++]=55296|b>>10&1023,D[k++]=56320|1023&b)}return D.length!==k&&(D.subarray?D=D.subarray(0,k):D.length=k),l.applyFromCharCode(D)})(p=l.transformTo(i.uint8array?"uint8array":"array",p))},l.inherits(m,c),m.prototype.processChunk=function(p){var S=l.transformTo(i.uint8array?"uint8array":"array",p.data);if(this.leftOver&&this.leftOver.length){if(i.uint8array){var v=S;(S=new Uint8Array(v.length+this.leftOver.length)).set(this.leftOver,0),S.set(v,this.leftOver.length)}else S=this.leftOver.concat(S);this.leftOver=null}var k=(function(f,T){var D;for((T=T||f.length)>f.length&&(T=f.length),D=T-1;0<=D&&(192&f[D])==128;)D--;return D<0||D===0?T:D+g[f[D]]>T?D:T})(S),b=S;k!==S.length&&(i.uint8array?(b=S.subarray(0,k),this.leftOver=S.subarray(k,S.length)):(b=S.slice(0,k),this.leftOver=S.slice(k,S.length))),this.push({data:n.utf8decode(b),meta:p.meta})},m.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:n.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},n.Utf8DecodeWorker=m,l.inherits(_,c),_.prototype.processChunk=function(p){this.push({data:n.utf8encode(p.data),meta:p.meta})},n.Utf8EncodeWorker=_},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(t,s,n){var l=t("./support"),i=t("./base64"),d=t("./nodejsUtils"),c=t("./external");function g(v){return v}function w(v,k){for(var b=0;b<v.length;++b)k[b]=255&v.charCodeAt(b);return k}t("setimmediate"),n.newBlob=function(v,k){n.checkSupport("blob");try{return new Blob([v],{type:k})}catch{try{var b=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return b.append(v),b.getBlob(k)}catch{throw new Error("Bug : can't construct the Blob.")}}};var m={stringifyByChunk:function(v,k,b){var f=[],T=0,D=v.length;if(D<=b)return String.fromCharCode.apply(null,v);for(;T<D;)k==="array"||k==="nodebuffer"?f.push(String.fromCharCode.apply(null,v.slice(T,Math.min(T+b,D)))):f.push(String.fromCharCode.apply(null,v.subarray(T,Math.min(T+b,D)))),T+=b;return f.join("")},stringifyByChar:function(v){for(var k="",b=0;b<v.length;b++)k+=String.fromCharCode(v[b]);return k},applyCanBeUsed:{uint8array:(function(){try{return l.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}})(),nodebuffer:(function(){try{return l.nodebuffer&&String.fromCharCode.apply(null,d.allocBuffer(1)).length===1}catch{return!1}})()}};function _(v){var k=65536,b=n.getTypeOf(v),f=!0;if(b==="uint8array"?f=m.applyCanBeUsed.uint8array:b==="nodebuffer"&&(f=m.applyCanBeUsed.nodebuffer),f)for(;1<k;)try{return m.stringifyByChunk(v,b,k)}catch{k=Math.floor(k/2)}return m.stringifyByChar(v)}function p(v,k){for(var b=0;b<v.length;b++)k[b]=v[b];return k}n.applyFromCharCode=_;var S={};S.string={string:g,array:function(v){return w(v,new Array(v.length))},arraybuffer:function(v){return S.string.uint8array(v).buffer},uint8array:function(v){return w(v,new Uint8Array(v.length))},nodebuffer:function(v){return w(v,d.allocBuffer(v.length))}},S.array={string:_,array:g,arraybuffer:function(v){return new Uint8Array(v).buffer},uint8array:function(v){return new Uint8Array(v)},nodebuffer:function(v){return d.newBufferFrom(v)}},S.arraybuffer={string:function(v){return _(new Uint8Array(v))},array:function(v){return p(new Uint8Array(v),new Array(v.byteLength))},arraybuffer:g,uint8array:function(v){return new Uint8Array(v)},nodebuffer:function(v){return d.newBufferFrom(new Uint8Array(v))}},S.uint8array={string:_,array:function(v){return p(v,new Array(v.length))},arraybuffer:function(v){return v.buffer},uint8array:g,nodebuffer:function(v){return d.newBufferFrom(v)}},S.nodebuffer={string:_,array:function(v){return p(v,new Array(v.length))},arraybuffer:function(v){return S.nodebuffer.uint8array(v).buffer},uint8array:function(v){return p(v,new Uint8Array(v.length))},nodebuffer:g},n.transformTo=function(v,k){if(k=k||"",!v)return k;n.checkSupport(v);var b=n.getTypeOf(k);return S[b][v](k)},n.resolve=function(v){for(var k=v.split("/"),b=[],f=0;f<k.length;f++){var T=k[f];T==="."||T===""&&f!==0&&f!==k.length-1||(T===".."?b.pop():b.push(T))}return b.join("/")},n.getTypeOf=function(v){return typeof v=="string"?"string":Object.prototype.toString.call(v)==="[object Array]"?"array":l.nodebuffer&&d.isBuffer(v)?"nodebuffer":l.uint8array&&v instanceof Uint8Array?"uint8array":l.arraybuffer&&v instanceof ArrayBuffer?"arraybuffer":void 0},n.checkSupport=function(v){if(!l[v.toLowerCase()])throw new Error(v+" is not supported by this platform")},n.MAX_VALUE_16BITS=65535,n.MAX_VALUE_32BITS=-1,n.pretty=function(v){var k,b,f="";for(b=0;b<(v||"").length;b++)f+="\\x"+((k=v.charCodeAt(b))<16?"0":"")+k.toString(16).toUpperCase();return f},n.delay=function(v,k,b){setImmediate(function(){v.apply(b||null,k||[])})},n.inherits=function(v,k){function b(){}b.prototype=k.prototype,v.prototype=new b},n.extend=function(){var v,k,b={};for(v=0;v<arguments.length;v++)for(k in arguments[v])Object.prototype.hasOwnProperty.call(arguments[v],k)&&b[k]===void 0&&(b[k]=arguments[v][k]);return b},n.prepareContent=function(v,k,b,f,T){return c.Promise.resolve(k).then(function(D){return l.blob&&(D instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(D))!==-1)&&typeof FileReader<"u"?new c.Promise(function(j,B){var A=new FileReader;A.onload=function(V){j(V.target.result)},A.onerror=function(V){B(V.target.error)},A.readAsArrayBuffer(D)}):D}).then(function(D){var j=n.getTypeOf(D);return j?(j==="arraybuffer"?D=n.transformTo("uint8array",D):j==="string"&&(T?D=i.decode(D):b&&f!==!0&&(D=(function(B){return w(B,l.uint8array?new Uint8Array(B.length):new Array(B.length))})(D))),D):c.Promise.reject(new Error("Can't read the data of '"+v+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(t,s,n){var l=t("./reader/readerFor"),i=t("./utils"),d=t("./signature"),c=t("./zipEntry"),g=t("./support");function w(m){this.files=[],this.loadOptions=m}w.prototype={checkSignature:function(m){if(!this.reader.readAndCheckSignature(m)){this.reader.index-=4;var _=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+i.pretty(_)+", expected "+i.pretty(m)+")")}},isSignature:function(m,_){var p=this.reader.index;this.reader.setIndex(m);var S=this.reader.readString(4)===_;return this.reader.setIndex(p),S},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var m=this.reader.readData(this.zipCommentLength),_=g.uint8array?"uint8array":"array",p=i.transformTo(_,m);this.zipComment=this.loadOptions.decodeFileName(p)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var m,_,p,S=this.zip64EndOfCentralSize-44;0<S;)m=this.reader.readInt(2),_=this.reader.readInt(4),p=this.reader.readData(_),this.zip64ExtensibleData[m]={id:m,length:_,value:p}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var m,_;for(m=0;m<this.files.length;m++)_=this.files[m],this.reader.setIndex(_.localHeaderOffset),this.checkSignature(d.LOCAL_FILE_HEADER),_.readLocalPart(this.reader),_.handleUTF8(),_.processAttributes()},readCentralDir:function(){var m;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(d.CENTRAL_FILE_HEADER);)(m=new c({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(m);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var m=this.reader.lastIndexOfSignature(d.CENTRAL_DIRECTORY_END);if(m<0)throw this.isSignature(0,d.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(m);var _=m;if(this.checkSignature(d.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===i.MAX_VALUE_16BITS||this.diskWithCentralDirStart===i.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===i.MAX_VALUE_16BITS||this.centralDirRecords===i.MAX_VALUE_16BITS||this.centralDirSize===i.MAX_VALUE_32BITS||this.centralDirOffset===i.MAX_VALUE_32BITS){if(this.zip64=!0,(m=this.reader.lastIndexOfSignature(d.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(m),this.checkSignature(d.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,d.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(d.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(d.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var p=this.centralDirOffset+this.centralDirSize;this.zip64&&(p+=20,p+=12+this.zip64EndOfCentralSize);var S=_-p;if(0<S)this.isSignature(_,d.CENTRAL_FILE_HEADER)||(this.reader.zero=S);else if(S<0)throw new Error("Corrupted zip: missing "+Math.abs(S)+" bytes.")},prepareReader:function(m){this.reader=l(m)},load:function(m){this.prepareReader(m),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},s.exports=w},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(t,s,n){var l=t("./reader/readerFor"),i=t("./utils"),d=t("./compressedObject"),c=t("./crc32"),g=t("./utf8"),w=t("./compressions"),m=t("./support");function _(p,S){this.options=p,this.loadOptions=S}_.prototype={isEncrypted:function(){return(1&this.bitFlag)==1},useUTF8:function(){return(2048&this.bitFlag)==2048},readLocalPart:function(p){var S,v;if(p.skip(22),this.fileNameLength=p.readInt(2),v=p.readInt(2),this.fileName=p.readData(this.fileNameLength),p.skip(v),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if((S=(function(k){for(var b in w)if(Object.prototype.hasOwnProperty.call(w,b)&&w[b].magic===k)return w[b];return null})(this.compressionMethod))===null)throw new Error("Corrupted zip : compression "+i.pretty(this.compressionMethod)+" unknown (inner file : "+i.transformTo("string",this.fileName)+")");this.decompressed=new d(this.compressedSize,this.uncompressedSize,this.crc32,S,p.readData(this.compressedSize))},readCentralPart:function(p){this.versionMadeBy=p.readInt(2),p.skip(2),this.bitFlag=p.readInt(2),this.compressionMethod=p.readString(2),this.date=p.readDate(),this.crc32=p.readInt(4),this.compressedSize=p.readInt(4),this.uncompressedSize=p.readInt(4);var S=p.readInt(2);if(this.extraFieldsLength=p.readInt(2),this.fileCommentLength=p.readInt(2),this.diskNumberStart=p.readInt(2),this.internalFileAttributes=p.readInt(2),this.externalFileAttributes=p.readInt(4),this.localHeaderOffset=p.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");p.skip(S),this.readExtraFields(p),this.parseZIP64ExtraField(p),this.fileComment=p.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var p=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),p==0&&(this.dosPermissions=63&this.externalFileAttributes),p==3&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||this.fileNameStr.slice(-1)!=="/"||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var p=l(this.extraFields[1].value);this.uncompressedSize===i.MAX_VALUE_32BITS&&(this.uncompressedSize=p.readInt(8)),this.compressedSize===i.MAX_VALUE_32BITS&&(this.compressedSize=p.readInt(8)),this.localHeaderOffset===i.MAX_VALUE_32BITS&&(this.localHeaderOffset=p.readInt(8)),this.diskNumberStart===i.MAX_VALUE_32BITS&&(this.diskNumberStart=p.readInt(4))}},readExtraFields:function(p){var S,v,k,b=p.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});p.index+4<b;)S=p.readInt(2),v=p.readInt(2),k=p.readData(v),this.extraFields[S]={id:S,length:v,value:k};p.setIndex(b)},handleUTF8:function(){var p=m.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=g.utf8decode(this.fileName),this.fileCommentStr=g.utf8decode(this.fileComment);else{var S=this.findExtraFieldUnicodePath();if(S!==null)this.fileNameStr=S;else{var v=i.transformTo(p,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(v)}var k=this.findExtraFieldUnicodeComment();if(k!==null)this.fileCommentStr=k;else{var b=i.transformTo(p,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(b)}}},findExtraFieldUnicodePath:function(){var p=this.extraFields[28789];if(p){var S=l(p.value);return S.readInt(1)!==1||c(this.fileName)!==S.readInt(4)?null:g.utf8decode(S.readData(p.length-5))}return null},findExtraFieldUnicodeComment:function(){var p=this.extraFields[25461];if(p){var S=l(p.value);return S.readInt(1)!==1||c(this.fileComment)!==S.readInt(4)?null:g.utf8decode(S.readData(p.length-5))}return null}},s.exports=_},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(t,s,n){function l(S,v,k){this.name=S,this.dir=k.dir,this.date=k.date,this.comment=k.comment,this.unixPermissions=k.unixPermissions,this.dosPermissions=k.dosPermissions,this._data=v,this._dataBinary=k.binary,this.options={compression:k.compression,compressionOptions:k.compressionOptions}}var i=t("./stream/StreamHelper"),d=t("./stream/DataWorker"),c=t("./utf8"),g=t("./compressedObject"),w=t("./stream/GenericWorker");l.prototype={internalStream:function(S){var v=null,k="string";try{if(!S)throw new Error("No output type specified.");var b=(k=S.toLowerCase())==="string"||k==="text";k!=="binarystring"&&k!=="text"||(k="string"),v=this._decompressWorker();var f=!this._dataBinary;f&&!b&&(v=v.pipe(new c.Utf8EncodeWorker)),!f&&b&&(v=v.pipe(new c.Utf8DecodeWorker))}catch(T){(v=new w("error")).error(T)}return new i(v,k,"")},async:function(S,v){return this.internalStream(S).accumulate(v)},nodeStream:function(S,v){return this.internalStream(S||"nodebuffer").toNodejsStream(v)},_compressWorker:function(S,v){if(this._data instanceof g&&this._data.compression.magic===S.magic)return this._data.getCompressedWorker();var k=this._decompressWorker();return this._dataBinary||(k=k.pipe(new c.Utf8EncodeWorker)),g.createWorkerFrom(k,S,v)},_decompressWorker:function(){return this._data instanceof g?this._data.getContentWorker():this._data instanceof w?this._data:new d(this._data)}};for(var m=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],_=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},p=0;p<m.length;p++)l.prototype[m[p]]=_;s.exports=l},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(t,s,n){(function(l){var i,d,c=l.MutationObserver||l.WebKitMutationObserver;if(c){var g=0,w=new c(S),m=l.document.createTextNode("");w.observe(m,{characterData:!0}),i=function(){m.data=g=++g%2}}else if(l.setImmediate||l.MessageChannel===void 0)i="document"in l&&"onreadystatechange"in l.document.createElement("script")?function(){var v=l.document.createElement("script");v.onreadystatechange=function(){S(),v.onreadystatechange=null,v.parentNode.removeChild(v),v=null},l.document.documentElement.appendChild(v)}:function(){setTimeout(S,0)};else{var _=new l.MessageChannel;_.port1.onmessage=S,i=function(){_.port2.postMessage(0)}}var p=[];function S(){var v,k;d=!0;for(var b=p.length;b;){for(k=p,p=[],v=-1;++v<b;)k[v]();b=p.length}d=!1}s.exports=function(v){p.push(v)!==1||d||i()}}).call(this,typeof dt<"u"?dt:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(t,s,n){var l=t("immediate");function i(){}var d={},c=["REJECTED"],g=["FULFILLED"],w=["PENDING"];function m(b){if(typeof b!="function")throw new TypeError("resolver must be a function");this.state=w,this.queue=[],this.outcome=void 0,b!==i&&v(this,b)}function _(b,f,T){this.promise=b,typeof f=="function"&&(this.onFulfilled=f,this.callFulfilled=this.otherCallFulfilled),typeof T=="function"&&(this.onRejected=T,this.callRejected=this.otherCallRejected)}function p(b,f,T){l(function(){var D;try{D=f(T)}catch(j){return d.reject(b,j)}D===b?d.reject(b,new TypeError("Cannot resolve promise with itself")):d.resolve(b,D)})}function S(b){var f=b&&b.then;if(b&&(typeof b=="object"||typeof b=="function")&&typeof f=="function")return function(){f.apply(b,arguments)}}function v(b,f){var T=!1;function D(A){T||(T=!0,d.reject(b,A))}function j(A){T||(T=!0,d.resolve(b,A))}var B=k(function(){f(j,D)});B.status==="error"&&D(B.value)}function k(b,f){var T={};try{T.value=b(f),T.status="success"}catch(D){T.status="error",T.value=D}return T}(s.exports=m).prototype.finally=function(b){if(typeof b!="function")return this;var f=this.constructor;return this.then(function(T){return f.resolve(b()).then(function(){return T})},function(T){return f.resolve(b()).then(function(){throw T})})},m.prototype.catch=function(b){return this.then(null,b)},m.prototype.then=function(b,f){if(typeof b!="function"&&this.state===g||typeof f!="function"&&this.state===c)return this;var T=new this.constructor(i);return this.state!==w?p(T,this.state===g?b:f,this.outcome):this.queue.push(new _(T,b,f)),T},_.prototype.callFulfilled=function(b){d.resolve(this.promise,b)},_.prototype.otherCallFulfilled=function(b){p(this.promise,this.onFulfilled,b)},_.prototype.callRejected=function(b){d.reject(this.promise,b)},_.prototype.otherCallRejected=function(b){p(this.promise,this.onRejected,b)},d.resolve=function(b,f){var T=k(S,f);if(T.status==="error")return d.reject(b,T.value);var D=T.value;if(D)v(b,D);else{b.state=g,b.outcome=f;for(var j=-1,B=b.queue.length;++j<B;)b.queue[j].callFulfilled(f)}return b},d.reject=function(b,f){b.state=c,b.outcome=f;for(var T=-1,D=b.queue.length;++T<D;)b.queue[T].callRejected(f);return b},m.resolve=function(b){return b instanceof this?b:d.resolve(new this(i),b)},m.reject=function(b){var f=new this(i);return d.reject(f,b)},m.all=function(b){var f=this;if(Object.prototype.toString.call(b)!=="[object Array]")return this.reject(new TypeError("must be an array"));var T=b.length,D=!1;if(!T)return this.resolve([]);for(var j=new Array(T),B=0,A=-1,V=new this(i);++A<T;)Y(b[A],A);return V;function Y(se,G){f.resolve(se).then(function(I){j[G]=I,++B!==T||D||(D=!0,d.resolve(V,j))},function(I){D||(D=!0,d.reject(V,I))})}},m.race=function(b){var f=this;if(Object.prototype.toString.call(b)!=="[object Array]")return this.reject(new TypeError("must be an array"));var T=b.length,D=!1;if(!T)return this.resolve([]);for(var j=-1,B=new this(i);++j<T;)A=b[j],f.resolve(A).then(function(V){D||(D=!0,d.resolve(B,V))},function(V){D||(D=!0,d.reject(B,V))});var A;return B}},{immediate:36}],38:[function(t,s,n){var l={};(0,t("./lib/utils/common").assign)(l,t("./lib/deflate"),t("./lib/inflate"),t("./lib/zlib/constants")),s.exports=l},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(t,s,n){var l=t("./zlib/deflate"),i=t("./utils/common"),d=t("./utils/strings"),c=t("./zlib/messages"),g=t("./zlib/zstream"),w=Object.prototype.toString,m=0,_=-1,p=0,S=8;function v(b){if(!(this instanceof v))return new v(b);this.options=i.assign({level:_,method:S,chunkSize:16384,windowBits:15,memLevel:8,strategy:p,to:""},b||{});var f=this.options;f.raw&&0<f.windowBits?f.windowBits=-f.windowBits:f.gzip&&0<f.windowBits&&f.windowBits<16&&(f.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new g,this.strm.avail_out=0;var T=l.deflateInit2(this.strm,f.level,f.method,f.windowBits,f.memLevel,f.strategy);if(T!==m)throw new Error(c[T]);if(f.header&&l.deflateSetHeader(this.strm,f.header),f.dictionary){var D;if(D=typeof f.dictionary=="string"?d.string2buf(f.dictionary):w.call(f.dictionary)==="[object ArrayBuffer]"?new Uint8Array(f.dictionary):f.dictionary,(T=l.deflateSetDictionary(this.strm,D))!==m)throw new Error(c[T]);this._dict_set=!0}}function k(b,f){var T=new v(f);if(T.push(b,!0),T.err)throw T.msg||c[T.err];return T.result}v.prototype.push=function(b,f){var T,D,j=this.strm,B=this.options.chunkSize;if(this.ended)return!1;D=f===~~f?f:f===!0?4:0,typeof b=="string"?j.input=d.string2buf(b):w.call(b)==="[object ArrayBuffer]"?j.input=new Uint8Array(b):j.input=b,j.next_in=0,j.avail_in=j.input.length;do{if(j.avail_out===0&&(j.output=new i.Buf8(B),j.next_out=0,j.avail_out=B),(T=l.deflate(j,D))!==1&&T!==m)return this.onEnd(T),!(this.ended=!0);j.avail_out!==0&&(j.avail_in!==0||D!==4&&D!==2)||(this.options.to==="string"?this.onData(d.buf2binstring(i.shrinkBuf(j.output,j.next_out))):this.onData(i.shrinkBuf(j.output,j.next_out)))}while((0<j.avail_in||j.avail_out===0)&&T!==1);return D===4?(T=l.deflateEnd(this.strm),this.onEnd(T),this.ended=!0,T===m):D!==2||(this.onEnd(m),!(j.avail_out=0))},v.prototype.onData=function(b){this.chunks.push(b)},v.prototype.onEnd=function(b){b===m&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=i.flattenChunks(this.chunks)),this.chunks=[],this.err=b,this.msg=this.strm.msg},n.Deflate=v,n.deflate=k,n.deflateRaw=function(b,f){return(f=f||{}).raw=!0,k(b,f)},n.gzip=function(b,f){return(f=f||{}).gzip=!0,k(b,f)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(t,s,n){var l=t("./zlib/inflate"),i=t("./utils/common"),d=t("./utils/strings"),c=t("./zlib/constants"),g=t("./zlib/messages"),w=t("./zlib/zstream"),m=t("./zlib/gzheader"),_=Object.prototype.toString;function p(v){if(!(this instanceof p))return new p(v);this.options=i.assign({chunkSize:16384,windowBits:0,to:""},v||{});var k=this.options;k.raw&&0<=k.windowBits&&k.windowBits<16&&(k.windowBits=-k.windowBits,k.windowBits===0&&(k.windowBits=-15)),!(0<=k.windowBits&&k.windowBits<16)||v&&v.windowBits||(k.windowBits+=32),15<k.windowBits&&k.windowBits<48&&(15&k.windowBits)==0&&(k.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new w,this.strm.avail_out=0;var b=l.inflateInit2(this.strm,k.windowBits);if(b!==c.Z_OK)throw new Error(g[b]);this.header=new m,l.inflateGetHeader(this.strm,this.header)}function S(v,k){var b=new p(k);if(b.push(v,!0),b.err)throw b.msg||g[b.err];return b.result}p.prototype.push=function(v,k){var b,f,T,D,j,B,A=this.strm,V=this.options.chunkSize,Y=this.options.dictionary,se=!1;if(this.ended)return!1;f=k===~~k?k:k===!0?c.Z_FINISH:c.Z_NO_FLUSH,typeof v=="string"?A.input=d.binstring2buf(v):_.call(v)==="[object ArrayBuffer]"?A.input=new Uint8Array(v):A.input=v,A.next_in=0,A.avail_in=A.input.length;do{if(A.avail_out===0&&(A.output=new i.Buf8(V),A.next_out=0,A.avail_out=V),(b=l.inflate(A,c.Z_NO_FLUSH))===c.Z_NEED_DICT&&Y&&(B=typeof Y=="string"?d.string2buf(Y):_.call(Y)==="[object ArrayBuffer]"?new Uint8Array(Y):Y,b=l.inflateSetDictionary(this.strm,B)),b===c.Z_BUF_ERROR&&se===!0&&(b=c.Z_OK,se=!1),b!==c.Z_STREAM_END&&b!==c.Z_OK)return this.onEnd(b),!(this.ended=!0);A.next_out&&(A.avail_out!==0&&b!==c.Z_STREAM_END&&(A.avail_in!==0||f!==c.Z_FINISH&&f!==c.Z_SYNC_FLUSH)||(this.options.to==="string"?(T=d.utf8border(A.output,A.next_out),D=A.next_out-T,j=d.buf2string(A.output,T),A.next_out=D,A.avail_out=V-D,D&&i.arraySet(A.output,A.output,T,D,0),this.onData(j)):this.onData(i.shrinkBuf(A.output,A.next_out)))),A.avail_in===0&&A.avail_out===0&&(se=!0)}while((0<A.avail_in||A.avail_out===0)&&b!==c.Z_STREAM_END);return b===c.Z_STREAM_END&&(f=c.Z_FINISH),f===c.Z_FINISH?(b=l.inflateEnd(this.strm),this.onEnd(b),this.ended=!0,b===c.Z_OK):f!==c.Z_SYNC_FLUSH||(this.onEnd(c.Z_OK),!(A.avail_out=0))},p.prototype.onData=function(v){this.chunks.push(v)},p.prototype.onEnd=function(v){v===c.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=i.flattenChunks(this.chunks)),this.chunks=[],this.err=v,this.msg=this.strm.msg},n.Inflate=p,n.inflate=S,n.inflateRaw=function(v,k){return(k=k||{}).raw=!0,S(v,k)},n.ungzip=S},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(t,s,n){var l=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";n.assign=function(c){for(var g=Array.prototype.slice.call(arguments,1);g.length;){var w=g.shift();if(w){if(typeof w!="object")throw new TypeError(w+"must be non-object");for(var m in w)w.hasOwnProperty(m)&&(c[m]=w[m])}}return c},n.shrinkBuf=function(c,g){return c.length===g?c:c.subarray?c.subarray(0,g):(c.length=g,c)};var i={arraySet:function(c,g,w,m,_){if(g.subarray&&c.subarray)c.set(g.subarray(w,w+m),_);else for(var p=0;p<m;p++)c[_+p]=g[w+p]},flattenChunks:function(c){var g,w,m,_,p,S;for(g=m=0,w=c.length;g<w;g++)m+=c[g].length;for(S=new Uint8Array(m),g=_=0,w=c.length;g<w;g++)p=c[g],S.set(p,_),_+=p.length;return S}},d={arraySet:function(c,g,w,m,_){for(var p=0;p<m;p++)c[_+p]=g[w+p]},flattenChunks:function(c){return[].concat.apply([],c)}};n.setTyped=function(c){c?(n.Buf8=Uint8Array,n.Buf16=Uint16Array,n.Buf32=Int32Array,n.assign(n,i)):(n.Buf8=Array,n.Buf16=Array,n.Buf32=Array,n.assign(n,d))},n.setTyped(l)},{}],42:[function(t,s,n){var l=t("./common"),i=!0,d=!0;try{String.fromCharCode.apply(null,[0])}catch{i=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{d=!1}for(var c=new l.Buf8(256),g=0;g<256;g++)c[g]=252<=g?6:248<=g?5:240<=g?4:224<=g?3:192<=g?2:1;function w(m,_){if(_<65537&&(m.subarray&&d||!m.subarray&&i))return String.fromCharCode.apply(null,l.shrinkBuf(m,_));for(var p="",S=0;S<_;S++)p+=String.fromCharCode(m[S]);return p}c[254]=c[254]=1,n.string2buf=function(m){var _,p,S,v,k,b=m.length,f=0;for(v=0;v<b;v++)(64512&(p=m.charCodeAt(v)))==55296&&v+1<b&&(64512&(S=m.charCodeAt(v+1)))==56320&&(p=65536+(p-55296<<10)+(S-56320),v++),f+=p<128?1:p<2048?2:p<65536?3:4;for(_=new l.Buf8(f),v=k=0;k<f;v++)(64512&(p=m.charCodeAt(v)))==55296&&v+1<b&&(64512&(S=m.charCodeAt(v+1)))==56320&&(p=65536+(p-55296<<10)+(S-56320),v++),p<128?_[k++]=p:(p<2048?_[k++]=192|p>>>6:(p<65536?_[k++]=224|p>>>12:(_[k++]=240|p>>>18,_[k++]=128|p>>>12&63),_[k++]=128|p>>>6&63),_[k++]=128|63&p);return _},n.buf2binstring=function(m){return w(m,m.length)},n.binstring2buf=function(m){for(var _=new l.Buf8(m.length),p=0,S=_.length;p<S;p++)_[p]=m.charCodeAt(p);return _},n.buf2string=function(m,_){var p,S,v,k,b=_||m.length,f=new Array(2*b);for(p=S=0;p<b;)if((v=m[p++])<128)f[S++]=v;else if(4<(k=c[v]))f[S++]=65533,p+=k-1;else{for(v&=k===2?31:k===3?15:7;1<k&&p<b;)v=v<<6|63&m[p++],k--;1<k?f[S++]=65533:v<65536?f[S++]=v:(v-=65536,f[S++]=55296|v>>10&1023,f[S++]=56320|1023&v)}return w(f,S)},n.utf8border=function(m,_){var p;for((_=_||m.length)>m.length&&(_=m.length),p=_-1;0<=p&&(192&m[p])==128;)p--;return p<0||p===0?_:p+c[m[p]]>_?p:_}},{"./common":41}],43:[function(t,s,n){s.exports=function(l,i,d,c){for(var g=65535&l|0,w=l>>>16&65535|0,m=0;d!==0;){for(d-=m=2e3<d?2e3:d;w=w+(g=g+i[c++]|0)|0,--m;);g%=65521,w%=65521}return g|w<<16|0}},{}],44:[function(t,s,n){s.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(t,s,n){var l=(function(){for(var i,d=[],c=0;c<256;c++){i=c;for(var g=0;g<8;g++)i=1&i?3988292384^i>>>1:i>>>1;d[c]=i}return d})();s.exports=function(i,d,c,g){var w=l,m=g+c;i^=-1;for(var _=g;_<m;_++)i=i>>>8^w[255&(i^d[_])];return-1^i}},{}],46:[function(t,s,n){var l,i=t("../utils/common"),d=t("./trees"),c=t("./adler32"),g=t("./crc32"),w=t("./messages"),m=0,_=4,p=0,S=-2,v=-1,k=4,b=2,f=8,T=9,D=286,j=30,B=19,A=2*D+1,V=15,Y=3,se=258,G=se+Y+1,I=42,q=113,h=1,y=2,ee=3,K=4;function te(u,U){return u.msg=w[U],U}function $(u){return(u<<1)-(4<u?9:0)}function W(u){for(var U=u.length;0<=--U;)u[U]=0}function L(u){var U=u.state,P=U.pending;P>u.avail_out&&(P=u.avail_out),P!==0&&(i.arraySet(u.output,U.pending_buf,U.pending_out,P,u.next_out),u.next_out+=P,U.pending_out+=P,u.total_out+=P,u.avail_out-=P,U.pending-=P,U.pending===0&&(U.pending_out=0))}function O(u,U){d._tr_flush_block(u,0<=u.block_start?u.block_start:-1,u.strstart-u.block_start,U),u.block_start=u.strstart,L(u.strm)}function re(u,U){u.pending_buf[u.pending++]=U}function Z(u,U){u.pending_buf[u.pending++]=U>>>8&255,u.pending_buf[u.pending++]=255&U}function ne(u,U){var P,x,C=u.max_chain_length,N=u.strstart,M=u.prev_length,X=u.nice_match,R=u.strstart>u.w_size-G?u.strstart-(u.w_size-G):0,ae=u.window,he=u.w_mask,de=u.prev,pe=u.strstart+se,Q=ae[N+M-1],H=ae[N+M];u.prev_length>=u.good_match&&(C>>=2),X>u.lookahead&&(X=u.lookahead);do if(ae[(P=U)+M]===H&&ae[P+M-1]===Q&&ae[P]===ae[N]&&ae[++P]===ae[N+1]){N+=2,P++;do;while(ae[++N]===ae[++P]&&ae[++N]===ae[++P]&&ae[++N]===ae[++P]&&ae[++N]===ae[++P]&&ae[++N]===ae[++P]&&ae[++N]===ae[++P]&&ae[++N]===ae[++P]&&ae[++N]===ae[++P]&&N<pe);if(x=se-(pe-N),N=pe-se,M<x){if(u.match_start=U,X<=(M=x))break;Q=ae[N+M-1],H=ae[N+M]}}while((U=de[U&he])>R&&--C!=0);return M<=u.lookahead?M:u.lookahead}function ve(u){var U,P,x,C,N,M,X,R,ae,he,de=u.w_size;do{if(C=u.window_size-u.lookahead-u.strstart,u.strstart>=de+(de-G)){for(i.arraySet(u.window,u.window,de,de,0),u.match_start-=de,u.strstart-=de,u.block_start-=de,U=P=u.hash_size;x=u.head[--U],u.head[U]=de<=x?x-de:0,--P;);for(U=P=de;x=u.prev[--U],u.prev[U]=de<=x?x-de:0,--P;);C+=de}if(u.strm.avail_in===0)break;if(M=u.strm,X=u.window,R=u.strstart+u.lookahead,ae=C,he=void 0,he=M.avail_in,ae<he&&(he=ae),P=he===0?0:(M.avail_in-=he,i.arraySet(X,M.input,M.next_in,he,R),M.state.wrap===1?M.adler=c(M.adler,X,he,R):M.state.wrap===2&&(M.adler=g(M.adler,X,he,R)),M.next_in+=he,M.total_in+=he,he),u.lookahead+=P,u.lookahead+u.insert>=Y)for(N=u.strstart-u.insert,u.ins_h=u.window[N],u.ins_h=(u.ins_h<<u.hash_shift^u.window[N+1])&u.hash_mask;u.insert&&(u.ins_h=(u.ins_h<<u.hash_shift^u.window[N+Y-1])&u.hash_mask,u.prev[N&u.w_mask]=u.head[u.ins_h],u.head[u.ins_h]=N,N++,u.insert--,!(u.lookahead+u.insert<Y)););}while(u.lookahead<G&&u.strm.avail_in!==0)}function we(u,U){for(var P,x;;){if(u.lookahead<G){if(ve(u),u.lookahead<G&&U===m)return h;if(u.lookahead===0)break}if(P=0,u.lookahead>=Y&&(u.ins_h=(u.ins_h<<u.hash_shift^u.window[u.strstart+Y-1])&u.hash_mask,P=u.prev[u.strstart&u.w_mask]=u.head[u.ins_h],u.head[u.ins_h]=u.strstart),P!==0&&u.strstart-P<=u.w_size-G&&(u.match_length=ne(u,P)),u.match_length>=Y)if(x=d._tr_tally(u,u.strstart-u.match_start,u.match_length-Y),u.lookahead-=u.match_length,u.match_length<=u.max_lazy_match&&u.lookahead>=Y){for(u.match_length--;u.strstart++,u.ins_h=(u.ins_h<<u.hash_shift^u.window[u.strstart+Y-1])&u.hash_mask,P=u.prev[u.strstart&u.w_mask]=u.head[u.ins_h],u.head[u.ins_h]=u.strstart,--u.match_length!=0;);u.strstart++}else u.strstart+=u.match_length,u.match_length=0,u.ins_h=u.window[u.strstart],u.ins_h=(u.ins_h<<u.hash_shift^u.window[u.strstart+1])&u.hash_mask;else x=d._tr_tally(u,0,u.window[u.strstart]),u.lookahead--,u.strstart++;if(x&&(O(u,!1),u.strm.avail_out===0))return h}return u.insert=u.strstart<Y-1?u.strstart:Y-1,U===_?(O(u,!0),u.strm.avail_out===0?ee:K):u.last_lit&&(O(u,!1),u.strm.avail_out===0)?h:y}function ie(u,U){for(var P,x,C;;){if(u.lookahead<G){if(ve(u),u.lookahead<G&&U===m)return h;if(u.lookahead===0)break}if(P=0,u.lookahead>=Y&&(u.ins_h=(u.ins_h<<u.hash_shift^u.window[u.strstart+Y-1])&u.hash_mask,P=u.prev[u.strstart&u.w_mask]=u.head[u.ins_h],u.head[u.ins_h]=u.strstart),u.prev_length=u.match_length,u.prev_match=u.match_start,u.match_length=Y-1,P!==0&&u.prev_length<u.max_lazy_match&&u.strstart-P<=u.w_size-G&&(u.match_length=ne(u,P),u.match_length<=5&&(u.strategy===1||u.match_length===Y&&4096<u.strstart-u.match_start)&&(u.match_length=Y-1)),u.prev_length>=Y&&u.match_length<=u.prev_length){for(C=u.strstart+u.lookahead-Y,x=d._tr_tally(u,u.strstart-1-u.prev_match,u.prev_length-Y),u.lookahead-=u.prev_length-1,u.prev_length-=2;++u.strstart<=C&&(u.ins_h=(u.ins_h<<u.hash_shift^u.window[u.strstart+Y-1])&u.hash_mask,P=u.prev[u.strstart&u.w_mask]=u.head[u.ins_h],u.head[u.ins_h]=u.strstart),--u.prev_length!=0;);if(u.match_available=0,u.match_length=Y-1,u.strstart++,x&&(O(u,!1),u.strm.avail_out===0))return h}else if(u.match_available){if((x=d._tr_tally(u,0,u.window[u.strstart-1]))&&O(u,!1),u.strstart++,u.lookahead--,u.strm.avail_out===0)return h}else u.match_available=1,u.strstart++,u.lookahead--}return u.match_available&&(x=d._tr_tally(u,0,u.window[u.strstart-1]),u.match_available=0),u.insert=u.strstart<Y-1?u.strstart:Y-1,U===_?(O(u,!0),u.strm.avail_out===0?ee:K):u.last_lit&&(O(u,!1),u.strm.avail_out===0)?h:y}function ke(u,U,P,x,C){this.good_length=u,this.max_lazy=U,this.nice_length=P,this.max_chain=x,this.func=C}function _e(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=f,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new i.Buf16(2*A),this.dyn_dtree=new i.Buf16(2*(2*j+1)),this.bl_tree=new i.Buf16(2*(2*B+1)),W(this.dyn_ltree),W(this.dyn_dtree),W(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new i.Buf16(V+1),this.heap=new i.Buf16(2*D+1),W(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new i.Buf16(2*D+1),W(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function oe(u){var U;return u&&u.state?(u.total_in=u.total_out=0,u.data_type=b,(U=u.state).pending=0,U.pending_out=0,U.wrap<0&&(U.wrap=-U.wrap),U.status=U.wrap?I:q,u.adler=U.wrap===2?0:1,U.last_flush=m,d._tr_init(U),p):te(u,S)}function ue(u){var U=oe(u);return U===p&&(function(P){P.window_size=2*P.w_size,W(P.head),P.max_lazy_match=l[P.level].max_lazy,P.good_match=l[P.level].good_length,P.nice_match=l[P.level].nice_length,P.max_chain_length=l[P.level].max_chain,P.strstart=0,P.block_start=0,P.lookahead=0,P.insert=0,P.match_length=P.prev_length=Y-1,P.match_available=0,P.ins_h=0})(u.state),U}function J(u,U,P,x,C,N){if(!u)return S;var M=1;if(U===v&&(U=6),x<0?(M=0,x=-x):15<x&&(M=2,x-=16),C<1||T<C||P!==f||x<8||15<x||U<0||9<U||N<0||k<N)return te(u,S);x===8&&(x=9);var X=new _e;return(u.state=X).strm=u,X.wrap=M,X.gzhead=null,X.w_bits=x,X.w_size=1<<X.w_bits,X.w_mask=X.w_size-1,X.hash_bits=C+7,X.hash_size=1<<X.hash_bits,X.hash_mask=X.hash_size-1,X.hash_shift=~~((X.hash_bits+Y-1)/Y),X.window=new i.Buf8(2*X.w_size),X.head=new i.Buf16(X.hash_size),X.prev=new i.Buf16(X.w_size),X.lit_bufsize=1<<C+6,X.pending_buf_size=4*X.lit_bufsize,X.pending_buf=new i.Buf8(X.pending_buf_size),X.d_buf=1*X.lit_bufsize,X.l_buf=3*X.lit_bufsize,X.level=U,X.strategy=N,X.method=P,ue(u)}l=[new ke(0,0,0,0,function(u,U){var P=65535;for(P>u.pending_buf_size-5&&(P=u.pending_buf_size-5);;){if(u.lookahead<=1){if(ve(u),u.lookahead===0&&U===m)return h;if(u.lookahead===0)break}u.strstart+=u.lookahead,u.lookahead=0;var x=u.block_start+P;if((u.strstart===0||u.strstart>=x)&&(u.lookahead=u.strstart-x,u.strstart=x,O(u,!1),u.strm.avail_out===0)||u.strstart-u.block_start>=u.w_size-G&&(O(u,!1),u.strm.avail_out===0))return h}return u.insert=0,U===_?(O(u,!0),u.strm.avail_out===0?ee:K):(u.strstart>u.block_start&&(O(u,!1),u.strm.avail_out),h)}),new ke(4,4,8,4,we),new ke(4,5,16,8,we),new ke(4,6,32,32,we),new ke(4,4,16,16,ie),new ke(8,16,32,32,ie),new ke(8,16,128,128,ie),new ke(8,32,128,256,ie),new ke(32,128,258,1024,ie),new ke(32,258,258,4096,ie)],n.deflateInit=function(u,U){return J(u,U,f,15,8,0)},n.deflateInit2=J,n.deflateReset=ue,n.deflateResetKeep=oe,n.deflateSetHeader=function(u,U){return u&&u.state?u.state.wrap!==2?S:(u.state.gzhead=U,p):S},n.deflate=function(u,U){var P,x,C,N;if(!u||!u.state||5<U||U<0)return u?te(u,S):S;if(x=u.state,!u.output||!u.input&&u.avail_in!==0||x.status===666&&U!==_)return te(u,u.avail_out===0?-5:S);if(x.strm=u,P=x.last_flush,x.last_flush=U,x.status===I)if(x.wrap===2)u.adler=0,re(x,31),re(x,139),re(x,8),x.gzhead?(re(x,(x.gzhead.text?1:0)+(x.gzhead.hcrc?2:0)+(x.gzhead.extra?4:0)+(x.gzhead.name?8:0)+(x.gzhead.comment?16:0)),re(x,255&x.gzhead.time),re(x,x.gzhead.time>>8&255),re(x,x.gzhead.time>>16&255),re(x,x.gzhead.time>>24&255),re(x,x.level===9?2:2<=x.strategy||x.level<2?4:0),re(x,255&x.gzhead.os),x.gzhead.extra&&x.gzhead.extra.length&&(re(x,255&x.gzhead.extra.length),re(x,x.gzhead.extra.length>>8&255)),x.gzhead.hcrc&&(u.adler=g(u.adler,x.pending_buf,x.pending,0)),x.gzindex=0,x.status=69):(re(x,0),re(x,0),re(x,0),re(x,0),re(x,0),re(x,x.level===9?2:2<=x.strategy||x.level<2?4:0),re(x,3),x.status=q);else{var M=f+(x.w_bits-8<<4)<<8;M|=(2<=x.strategy||x.level<2?0:x.level<6?1:x.level===6?2:3)<<6,x.strstart!==0&&(M|=32),M+=31-M%31,x.status=q,Z(x,M),x.strstart!==0&&(Z(x,u.adler>>>16),Z(x,65535&u.adler)),u.adler=1}if(x.status===69)if(x.gzhead.extra){for(C=x.pending;x.gzindex<(65535&x.gzhead.extra.length)&&(x.pending!==x.pending_buf_size||(x.gzhead.hcrc&&x.pending>C&&(u.adler=g(u.adler,x.pending_buf,x.pending-C,C)),L(u),C=x.pending,x.pending!==x.pending_buf_size));)re(x,255&x.gzhead.extra[x.gzindex]),x.gzindex++;x.gzhead.hcrc&&x.pending>C&&(u.adler=g(u.adler,x.pending_buf,x.pending-C,C)),x.gzindex===x.gzhead.extra.length&&(x.gzindex=0,x.status=73)}else x.status=73;if(x.status===73)if(x.gzhead.name){C=x.pending;do{if(x.pending===x.pending_buf_size&&(x.gzhead.hcrc&&x.pending>C&&(u.adler=g(u.adler,x.pending_buf,x.pending-C,C)),L(u),C=x.pending,x.pending===x.pending_buf_size)){N=1;break}N=x.gzindex<x.gzhead.name.length?255&x.gzhead.name.charCodeAt(x.gzindex++):0,re(x,N)}while(N!==0);x.gzhead.hcrc&&x.pending>C&&(u.adler=g(u.adler,x.pending_buf,x.pending-C,C)),N===0&&(x.gzindex=0,x.status=91)}else x.status=91;if(x.status===91)if(x.gzhead.comment){C=x.pending;do{if(x.pending===x.pending_buf_size&&(x.gzhead.hcrc&&x.pending>C&&(u.adler=g(u.adler,x.pending_buf,x.pending-C,C)),L(u),C=x.pending,x.pending===x.pending_buf_size)){N=1;break}N=x.gzindex<x.gzhead.comment.length?255&x.gzhead.comment.charCodeAt(x.gzindex++):0,re(x,N)}while(N!==0);x.gzhead.hcrc&&x.pending>C&&(u.adler=g(u.adler,x.pending_buf,x.pending-C,C)),N===0&&(x.status=103)}else x.status=103;if(x.status===103&&(x.gzhead.hcrc?(x.pending+2>x.pending_buf_size&&L(u),x.pending+2<=x.pending_buf_size&&(re(x,255&u.adler),re(x,u.adler>>8&255),u.adler=0,x.status=q)):x.status=q),x.pending!==0){if(L(u),u.avail_out===0)return x.last_flush=-1,p}else if(u.avail_in===0&&$(U)<=$(P)&&U!==_)return te(u,-5);if(x.status===666&&u.avail_in!==0)return te(u,-5);if(u.avail_in!==0||x.lookahead!==0||U!==m&&x.status!==666){var X=x.strategy===2?(function(R,ae){for(var he;;){if(R.lookahead===0&&(ve(R),R.lookahead===0)){if(ae===m)return h;break}if(R.match_length=0,he=d._tr_tally(R,0,R.window[R.strstart]),R.lookahead--,R.strstart++,he&&(O(R,!1),R.strm.avail_out===0))return h}return R.insert=0,ae===_?(O(R,!0),R.strm.avail_out===0?ee:K):R.last_lit&&(O(R,!1),R.strm.avail_out===0)?h:y})(x,U):x.strategy===3?(function(R,ae){for(var he,de,pe,Q,H=R.window;;){if(R.lookahead<=se){if(ve(R),R.lookahead<=se&&ae===m)return h;if(R.lookahead===0)break}if(R.match_length=0,R.lookahead>=Y&&0<R.strstart&&(de=H[pe=R.strstart-1])===H[++pe]&&de===H[++pe]&&de===H[++pe]){Q=R.strstart+se;do;while(de===H[++pe]&&de===H[++pe]&&de===H[++pe]&&de===H[++pe]&&de===H[++pe]&&de===H[++pe]&&de===H[++pe]&&de===H[++pe]&&pe<Q);R.match_length=se-(Q-pe),R.match_length>R.lookahead&&(R.match_length=R.lookahead)}if(R.match_length>=Y?(he=d._tr_tally(R,1,R.match_length-Y),R.lookahead-=R.match_length,R.strstart+=R.match_length,R.match_length=0):(he=d._tr_tally(R,0,R.window[R.strstart]),R.lookahead--,R.strstart++),he&&(O(R,!1),R.strm.avail_out===0))return h}return R.insert=0,ae===_?(O(R,!0),R.strm.avail_out===0?ee:K):R.last_lit&&(O(R,!1),R.strm.avail_out===0)?h:y})(x,U):l[x.level].func(x,U);if(X!==ee&&X!==K||(x.status=666),X===h||X===ee)return u.avail_out===0&&(x.last_flush=-1),p;if(X===y&&(U===1?d._tr_align(x):U!==5&&(d._tr_stored_block(x,0,0,!1),U===3&&(W(x.head),x.lookahead===0&&(x.strstart=0,x.block_start=0,x.insert=0))),L(u),u.avail_out===0))return x.last_flush=-1,p}return U!==_?p:x.wrap<=0?1:(x.wrap===2?(re(x,255&u.adler),re(x,u.adler>>8&255),re(x,u.adler>>16&255),re(x,u.adler>>24&255),re(x,255&u.total_in),re(x,u.total_in>>8&255),re(x,u.total_in>>16&255),re(x,u.total_in>>24&255)):(Z(x,u.adler>>>16),Z(x,65535&u.adler)),L(u),0<x.wrap&&(x.wrap=-x.wrap),x.pending!==0?p:1)},n.deflateEnd=function(u){var U;return u&&u.state?(U=u.state.status)!==I&&U!==69&&U!==73&&U!==91&&U!==103&&U!==q&&U!==666?te(u,S):(u.state=null,U===q?te(u,-3):p):S},n.deflateSetDictionary=function(u,U){var P,x,C,N,M,X,R,ae,he=U.length;if(!u||!u.state||(N=(P=u.state).wrap)===2||N===1&&P.status!==I||P.lookahead)return S;for(N===1&&(u.adler=c(u.adler,U,he,0)),P.wrap=0,he>=P.w_size&&(N===0&&(W(P.head),P.strstart=0,P.block_start=0,P.insert=0),ae=new i.Buf8(P.w_size),i.arraySet(ae,U,he-P.w_size,P.w_size,0),U=ae,he=P.w_size),M=u.avail_in,X=u.next_in,R=u.input,u.avail_in=he,u.next_in=0,u.input=U,ve(P);P.lookahead>=Y;){for(x=P.strstart,C=P.lookahead-(Y-1);P.ins_h=(P.ins_h<<P.hash_shift^P.window[x+Y-1])&P.hash_mask,P.prev[x&P.w_mask]=P.head[P.ins_h],P.head[P.ins_h]=x,x++,--C;);P.strstart=x,P.lookahead=Y-1,ve(P)}return P.strstart+=P.lookahead,P.block_start=P.strstart,P.insert=P.lookahead,P.lookahead=0,P.match_length=P.prev_length=Y-1,P.match_available=0,u.next_in=X,u.input=R,u.avail_in=M,P.wrap=N,p},n.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(t,s,n){s.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(t,s,n){s.exports=function(l,i){var d,c,g,w,m,_,p,S,v,k,b,f,T,D,j,B,A,V,Y,se,G,I,q,h,y;d=l.state,c=l.next_in,h=l.input,g=c+(l.avail_in-5),w=l.next_out,y=l.output,m=w-(i-l.avail_out),_=w+(l.avail_out-257),p=d.dmax,S=d.wsize,v=d.whave,k=d.wnext,b=d.window,f=d.hold,T=d.bits,D=d.lencode,j=d.distcode,B=(1<<d.lenbits)-1,A=(1<<d.distbits)-1;e:do{T<15&&(f+=h[c++]<<T,T+=8,f+=h[c++]<<T,T+=8),V=D[f&B];t:for(;;){if(f>>>=Y=V>>>24,T-=Y,(Y=V>>>16&255)===0)y[w++]=65535&V;else{if(!(16&Y)){if((64&Y)==0){V=D[(65535&V)+(f&(1<<Y)-1)];continue t}if(32&Y){d.mode=12;break e}l.msg="invalid literal/length code",d.mode=30;break e}se=65535&V,(Y&=15)&&(T<Y&&(f+=h[c++]<<T,T+=8),se+=f&(1<<Y)-1,f>>>=Y,T-=Y),T<15&&(f+=h[c++]<<T,T+=8,f+=h[c++]<<T,T+=8),V=j[f&A];r:for(;;){if(f>>>=Y=V>>>24,T-=Y,!(16&(Y=V>>>16&255))){if((64&Y)==0){V=j[(65535&V)+(f&(1<<Y)-1)];continue r}l.msg="invalid distance code",d.mode=30;break e}if(G=65535&V,T<(Y&=15)&&(f+=h[c++]<<T,(T+=8)<Y&&(f+=h[c++]<<T,T+=8)),p<(G+=f&(1<<Y)-1)){l.msg="invalid distance too far back",d.mode=30;break e}if(f>>>=Y,T-=Y,(Y=w-m)<G){if(v<(Y=G-Y)&&d.sane){l.msg="invalid distance too far back",d.mode=30;break e}if(q=b,(I=0)===k){if(I+=S-Y,Y<se){for(se-=Y;y[w++]=b[I++],--Y;);I=w-G,q=y}}else if(k<Y){if(I+=S+k-Y,(Y-=k)<se){for(se-=Y;y[w++]=b[I++],--Y;);if(I=0,k<se){for(se-=Y=k;y[w++]=b[I++],--Y;);I=w-G,q=y}}}else if(I+=k-Y,Y<se){for(se-=Y;y[w++]=b[I++],--Y;);I=w-G,q=y}for(;2<se;)y[w++]=q[I++],y[w++]=q[I++],y[w++]=q[I++],se-=3;se&&(y[w++]=q[I++],1<se&&(y[w++]=q[I++]))}else{for(I=w-G;y[w++]=y[I++],y[w++]=y[I++],y[w++]=y[I++],2<(se-=3););se&&(y[w++]=y[I++],1<se&&(y[w++]=y[I++]))}break}}break}}while(c<g&&w<_);c-=se=T>>3,f&=(1<<(T-=se<<3))-1,l.next_in=c,l.next_out=w,l.avail_in=c<g?g-c+5:5-(c-g),l.avail_out=w<_?_-w+257:257-(w-_),d.hold=f,d.bits=T}},{}],49:[function(t,s,n){var l=t("../utils/common"),i=t("./adler32"),d=t("./crc32"),c=t("./inffast"),g=t("./inftrees"),w=1,m=2,_=0,p=-2,S=1,v=852,k=592;function b(I){return(I>>>24&255)+(I>>>8&65280)+((65280&I)<<8)+((255&I)<<24)}function f(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new l.Buf16(320),this.work=new l.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function T(I){var q;return I&&I.state?(q=I.state,I.total_in=I.total_out=q.total=0,I.msg="",q.wrap&&(I.adler=1&q.wrap),q.mode=S,q.last=0,q.havedict=0,q.dmax=32768,q.head=null,q.hold=0,q.bits=0,q.lencode=q.lendyn=new l.Buf32(v),q.distcode=q.distdyn=new l.Buf32(k),q.sane=1,q.back=-1,_):p}function D(I){var q;return I&&I.state?((q=I.state).wsize=0,q.whave=0,q.wnext=0,T(I)):p}function j(I,q){var h,y;return I&&I.state?(y=I.state,q<0?(h=0,q=-q):(h=1+(q>>4),q<48&&(q&=15)),q&&(q<8||15<q)?p:(y.window!==null&&y.wbits!==q&&(y.window=null),y.wrap=h,y.wbits=q,D(I))):p}function B(I,q){var h,y;return I?(y=new f,(I.state=y).window=null,(h=j(I,q))!==_&&(I.state=null),h):p}var A,V,Y=!0;function se(I){if(Y){var q;for(A=new l.Buf32(512),V=new l.Buf32(32),q=0;q<144;)I.lens[q++]=8;for(;q<256;)I.lens[q++]=9;for(;q<280;)I.lens[q++]=7;for(;q<288;)I.lens[q++]=8;for(g(w,I.lens,0,288,A,0,I.work,{bits:9}),q=0;q<32;)I.lens[q++]=5;g(m,I.lens,0,32,V,0,I.work,{bits:5}),Y=!1}I.lencode=A,I.lenbits=9,I.distcode=V,I.distbits=5}function G(I,q,h,y){var ee,K=I.state;return K.window===null&&(K.wsize=1<<K.wbits,K.wnext=0,K.whave=0,K.window=new l.Buf8(K.wsize)),y>=K.wsize?(l.arraySet(K.window,q,h-K.wsize,K.wsize,0),K.wnext=0,K.whave=K.wsize):(y<(ee=K.wsize-K.wnext)&&(ee=y),l.arraySet(K.window,q,h-y,ee,K.wnext),(y-=ee)?(l.arraySet(K.window,q,h-y,y,0),K.wnext=y,K.whave=K.wsize):(K.wnext+=ee,K.wnext===K.wsize&&(K.wnext=0),K.whave<K.wsize&&(K.whave+=ee))),0}n.inflateReset=D,n.inflateReset2=j,n.inflateResetKeep=T,n.inflateInit=function(I){return B(I,15)},n.inflateInit2=B,n.inflate=function(I,q){var h,y,ee,K,te,$,W,L,O,re,Z,ne,ve,we,ie,ke,_e,oe,ue,J,u,U,P,x,C=0,N=new l.Buf8(4),M=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!I||!I.state||!I.output||!I.input&&I.avail_in!==0)return p;(h=I.state).mode===12&&(h.mode=13),te=I.next_out,ee=I.output,W=I.avail_out,K=I.next_in,y=I.input,$=I.avail_in,L=h.hold,O=h.bits,re=$,Z=W,U=_;e:for(;;)switch(h.mode){case S:if(h.wrap===0){h.mode=13;break}for(;O<16;){if($===0)break e;$--,L+=y[K++]<<O,O+=8}if(2&h.wrap&&L===35615){N[h.check=0]=255&L,N[1]=L>>>8&255,h.check=d(h.check,N,2,0),O=L=0,h.mode=2;break}if(h.flags=0,h.head&&(h.head.done=!1),!(1&h.wrap)||(((255&L)<<8)+(L>>8))%31){I.msg="incorrect header check",h.mode=30;break}if((15&L)!=8){I.msg="unknown compression method",h.mode=30;break}if(O-=4,u=8+(15&(L>>>=4)),h.wbits===0)h.wbits=u;else if(u>h.wbits){I.msg="invalid window size",h.mode=30;break}h.dmax=1<<u,I.adler=h.check=1,h.mode=512&L?10:12,O=L=0;break;case 2:for(;O<16;){if($===0)break e;$--,L+=y[K++]<<O,O+=8}if(h.flags=L,(255&h.flags)!=8){I.msg="unknown compression method",h.mode=30;break}if(57344&h.flags){I.msg="unknown header flags set",h.mode=30;break}h.head&&(h.head.text=L>>8&1),512&h.flags&&(N[0]=255&L,N[1]=L>>>8&255,h.check=d(h.check,N,2,0)),O=L=0,h.mode=3;case 3:for(;O<32;){if($===0)break e;$--,L+=y[K++]<<O,O+=8}h.head&&(h.head.time=L),512&h.flags&&(N[0]=255&L,N[1]=L>>>8&255,N[2]=L>>>16&255,N[3]=L>>>24&255,h.check=d(h.check,N,4,0)),O=L=0,h.mode=4;case 4:for(;O<16;){if($===0)break e;$--,L+=y[K++]<<O,O+=8}h.head&&(h.head.xflags=255&L,h.head.os=L>>8),512&h.flags&&(N[0]=255&L,N[1]=L>>>8&255,h.check=d(h.check,N,2,0)),O=L=0,h.mode=5;case 5:if(1024&h.flags){for(;O<16;){if($===0)break e;$--,L+=y[K++]<<O,O+=8}h.length=L,h.head&&(h.head.extra_len=L),512&h.flags&&(N[0]=255&L,N[1]=L>>>8&255,h.check=d(h.check,N,2,0)),O=L=0}else h.head&&(h.head.extra=null);h.mode=6;case 6:if(1024&h.flags&&($<(ne=h.length)&&(ne=$),ne&&(h.head&&(u=h.head.extra_len-h.length,h.head.extra||(h.head.extra=new Array(h.head.extra_len)),l.arraySet(h.head.extra,y,K,ne,u)),512&h.flags&&(h.check=d(h.check,y,ne,K)),$-=ne,K+=ne,h.length-=ne),h.length))break e;h.length=0,h.mode=7;case 7:if(2048&h.flags){if($===0)break e;for(ne=0;u=y[K+ne++],h.head&&u&&h.length<65536&&(h.head.name+=String.fromCharCode(u)),u&&ne<$;);if(512&h.flags&&(h.check=d(h.check,y,ne,K)),$-=ne,K+=ne,u)break e}else h.head&&(h.head.name=null);h.length=0,h.mode=8;case 8:if(4096&h.flags){if($===0)break e;for(ne=0;u=y[K+ne++],h.head&&u&&h.length<65536&&(h.head.comment+=String.fromCharCode(u)),u&&ne<$;);if(512&h.flags&&(h.check=d(h.check,y,ne,K)),$-=ne,K+=ne,u)break e}else h.head&&(h.head.comment=null);h.mode=9;case 9:if(512&h.flags){for(;O<16;){if($===0)break e;$--,L+=y[K++]<<O,O+=8}if(L!==(65535&h.check)){I.msg="header crc mismatch",h.mode=30;break}O=L=0}h.head&&(h.head.hcrc=h.flags>>9&1,h.head.done=!0),I.adler=h.check=0,h.mode=12;break;case 10:for(;O<32;){if($===0)break e;$--,L+=y[K++]<<O,O+=8}I.adler=h.check=b(L),O=L=0,h.mode=11;case 11:if(h.havedict===0)return I.next_out=te,I.avail_out=W,I.next_in=K,I.avail_in=$,h.hold=L,h.bits=O,2;I.adler=h.check=1,h.mode=12;case 12:if(q===5||q===6)break e;case 13:if(h.last){L>>>=7&O,O-=7&O,h.mode=27;break}for(;O<3;){if($===0)break e;$--,L+=y[K++]<<O,O+=8}switch(h.last=1&L,O-=1,3&(L>>>=1)){case 0:h.mode=14;break;case 1:if(se(h),h.mode=20,q!==6)break;L>>>=2,O-=2;break e;case 2:h.mode=17;break;case 3:I.msg="invalid block type",h.mode=30}L>>>=2,O-=2;break;case 14:for(L>>>=7&O,O-=7&O;O<32;){if($===0)break e;$--,L+=y[K++]<<O,O+=8}if((65535&L)!=(L>>>16^65535)){I.msg="invalid stored block lengths",h.mode=30;break}if(h.length=65535&L,O=L=0,h.mode=15,q===6)break e;case 15:h.mode=16;case 16:if(ne=h.length){if($<ne&&(ne=$),W<ne&&(ne=W),ne===0)break e;l.arraySet(ee,y,K,ne,te),$-=ne,K+=ne,W-=ne,te+=ne,h.length-=ne;break}h.mode=12;break;case 17:for(;O<14;){if($===0)break e;$--,L+=y[K++]<<O,O+=8}if(h.nlen=257+(31&L),L>>>=5,O-=5,h.ndist=1+(31&L),L>>>=5,O-=5,h.ncode=4+(15&L),L>>>=4,O-=4,286<h.nlen||30<h.ndist){I.msg="too many length or distance symbols",h.mode=30;break}h.have=0,h.mode=18;case 18:for(;h.have<h.ncode;){for(;O<3;){if($===0)break e;$--,L+=y[K++]<<O,O+=8}h.lens[M[h.have++]]=7&L,L>>>=3,O-=3}for(;h.have<19;)h.lens[M[h.have++]]=0;if(h.lencode=h.lendyn,h.lenbits=7,P={bits:h.lenbits},U=g(0,h.lens,0,19,h.lencode,0,h.work,P),h.lenbits=P.bits,U){I.msg="invalid code lengths set",h.mode=30;break}h.have=0,h.mode=19;case 19:for(;h.have<h.nlen+h.ndist;){for(;ke=(C=h.lencode[L&(1<<h.lenbits)-1])>>>16&255,_e=65535&C,!((ie=C>>>24)<=O);){if($===0)break e;$--,L+=y[K++]<<O,O+=8}if(_e<16)L>>>=ie,O-=ie,h.lens[h.have++]=_e;else{if(_e===16){for(x=ie+2;O<x;){if($===0)break e;$--,L+=y[K++]<<O,O+=8}if(L>>>=ie,O-=ie,h.have===0){I.msg="invalid bit length repeat",h.mode=30;break}u=h.lens[h.have-1],ne=3+(3&L),L>>>=2,O-=2}else if(_e===17){for(x=ie+3;O<x;){if($===0)break e;$--,L+=y[K++]<<O,O+=8}O-=ie,u=0,ne=3+(7&(L>>>=ie)),L>>>=3,O-=3}else{for(x=ie+7;O<x;){if($===0)break e;$--,L+=y[K++]<<O,O+=8}O-=ie,u=0,ne=11+(127&(L>>>=ie)),L>>>=7,O-=7}if(h.have+ne>h.nlen+h.ndist){I.msg="invalid bit length repeat",h.mode=30;break}for(;ne--;)h.lens[h.have++]=u}}if(h.mode===30)break;if(h.lens[256]===0){I.msg="invalid code -- missing end-of-block",h.mode=30;break}if(h.lenbits=9,P={bits:h.lenbits},U=g(w,h.lens,0,h.nlen,h.lencode,0,h.work,P),h.lenbits=P.bits,U){I.msg="invalid literal/lengths set",h.mode=30;break}if(h.distbits=6,h.distcode=h.distdyn,P={bits:h.distbits},U=g(m,h.lens,h.nlen,h.ndist,h.distcode,0,h.work,P),h.distbits=P.bits,U){I.msg="invalid distances set",h.mode=30;break}if(h.mode=20,q===6)break e;case 20:h.mode=21;case 21:if(6<=$&&258<=W){I.next_out=te,I.avail_out=W,I.next_in=K,I.avail_in=$,h.hold=L,h.bits=O,c(I,Z),te=I.next_out,ee=I.output,W=I.avail_out,K=I.next_in,y=I.input,$=I.avail_in,L=h.hold,O=h.bits,h.mode===12&&(h.back=-1);break}for(h.back=0;ke=(C=h.lencode[L&(1<<h.lenbits)-1])>>>16&255,_e=65535&C,!((ie=C>>>24)<=O);){if($===0)break e;$--,L+=y[K++]<<O,O+=8}if(ke&&(240&ke)==0){for(oe=ie,ue=ke,J=_e;ke=(C=h.lencode[J+((L&(1<<oe+ue)-1)>>oe)])>>>16&255,_e=65535&C,!(oe+(ie=C>>>24)<=O);){if($===0)break e;$--,L+=y[K++]<<O,O+=8}L>>>=oe,O-=oe,h.back+=oe}if(L>>>=ie,O-=ie,h.back+=ie,h.length=_e,ke===0){h.mode=26;break}if(32&ke){h.back=-1,h.mode=12;break}if(64&ke){I.msg="invalid literal/length code",h.mode=30;break}h.extra=15&ke,h.mode=22;case 22:if(h.extra){for(x=h.extra;O<x;){if($===0)break e;$--,L+=y[K++]<<O,O+=8}h.length+=L&(1<<h.extra)-1,L>>>=h.extra,O-=h.extra,h.back+=h.extra}h.was=h.length,h.mode=23;case 23:for(;ke=(C=h.distcode[L&(1<<h.distbits)-1])>>>16&255,_e=65535&C,!((ie=C>>>24)<=O);){if($===0)break e;$--,L+=y[K++]<<O,O+=8}if((240&ke)==0){for(oe=ie,ue=ke,J=_e;ke=(C=h.distcode[J+((L&(1<<oe+ue)-1)>>oe)])>>>16&255,_e=65535&C,!(oe+(ie=C>>>24)<=O);){if($===0)break e;$--,L+=y[K++]<<O,O+=8}L>>>=oe,O-=oe,h.back+=oe}if(L>>>=ie,O-=ie,h.back+=ie,64&ke){I.msg="invalid distance code",h.mode=30;break}h.offset=_e,h.extra=15&ke,h.mode=24;case 24:if(h.extra){for(x=h.extra;O<x;){if($===0)break e;$--,L+=y[K++]<<O,O+=8}h.offset+=L&(1<<h.extra)-1,L>>>=h.extra,O-=h.extra,h.back+=h.extra}if(h.offset>h.dmax){I.msg="invalid distance too far back",h.mode=30;break}h.mode=25;case 25:if(W===0)break e;if(ne=Z-W,h.offset>ne){if((ne=h.offset-ne)>h.whave&&h.sane){I.msg="invalid distance too far back",h.mode=30;break}ve=ne>h.wnext?(ne-=h.wnext,h.wsize-ne):h.wnext-ne,ne>h.length&&(ne=h.length),we=h.window}else we=ee,ve=te-h.offset,ne=h.length;for(W<ne&&(ne=W),W-=ne,h.length-=ne;ee[te++]=we[ve++],--ne;);h.length===0&&(h.mode=21);break;case 26:if(W===0)break e;ee[te++]=h.length,W--,h.mode=21;break;case 27:if(h.wrap){for(;O<32;){if($===0)break e;$--,L|=y[K++]<<O,O+=8}if(Z-=W,I.total_out+=Z,h.total+=Z,Z&&(I.adler=h.check=h.flags?d(h.check,ee,Z,te-Z):i(h.check,ee,Z,te-Z)),Z=W,(h.flags?L:b(L))!==h.check){I.msg="incorrect data check",h.mode=30;break}O=L=0}h.mode=28;case 28:if(h.wrap&&h.flags){for(;O<32;){if($===0)break e;$--,L+=y[K++]<<O,O+=8}if(L!==(4294967295&h.total)){I.msg="incorrect length check",h.mode=30;break}O=L=0}h.mode=29;case 29:U=1;break e;case 30:U=-3;break e;case 31:return-4;case 32:default:return p}return I.next_out=te,I.avail_out=W,I.next_in=K,I.avail_in=$,h.hold=L,h.bits=O,(h.wsize||Z!==I.avail_out&&h.mode<30&&(h.mode<27||q!==4))&&G(I,I.output,I.next_out,Z-I.avail_out)?(h.mode=31,-4):(re-=I.avail_in,Z-=I.avail_out,I.total_in+=re,I.total_out+=Z,h.total+=Z,h.wrap&&Z&&(I.adler=h.check=h.flags?d(h.check,ee,Z,I.next_out-Z):i(h.check,ee,Z,I.next_out-Z)),I.data_type=h.bits+(h.last?64:0)+(h.mode===12?128:0)+(h.mode===20||h.mode===15?256:0),(re==0&&Z===0||q===4)&&U===_&&(U=-5),U)},n.inflateEnd=function(I){if(!I||!I.state)return p;var q=I.state;return q.window&&(q.window=null),I.state=null,_},n.inflateGetHeader=function(I,q){var h;return I&&I.state?(2&(h=I.state).wrap)==0?p:((h.head=q).done=!1,_):p},n.inflateSetDictionary=function(I,q){var h,y=q.length;return I&&I.state?(h=I.state).wrap!==0&&h.mode!==11?p:h.mode===11&&i(1,q,y,0)!==h.check?-3:G(I,q,y,y)?(h.mode=31,-4):(h.havedict=1,_):p},n.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(t,s,n){var l=t("../utils/common"),i=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],d=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],c=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],g=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];s.exports=function(w,m,_,p,S,v,k,b){var f,T,D,j,B,A,V,Y,se,G=b.bits,I=0,q=0,h=0,y=0,ee=0,K=0,te=0,$=0,W=0,L=0,O=null,re=0,Z=new l.Buf16(16),ne=new l.Buf16(16),ve=null,we=0;for(I=0;I<=15;I++)Z[I]=0;for(q=0;q<p;q++)Z[m[_+q]]++;for(ee=G,y=15;1<=y&&Z[y]===0;y--);if(y<ee&&(ee=y),y===0)return S[v++]=20971520,S[v++]=20971520,b.bits=1,0;for(h=1;h<y&&Z[h]===0;h++);for(ee<h&&(ee=h),I=$=1;I<=15;I++)if($<<=1,($-=Z[I])<0)return-1;if(0<$&&(w===0||y!==1))return-1;for(ne[1]=0,I=1;I<15;I++)ne[I+1]=ne[I]+Z[I];for(q=0;q<p;q++)m[_+q]!==0&&(k[ne[m[_+q]]++]=q);if(A=w===0?(O=ve=k,19):w===1?(O=i,re-=257,ve=d,we-=257,256):(O=c,ve=g,-1),I=h,B=v,te=q=L=0,D=-1,j=(W=1<<(K=ee))-1,w===1&&852<W||w===2&&592<W)return 1;for(;;){for(V=I-te,se=k[q]<A?(Y=0,k[q]):k[q]>A?(Y=ve[we+k[q]],O[re+k[q]]):(Y=96,0),f=1<<I-te,h=T=1<<K;S[B+(L>>te)+(T-=f)]=V<<24|Y<<16|se|0,T!==0;);for(f=1<<I-1;L&f;)f>>=1;if(f!==0?(L&=f-1,L+=f):L=0,q++,--Z[I]==0){if(I===y)break;I=m[_+k[q]]}if(ee<I&&(L&j)!==D){for(te===0&&(te=ee),B+=h,$=1<<(K=I-te);K+te<y&&!(($-=Z[K+te])<=0);)K++,$<<=1;if(W+=1<<K,w===1&&852<W||w===2&&592<W)return 1;S[D=L&j]=ee<<24|K<<16|B-v|0}}return L!==0&&(S[B+L]=I-te<<24|64<<16|0),b.bits=ee,0}},{"../utils/common":41}],51:[function(t,s,n){s.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(t,s,n){var l=t("../utils/common"),i=0,d=1;function c(C){for(var N=C.length;0<=--N;)C[N]=0}var g=0,w=29,m=256,_=m+1+w,p=30,S=19,v=2*_+1,k=15,b=16,f=7,T=256,D=16,j=17,B=18,A=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],V=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],Y=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],se=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],G=new Array(2*(_+2));c(G);var I=new Array(2*p);c(I);var q=new Array(512);c(q);var h=new Array(256);c(h);var y=new Array(w);c(y);var ee,K,te,$=new Array(p);function W(C,N,M,X,R){this.static_tree=C,this.extra_bits=N,this.extra_base=M,this.elems=X,this.max_length=R,this.has_stree=C&&C.length}function L(C,N){this.dyn_tree=C,this.max_code=0,this.stat_desc=N}function O(C){return C<256?q[C]:q[256+(C>>>7)]}function re(C,N){C.pending_buf[C.pending++]=255&N,C.pending_buf[C.pending++]=N>>>8&255}function Z(C,N,M){C.bi_valid>b-M?(C.bi_buf|=N<<C.bi_valid&65535,re(C,C.bi_buf),C.bi_buf=N>>b-C.bi_valid,C.bi_valid+=M-b):(C.bi_buf|=N<<C.bi_valid&65535,C.bi_valid+=M)}function ne(C,N,M){Z(C,M[2*N],M[2*N+1])}function ve(C,N){for(var M=0;M|=1&C,C>>>=1,M<<=1,0<--N;);return M>>>1}function we(C,N,M){var X,R,ae=new Array(k+1),he=0;for(X=1;X<=k;X++)ae[X]=he=he+M[X-1]<<1;for(R=0;R<=N;R++){var de=C[2*R+1];de!==0&&(C[2*R]=ve(ae[de]++,de))}}function ie(C){var N;for(N=0;N<_;N++)C.dyn_ltree[2*N]=0;for(N=0;N<p;N++)C.dyn_dtree[2*N]=0;for(N=0;N<S;N++)C.bl_tree[2*N]=0;C.dyn_ltree[2*T]=1,C.opt_len=C.static_len=0,C.last_lit=C.matches=0}function ke(C){8<C.bi_valid?re(C,C.bi_buf):0<C.bi_valid&&(C.pending_buf[C.pending++]=C.bi_buf),C.bi_buf=0,C.bi_valid=0}function _e(C,N,M,X){var R=2*N,ae=2*M;return C[R]<C[ae]||C[R]===C[ae]&&X[N]<=X[M]}function oe(C,N,M){for(var X=C.heap[M],R=M<<1;R<=C.heap_len&&(R<C.heap_len&&_e(N,C.heap[R+1],C.heap[R],C.depth)&&R++,!_e(N,X,C.heap[R],C.depth));)C.heap[M]=C.heap[R],M=R,R<<=1;C.heap[M]=X}function ue(C,N,M){var X,R,ae,he,de=0;if(C.last_lit!==0)for(;X=C.pending_buf[C.d_buf+2*de]<<8|C.pending_buf[C.d_buf+2*de+1],R=C.pending_buf[C.l_buf+de],de++,X===0?ne(C,R,N):(ne(C,(ae=h[R])+m+1,N),(he=A[ae])!==0&&Z(C,R-=y[ae],he),ne(C,ae=O(--X),M),(he=V[ae])!==0&&Z(C,X-=$[ae],he)),de<C.last_lit;);ne(C,T,N)}function J(C,N){var M,X,R,ae=N.dyn_tree,he=N.stat_desc.static_tree,de=N.stat_desc.has_stree,pe=N.stat_desc.elems,Q=-1;for(C.heap_len=0,C.heap_max=v,M=0;M<pe;M++)ae[2*M]!==0?(C.heap[++C.heap_len]=Q=M,C.depth[M]=0):ae[2*M+1]=0;for(;C.heap_len<2;)ae[2*(R=C.heap[++C.heap_len]=Q<2?++Q:0)]=1,C.depth[R]=0,C.opt_len--,de&&(C.static_len-=he[2*R+1]);for(N.max_code=Q,M=C.heap_len>>1;1<=M;M--)oe(C,ae,M);for(R=pe;M=C.heap[1],C.heap[1]=C.heap[C.heap_len--],oe(C,ae,1),X=C.heap[1],C.heap[--C.heap_max]=M,C.heap[--C.heap_max]=X,ae[2*R]=ae[2*M]+ae[2*X],C.depth[R]=(C.depth[M]>=C.depth[X]?C.depth[M]:C.depth[X])+1,ae[2*M+1]=ae[2*X+1]=R,C.heap[1]=R++,oe(C,ae,1),2<=C.heap_len;);C.heap[--C.heap_max]=C.heap[1],(function(H,me){var Oe,Be,Ue,Ie,Fe,st,Ve=me.dyn_tree,je=me.max_code,Ze=me.stat_desc.static_tree,lt=me.stat_desc.has_stree,nt=me.stat_desc.extra_bits,Tt=me.stat_desc.extra_base,ht=me.stat_desc.max_length,pt=0;for(Ie=0;Ie<=k;Ie++)H.bl_count[Ie]=0;for(Ve[2*H.heap[H.heap_max]+1]=0,Oe=H.heap_max+1;Oe<v;Oe++)ht<(Ie=Ve[2*Ve[2*(Be=H.heap[Oe])+1]+1]+1)&&(Ie=ht,pt++),Ve[2*Be+1]=Ie,je<Be||(H.bl_count[Ie]++,Fe=0,Tt<=Be&&(Fe=nt[Be-Tt]),st=Ve[2*Be],H.opt_len+=st*(Ie+Fe),lt&&(H.static_len+=st*(Ze[2*Be+1]+Fe)));if(pt!==0){do{for(Ie=ht-1;H.bl_count[Ie]===0;)Ie--;H.bl_count[Ie]--,H.bl_count[Ie+1]+=2,H.bl_count[ht]--,pt-=2}while(0<pt);for(Ie=ht;Ie!==0;Ie--)for(Be=H.bl_count[Ie];Be!==0;)je<(Ue=H.heap[--Oe])||(Ve[2*Ue+1]!==Ie&&(H.opt_len+=(Ie-Ve[2*Ue+1])*Ve[2*Ue],Ve[2*Ue+1]=Ie),Be--)}})(C,N),we(ae,Q,C.bl_count)}function u(C,N,M){var X,R,ae=-1,he=N[1],de=0,pe=7,Q=4;for(he===0&&(pe=138,Q=3),N[2*(M+1)+1]=65535,X=0;X<=M;X++)R=he,he=N[2*(X+1)+1],++de<pe&&R===he||(de<Q?C.bl_tree[2*R]+=de:R!==0?(R!==ae&&C.bl_tree[2*R]++,C.bl_tree[2*D]++):de<=10?C.bl_tree[2*j]++:C.bl_tree[2*B]++,ae=R,Q=(de=0)===he?(pe=138,3):R===he?(pe=6,3):(pe=7,4))}function U(C,N,M){var X,R,ae=-1,he=N[1],de=0,pe=7,Q=4;for(he===0&&(pe=138,Q=3),X=0;X<=M;X++)if(R=he,he=N[2*(X+1)+1],!(++de<pe&&R===he)){if(de<Q)for(;ne(C,R,C.bl_tree),--de!=0;);else R!==0?(R!==ae&&(ne(C,R,C.bl_tree),de--),ne(C,D,C.bl_tree),Z(C,de-3,2)):de<=10?(ne(C,j,C.bl_tree),Z(C,de-3,3)):(ne(C,B,C.bl_tree),Z(C,de-11,7));ae=R,Q=(de=0)===he?(pe=138,3):R===he?(pe=6,3):(pe=7,4)}}c($);var P=!1;function x(C,N,M,X){Z(C,(g<<1)+(X?1:0),3),(function(R,ae,he,de){ke(R),re(R,he),re(R,~he),l.arraySet(R.pending_buf,R.window,ae,he,R.pending),R.pending+=he})(C,N,M)}n._tr_init=function(C){P||((function(){var N,M,X,R,ae,he=new Array(k+1);for(R=X=0;R<w-1;R++)for(y[R]=X,N=0;N<1<<A[R];N++)h[X++]=R;for(h[X-1]=R,R=ae=0;R<16;R++)for($[R]=ae,N=0;N<1<<V[R];N++)q[ae++]=R;for(ae>>=7;R<p;R++)for($[R]=ae<<7,N=0;N<1<<V[R]-7;N++)q[256+ae++]=R;for(M=0;M<=k;M++)he[M]=0;for(N=0;N<=143;)G[2*N+1]=8,N++,he[8]++;for(;N<=255;)G[2*N+1]=9,N++,he[9]++;for(;N<=279;)G[2*N+1]=7,N++,he[7]++;for(;N<=287;)G[2*N+1]=8,N++,he[8]++;for(we(G,_+1,he),N=0;N<p;N++)I[2*N+1]=5,I[2*N]=ve(N,5);ee=new W(G,A,m+1,_,k),K=new W(I,V,0,p,k),te=new W(new Array(0),Y,0,S,f)})(),P=!0),C.l_desc=new L(C.dyn_ltree,ee),C.d_desc=new L(C.dyn_dtree,K),C.bl_desc=new L(C.bl_tree,te),C.bi_buf=0,C.bi_valid=0,ie(C)},n._tr_stored_block=x,n._tr_flush_block=function(C,N,M,X){var R,ae,he=0;0<C.level?(C.strm.data_type===2&&(C.strm.data_type=(function(de){var pe,Q=4093624447;for(pe=0;pe<=31;pe++,Q>>>=1)if(1&Q&&de.dyn_ltree[2*pe]!==0)return i;if(de.dyn_ltree[18]!==0||de.dyn_ltree[20]!==0||de.dyn_ltree[26]!==0)return d;for(pe=32;pe<m;pe++)if(de.dyn_ltree[2*pe]!==0)return d;return i})(C)),J(C,C.l_desc),J(C,C.d_desc),he=(function(de){var pe;for(u(de,de.dyn_ltree,de.l_desc.max_code),u(de,de.dyn_dtree,de.d_desc.max_code),J(de,de.bl_desc),pe=S-1;3<=pe&&de.bl_tree[2*se[pe]+1]===0;pe--);return de.opt_len+=3*(pe+1)+5+5+4,pe})(C),R=C.opt_len+3+7>>>3,(ae=C.static_len+3+7>>>3)<=R&&(R=ae)):R=ae=M+5,M+4<=R&&N!==-1?x(C,N,M,X):C.strategy===4||ae===R?(Z(C,2+(X?1:0),3),ue(C,G,I)):(Z(C,4+(X?1:0),3),(function(de,pe,Q,H){var me;for(Z(de,pe-257,5),Z(de,Q-1,5),Z(de,H-4,4),me=0;me<H;me++)Z(de,de.bl_tree[2*se[me]+1],3);U(de,de.dyn_ltree,pe-1),U(de,de.dyn_dtree,Q-1)})(C,C.l_desc.max_code+1,C.d_desc.max_code+1,he+1),ue(C,C.dyn_ltree,C.dyn_dtree)),ie(C),X&&ke(C)},n._tr_tally=function(C,N,M){return C.pending_buf[C.d_buf+2*C.last_lit]=N>>>8&255,C.pending_buf[C.d_buf+2*C.last_lit+1]=255&N,C.pending_buf[C.l_buf+C.last_lit]=255&M,C.last_lit++,N===0?C.dyn_ltree[2*M]++:(C.matches++,N--,C.dyn_ltree[2*(h[M]+m+1)]++,C.dyn_dtree[2*O(N)]++),C.last_lit===C.lit_bufsize-1},n._tr_align=function(C){Z(C,2,3),ne(C,T,G),(function(N){N.bi_valid===16?(re(N,N.bi_buf),N.bi_buf=0,N.bi_valid=0):8<=N.bi_valid&&(N.pending_buf[N.pending++]=255&N.bi_buf,N.bi_buf>>=8,N.bi_valid-=8)})(C)}},{"../utils/common":41}],53:[function(t,s,n){s.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(t,s,n){(function(l){(function(i,d){if(!i.setImmediate){var c,g,w,m,_=1,p={},S=!1,v=i.document,k=Object.getPrototypeOf&&Object.getPrototypeOf(i);k=k&&k.setTimeout?k:i,c={}.toString.call(i.process)==="[object process]"?function(D){process.nextTick(function(){f(D)})}:(function(){if(i.postMessage&&!i.importScripts){var D=!0,j=i.onmessage;return i.onmessage=function(){D=!1},i.postMessage("","*"),i.onmessage=j,D}})()?(m="setImmediate$"+Math.random()+"$",i.addEventListener?i.addEventListener("message",T,!1):i.attachEvent("onmessage",T),function(D){i.postMessage(m+D,"*")}):i.MessageChannel?((w=new MessageChannel).port1.onmessage=function(D){f(D.data)},function(D){w.port2.postMessage(D)}):v&&"onreadystatechange"in v.createElement("script")?(g=v.documentElement,function(D){var j=v.createElement("script");j.onreadystatechange=function(){f(D),j.onreadystatechange=null,g.removeChild(j),j=null},g.appendChild(j)}):function(D){setTimeout(f,0,D)},k.setImmediate=function(D){typeof D!="function"&&(D=new Function(""+D));for(var j=new Array(arguments.length-1),B=0;B<j.length;B++)j[B]=arguments[B+1];var A={callback:D,args:j};return p[_]=A,c(_),_++},k.clearImmediate=b}function b(D){delete p[D]}function f(D){if(S)setTimeout(f,0,D);else{var j=p[D];if(j){S=!0;try{(function(B){var A=B.callback,V=B.args;switch(V.length){case 0:A();break;case 1:A(V[0]);break;case 2:A(V[0],V[1]);break;case 3:A(V[0],V[1],V[2]);break;default:A.apply(d,V)}})(j)}finally{b(D),S=!1}}}}function T(D){D.source===i&&typeof D.data=="string"&&D.data.indexOf(m)===0&&f(+D.data.slice(m.length))}})(typeof self>"u"?l===void 0?this:l:self)}).call(this,typeof dt<"u"?dt:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[10])(10)})})(lo)),lo.exports}var Ec=Cc();const Tc=_t(Ec),qe={printMode:"print-designer-print-mode",preferredPrintMode:"print-designer-preferred-print-mode",silentPrint:"print-designer-silent-print",exportImageMerged:"print-designer-export-image-merged",localSettings:"print-designer-local-settings",remoteSettings:"print-designer-remote-settings",localPrintOptions:"print-designer-local-print-options",remotePrintOptions:"print-designer-remote-print-options",remoteAuthToken:"print-designer-remote-auth-token",remoteSelectedClientId:"print-designer-remote-selected-client-id"},$c={wsAddress:"ws://localhost:1122/ws",secretKey:""},Ic={wsAddress:"ws://localhost:8080/ws/request",apiBaseUrl:"http://localhost:8080/api/login",username:"",password:""},ja={printer:"",jobName:"",copies:1,intervalMs:0,pageRange:"",pageSet:"",scale:"fit",orientation:"portrait",colorMode:"color",sidesMode:"simplex",paperSize:"",trayBin:""},jt=(r,e)=>{const t=localStorage.getItem(r);if(!t)return e;try{return{...e,...JSON.parse(t)}}catch{return e}},Ht=(r,e)=>{localStorage.setItem(r,JSON.stringify(e))},Ac=r=>r.trim(),Ha=r=>{const e=Ac(r);return e?/^wss?:\/\//i.test(e)?e:`ws://${e.replace(/^\/+/,"")}`:"ws://"},Ua=(r,e,t)=>{if(!t)return r;try{const s=new URL(r);return s.searchParams.set(e,t),s.toString()}catch{const s=r.includes("?")?"&":"?";return`${r}${s}${encodeURIComponent(e)}=${encodeURIComponent(t)}`}};let io=null;const zc=()=>{const r=localStorage.getItem(qe.preferredPrintMode),e=le(r||localStorage.getItem(qe.printMode)||"browser"),t=le(localStorage.getItem(qe.silentPrint)==="true"),s=le(localStorage.getItem(qe.exportImageMerged)!=="false"),n=yt(jt(qe.localSettings,$c));if(!n.wsAddress){const M=n;if(M.host||M.port||M.path){const X=M.host||"localhost",R=M.port?`:${M.port}`:"",ae=M.path||"/ws",he=M.protocol||"ws";n.wsAddress=`${he}://${X}${R}${ae}`}}const l=yt(jt(qe.remoteSettings,Ic));if(!l.wsAddress){const M=l;if(M.host||M.wsPort||M.wsPath){const X=M.host||"localhost",R=M.wsPort?`:${M.wsPort}`:"",ae=M.wsPath||"/ws/request";l.wsAddress=`${X}${R}${ae}`}}const i=le("disconnected"),d=le("disconnected"),c=le(""),g=le(""),w=yt(jt(qe.localPrintOptions,ja)),m=yt(jt(qe.remotePrintOptions,ja)),_=le(localStorage.getItem(qe.remoteAuthToken)||""),p=le(localStorage.getItem(qe.remoteSelectedClientId)||""),S=le([]),v=le([]),k=le([]),b=yt({}),f=le(null),T=le(null),D=[],j=[];let B=null,A=null;const V=le(0),Y=le(0),se=le(null),G=le(null),I=le(!1),q=le(!1),h=3e3,y=10,ee=fe(()=>{const M=Ha(n.wsAddress);return Ua(M,"key",n.secretKey.trim())}),K=fe(()=>{const M=Ha(l.wsAddress);return Ua(M,"token",_.value.trim())});Ae(e,M=>{if(localStorage.setItem(qe.printMode,M),M!=="browser"){localStorage.setItem(qe.preferredPrintMode,M);return}localStorage.removeItem(qe.preferredPrintMode)}),Ae(t,M=>{localStorage.setItem(qe.silentPrint,String(M))}),Ae(s,M=>{localStorage.setItem(qe.exportImageMerged,String(M))}),Ae(n,M=>{Ht(qe.localSettings,M),i.value="disconnected",c.value=""},{deep:!0}),Ae(l,M=>{Ht(qe.remoteSettings,M),d.value="disconnected",g.value=""},{deep:!0}),Ae(w,M=>{Ht(qe.localPrintOptions,M)},{deep:!0}),Ae(m,M=>{Ht(qe.remotePrintOptions,M)},{deep:!0}),Ae(_,M=>{localStorage.setItem(qe.remoteAuthToken,M)}),Ae(p,M=>{localStorage.setItem(qe.remoteSelectedClientId,M)});const te=()=>{const M=localStorage.getItem(qe.preferredPrintMode);!M||M==="browser"||e.value==="browser"&&(M==="local"&&i.value==="connected"&&(e.value="local"),M==="remote"&&d.value==="connected"&&(e.value="remote"))},$=()=>{const M=i.value==="connected",X=d.value==="connected";if(e.value==="local"&&!M){e.value="browser";return}if(e.value==="remote"&&!X){e.value="browser";return}!M&&!X&&(e.value="browser")};Ae([i,d],()=>{$(),te()},{immediate:!0});const W=(M,X)=>{M.slice().forEach(R=>{R.match(X)&&(window.clearTimeout(R.timeoutId),M.splice(M.indexOf(R),1),R.resolve(X))})},L=(M,X)=>{M.slice().forEach(R=>{window.clearTimeout(R.timeoutId),M.splice(M.indexOf(R),1),R.reject(X)})},O=()=>{se.value&&(window.clearTimeout(se.value),se.value=null),V.value=0},re=()=>{G.value&&(window.clearTimeout(G.value),G.value=null),Y.value=0},Z=()=>{I.value=!0,O(),f.value&&f.value.close(),f.value=null,i.value="disconnected",c.value=""},ne=()=>{q.value=!0,re(),T.value&&T.value.close(),T.value=null,d.value="disconnected",g.value=""},ve=()=>{if(!I.value&&!se.value){if(V.value>=y){i.value="error",c.value="Local connection failed",V.value=0;return}V.value+=1,i.value="connecting",se.value=window.setTimeout(()=>{se.value=null,oe()},h)}},we=()=>{if(!q.value&&!G.value){if(Y.value>=y){d.value="error",g.value="Remote connection failed",Y.value=0;return}Y.value+=1,d.value="connecting",G.value=window.setTimeout(()=>{G.value=null,J()},h)}},ie=(M,X,R,ae,he=5e3)=>new Promise((de,pe)=>{const Q=M.value;if(!Q||Q.readyState!==WebSocket.OPEN){pe(new Error("WebSocket not connected"));return}const H=window.setTimeout(()=>{const me=X.findIndex(Oe=>Oe.resolve===de);me>=0&&X.splice(me,1),pe(new Error("WebSocket timeout"))},he);X.push({match:ae,resolve:de,reject:pe,timeoutId:H}),Q.send(JSON.stringify(R))}),ke=M=>{M.onmessage=X=>{try{const R=JSON.parse(X.data);(R==null?void 0:R.type)==="printer_list"&&(S.value=Array.isArray(R.data)?R.data:[]),(R==null?void 0:R.type)==="printer_caps"&&R.printer&&(b[R.printer]=(R==null?void 0:R.data)||{}),W(D,R)}catch(R){L(D,R)}},M.onclose=()=>{f.value=null,i.value!=="error"&&(i.value="disconnected"),L(D,new Error("WebSocket closed")),ve()},M.onerror=()=>{i.value="error",c.value="Local connection failed",L(D,new Error("WebSocket error")),ve()}},_e=M=>{M.onmessage=X=>{try{const R=JSON.parse(X.data);if((R==null?void 0:R.cmd)==="clients_list")if(k.value=Array.isArray(R.clients)?R.clients:[],k.value.length>0){if(!k.value.some(he=>he.client_id===p.value)){const he=k.value.find(de=>de.online)||k.value[0];p.value=(he==null?void 0:he.client_id)||""}}else p.value="";(R==null?void 0:R.cmd)==="printers_list"&&(v.value=Array.isArray(R.printers)?R.printers:[]),W(j,R)}catch(R){L(j,R)}},M.onclose=()=>{T.value=null,d.value!=="error"&&(d.value="disconnected"),L(j,new Error("WebSocket closed")),we()},M.onerror=()=>{d.value="error",g.value="Remote connection failed",L(j,new Error("WebSocket error")),we()}},oe=async()=>{if(B)return B;if(f.value&&f.value.readyState===WebSocket.OPEN)return i.value="connected",Promise.resolve();I.value=!1,i.value="connecting",c.value="";const M=new WebSocket(ee.value);return f.value=M,ke(M),B=new Promise((X,R)=>{M.addEventListener("open",()=>{i.value="connected",O(),B=null,M.send(JSON.stringify({type:"get_printers"})),X()}),M.addEventListener("error",()=>{i.value="error",c.value="Local connection failed",B=null,ve(),R(new Error("WebSocket error"))})}),B},ue=()=>{I.value=!0,O(),f.value&&f.value.close(),f.value=null,i.value="disconnected",c.value=""},J=async()=>A||(T.value&&T.value.readyState===WebSocket.OPEN?(d.value="connected",Promise.resolve()):(q.value=!1,d.value="connecting",g.value="",A=(async()=>{try{if(!l.apiBaseUrl||!l.username||!l.password){d.value="error",g.value="Missing remote connection fields";return}const M=await fetch(l.apiBaseUrl,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:l.username,password:l.password})});if(!M.ok){const ae=await M.text();throw new Error(ae||`HTTP ${M.status}`)}const X=await M.json();if(!(X!=null&&X.token))throw new Error("Missing auth token");_.value=X.token;const R=new WebSocket(K.value);T.value=R,_e(R),await new Promise((ae,he)=>{R.addEventListener("open",()=>{d.value="connected",re(),R.send(JSON.stringify({cmd:"get_clients"})),ae()}),R.addEventListener("error",()=>{d.value="error",g.value="Remote connection failed",we(),he(new Error("WebSocket error"))})})}catch(M){d.value="error",g.value=M.message||"Remote connection failed",we()}finally{A=null}})(),A)),u=()=>{q.value=!0,re(),T.value&&T.value.close(),T.value=null,d.value="disconnected",g.value=""},U=async()=>{await oe();const M=await ie(f,D,{type:"get_printers"},X=>(X==null?void 0:X.type)==="printer_list");return S.value=Array.isArray(M.data)?M.data:[],S.value},P=async M=>{if(!M)return;if(b[M])return b[M];await oe();const X=await ie(f,D,{type:"get_printer_caps",printer:M},R=>(R==null?void 0:R.type)==="printer_caps");return b[M]=(X==null?void 0:X.data)||{},b[M]},x=async()=>{await J();const M=await ie(T,j,{cmd:"get_clients"},X=>(X==null?void 0:X.cmd)==="clients_list");if(k.value=Array.isArray(M.clients)?M.clients:[],k.value.length>0){if(!k.value.some(R=>R.client_id===p.value)){const R=k.value.find(ae=>ae.online)||k.value[0];p.value=(R==null?void 0:R.client_id)||""}}else p.value="";return k.value},C=async M=>{const X=M||p.value;if(!X)return v.value=[],v.value;await J();const R=await ie(T,j,{cmd:"get_printers",client_id:X},ae=>(ae==null?void 0:ae.cmd)==="printers_list");return v.value=Array.isArray(R.printers)?R.printers:[],v.value};return(()=>{const M=!!n.wsAddress,X=!!(l.apiBaseUrl&&l.username&&l.password);M&&oe(),X&&J()})(),{printMode:e,silentPrint:t,exportImageMerged:s,localSettings:n,remoteSettings:l,localStatus:i,remoteStatus:d,localStatusMessage:c,remoteStatusMessage:g,localRetryCount:V,remoteRetryCount:Y,localPrintOptions:w,remotePrintOptions:m,localWsUrl:ee,remoteWsUrl:K,remoteAuthToken:_,localPrinters:S,remotePrinters:v,remoteClients:k,remoteSelectedClientId:p,localPrinterCaps:b,fetchLocalPrinters:U,fetchRemoteClients:x,fetchRemotePrinters:C,fetchLocalPrinterCaps:P,cancelLocalRetry:Z,cancelRemoteRetry:ne,connectLocal:oe,disconnectLocal:ue,connectRemote:J,disconnectRemote:u}},er=()=>(io||(io=zc()),io),Fl=()=>{const r=Re(),{printMode:e,localSettings:t,remoteSettings:s,localStatus:n,remoteStatus:l,localPrintOptions:i,remotePrintOptions:d,localWsUrl:c,remoteWsUrl:g,remoteSelectedClientId:w,exportImageMerged:m}=er(),_=oe=>{const ue=Ee(oe),J=r.headerHeight>0&&r.showHeaderLine,u=r.footerHeight>0&&r.showFooterLine;if(!J&&!u)return ue;const U=ue[0],P=r.canvasSize.height,x=J?U.elements.filter(M=>M.y+M.height<=r.headerHeight):[],C=u?U.elements.filter(M=>M.y>=P-r.footerHeight):[],N=Ee(ue);for(let M=0;M<N.length;M++){if(M===0)continue;const X=N[M];for(const R of x)X.elements.push({...Ee(R),id:He()});for(const R of C)X.elements.push({...Ee(R),id:He()})}return N},p=async(oe={})=>{const ue=oe.mutateStore!==!1,J=oe.setExporting!==!1,u=ue?r.selectedElementId:null,U=ue?r.showGrid:!1,P=ue?r.zoom:1,x=ue?Ee(r.pages):null,C=ue?r.showHeaderLine:!1,N=ue?r.showFooterLine:!1,M=ue?r.showCornerMarkers:!1,X=J?!!r.isExporting:!1,R=document.documentElement.style.overflowX,ae=document.documentElement.style.overflowY,he=document.body.style.overflowX,de=document.body.style.overflowY;return ue&&(r.selectElement(null),r.setShowGrid(!1),r.setZoom(1),r.pages=_(r.pages),r.setShowHeaderLine(!1),r.setShowFooterLine(!1),r.showCornerMarkers=!1,J&&(r.setIsExporting(!0),document.body.classList.add("exporting"))),document.documentElement.style.overflowX="hidden",document.documentElement.style.overflowY="hidden",document.body.style.overflowX="hidden",document.body.style.overflowY="hidden",!ue&&J&&(r.setIsExporting(!0),document.body.classList.add("exporting")),await Xe(),await new Promise(pe=>setTimeout(pe,500)),()=>{J&&(document.body.classList.remove("exporting"),r.setIsExporting(X)),document.documentElement.style.overflowX=R,document.documentElement.style.overflowY=ae,document.body.style.overflowX=he,document.body.style.overflowY=de,ue&&(r.setShowGrid(U),r.selectElement(u),r.setZoom(P),x&&(r.pages=x),r.setShowHeaderLine(C),r.setShowFooterLine(N),r.showCornerMarkers=M)}},S=oe=>{oe.classList.remove("group","cursor-move","select-none","ring-2","ring-blue-500","ring-red-500","hover:outline","hover:outline-1","hover:outline-blue-300");const ue=[];oe.classList.forEach(u=>{(u.startsWith("hover:")||u.startsWith("focus:")||u.startsWith("active:"))&&ue.push(u)}),ue.forEach(u=>oe.classList.remove(u)),(oe.style.borderColor==="transparent"||oe.style.border.includes("transparent")||oe.style.borderStyle==="dashed"&&(oe.style.borderColor==="transparent"||!oe.style.borderColor&&oe.style.border.includes("transparent")))&&(oe.style.border="none",oe.style.outline="none",oe.style.boxShadow="none"),Array.from(oe.children).forEach(u=>S(u))},v={enabled:!1,text:"",angle:-30,color:"#000000",opacity:.1,size:24,density:160},k=()=>({pages:_(r.pages),canvasSize:{...r.canvasSize},canvasBackground:r.canvasBackground,headerHeight:r.headerHeight,footerHeight:r.footerHeight,showHeaderLine:r.showHeaderLine,showFooterLine:r.showFooterLine,watermark:Ee(r.watermark||v),unit:r.unit||"mm",testData:Ee(r.testData||{})}),b=(oe,ue,J=1e4)=>new Promise((u,U)=>{const P=window.location.origin,x=window.setTimeout(()=>{window.removeEventListener("message",C),U(new Error(`Print renderer timeout: ${ue}`))},J),C=N=>{if(N.origin!==P)return;const M=N.data;!M||M.type!==ue||M.token!==oe||(window.clearTimeout(x),window.removeEventListener("message",C),u(M))};window.addEventListener("message",C)}),f=async()=>{var u;const oe=He(),ue=document.createElement("iframe");ue.setAttribute("data-print-renderer","true"),ue.style.cssText="position:fixed;left:0;top:0;width:0;height:0;border:0;visibility:hidden;",ue.src=`${window.location.origin}${window.location.pathname}?print=1&printToken=${encodeURIComponent(oe)}`,document.body.appendChild(ue);const J=()=>{ue.parentNode&&ue.parentNode.removeChild(ue)};try{await b(oe,"print-renderer-ready");const U=k();(u=ue.contentWindow)==null||u.postMessage({type:"print-renderer-payload",token:oe,payload:U},window.location.origin),await b(oe,"print-renderer-rendered");const P=ue.contentDocument,x=ue.contentWindow;if(!P||!x)throw new Error("Print renderer not available");return{pages:Array.from(P.querySelectorAll(".print-page")),cleanup:J,getComputedStyleFn:x.getComputedStyle.bind(x)}}catch(U){throw J(),U}},T=async oe=>{if(typeof oe=="string")return{content:oe,cleanup:null,getComputedStyleFn:window.getComputedStyle};const ue=await f();return{content:ue.pages,cleanup:ue.cleanup,getComputedStyleFn:ue.getComputedStyleFn}},D=async()=>{const oe=await p({mutateStore:!1,setExporting:!1}),ue=r.canvasSize.width,J=r.canvasSize.height;let u=null,U=null,P=null;try{const x=await T(Array.from(document.querySelectorAll(".print-page")));P=x.cleanup;const C=await G(x.content,ue,J,!0,x.getComputedStyleFn);u=C.container,U=C.tempWrapper;const N=document.createElement("div");return N.style.width="100%",N.style.display="flex",N.style.flexDirection="column",N.style.alignItems="center",Array.from(u.children).filter(X=>!["STYLE","LINK","SCRIPT"].includes(X.tagName)).forEach((X,R)=>{const ae=X.cloneNode(!0);ae.style.position="relative",ae.style.left="auto",ae.style.top="auto",ae.style.width=`${ue}px`,ae.style.height=`${J}px`,ae.style.margin="0 0 20px 0",ae.style.backgroundColor=r.canvasBackground,ae.style.transform="none",N.appendChild(ae)}),N.outerHTML}finally{U&&U.parentNode&&U.parentNode.removeChild(U),P&&P(),oe()}},j=oe=>{oe.querySelectorAll("svg").forEach(J=>{const u=J.parentElement;if(!u)return;const U=getComputedStyle(u),P=parseFloat(U.width),x=parseFloat(U.height),C=document.createElement("canvas");C.width=Number.isFinite(P)?Math.max(1,Math.round(P)):10,C.height=Number.isFinite(x)?Math.max(1,Math.round(x)):10;const N=C.getContext("2d");if(!N)return;const M=new XMLSerializer;J.setAttribute("width",`${P}px`),J.setAttribute("height",`${x}px`);const X=M.serializeToString(J);Zl.fromString(N,X).render();const ae=document.createElement("img");ae.src=C.toDataURL("image/png"),ae.style.width=`${P}px`,ae.style.height=`${x}px`,ae.style.display="block",J.before(ae),u.removeChild(J)})},B=(oe,ue)=>{Array.from(oe.children).filter(u=>!["STYLE","LINK","SCRIPT"].includes(u.tagName)).forEach((u,U)=>{u.querySelectorAll('[data-print-type="page-number"]').forEach(x=>{const C=x.querySelector(".page-number-text");C&&(C.textContent=`${U+1}/${ue}`)})})},A=(oe,ue,J,u,U,P,x)=>{oe.querySelectorAll("[data-print-wrapper]").forEach(N=>{const M=N,X=parseFloat(M.style.top)||0;parseFloat(M.style.height)||M.offsetHeight;const R=P&&X<J,ae=x&&X>=U-u;if(R||ae){const he=M.cloneNode(!0);ue.appendChild(he)}})},V=oe=>{const ue=oe.querySelector("tfoot");if(!ue)return;const J=oe.getAttribute("data-custom-script");if(J)try{const u=oe.querySelector("tbody"),U=[];u&&Array.from(u.querySelectorAll("tr")).forEach(M=>{const X={};Array.from(M.querySelectorAll("td")).forEach(ae=>{const he=ae.getAttribute("data-field");he&&(X[he]=ae.textContent||"")}),Object.keys(X).length>0&&U.push(X)});const P=[];Array.from(ue.querySelectorAll("tr")).forEach(N=>{const M={};Array.from(N.querySelectorAll("td")).forEach(R=>{const ae=R.getAttribute("data-field");ae&&(M[ae]={value:R.getAttribute("data-value")||R.textContent||""})}),P.push(M)}),new Function("data","footerData","columns","type",J)(U,P,[],"page"),P.length>0&&Array.from(ue.querySelectorAll("tr")).forEach((M,X)=>{P[X]&&Array.from(M.querySelectorAll("td")).forEach(ae=>{const he=ae.getAttribute("data-field");if(he&&P[X][he]!==void 0){let de=P[X][he];de&&typeof de=="object"&&(de.result!==void 0?de=de.result:de.value!==void 0&&(de=de.value)),ae.textContent=String(de)}})});return}catch(u){console.error("Page sum script error:",u)}},Y=(oe,ue,J,u,U,P)=>{let x=Array.from(oe.children).filter(C=>!["STYLE","LINK","SCRIPT"].includes(C.tagName));for(let C=0;C<x.length;C++){const N=x[C];N.querySelectorAll("table").forEach(X=>{const R=X.closest("[data-print-wrapper]");if(!R||!(X.getAttribute("data-auto-paginate")==="true"))return;R.style.height="auto",X.style.height="auto";const he=X.querySelector("tbody");he&&(he.style.height="auto");const de=X.parentElement;de&&(de.classList.remove("h-full","overflow-hidden"),de.style.height="auto",de.style.overflow="visible");const Q=N.getBoundingClientRect().top+ue-u,me=R.getBoundingClientRect().top;if(X.getBoundingClientRect().bottom<=Q){V(X);return}let Be=-1;const Ue=X.querySelector("tbody");if(!Ue)return;const Ie=Array.from(Ue.querySelectorAll("tr")),Fe=X.querySelector("tfoot"),st=X.getAttribute("data-tfoot-repeat")==="true";let Ve=0;Fe&&st&&(Ve=Fe.getBoundingClientRect().height);for(let je=0;je<Ie.length;je++)if(Ie[je].getBoundingClientRect().bottom+Ve>Q+1){if(Be=je,Be===0){const nt=U&&J>0?J+10:r.pageSpacingY||0;me<=nt+5&&(Be=1)}break}if(Be!==-1){const je=document.createElement("div");je.className=N.className,je.style.cssText=N.style.cssText,je.innerHTML="",A(N,je,J,u,ue,U,P),C===x.length-1?oe.appendChild(je):oe.insertBefore(je,x[C+1]),x=Array.from(oe.children).filter(at=>!["STYLE","LINK","SCRIPT"].includes(at.tagName));const Ze=R.cloneNode(!0),lt=U&&J>0?J+10:r.pageSpacingY||0;Ze.style.removeProperty("top"),Ze.style.setProperty("top",`${lt}px`,"important");const nt=Ie;for(let at=Be;at<nt.length;at++)nt[at].remove();Be===0&&R.remove();const Tt=X.querySelector("tfoot"),ht=X.getAttribute("data-tfoot-repeat")==="true";Tt&&(ht?V(X):Tt.remove());const pt=Ze.querySelector("table");pt.style.height="auto";const tr=pt.querySelector("tbody");tr&&(tr.style.height="auto");const Gl=Array.from(tr.querySelectorAll("tr"));for(let at=0;at<Be;at++)Gl[at].remove();je.appendChild(Ze)}else V(X)})}return x=Array.from(oe.children).filter(C=>!["STYLE","LINK","SCRIPT"].includes(C.tagName)),x.forEach((C,N)=>{C.style.top=`${N*ue}px`}),x.length},se=(oe,ue=window.getComputedStyle)=>{const J=oe.cloneNode(!0),u=[[oe,J]];for(;u.length>0;){const[U,P]=u.shift();if(U.nodeType===1){const x=ue(U),C=P.style;for(let N=0;N<x.length;N++){const M=x[N];C.setProperty(M,x.getPropertyValue(M),x.getPropertyPriority(M))}}for(let x=0;x<U.children.length;x++)P.children[x]&&u.push([U.children[x],P.children[x]])}return J},G=async(oe,ue,J,u=!0,U=window.getComputedStyle)=>{const P=document.createElement("div");P.style.position="fixed",P.style.left="0",P.style.top="0",P.style.width=`${ue}px`,P.style.height=`${J}px`,P.style.zIndex="-9999",P.className="print_temp_container",document.body.appendChild(P),document.head.querySelectorAll('style, link[rel="stylesheet"]').forEach(M=>{P.appendChild(M.cloneNode(!0))});let C=[];typeof oe=="string"?(P.innerHTML=oe,C=Array.from(P.children).filter(M=>!["STYLE","LINK","SCRIPT"].includes(M.tagName))):Array.isArray(oe)?C=oe:oe.classList.contains("design-workspace")?C=Array.from(oe.children):C=[oe],C.forEach((M,X)=>{const R=se(M,U);R.style.position="absolute",R.style.left="0",R.style.top=`${X*J}px`,R.style.width=`${ue}px`,R.style.height=`${J}px`,R.style.transform="none",R.style.backgroundColor=r.canvasBackground,R.querySelectorAll('[data-print-exclude="true"]').forEach(de=>de.remove()),R.querySelectorAll(".element-wrapper").forEach(de=>de.setAttribute("data-print-wrapper","true")),S(R),R.querySelectorAll("svg").forEach(de=>{const pe=de.getBoundingClientRect();if(pe.width===0||pe.height===0){const Q=de.getAttribute("width"),H=de.getAttribute("height");Q&&(de.style.width=Q.includes("px")?Q:`${Q}px`),H&&(de.style.height=H.includes("px")?H:`${H}px`)}}),P.appendChild(R)}),await new Promise(M=>setTimeout(M,100)),u&&j(P);const N=Y(P,J,r.headerHeight,r.footerHeight,r.showHeaderLine,r.showFooterLine);return B(P,N),P.style.height=`${J*N}px`,{container:P,tempWrapper:P,pagesCount:N}},I=async(oe,ue,J)=>{const u=Array.from(oe.children).filter(C=>!["STYLE","LINK","SCRIPT"].includes(C.tagName));u.forEach(C=>{C.style.top="0px"});const U=async C=>{const N=await Sc.toCanvas(C,{scale:1.5,width:ue,height:J,useCORS:!0,bgcolor:r.canvasBackground}),M=N.getContext("2d");return M&&(M.mozImageSmoothingEnabled=!1,M.webkitImageSmoothingEnabled=!1,M.msImageSmoothingEnabled=!1,M.imageSmoothingEnabled=!1),N.toDataURL("image/jpeg",.5)},P=3,x=[];for(let C=0;C<u.length;C+=P){const N=u.slice(C,C+P),M=await Promise.all(N.map(X=>U(X)));x.push(...M)}return x},q=async oe=>{const ue=await p({mutateStore:!1,setExporting:!1}),J=r.canvasSize.width,u=r.canvasSize.height,U=co(J),P=co(u);let x=null,C=null;try{const N=await T(oe);C=N.cleanup;const{container:M,tempWrapper:X}=await G(N.content,J,u,!0,N.getComputedStyleFn);x=X;const R=new ei({orientation:J>u?"l":"p",unit:"mm",format:[U,P],hotfixes:["px_scaling"]});return(await I(M,J,u)).forEach((he,de)=>{de>0&&R.addPage([U,P]),R.addImage(he,"JPEG",0,0,U,P)}),R}finally{x&&x.parentNode&&x.parentNode.removeChild(x),C&&C(),ue()}},h=async(oe,ue="print-design.pdf")=>{try{const J=oe||Array.from(document.querySelectorAll(".print-page"));(await q(J)).save(ue)}catch(J){console.error("Export PDF failed",J),alert("Export PDF failed")}},y=async oe=>{try{const J=(await q(oe)).output("blob"),u=URL.createObjectURL(J);if(/Edg\//.test(navigator.userAgent)){const x=window.open(u,"_blank","noopener,noreferrer");if(!x){URL.revokeObjectURL(u);return}x.addEventListener("beforeunload",()=>{URL.revokeObjectURL(u)}),x.onload=()=>{try{x.focus(),x.print()}finally{setTimeout(()=>{URL.revokeObjectURL(u)},1e3)}};return}const P=document.createElement("iframe");P.style.position="fixed",P.style.left="0",P.style.top="0",P.style.width="0px",P.style.height="0px",P.style.border="0",P.style.visibility="hidden",P.src=u,document.body.appendChild(P),P.onload=()=>{const x=P.contentWindow;x&&(x.focus(),setTimeout(()=>{x.print()},100)),setTimeout(()=>{document.body.removeChild(P),URL.revokeObjectURL(u)},1e3)}}catch(ue){console.error("Print failed",ue),alert("Print failed")}},ee=oe=>new Promise((ue,J)=>{const u=new FileReader;u.onloadend=()=>ue(u.result),u.onerror=()=>J(new Error("Failed to read PDF blob")),u.readAsDataURL(oe)}),K=(oe,ue,J)=>{const u={printer:oe.printer,content:ue};return J&&(u.key=J),(oe.jobName||oe.copies||oe.intervalMs)&&(u.job={...oe.jobName?{name:oe.jobName}:{},...oe.copies?{copies:oe.copies}:{},...oe.intervalMs?{intervalMs:oe.intervalMs}:{}}),(oe.pageRange||oe.pageSet)&&(u.pages={...oe.pageRange?{range:oe.pageRange}:{},...oe.pageSet?{set:oe.pageSet}:{}}),(oe.scale||oe.orientation)&&(u.layout={...oe.scale?{scale:oe.scale}:{},...oe.orientation?{orientation:oe.orientation}:{}}),oe.colorMode&&(u.color={mode:oe.colorMode}),oe.sidesMode&&(u.sides={mode:oe.sidesMode}),oe.paperSize&&(u.paper={size:oe.paperSize}),oe.trayBin&&(u.tray={bin:oe.trayBin}),u},te=(oe,ue,J)=>new Promise((u,U)=>{let P=!1;const x=new WebSocket(oe),C=window.setTimeout(()=>{P||(P=!0,x.close(),U(new Error("Print request timeout")))},3e4);x.onopen=()=>{x.send(JSON.stringify(ue))},x.onmessage=N=>{if(!P)try{const M=JSON.parse(N.data);if(J==="status"&&(M.status==="success"||M.status),J==="task_result"&&M.cmd==="task_result"){P=!0,window.clearTimeout(C),x.close(),u();return}}catch(M){P=!0,window.clearTimeout(C),x.close(),U(M instanceof Error?M:new Error("Print failed"))}},x.onerror=()=>{P||(P=!0,window.clearTimeout(C),x.close(),U(new Error("Print connection failed")))}});let $=null,W="",L=null,O=Promise.resolve();const re=()=>{$&&$.readyState===WebSocket.OPEN&&$.close(),$=null,W="",L=null},Z=oe=>$&&$.readyState===WebSocket.OPEN&&W===oe?Promise.resolve($):L||(W=oe,L=new Promise((ue,J)=>{const u=new WebSocket(oe),U=()=>{u.removeEventListener("open",U),u.removeEventListener("error",P),$=u,L=null,ue(u)},P=()=>{u.removeEventListener("open",U),u.removeEventListener("error",P),re(),J(new Error("Print connection failed"))};u.addEventListener("open",U),u.addEventListener("error",P)}),L),ne=(oe,ue,J)=>(O=O.then(()=>new Promise(async(u,U)=>{let P=!1,x=null;const C=window.setTimeout(()=>{P||(P=!0,re(),U(new Error("Print request timeout")))},3e4),N=()=>{x&&(x.removeEventListener("message",M),x.removeEventListener("error",X),x.removeEventListener("close",R))},M=ae=>{if(!P)try{const he=JSON.parse(ae.data);(he.status==="success"||he.status==="error")&&(P=!0,window.clearTimeout(C),N(),he.status==="success"?u():U(new Error(he.message||"Print failed")))}catch(he){P=!0,window.clearTimeout(C),N(),U(he instanceof Error?he:new Error("Print failed"))}},X=()=>{P||(P=!0,window.clearTimeout(C),N(),re(),U(new Error("Print connection failed")))},R=()=>{P||(P=!0,window.clearTimeout(C),N(),re(),U(new Error("Print connection closed")))};try{x=await Z(oe),x.addEventListener("message",M),x.addEventListener("error",X),x.addEventListener("close",R),x.send(JSON.stringify(ue))}catch(ae){P=!0,window.clearTimeout(C),N(),U(ae instanceof Error?ae:new Error("Print connection failed"))}})),O),ve=async(oe,ue)=>{const J=(ue==null?void 0:ue.mode)||e.value;if(J==="browser"){await y(oe);return}if(!(J==="local"?n.value==="connected":l.value==="connected")){await y(oe);return}const U=(ue==null?void 0:ue.options)||(J==="local"?i:d);if(!U.printer){alert("Printer is required");return}try{const P=await _e(oe),x=await ee(P);if(J==="local"){const N=K(U,x,t.secretKey.trim());await ne(c.value,N,"status");return}if(!w.value){alert("Client is required");return}const C=K(U,x);C.cmd="submit_task",C.client_id=w.value,await te(g.value,C,"task_result")}catch(P){console.error("Print failed",P),alert("Print failed")}},we=async oe=>{if(oe.length===0)return"";const ue=await new Promise((C,N)=>{const M=new Image;M.onload=()=>C(M),M.onerror=N,M.src=oe[0]}),J=ue.width,u=ue.height,U=u*oe.length,P=document.createElement("canvas");P.width=J,P.height=U;const x=P.getContext("2d");if(!x)throw new Error("Could not get canvas context");x.drawImage(ue,0,0);for(let C=1;C<oe.length;C++)await new Promise((N,M)=>{const X=new Image;X.onload=()=>{x.drawImage(X,0,C*u),N()},X.onerror=M,X.src=oe[C]});return P.toDataURL("image/jpeg",.8)},ie=async(oe,ue="print-design")=>{try{const J=oe||Array.from(document.querySelectorAll(".print-page")),u=await p({mutateStore:!1,setExporting:!1}),U=r.canvasSize.width,P=r.canvasSize.height;let x=null;const C=await T(J);x=C.cleanup;const{container:N,tempWrapper:M}=await G(C.content,U,P,!0,C.getComputedStyleFn);try{const X=await I(N,U,P);if(X.length===0)return;if(m.value){const R=await we(X),ae=document.createElement("a");ae.href=R,ae.download=`${ue}.jpg`,document.body.appendChild(ae),ae.click(),document.body.removeChild(ae)}else{const R=new Tc;await Promise.all(X.map(async(pe,Q)=>{const me=await(await fetch(pe)).blob();R.file(`${ue}-${Q+1}.jpg`,me)}));const ae=await R.generateAsync({type:"blob"}),he=URL.createObjectURL(ae),de=document.createElement("a");de.href=he,de.download=`${ue}.zip`,document.body.appendChild(de),de.click(),document.body.removeChild(de),URL.revokeObjectURL(he)}}finally{M&&M.parentNode&&M.parentNode.removeChild(M),x&&x(),u()}}catch(J){console.error("Export Images failed",J),alert("Export Images failed")}},ke=async oe=>{try{const ue=oe||Array.from(document.querySelectorAll(".print-page")),J=await p({mutateStore:!1,setExporting:!1}),u=r.canvasSize.width,U=r.canvasSize.height;let P=null;const x=await T(ue);P=x.cleanup;const{container:C,tempWrapper:N}=await G(x.content,u,U,!0,x.getComputedStyleFn);try{const M=await I(C,u,U);if(M.length===0)throw new Error("No images generated");const X=await we(M);return await(await fetch(X)).blob()}finally{N&&N.parentNode&&N.parentNode.removeChild(N),P&&P(),J()}}catch(ue){throw console.error("Get Image Blob failed",ue),ue}},_e=async oe=>{try{return(await q(oe)).output("blob")}catch(ue){throw console.error("Get PDF Blob failed",ue),ue}};return{getPrintHtml:D,print:ve,exportPdf:h,exportImages:ie,getPdfBlob:_e,getImageBlob:ke}},Pc={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function Lc(r,e){return z(),F("svg",Pc,[...e[0]||(e[0]=[o("path",{fill:"currentColor",d:"M6.4 19L5 17.6l5.6-5.6L5 6.4L6.4 5l5.6 5.6L17.6 5L19 6.4L13.4 12l5.6 5.6l-1.4 1.4l-5.6-5.6z"},null,-1)])])}const vt=Se({name:"material-symbols-close",render:Lc}),Mc={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function Rc(r,e){return z(),F("svg",Mc,[...e[0]||(e[0]=[o("path",{fill:"currentColor",d:"M14 20v-2h3q.425 0 .713-.288T18 17v-2q0-.95.55-1.725t1.45-1.1v-.35q-.9-.325-1.45-1.1T18 9V7q0-.425-.288-.712T17 6h-3V4h3q1.25 0 2.125.875T20 7v2q0 .425.288.713T21 10h1v4h-1q-.425 0-.712.288T20 15v2q0 1.25-.875 2.125T17 20zm-7 0q-1.25 0-2.125-.875T4 17v-2q0-.425-.288-.712T3 14H2v-4h1q.425 0 .713-.288T4 9V7q0-1.25.875-2.125T7 4h3v2H7q-.425 0-.712.288T6 7v2q0 .95-.55 1.725T4 11.825v.35q.9.325 1.45 1.1T6 15v2q0 .425.288.713T7 18h3v2z"},null,-1)])])}const ut=Se({name:"material-symbols-data-object",render:Rc}),Dc={class:"bg-white rounded-lg shadow-xl w-[60vw] h-[80vh] flex flex-col overflow-hidden animate-fade-in"},Bc={class:"h-[60px] flex items-center justify-between px-4 border-b border-gray-200 shrink-0"},Oc={class:"flex items-center gap-2"},qc={class:"text-lg font-semibold text-gray-800"},Fc={class:"px-2 py-0.5 rounded bg-gray-200 text-gray-600 text-xs font-mono"},Nc={class:"flex-1 overflow-hidden relative"},jc={class:"p-4 border-t border-gray-200 bg-gray-50 flex justify-end rounded-b-lg"},Hc=ze({__name:"CodeEditorModal",props:{visible:{type:Boolean},title:{},value:{},language:{},readOnly:{type:Boolean}},emits:["update:visible","update:value","close"],setup(r,{emit:e}){const{t}=Ne(),{isDark:s}=Co(),n=r,l=e,i=Re(),d=fe(()=>({minimap:{enabled:!0},lineNumbers:"on",glyphMargin:!1,folding:!0,wordWrap:"on",automaticLayout:!0,scrollBeyondLastLine:!1,theme:s.value?"vs-dark":"vs",fontSize:14,fontFamily:'Consolas, "Courier New", monospace',renderLineHighlight:"none",overviewRulerLanes:0,hideCursorInOverviewRuler:!0,contextmenu:!0})),c=m=>{l("update:value",m||"")},g=()=>{l("update:visible",!1),l("close")},w=m=>{n.visible&&m.key==="Escape"&&g()};return Ae(()=>n.visible,m=>{i.setDisableGlobalShortcuts(m)}),We(()=>{window.addEventListener("keydown",w)}),Ge(()=>{window.removeEventListener("keydown",w),n.visible&&i.setDisableGlobalShortcuts(!1)}),(m,_)=>(z(),Pe(tt,{to:"body"},[r.visible?(z(),F("div",{key:0,class:"fixed inset-0 z-[99999] flex items-center justify-center bg-black/50",onClick:Ke(g,["self"])},[o("div",Dc,[o("div",Bc,[o("div",Oc,[o("h3",qc,E(r.title),1),o("span",Fc,E(r.language),1)]),o("button",{onClick:g,class:"p-1 hover:bg-gray-100 rounded-full transition-colors text-gray-500"},[ce(a(vt),{class:"w-4 h-4"})])]),o("div",Nc,[ce(a(cl),{value:r.value,language:r.language,options:{...d.value,readOnly:r.readOnly},"onUpdate:value":c,class:"w-full h-full"},null,8,["value","language","options"])]),o("div",jc,[o("button",{onClick:g,class:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 transition-colors text-sm"},E(a(t)("common.close")),1)])])])):be("",!0)]))}}),Et=(r,e)=>{const t=r.__vccOpts||r;for(const[s,n]of e)t[s]=n;return t},Ot=Et(Hc,[["__scopeId","data-v-511b518d"]]),Uc={class:"bg-white rounded-lg shadow-xl w-[90vw] h-[90vh] flex flex-col overflow-hidden"},Vc={class:"relative flex items-center justify-between p-4 border-b border-gray-200"},Wc={class:"text-lg font-semibold text-gray-800"},Gc={class:"absolute left-1/2 -translate-x-1/2 flex items-center gap-2"},Kc=["title"],Yc=["title"],Xc={class:"text-xs text-gray-600 w-9 text-right select-none"},Zc=["innerHTML"],Jc={class:"p-4 border-t border-gray-200 bg-gray-50 flex justify-end gap-3 rounded-b-lg"},Qc=ze({__name:"PreviewModal",props:{visible:{type:Boolean},htmlContent:{},width:{}},emits:["update:visible"],setup(r,{emit:e}){const t=r,s=e,{t:n}=Ne(),l=Re(),{exportPdf:i,getPdfBlob:d,exportImages:c,getImageBlob:g}=Fl(),w=Jt(),m=le(null),_=le(null),p=le(100),S=le(!1),v=le(""),k=le(""),b=le("json"),f=K=>{document.documentElement.classList.toggle("previewing",K),document.body.classList.toggle("previewing",K)};Ae(()=>t.visible,K=>{K||(p.value=100),l.setDisableGlobalShortcuts(K),f(K)});const T=()=>{s("update:visible",!1)},D=()=>{const K={pages:Ee(l.pages),canvasSize:Ee(l.canvasSize),guides:Ee(l.guides),zoom:l.zoom,showGrid:l.showGrid,headerHeight:l.headerHeight,footerHeight:l.footerHeight,showHeaderLine:l.showHeaderLine,showFooterLine:l.showFooterLine,showMinimap:l.showMinimap,canvasBackground:l.canvasBackground};v.value=JSON.stringify(K,null,2),k.value=n("preview.templateJson"),b.value="json",S.value=!0},j=async()=>{try{if(!m.value)return;const K=Array.from(m.value.querySelectorAll(".print-page")),te=await g(K),$=new FileReader;$.readAsDataURL(te),$.onloadend=()=>{v.value=$.result,k.value=n("editor.viewImageBlob"),b.value="text",S.value=!0}}catch(K){console.error(K),alert("Failed to generate blob")}},B=async()=>{try{if(!m.value)return;const K=Array.from(m.value.querySelectorAll(".print-page")),te=await d(K),$=new FileReader;$.readAsDataURL(te),$.onloadend=()=>{v.value=$.result,k.value=n("editor.viewPdfBlob"),b.value="text",S.value=!0}}catch(K){console.error(K),alert("Failed to generate PDF blob")}},A=()=>{window.dispatchEvent(new CustomEvent("designer:print"))},V=()=>{if(m.value){const K=Array.from(m.value.querySelectorAll(".print-page"));i(K,`${se()}.pdf`)}},Y=async()=>{if(m.value){const K=Array.from(m.value.querySelectorAll(".print-page"));await c(K,se())}},se=()=>{const K=w.templates.find(Z=>Z.id===w.currentTemplateId),$=((K==null?void 0:K.name)||"print-design").trim().replace(/[\\/:*?"<>|]/g,"-").replace(/\s+/g," ").trim()||"print-design",W=new Date,L=W.getFullYear(),O=String(W.getMonth()+1).padStart(2,"0"),re=String(W.getDate()).padStart(2,"0");return`${$}-${L}${O}${re}`},G=()=>{p.value=Math.min(500,p.value+10)},I=()=>{p.value=Math.max(20,p.value-10)},q=K=>{K.ctrlKey&&(K.preventDefault(),K.deltaY<0?G():I())},h=K=>{var te,$;(K.key==="Control"||K.key==="Meta")&&(K.type==="keydown"&&!K.repeat?(te=_.value)==null||te.addEventListener("wheel",q,{passive:!1}):K.type==="keyup"&&(($=_.value)==null||$.removeEventListener("wheel",q)))},y=()=>{var K;(K=_.value)==null||K.removeEventListener("wheel",q)},ee=K=>{t.visible&&K.key==="Escape"&&T(),h(K)};return We(()=>{window.addEventListener("keydown",ee),window.addEventListener("keyup",h),window.addEventListener("blur",y)}),Ge(()=>{var K;window.removeEventListener("keydown",ee),window.removeEventListener("keyup",h),window.removeEventListener("blur",y),(K=_.value)==null||K.removeEventListener("wheel",q),t.visible&&l.setDisableGlobalShortcuts(!1),f(!1)}),(K,te)=>(z(),F(Te,null,[(z(),Pe(tt,{to:"body"},[r.visible?(z(),F("div",{key:0,class:"fixed inset-0 z-[99999] flex items-center justify-center bg-black/50",onClick:Ke(T,["self"])},[o("div",Uc,[o("div",Vc,[o("h3",Wc,E(a(n)("preview.title")),1),o("div",Gc,[o("button",{onClick:I,class:"p-1 hover:bg-gray-100 rounded text-gray-600 transition-colors",title:a(n)("preview.zoomOut")},[ce(a(Rl),{class:"w-4 h-4"})],8,Kc),$e(o("input",{type:"range",min:"20",max:"500",step:"10","onUpdate:modelValue":te[0]||(te[0]=$=>p.value=$),class:"w-32 h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer [&::-webkit-slider-thumb]:appearance-none [&::-webkit-slider-thumb]:w-4 [&::-webkit-slider-thumb]:h-4 [&::-webkit-slider-thumb]:bg-blue-600 [&::-webkit-slider-thumb]:rounded-full [&::-webkit-slider-thumb]:cursor-pointer [&::-webkit-slider-thumb]:transition-all [&::-webkit-slider-thumb]:hover:scale-110 [&::-moz-range-thumb]:w-4 [&::-moz-range-thumb]:h-4 [&::-moz-range-thumb]:bg-blue-600 [&::-moz-range-thumb]:border-none [&::-moz-range-thumb]:rounded-full [&::-moz-range-thumb]:cursor-pointer [&::-moz-range-thumb]:transition-all [&::-moz-range-thumb]:hover:scale-110"},null,512),[[De,p.value,void 0,{number:!0}]]),o("button",{onClick:G,class:"p-1 hover:bg-gray-100 rounded text-gray-600 transition-colors",title:a(n)("preview.zoomIn")},[ce(a(Ml),{class:"w-4 h-4"})],8,Yc),o("span",Xc,E(p.value)+"%",1)]),o("button",{onClick:T,class:"p-1 hover:bg-gray-100 rounded-full transition-colors text-gray-500"},[ce(a(vt),{class:"w-4 h-4"})])]),o("div",{class:"flex-1 overflow-auto bg-gray-100 p-8 flex justify-center",ref_key:"wrapperRef",ref:_},[o("div",{ref_key:"previewContainer",ref:m,class:"preview-content",style:ye(`width: ${r.width}px; zoom: ${p.value/100}`),innerHTML:r.htmlContent},null,12,Zc)],512),o("div",Jc,[o("button",{onClick:A,class:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 flex items-center gap-2 text-sm transition-colors disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:bg-blue-600"},[ce(a(Eo),{class:"text-lg"}),Ce(" "+E(a(n)("editor.print")),1)]),o("button",{onClick:V,class:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 flex items-center gap-2 text-sm transition-colors disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:bg-blue-600"},[ce(a(Vt),{class:"text-lg"}),Ce(" "+E(a(n)("editor.exportPdf")),1)]),o("button",{onClick:Y,class:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 flex items-center gap-2 text-sm transition-colors disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:bg-blue-600"},[ce(a(Vt),{class:"text-lg"}),Ce(" "+E(a(n)("editor.exportImage")),1)]),o("button",{onClick:j,class:"px-4 py-2 border border-gray-300 rounded hover:bg-gray-100 text-sm text-gray-700 flex items-center gap-2 transition-colors disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:bg-gray-100"},[ce(a(ut),{class:"text-lg"}),Ce(" "+E(a(n)("editor.viewImageBlob")),1)]),o("button",{onClick:B,class:"px-4 py-2 border border-gray-300 rounded hover:bg-gray-100 text-sm text-gray-700 flex items-center gap-2 transition-colors disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:bg-gray-100"},[ce(a(ut),{class:"text-lg"}),Ce(" "+E(a(n)("editor.viewPdfBlob")),1)]),o("button",{onClick:D,class:"px-4 py-2 border border-gray-300 rounded hover:bg-gray-100 text-sm text-gray-700 flex items-center gap-2 transition-colors disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:bg-gray-100"},[ce(a(ut),{class:"text-lg"}),Ce(" "+E(a(n)("editor.viewJson")),1)]),o("button",{onClick:T,class:"px-4 py-2 border border-gray-300 rounded hover:bg-gray-100 text-sm text-gray-700 flex items-center gap-2 transition-colors disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:bg-gray-100"},E(a(n)("common.close")),1)])])])):be("",!0)])),ce(Ot,{visible:S.value,"onUpdate:visible":te[1]||(te[1]=$=>S.value=$),title:k.value,value:v.value,language:b.value,"read-only":""},null,8,["visible","title","value","language"])],64))}}),eh=Et(Qc,[["__scopeId","data-v-2a260b8b"]]),th={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function rh(r,e){return z(),F("svg",th,[...e[0]||(e[0]=[o("path",{fill:"currentColor",d:"m9.55 18l-5.7-5.7l1.425-1.425L9.55 15.15l9.175-9.175L20.15 7.4z"},null,-1)])])}const nh=Se({name:"material-symbols-check",render:rh}),oh={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function sh(r,e){return z(),F("svg",oh,[...e[0]||(e[0]=[o("path",{fill:"currentColor",d:"M19.25 16.4L8.4 5.55L12 2l5.65 5.55q1.1 1.05 1.725 2.488T20 13.1q0 .9-.2 1.725t-.55 1.575m.55 6.2l-3.1-3.1q-1.025.725-2.2 1.113T12 21q-3.325 0-5.663-2.312T4 13.1q0-1.275.4-2.45T5.6 8.4L1.4 4.2l1.4-1.4l18.4 18.4z"},null,-1)])])}Se({name:"material-symbols-format-color-reset",render:sh});const ah={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function lh(r,e){return z(),F("svg",ah,[...e[0]||(e[0]=[o("path",{fill:"currentColor",d:"m20.475 23.3l-2.3-2.3h-1.85v-1.85l-2-2V21h-4.65v-4.675H13.5l-2-2H9.675v-1.85l-2-2v3.85H3v-4.65h3.875l-2-2H3V5.8L.7 3.5l1.4-1.4l19.8 19.8zM5 21q-.825 0-1.412-.587T3 19v-2.675h4.675V21zm16-2.9l-1.775-1.775H21zm-3.775-3.775l-.9-.9v-3.75H21v4.65zm-2.9-2.9l-1.75-1.75h1.75zm-3.75-3.75l-.9-.9V3h4.65v4.675zm5.75 0V3H19q.825 0 1.413.588T21 5v2.675zm-8.65-2.9L5.9 3h1.775z"},null,-1)])])}Se({name:"material-symbols-grid-off",render:lh});const ih={key:0,class:"w-full h-[1px] bg-red-500 rotate-45 absolute"},dh={key:1,class:"w-full h-full bg-[url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAIAAADZF8uwAAAAGUlEQVQYV2M4gwZ+5wNisxL//8n04mEeRAAAhNwX869V4DYAAAAASUVORK5CYII=')] opacity-50"},uh={class:"flex gap-2 mb-3"},ch={class:"flex-1 flex flex-col gap-2"},hh={class:"relative h-3 rounded bg-[url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAIAAADZF8uwAAAAGUlEQVQYV2M4gwZ+5wNisxL//8n04mEeRAAAhNwX869V4DYAAAAASUVORK5CYII=')] border border-gray-200"},ph={class:"w-8 h-8 rounded border border-gray-200 overflow-hidden relative"},fh={key:0,class:"absolute inset-0 flex items-center justify-center pointer-events-none"},mh={class:"flex gap-2 mb-3"},gh={class:"flex-1"},vh={class:"w-16 text-right text-xs text-gray-500 flex items-center justify-end"},bh={class:"grid grid-cols-9 gap-1.5 mb-3"},yh=["onClick","title"],wh={class:"flex justify-between border-t pt-2"},xh={key:0},_h={class:"flex gap-2 mb-3"},kh={class:"flex-1 flex flex-col gap-2"},Sh={class:"relative h-3 rounded bg-[url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAIAAADZF8uwAAAAGUlEQVQYV2M4gwZ+5wNisxL//8n04mEeRAAAhNwX869V4DYAAAAASUVORK5CYII=')] border border-gray-200"},Ch={class:"w-8 h-8 rounded border border-gray-200 overflow-hidden relative"},Eh={key:0,class:"absolute inset-0 flex items-center justify-center pointer-events-none"},Th={class:"flex gap-2 mb-3"},$h={class:"flex-1"},Ih={class:"w-16 text-right text-xs text-gray-500 flex items-center justify-end"},Ah={class:"grid grid-cols-9 gap-1.5 mb-3"},zh=["onClick","title"],Ph={class:"flex justify-between border-t pt-2"},Lh={key:0},xt=ze({__name:"ColorPicker",props:{modelValue:{},disabled:{type:Boolean},defaultColor:{},allowTransparent:{type:Boolean},teleportToBody:{type:Boolean}},emits:["update:modelValue"],setup(r,{emit:e}){const t=r,s=e,{t:n}=Ne(),l=le(!1),i=le(null),d=le(null),c=le({h:0,s:0,v:0,a:1}),g=le(null),w=le(null),m=le(null),_=fe(()=>t.modelValue?t.modelValue==="transparent"?"transparent":t.modelValue:t.defaultColor||"#000000"),p=fe(()=>t.modelValue==="transparent"),S=fe({get:()=>qa(c.value.h,c.value.s,c.value.v,c.value.a),set:h=>{const y=Mt(h);y&&(c.value=y,B())}}),v=fe(()=>{const{r:h,g:y,b:ee}=Dt(c.value.h,c.value.s,c.value.v);return`rgba(${h}, ${y}, ${ee}, ${parseFloat(c.value.a.toFixed(2))})`}),k=fe(()=>({backgroundColor:`hsl(${c.value.h}, 100%, 50%)`})),b=fe(()=>({top:`${(1-c.value.v)*100}%`,left:`${c.value.s*100}%`})),f=fe(()=>({left:`${c.value.h/360*100}%`})),T=fe(()=>({left:`${c.value.a*100}%`})),D=fe(()=>{const{r:h,g:y,b:ee}=Dt(c.value.h,c.value.s,c.value.v);return{background:`linear-gradient(to right, rgba(${h},${y},${ee},0) 0%, rgba(${h},${y},${ee},1) 100%)`}});Ae(()=>t.modelValue,h=>{if(h){const y=Mt(h);y&&(c.value=y)}},{immediate:!0});const j=(h,y)=>{h.preventDefault();const ee=y==="sv"?g.value:y==="hue"?w.value:m.value;if(!ee)return;const K=(W,L)=>{const O=ee.getBoundingClientRect();let re=(W-O.left)/O.width,Z=(L-O.top)/O.height;re=Math.max(0,Math.min(1,re)),Z=Math.max(0,Math.min(1,Z)),y==="sv"?(c.value.s=re,c.value.v=1-Z,c.value.a===0&&(c.value.a=1)):y==="hue"?(c.value.h=re*360,c.value.a===0&&(c.value.a=1)):y==="alpha"&&(c.value.a=re),B()};K(h.clientX,h.clientY);const te=W=>K(W.clientX,W.clientY),$=()=>{window.removeEventListener("mousemove",te),window.removeEventListener("mouseup",$)};window.addEventListener("mousemove",te),window.addEventListener("mouseup",$)},B=()=>{c.value.a===0&&t.allowTransparent?s("update:modelValue","transparent"):s("update:modelValue",qa(c.value.h,c.value.s,c.value.v,c.value.a))},A=le({top:"100%",left:"0",marginTop:"8px"}),V=()=>{if(!i.value)return;const h=i.value.getBoundingClientRect(),y=window.innerWidth,ee=window.innerHeight,K=240,te=350,$={};if(t.teleportToBody){const W=h.left+K<=y-20,L=h.bottom+te<=ee-10;$.position="fixed",$.left=`${W?h.left:Math.max(8,h.right-K)}px`,$.top=`${L?h.bottom+8:Math.max(8,h.top-te-8)}px`,A.value=$;return}h.left+K>y-20?($.left="auto",$.right="0"):($.left="0",$.right="auto"),h.bottom+te>ee-10?($.top="auto",$.bottom="100%",$.marginTop="0",$.marginBottom="8px"):($.top="100%",$.bottom="auto",$.marginTop="8px",$.marginBottom="0"),A.value=$},Y=async()=>{t.disabled||(l.value=!l.value,l.value&&(await Xe(),V()))},se=()=>{l.value=!1},G=h=>{const y=h.target;i.value&&i.value.contains(y)||d.value&&d.value.contains(y)||i.value&&se()};Ae(l,h=>{t.teleportToBody&&(h?(V(),window.addEventListener("scroll",V,!0),window.addEventListener("resize",V)):(window.removeEventListener("scroll",V,!0),window.removeEventListener("resize",V)))});const I=["#000000","#ffffff","#ff0000","#00ff00","#0000ff","#ffff00","#00ffff","#ff00ff","#f44336","#e91e63","#9c27b0","#673ab7","#3f51b5","#2196f3","#03a9f4","#00bcd4","#009688","#4caf50","#8bc34a","#cddc39","#ffeb3b","#ffc107","#ff9800","#ff5722","#795548","#9e9e9e","#607d8b"],q=h=>{const y=Mt(h);y&&(c.value=y,B())};return We(()=>{window.addEventListener("mousedown",G)}),Ge(()=>{window.removeEventListener("mousedown",G)}),(h,y)=>(z(),F("div",{class:"relative flex",ref_key:"containerRef",ref:i,onClick:Y},[ul(h.$slots,"trigger",{open:l.value,color:_.value,disabled:r.disabled},()=>[o("div",{class:xe(["w-6 h-6 rounded border border-gray-300 cursor-pointer flex items-center justify-center overflow-hidden transition-all hover:border-blue-500",{"opacity-50 cursor-not-allowed":r.disabled,"ring-2 ring-blue-500 ring-offset-1":l.value}]),style:ye({backgroundColor:p.value?"transparent":_.value})},[r.modelValue?be("",!0):(z(),F("div",ih)),p.value?(z(),F("div",dh)):be("",!0)],6)]),l.value&&r.teleportToBody?(z(),Pe(tt,{key:0,to:"body"},[o("div",{ref_key:"dropdownRef",ref:d,class:"fixed z-[99999] bg-white rounded-lg shadow-xl border border-gray-200 p-3 w-[240px]",style:ye(A.value),onClick:y[6]||(y[6]=Ke(()=>{},["stop"]))},[o("div",{ref_key:"svPanelRef",ref:g,class:"w-full h-32 rounded relative cursor-crosshair mb-3",style:ye(k.value),onMousedown:y[0]||(y[0]=ee=>j(ee,"sv"))},[y[14]||(y[14]=o("div",{class:"absolute inset-0 bg-gradient-to-r from-white to-transparent rounded"},null,-1)),y[15]||(y[15]=o("div",{class:"absolute inset-0 bg-gradient-to-t from-black to-transparent rounded"},null,-1)),o("div",{class:"absolute w-3 h-3 border-2 border-white rounded-full shadow-sm -ml-1.5 -mt-1.5 pointer-events-none",style:ye(b.value)},null,4)],36),o("div",uh,[o("div",ch,[o("div",{ref_key:"hueSliderRef",ref:w,class:"h-3 rounded relative cursor-pointer border border-gray-200",style:{background:"linear-gradient(to right, #f00 0%, #ff0 17%, #0f0 33%, #0ff 50%, #00f 67%, #f0f 83%, #f00 100%)"},onMousedown:y[1]||(y[1]=ee=>j(ee,"hue"))},[o("div",{class:"absolute top-1/2 -translate-y-1/2 w-3 h-3 bg-white border border-gray-300 rounded-full shadow-sm -ml-1.5 pointer-events-none",style:ye(f.value)},null,4)],544),o("div",hh,[o("div",{ref_key:"alphaSliderRef",ref:m,class:"absolute inset-0 cursor-pointer rounded",style:ye(D.value),onMousedown:y[2]||(y[2]=ee=>j(ee,"alpha"))},[o("div",{class:"absolute top-1/2 -translate-y-1/2 w-3 h-3 bg-white border border-gray-300 rounded-full shadow-sm -ml-1.5 pointer-events-none",style:ye(T.value)},null,4)],36)])]),o("div",ph,[y[17]||(y[17]=o("div",{class:"absolute inset-0 bg-[url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAIAAADZF8uwAAAAGUlEQVQYV2M4gwZ+5wNisxL//8n04mEeRAAAhNwX869V4DYAAAAASUVORK5CYII=')] opacity-50"},null,-1)),o("div",{class:"absolute inset-0",style:ye({backgroundColor:v.value})},null,4),c.value.a===0?(z(),F("div",fh,[...y[16]||(y[16]=[o("div",{class:"w-full h-[1px] bg-red-500 rotate-45"},null,-1)])])):be("",!0)])]),o("div",mh,[o("div",gh,[$e(o("input",{type:"text","onUpdate:modelValue":y[3]||(y[3]=ee=>S.value=ee),class:"w-full text-xs px-2 py-1 border border-gray-300 rounded focus:border-blue-500 outline-none font-mono uppercase",placeholder:"#000000"},null,512),[[De,S.value]])]),o("div",vh,E(Math.round(c.value.a*100))+"% ",1)]),o("div",bh,[(z(),F(Te,null,Le(I,ee=>o("div",{key:ee,class:xe(["w-4 h-4 rounded-sm cursor-pointer border border-transparent hover:scale-110 hover:border-gray-400 hover:z-10 transition-all relative",{"ring-2 ring-blue-500 ring-offset-1 z-10":S.value===ee}]),style:ye({backgroundColor:ee}),onClick:K=>q(ee),title:ee},null,14,yh)),64))]),o("div",wh,[o("button",{onClick:y[4]||(y[4]=ee=>{h.$emit("update:modelValue",void 0),se()}),class:"text-xs text-red-600 hover:text-red-800 hover:bg-red-50 px-2 py-1 rounded transition-colors"},E(a(n)("colorPicker.clear")),1),r.allowTransparent?(z(),F("div",xh,[o("button",{onClick:y[5]||(y[5]=ee=>{h.$emit("update:modelValue","transparent"),se()}),class:"text-xs text-gray-600 hover:text-gray-800 hover:bg-gray-100 px-2 py-1 rounded transition-colors"},E(a(n)("colorPicker.transparent")),1)])):be("",!0)])],4)])):l.value?(z(),F("div",{key:1,ref_key:"dropdownRef",ref:d,class:"absolute z-50 bg-white rounded-lg shadow-xl border border-gray-200 p-3 w-[240px]",style:ye(A.value),onClick:y[13]||(y[13]=Ke(()=>{},["stop"]))},[o("div",{ref_key:"svPanelRef",ref:g,class:"w-full h-32 rounded relative cursor-crosshair mb-3",style:ye(k.value),onMousedown:y[7]||(y[7]=ee=>j(ee,"sv"))},[y[18]||(y[18]=o("div",{class:"absolute inset-0 bg-gradient-to-r from-white to-transparent rounded"},null,-1)),y[19]||(y[19]=o("div",{class:"absolute inset-0 bg-gradient-to-t from-black to-transparent rounded"},null,-1)),o("div",{class:"absolute w-3 h-3 border-2 border-white rounded-full shadow-sm -ml-1.5 -mt-1.5 pointer-events-none",style:ye(b.value)},null,4)],36),o("div",_h,[o("div",kh,[o("div",{ref_key:"hueSliderRef",ref:w,class:"h-3 rounded relative cursor-pointer border border-gray-200",style:{background:"linear-gradient(to right, #f00 0%, #ff0 17%, #0f0 33%, #0ff 50%, #00f 67%, #f0f 83%, #f00 100%)"},onMousedown:y[8]||(y[8]=ee=>j(ee,"hue"))},[o("div",{class:"absolute top-1/2 -translate-y-1/2 w-3 h-3 bg-white border border-gray-300 rounded-full shadow-sm -ml-1.5 pointer-events-none",style:ye(f.value)},null,4)],544),o("div",Sh,[o("div",{ref_key:"alphaSliderRef",ref:m,class:"absolute inset-0 cursor-pointer rounded",style:ye(D.value),onMousedown:y[9]||(y[9]=ee=>j(ee,"alpha"))},[o("div",{class:"absolute top-1/2 -translate-y-1/2 w-3 h-3 bg-white border border-gray-300 rounded-full shadow-sm -ml-1.5 pointer-events-none",style:ye(T.value)},null,4)],36)])]),o("div",Ch,[y[21]||(y[21]=o("div",{class:"absolute inset-0 bg-[url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAIAAADZF8uwAAAAGUlEQVQYV2M4gwZ+5wNisxL//8n04mEeRAAAhNwX869V4DYAAAAASUVORK5CYII=')] opacity-50"},null,-1)),o("div",{class:"absolute inset-0",style:ye({backgroundColor:v.value})},null,4),c.value.a===0?(z(),F("div",Eh,[...y[20]||(y[20]=[o("div",{class:"w-full h-[1px] bg-red-500 rotate-45"},null,-1)])])):be("",!0)])]),o("div",Th,[o("div",$h,[$e(o("input",{type:"text","onUpdate:modelValue":y[10]||(y[10]=ee=>S.value=ee),class:"w-full text-xs px-2 py-1 border border-gray-300 rounded focus:border-blue-500 outline-none font-mono uppercase",placeholder:"#000000"},null,512),[[De,S.value]])]),o("div",Ih,E(Math.round(c.value.a*100))+"% ",1)]),o("div",Ah,[(z(),F(Te,null,Le(I,ee=>o("div",{key:ee,class:xe(["w-4 h-4 rounded-sm cursor-pointer border border-transparent hover:scale-110 hover:border-gray-400 hover:z-10 transition-all relative",{"ring-2 ring-blue-500 ring-offset-1 z-10":S.value===ee}]),style:ye({backgroundColor:ee}),onClick:K=>q(ee),title:ee},null,14,zh)),64))]),o("div",Ph,[o("button",{onClick:y[11]||(y[11]=ee=>{h.$emit("update:modelValue",void 0),se()}),class:"text-xs text-red-600 hover:text-red-800 hover:bg-red-50 px-2 py-1 rounded transition-colors"},E(a(n)("colorPicker.clear")),1),r.allowTransparent?(z(),F("div",Lh,[o("button",{onClick:y[12]||(y[12]=ee=>{h.$emit("update:modelValue","transparent"),se()}),class:"text-xs text-gray-600 hover:text-gray-800 hover:bg-gray-100 px-2 py-1 rounded transition-colors"},E(a(n)("colorPicker.transparent")),1)])):be("",!0)])],4)):be("",!0)],512))}}),Mh={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function Rh(r,e){return z(),F("svg",Mh,[...e[0]||(e[0]=[o("path",{fill:"currentColor",d:"M12 20q-.825 0-1.412-.587T10 18t.588-1.412T12 16t1.413.588T14 18t-.587 1.413T12 20m0-6q-.825 0-1.412-.587T10 12t.588-1.412T12 10t1.413.588T14 12t-.587 1.413T12 14m0-6q-.825 0-1.412-.587T10 6t.588-1.412T12 4t1.413.588T14 6t-.587 1.413T12 8"},null,-1)])])}const Nl=Se({name:"material-symbols-more-vert",render:Rh}),Dh={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function Bh(r,e){return z(),F("svg",Dh,[...e[0]||(e[0]=[o("path",{fill:"currentColor",d:"M3 21v-4.25L16.2 3.575q.3-.275.663-.425t.762-.15t.775.15t.65.45L20.425 5q.3.275.438.65T21 6.4q0 .4-.137.763t-.438.662L7.25 21zM17.6 7.8L19 6.4L17.6 5l-1.4 1.4z"},null,-1)])])}const ho=Se({name:"material-symbols-edit",render:Bh}),Oh={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function qh(r,e){return z(),F("svg",Oh,[...e[0]||(e[0]=[o("path",{fill:"currentColor",d:"M11 13H5v-2h6V5h2v6h6v2h-6v6h-2z"},null,-1)])])}const Ao=Se({name:"material-symbols-add",render:qh}),Fh={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function Nh(r,e){return z(),F("svg",Fh,[...e[0]||(e[0]=[o("path",{fill:"currentColor",d:"M8 18h8v-2H8zm0-4h8v-2H8zm-2 8q-.825 0-1.412-.587T4 20V4q0-.825.588-1.412T6 2h8l6 6v12q0 .825-.587 1.413T18 22zm7-13h5l-5-5z"},null,-1)])])}const jh=Se({name:"material-symbols-description",render:Nh}),Hh={key:0,class:"fixed inset-0 z-[2000] flex items-center justify-center bg-black/50"},Uh={class:"bg-white rounded-lg shadow-xl w-96 animate-in fade-in zoom-in duration-200 flex flex-col overflow-hidden"},Vh={class:"h-[60px] flex items-center justify-between px-4 border-b border-gray-200 shrink-0"},Wh={class:"text-lg font-semibold text-gray-800"},Gh={class:"p-4"},Kh={class:"mb-4"},Yh=["placeholder"],Xh={class:"flex justify-end gap-2"},Zh=["disabled"],qt=ze({__name:"InputModal",props:{show:{type:Boolean},initialValue:{},title:{},placeholder:{}},emits:["close","save"],setup(r,{emit:e}){const t=r,s=e,{t:n}=Ne(),l=Re(),i=le(""),d=le(null);Ae(()=>t.show,g=>{if(g){i.value=t.initialValue||"",setTimeout(()=>{var w;(w=d.value)==null||w.focus()},100),l.setDisableGlobalShortcuts(!0);return}l.setDisableGlobalShortcuts(!1)});const c=()=>{i.value.trim()&&(s("save",i.value.trim()),s("close"))};return Ge(()=>{t.show&&l.setDisableGlobalShortcuts(!1)}),(g,w)=>(z(),Pe(tt,{to:"body"},[r.show?(z(),F("div",Hh,[o("div",Uh,[o("div",Vh,[o("h3",Wh,E(r.title||a(n)("input.title")),1),o("button",{onClick:w[0]||(w[0]=m=>s("close")),class:"p-1 hover:bg-gray-100 rounded-full transition-colors text-gray-500"},[ce(a(vt),{class:"w-4 h-4"})])]),o("div",Gh,[o("div",Kh,[$e(o("input",{ref_key:"inputRef",ref:d,"onUpdate:modelValue":w[1]||(w[1]=m=>i.value=m),type:"text",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:r.placeholder||a(n)("input.placeholder"),onKeydown:[wt(c,["enter"]),w[2]||(w[2]=wt(m=>s("close"),["esc"]))]},null,40,Yh),[[De,i.value]])]),o("div",Xh,[o("button",{onClick:w[3]||(w[3]=m=>s("close")),class:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-md transition-colors"},E(a(n)("common.cancel")),1),o("button",{onClick:c,disabled:!i.value.trim(),class:"px-4 py-2 text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 rounded-md transition-colors disabled:opacity-50 disabled:cursor-not-allowed"},E(a(n)("common.confirm")),9,Zh)])])])])):be("",!0)]))}}),Ft=r=>{const e=r.trim();return e?e.startsWith("@")?e.slice(1).trim():e.startsWith("{#")&&e.endsWith("}")?e.slice(2,-1).trim():e:""},jl=r=>[ge.TEXT,ge.BARCODE,ge.QRCODE,ge.TABLE].includes(r.type),Jh=r=>{if(Array.isArray(r.data)&&r.data.length>0)return Ee(r.data);const e=r.columns||[];if(e.length===0)return[];const t={};return e.forEach(s=>{t[s.field]=""}),[t]},po=(r,e={})=>{const t={...e};if(!jl(r))return t;const s=r.variable||"",n=Ft(s);return!n||Object.prototype.hasOwnProperty.call(t,n)?t:r.type===ge.TABLE?(t[n]=Jh(r),t):(t[n]=r.content??"",t)},Qh=(r=[],e={})=>{let t={...e};return r.forEach(s=>{s.elements.forEach(n=>{t=po(n,t)})}),t},ep={class:"flex-1 truncate text-left"},tp={key:0,class:"absolute top-full left-0 mt-2 w-[220px] bg-white rounded-lg shadow-xl border border-gray-200 z-[100] flex flex-col max-h-[500px]"},rp={class:"flex-1 overflow-y-auto py-1"},np={key:0,class:"px-4 py-3 text-sm text-gray-500 text-center"},op=["onClick"],sp={class:"flex items-center gap-2 overflow-hidden flex-1"},ap={class:"w-2 h-2 flex items-center justify-center flex-shrink-0"},lp={key:0,class:"w-1.5 h-1.5 rounded-full bg-blue-500"},ip=["onClick"],dp={class:"border-t border-gray-100 p-1"},up=ze({__name:"TemplateDropdown",setup(r){const{t:e}=Ne(),t=Jt(),s=Re(),n=le(!1),l=le(null),i=le(null),d=le({}),c=le(!1),g=le("create"),w=le(""),m=le(null),_=le(!1),p=le(""),S=le(null),v=le([]);We(()=>{t.loadTemplates(),!t.currentTemplateId&&t.templates.length>0&&t.loadTemplate(t.templates[0].id),document.addEventListener("click",k),window.addEventListener("designer:new-template",B)}),Ge(()=>{document.removeEventListener("click",k),window.removeEventListener("designer:new-template",B)});const k=h=>{l.value&&!l.value.contains(h.target)&&(n.value=!1,i.value=null);const y=h.target;i.value&&!y.closest(".row-menu-trigger")&&!y.closest(".row-menu-content")&&(i.value=null)},b=fe(()=>{const h=t.templates.find(y=>y.id===t.currentTemplateId);return h?h.name:e("template.select")}),f=()=>{n.value=!n.value,n.value||(i.value=null)},T=h=>{if(t.currentTemplateId){const y=t.templates.find(ee=>ee.id===t.currentTemplateId);y&&t.saveCurrentTemplate(y.name)}t.loadTemplate(h.id),n.value=!1},D=(h,y)=>{if(h.stopPropagation(),i.value===y)i.value=null;else{const K=h.currentTarget.getBoundingClientRect();let $=K.right-128;$<5&&($=K.left),window.innerHeight-K.bottom<150?d.value={bottom:`${window.innerHeight-K.top+5}px`,left:`${$}px`}:d.value={top:`${K.bottom+5}px`,left:`${$}px`},i.value=y}},j=()=>t.templates.find(h=>h.id===i.value),B=()=>{i.value=null,g.value="create",w.value="",c.value=!0,n.value=!1},A=h=>{i.value=null,g.value="rename",m.value=h.id,w.value=h.name,c.value=!0,n.value=!1},V=h=>{t.copyTemplate(h.id),i.value=null},Y=h=>{confirm(e("template.confirmDelete",{name:h.name}))&&(t.deleteTemplate(h.id),!t.currentTemplateId&&t.templates.length>0&&t.loadTemplate(t.templates[0].id)),i.value=null},se=h=>{var te,$;const y=t.currentTemplateId===h.id,ee=y?s.testData||{}:((te=h.data)==null?void 0:te.testData)||{},K=y?s.pages:(($=h.data)==null?void 0:$.pages)||[];return Qh(K,ee)},G=h=>{i.value=null,S.value=h;const y=se(h);v.value=Object.keys(y),p.value=JSON.stringify(y,null,2),_.value=!0,n.value=!1},I=()=>{var K;const h=S.value,y=new Set(v.value||[]);if(S.value=null,v.value=[],!h)return;let ee=null;try{const te=((K=p.value)==null?void 0:K.trim())||"{}",$=JSON.parse(te);$&&typeof $=="object"&&!Array.isArray($)&&(ee=$)}catch{ee=null}if(!ee){alert(e("common.invalidJson"));return}if(y.size>0){const te=Object.keys(ee);if(te.length!==y.size||te.some(W=>!y.has(W))){alert(e("common.testDataKeyChanged"));return}}h.data={...h.data||{},testData:ee},h.updatedAt=Date.now(),t.saveToLocalStorage(),t.currentTemplateId===h.id&&(s.testData=ee)},q=h=>{if(g.value==="create"){if(t.currentTemplateId){const ee=t.templates.find(K=>K.id===t.currentTemplateId);ee&&t.saveCurrentTemplate(ee.name)}Re().resetCanvas(),t.createTemplate(h)}else g.value==="rename"&&m.value&&t.renameTemplate(m.value,h)};return(h,y)=>(z(),F("div",{class:"relative",ref_key:"containerRef",ref:l},[o("button",{onClick:f,class:"flex items-center gap-2 px-3 py-1.5 bg-gray-100 hover:bg-gray-200 rounded-lg text-sm font-medium text-gray-700 transition-colors w-40",title:"Templates"},[ce(a(jh),{class:"w-4 h-4 flex-shrink-0"}),o("span",ep,E(b.value),1),ce(a(Io),{class:"w-4 h-4 flex-shrink-0"})]),n.value?(z(),F("div",tp,[o("div",rp,[a(t).templates.length===0?(z(),F("div",np,E(a(e)("template.noTemplates")),1)):be("",!0),(z(!0),F(Te,null,Le(a(t).templates,ee=>(z(),F("div",{key:ee.id,class:"relative group border-b border-gray-100 last:border-b-0 flex items-center justify-between px-3 py-2 hover:bg-gray-50 cursor-pointer",onClick:K=>T(ee)},[o("div",sp,[o("div",ap,[a(t).currentTemplateId===ee.id?(z(),F("div",lp)):be("",!0)]),o("span",{class:xe(["text-sm text-gray-700 truncate",{"font-medium text-blue-600":a(t).currentTemplateId===ee.id}])},E(ee.name),3)]),o("button",{onClick:K=>D(K,ee.id),class:xe(["row-menu-trigger p-1 hover:bg-gray-200 rounded-full text-gray-400 hover:text-gray-600 opacity-0 group-hover:opacity-100 transition-opacity",{"opacity-100 bg-gray-200":i.value===ee.id}])},[ce(a(Nl),{class:"w-4 h-4"})],10,ip)],8,op))),128))]),o("div",dp,[o("button",{onClick:B,class:"w-full flex items-center justify-center gap-2 px-3 py-2 text-sm text-blue-600 hover:bg-blue-50 rounded transition-colors"},[ce(a(Ao),{class:"w-4 h-4"}),Ce(" "+E(a(e)("template.new")),1)])])])):be("",!0),(z(),Pe(tt,{to:"body"},[i.value?(z(),F("div",{key:0,class:"row-menu-content fixed w-32 bg-white rounded shadow-lg border border-gray-100 z-[2001] py-1",style:ye(d.value),onClick:y[4]||(y[4]=Ke(()=>{},["stop"]))},[j()?(z(),F(Te,{key:0},[o("button",{onClick:y[0]||(y[0]=ee=>G(j())),class:"w-full text-left px-3 py-1.5 text-xs text-gray-700 hover:bg-gray-50 flex items-center gap-2"},[ce(a(ut),{class:"w-3.5 h-3.5"}),Ce(" "+E(a(e)("common.testData")),1)]),o("button",{onClick:y[1]||(y[1]=ee=>A(j())),class:"w-full text-left px-3 py-1.5 text-xs text-gray-700 hover:bg-gray-50 flex items-center gap-2"},[ce(a(ho),{class:"w-3.5 h-3.5"}),Ce(" "+E(a(e)("common.rename")),1)]),o("button",{onClick:y[2]||(y[2]=ee=>V(j())),class:"w-full text-left px-3 py-1.5 text-xs text-gray-700 hover:bg-gray-50 flex items-center gap-2"},[ce(a(Ct),{class:"w-3.5 h-3.5"}),Ce(" "+E(a(e)("common.copy")),1)]),o("button",{onClick:y[3]||(y[3]=ee=>Y(j())),class:"w-full text-left px-3 py-1.5 text-xs text-red-600 hover:bg-red-50 flex items-center gap-2"},[ce(a(St),{class:"w-3.5 h-3.5"}),Ce(" "+E(a(e)("common.delete")),1)])],64)):be("",!0)],4)):be("",!0)])),ce(qt,{show:c.value,"initial-value":w.value,title:g.value==="create"?a(e)("template.new"):a(e)("template.rename"),onClose:y[5]||(y[5]=ee=>c.value=!1),onSave:q},null,8,["show","initial-value","title"]),ce(Ot,{visible:_.value,"onUpdate:visible":y[6]||(y[6]=ee=>_.value=ee),title:a(e)("common.testData"),value:p.value,language:"json","onUpdate:value":y[7]||(y[7]=ee=>p.value=ee),onClose:I},null,8,["visible","title","value"])],512))}}),bt={A3:{width:1123,height:1587},A4:{width:794,height:1123},A5:{width:559,height:794},LETTER:{width:816,height:1056},LEGAL:{width:816,height:1344},"Receipt 58mm":{width:219,height:794},"Receipt 80mm":{width:302,height:794},"241-1 (Full)":{width:911,height:1058},"241-2 (Half)":{width:911,height:529},"241-3 (Third)":{width:911,height:352}},cp={class:"relative"},hp={class:"flex items-center bg-gray-100 rounded-lg p-1"},pp=["title"],fp=["title"],mp={class:"truncate"},gp=["title"],vp={key:0,class:"absolute top-full left-0 mt-2 w-64 bg-white border border-gray-200 shadow-xl rounded-lg p-4 z-[1000]"},bp={class:"text-sm font-semibold text-gray-700 mb-3"},yp={class:"space-y-3"},wp={class:"block text-xs text-gray-500 mb-1"},xp=["value"],_p={value:"CUSTOM"},kp={class:"block text-xs text-gray-500 mb-1"},Sp=["value"],Cp={value:"mm"},Ep={value:"pt"},Tp={value:"px"},$p={class:"grid grid-cols-2 gap-2"},Ip={class:"block text-xs text-gray-500 mb-1"},Ap=["value"],zp={class:"block text-xs text-gray-500 mb-1"},Pp=["value"],Lp={class:"grid grid-cols-2 gap-2"},Mp={class:"block text-xs text-gray-500 mb-1"},Rp=["value"],Dp={class:"block text-xs text-gray-500 mb-1"},Bp=["value"],Op={class:"mt-4 flex items-center justify-between"},qp={class:"text-sm text-gray-700 font-medium"},Fp={class:"mt-3 flex items-center justify-between"},Np={class:"text-sm text-gray-700 font-medium"},jp={class:"mt-3 flex items-center justify-between"},Hp={class:"text-sm text-gray-700 font-medium"},Up={class:"mt-3 flex items-center justify-between"},Vp={class:"text-sm text-gray-700 font-medium"},Wp={key:0,class:"absolute inset-0 flex items-center justify-center"},Gp={class:"border-t border-gray-200 my-4 pt-3"},Kp={class:"text-sm font-semibold text-gray-700 mb-3"},Yp={class:"space-y-3"},Xp={class:"flex items-center justify-between"},Zp={class:"flex items-center gap-2"},Jp={class:"text-xs text-gray-600"},Qp={class:"flex items-center gap-1"},ef=["value"],tf={class:"text-xs text-gray-500"},rf={class:"flex items-center justify-between"},nf={class:"flex items-center gap-2"},of={class:"text-xs text-gray-600"},sf={class:"flex items-center gap-1"},af=["value"],lf={class:"text-xs text-gray-500"},df={class:"border-t border-gray-200 pt-3 mt-3"},uf={class:"bg-white rounded-lg shadow-xl w-[640px] max-w-full max-h-[90vh] flex flex-col overflow-hidden"},cf={class:"h-[60px] flex items-center justify-between px-4 border-b border-gray-200 shrink-0"},hf={class:"text-lg font-semibold text-gray-800"},pf={class:"p-4 overflow-y-auto space-y-4"},ff={class:"text-sm font-semibold text-gray-700 mb-3"},mf={class:"space-y-3"},gf={class:"flex items-center justify-between"},vf={class:"text-sm text-gray-700 font-medium"},bf={class:"block text-xs text-gray-500 mb-1"},yf=["placeholder"],wf={class:"grid grid-cols-2 gap-2"},xf={class:"block text-xs text-gray-500 mb-1"},_f={class:"block text-xs text-gray-500 mb-1"},kf={class:"grid grid-cols-2 gap-2"},Sf={class:"block text-xs text-gray-500 mb-1"},Cf={class:"block text-xs text-gray-500 mb-1"},Ef={class:"block text-xs text-gray-500 mb-1"},Tf={class:"p-4 border-t border-gray-200 bg-gray-50 flex justify-end"},$f=ze({__name:"PaperSettings",setup(r){const{t:e}=Ne(),t=Re(),s=le("A4"),n=le(bt.A4.width),l=le(bt.A4.height),i=le(!1),d=le(!1),c=fe({get:()=>t.canvasBackground,set:B=>t.setCanvasBackground(B)}),g=fe({get:()=>{var B;return((B=t.watermark)==null?void 0:B.text)||""},set:B=>t.setWatermark({text:B})}),w=fe({get:()=>{var B;return((B=t.watermark)==null?void 0:B.enabled)??!1},set:B=>t.setWatermark({enabled:!!B})}),m=fe({get:()=>{var B;return((B=t.watermark)==null?void 0:B.angle)??-30},set:B=>t.setWatermark({angle:Number(B)})}),_=fe({get:()=>{var B;return((B=t.watermark)==null?void 0:B.color)||"#000000"},set:B=>t.setWatermark({color:B})}),p=fe({get:()=>{var B;return Math.round((((B=t.watermark)==null?void 0:B.opacity)??.1)*100)},set:B=>{const A=Math.max(0,Math.min(100,Number(B)));t.setWatermark({opacity:A/100})}}),S=fe({get:()=>{var B;return T(((B=t.watermark)==null?void 0:B.size)??24)},set:B=>t.setWatermark({size:Ye(Number(B),t.unit)})}),v=fe({get:()=>{var B;return T(((B=t.watermark)==null?void 0:B.density)??160)},set:B=>t.setWatermark({density:Ye(Number(B),t.unit)})}),k=fe({get:()=>T(t.pageSpacingX||0),set:B=>t.setPageSpacingX(Ye(Number(B),t.unit))}),b=fe({get:()=>T(t.pageSpacingY||0),set:B=>t.setPageSpacingY(Ye(Number(B),t.unit))}),f=fe(()=>t.unit==="px"?e("common.px"):t.unit==="pt"?e("common.pt"):e("common.mm")),T=B=>{const A=ot(B,t.unit);return t.unit==="px"?Math.round(A):Number(A.toFixed(1))},D=()=>{if(s.value!=="CUSTOM"){const B=bt[s.value];n.value=B.width,l.value=B.height,t.setCanvasSize(B.width,B.height)}},j=()=>{t.setCanvasSize(n.value,l.value),Object.values(bt).some(B=>B.width===n.value&&B.height===l.value)||(s.value="CUSTOM")};return Ae(()=>t.canvasSize,B=>{n.value=B.width,l.value=B.height;const A=Object.entries(bt).find(([V,Y])=>Y.width===B.width&&Y.height===B.height);A?s.value=A[0]:s.value="CUSTOM"},{immediate:!0}),(B,A)=>(z(),F("div",cp,[o("div",hp,[o("button",{onClick:A[0]||(A[0]=V=>i.value=!i.value),class:"p-1 hover:bg-gray-200 rounded transition-colors",title:a(e)("editor.paperSettings")},[ce(a(Wt),{class:"w-4 h-4"})],8,pp),o("button",{onClick:A[1]||(A[1]=V=>i.value=!i.value),class:"flex items-center justify-center text-xs text-gray-700 hover:bg-gray-200 rounded px-1 py-0.5 transition-colors w-16 text-center",title:a(e)("editor.paperSettings")},[o("span",mp,E(s.value==="CUSTOM"?a(e)("editor.custom"):s.value),1)],8,fp),o("button",{onClick:A[2]||(A[2]=V=>i.value=!i.value),class:"p-1 hover:bg-gray-200 rounded transition-colors",title:a(e)("editor.paperSettings")},[ce(a(Io),{class:"w-4 h-4"})],8,gp)]),i.value?(z(),F("div",vp,[o("h3",bp,E(a(e)("editor.paperSettings")),1),o("div",yp,[o("div",null,[o("label",wp,E(a(e)("editor.sizePreset")),1),$e(o("select",{"onUpdate:modelValue":A[3]||(A[3]=V=>s.value=V),onChange:D,class:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded focus:border-blue-500 outline-none"},[(z(!0),F(Te,null,Le(a(bt),(V,Y)=>(z(),F("option",{key:Y,value:Y},E(Y)+" ("+E(T(V.width))+E(f.value)+" x "+E(T(V.height))+E(f.value)+") ",9,xp))),128)),o("option",_p,E(a(e)("editor.custom")),1)],544),[[Je,s.value]])]),o("div",null,[o("label",kp,E(a(e)("editor.unit")),1),o("select",{value:a(t).unit,onChange:A[4]||(A[4]=V=>a(t).setUnit(V.target.value)),class:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded focus:border-blue-500 outline-none"},[o("option",Cp,E(a(e)("common.mm")),1),o("option",Ep,E(a(e)("common.pt")),1),o("option",Tp,E(a(e)("common.px")),1)],40,Sp)]),o("div",$p,[o("div",null,[o("label",Ip,E(a(e)("common.width"))+" ("+E(f.value)+")",1),o("input",{type:"number",value:T(n.value),onChange:A[5]||(A[5]=V=>{n.value=a(Ye)(Number(V.target.value),a(t).unit),j()}),class:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:border-blue-500 outline-none"},null,40,Ap)]),o("div",null,[o("label",zp,E(a(e)("common.height"))+" ("+E(f.value)+")",1),o("input",{type:"number",value:T(l.value),onChange:A[6]||(A[6]=V=>{l.value=a(Ye)(Number(V.target.value),a(t).unit),j()}),class:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:border-blue-500 outline-none"},null,40,Pp)])]),o("div",Lp,[o("div",null,[o("label",Mp,E(a(e)("editor.spacingX"))+" ("+E(f.value)+")",1),o("input",{type:"number",value:k.value,onChange:A[7]||(A[7]=V=>{k.value=Number(V.target.value)}),class:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:border-blue-500 outline-none"},null,40,Rp)]),o("div",null,[o("label",Dp,E(a(e)("editor.spacingY"))+" ("+E(f.value)+")",1),o("input",{type:"number",value:b.value,onChange:A[8]||(A[8]=V=>{b.value=Number(V.target.value)}),class:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:border-blue-500 outline-none"},null,40,Bp)])]),o("div",null,[o("button",{onClick:A[9]||(A[9]=V=>d.value=!0),class:"w-full flex items-center justify-center gap-2 px-3 py-2 bg-blue-50 text-blue-700 hover:bg-blue-100 rounded-md transition-colors text-sm font-medium"},[ce(a(Wt),{class:"w-4 h-4"}),Ce(" "+E(a(e)("editor.advancedSettings")),1)])])]),o("div",Op,[o("span",qp,E(a(e)("editor.showCornerMarkers")),1),o("button",{onClick:A[10]||(A[10]=V=>a(t).setShowCornerMarkers(!a(t).showCornerMarkers)),class:xe(["relative inline-flex h-6 w-11 flex-shrink-0 cursor-pointer rounded-full border-2 border-transparent transition-colors duration-200 ease-in-out focus:outline-none focus:ring-2 focus:ring-blue-600 focus:ring-offset-2",a(t).showCornerMarkers?"bg-blue-600":"bg-gray-200"])},[A[30]||(A[30]=o("span",{class:"sr-only"},"Toggle corner markers",-1)),o("span",{"aria-hidden":"true",class:xe(["pointer-events-none inline-block h-5 w-5 transform rounded-full bg-white shadow ring-0 transition duration-200 ease-in-out",a(t).showCornerMarkers?"translate-x-5":"translate-x-0"])},null,2)],2)]),o("div",Fp,[o("span",Np,E(a(e)("editor.showGrid")),1),o("button",{onClick:A[11]||(A[11]=V=>a(t).setShowGrid(!a(t).showGrid)),class:xe(["relative inline-flex h-6 w-11 flex-shrink-0 cursor-pointer rounded-full border-2 border-transparent transition-colors duration-200 ease-in-out focus:outline-none focus:ring-2 focus:ring-blue-600 focus:ring-offset-2",a(t).showGrid?"bg-blue-600":"bg-gray-200"])},[A[31]||(A[31]=o("span",{class:"sr-only"},"Toggle grid",-1)),o("span",{"aria-hidden":"true",class:xe(["pointer-events-none inline-block h-5 w-5 transform rounded-full bg-white shadow ring-0 transition duration-200 ease-in-out",a(t).showGrid?"translate-x-5":"translate-x-0"])},null,2)],2)]),o("div",jp,[o("span",Hp,E(a(e)("editor.showMinimap")),1),o("button",{onClick:A[12]||(A[12]=V=>a(t).setShowMinimap(!a(t).showMinimap)),class:xe(["relative inline-flex h-6 w-11 flex-shrink-0 cursor-pointer rounded-full border-2 border-transparent transition-colors duration-200 ease-in-out focus:outline-none focus:ring-2 focus:ring-blue-600 focus:ring-offset-2",a(t).showMinimap?"bg-blue-600":"bg-gray-200"])},[A[32]||(A[32]=o("span",{class:"sr-only"},"Toggle minimap",-1)),o("span",{"aria-hidden":"true",class:xe(["pointer-events-none inline-block h-5 w-5 transform rounded-full bg-white shadow ring-0 transition duration-200 ease-in-out",a(t).showMinimap?"translate-x-5":"translate-x-0"])},null,2)],2)]),o("div",Up,[o("span",Vp,E(a(e)("editor.backgroundColor")),1),ce(xt,{modelValue:c.value,"onUpdate:modelValue":A[13]||(A[13]=V=>c.value=V),"allow-transparent":!0,"default-color":"#ffffff",placement:"bottom-end"},{trigger:ct(({color:V,open:Y})=>[o("div",{class:xe(["w-8 h-6 rounded border border-gray-300 cursor-pointer relative overflow-hidden hover:border-blue-500 transition-colors",{"ring-2 ring-blue-500 ring-offset-1":Y}])},[A[34]||(A[34]=o("div",{class:"absolute inset-0 bg-[url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAIAAADZF8uwAAAAGUlEQVQYV2M4gwZ+5wNisxL//8n04mEeRAAAhNwX869V4DYAAAAASUVORK5CYII=')] opacity-50"},null,-1)),o("div",{class:"absolute inset-0",style:ye({backgroundColor:V==="transparent"?"transparent":V})},null,4),V==="transparent"?(z(),F("div",Wp,[...A[33]||(A[33]=[o("div",{class:"w-full h-[1px] bg-red-500 rotate-45"},null,-1)])])):be("",!0)],2)]),_:1},8,["modelValue"])]),o("div",Gp,[o("h3",Kp,E(a(e)("editor.headerFooter")),1),o("div",Yp,[o("div",Xp,[o("div",Zp,[o("button",{onClick:A[14]||(A[14]=V=>a(t).setShowHeaderLine(!a(t).showHeaderLine)),class:xe(["relative inline-flex h-5 w-9 flex-shrink-0 cursor-pointer rounded-full border-2 border-transparent transition-colors duration-200 ease-in-out focus:outline-none focus:ring-2 focus:ring-blue-600 focus:ring-offset-2",a(t).showHeaderLine?"bg-blue-600":"bg-gray-200"])},[A[35]||(A[35]=o("span",{class:"sr-only"},"Toggle header line",-1)),o("span",{"aria-hidden":"true",class:xe(["pointer-events-none inline-block h-4 w-4 transform rounded-full bg-white shadow ring-0 transition duration-200 ease-in-out",a(t).showHeaderLine?"translate-x-4":"translate-x-0"])},null,2)],2),o("label",Jp,E(a(e)("editor.headerLine")),1)]),o("div",Qp,[o("input",{type:"number",value:T(a(t).headerHeight),onChange:A[15]||(A[15]=V=>a(t).setHeaderHeight(a(Ye)(Number(V.target.value),a(t).unit))),class:"w-16 px-2 py-1 text-sm border border-gray-300 rounded focus:border-blue-500 outline-none text-right",min:"0"},null,40,ef),o("span",tf,E(f.value),1)])]),o("div",rf,[o("div",nf,[o("button",{onClick:A[16]||(A[16]=V=>a(t).setShowFooterLine(!a(t).showFooterLine)),class:xe(["relative inline-flex h-5 w-9 flex-shrink-0 cursor-pointer rounded-full border-2 border-transparent transition-colors duration-200 ease-in-out focus:outline-none focus:ring-2 focus:ring-blue-600 focus:ring-offset-2",a(t).showFooterLine?"bg-blue-600":"bg-gray-200"])},[A[36]||(A[36]=o("span",{class:"sr-only"},"Toggle footer line",-1)),o("span",{"aria-hidden":"true",class:xe(["pointer-events-none inline-block h-4 w-4 transform rounded-full bg-white shadow ring-0 transition duration-200 ease-in-out",a(t).showFooterLine?"translate-x-4":"translate-x-0"])},null,2)],2),o("label",of,E(a(e)("editor.footerLine")),1)]),o("div",sf,[o("input",{type:"number",value:T(a(t).footerHeight),onChange:A[17]||(A[17]=V=>a(t).setFooterHeight(a(Ye)(Number(V.target.value),a(t).unit))),class:"w-16 px-2 py-1 text-sm border border-gray-300 rounded focus:border-blue-500 outline-none text-right",min:"0"},null,40,af),o("span",lf,E(f.value),1)])])])]),o("div",df,[o("button",{onClick:A[18]||(A[18]=V=>{a(t).addPage(),i.value=!1}),class:"w-full flex items-center justify-center gap-2 px-3 py-2 bg-blue-50 text-blue-700 hover:bg-blue-100 rounded-md transition-colors text-sm font-medium"},[ce(a(Ao),{class:"w-4 h-4"}),o("span",null,E(a(e)("editor.addNewPage")),1)])]),o("div",{class:"fixed inset-0 z-[-1]",onClick:A[19]||(A[19]=V=>i.value=!1)})])):be("",!0),(z(),Pe(tt,{to:"body"},[d.value?(z(),F("div",{key:0,class:"fixed inset-0 z-[2000] flex items-center justify-center bg-black/50",onClick:A[29]||(A[29]=Ke(V=>d.value=!1,["self"]))},[o("div",uf,[o("div",cf,[o("h3",hf,E(a(e)("editor.advancedSettings")),1),o("button",{onClick:A[20]||(A[20]=V=>d.value=!1),class:"p-1 hover:bg-gray-100 rounded-full transition-colors text-gray-500"},[ce(a(vt),{class:"w-4 h-4"})])]),o("div",pf,[o("div",null,[o("h3",ff,E(a(e)("editor.watermark")),1),o("div",mf,[o("div",gf,[o("span",vf,E(a(e)("editor.watermarkEnable")),1),o("button",{onClick:A[21]||(A[21]=V=>w.value=!w.value),class:xe(["relative inline-flex h-6 w-11 flex-shrink-0 cursor-pointer rounded-full border-2 border-transparent transition-colors duration-200 ease-in-out focus:outline-none focus:ring-2 focus:ring-blue-600 focus:ring-offset-2",w.value?"bg-blue-600":"bg-gray-200"])},[A[37]||(A[37]=o("span",{class:"sr-only"},"Toggle watermark",-1)),o("span",{"aria-hidden":"true",class:xe(["pointer-events-none inline-block h-5 w-5 transform rounded-full bg-white shadow ring-0 transition duration-200 ease-in-out",w.value?"translate-x-5":"translate-x-0"])},null,2)],2)]),o("div",null,[o("label",bf,E(a(e)("editor.watermarkText")),1),$e(o("input",{"onUpdate:modelValue":A[22]||(A[22]=V=>g.value=V),type:"text",class:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded focus:border-blue-500 outline-none",placeholder:a(e)("editor.watermarkTextPlaceholder")},null,8,yf),[[De,g.value]])]),o("div",wf,[o("div",null,[o("label",xf,E(a(e)("editor.watermarkAngle")),1),$e(o("input",{"onUpdate:modelValue":A[23]||(A[23]=V=>m.value=V),type:"number",class:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:border-blue-500 outline-none"},null,512),[[De,m.value,void 0,{number:!0}]])]),o("div",null,[o("label",_f,E(a(e)("editor.watermarkOpacity")),1),$e(o("input",{"onUpdate:modelValue":A[24]||(A[24]=V=>p.value=V),type:"number",min:"0",max:"100",class:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:border-blue-500 outline-none"},null,512),[[De,p.value,void 0,{number:!0}]])])]),o("div",kf,[o("div",null,[o("label",Sf,E(a(e)("editor.watermarkSize"))+" ("+E(f.value)+")",1),$e(o("input",{"onUpdate:modelValue":A[25]||(A[25]=V=>S.value=V),type:"number",min:"1",class:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:border-blue-500 outline-none"},null,512),[[De,S.value,void 0,{number:!0}]])]),o("div",null,[o("label",Cf,E(a(e)("editor.watermarkDensity"))+" ("+E(f.value)+")",1),$e(o("input",{"onUpdate:modelValue":A[26]||(A[26]=V=>v.value=V),type:"number",min:"20",class:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:border-blue-500 outline-none"},null,512),[[De,v.value,void 0,{number:!0}]])])]),o("div",null,[o("label",Ef,E(a(e)("editor.watermarkColor")),1),ce(xt,{modelValue:_.value,"onUpdate:modelValue":A[27]||(A[27]=V=>_.value=V),"default-color":"#000000",placement:"bottom-end"},{trigger:ct(({color:V,open:Y})=>[o("div",{class:xe(["w-8 h-6 rounded border border-gray-300 cursor-pointer relative overflow-hidden hover:border-blue-500 transition-colors",{"ring-2 ring-blue-500 ring-offset-1":Y}])},[o("div",{class:"absolute inset-0",style:ye({backgroundColor:V})},null,4)],2)]),_:1},8,["modelValue"])])])])]),o("div",Tf,[o("button",{onClick:A[28]||(A[28]=V=>d.value=!1),class:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 transition-colors text-sm"},E(a(e)("common.close")),1)])])])):be("",!0)]))]))}}),If=()=>typeof navigator>"u"?!1:/Mac|iPod|iPhone|iPad/.test(navigator.platform),Me=r=>{const e=If();return r.map(t=>{switch(t.toLowerCase()){case"ctrl":case"control":return e?"⌘":"Ctrl";case"alt":return e?"⌥":"Alt";case"shift":return e?"⇧":"Shift";case"enter":return e?"⏎":"Enter";case"backspace":return e?"⌫":"Backspace";case"delete":return e?"⌦":"Del";case"esc":case"escape":return"Esc";default:return t.toUpperCase()}}).join(" + ")},Af={class:"bg-white rounded-lg shadow-xl w-[700px] max-w-full max-h-[90vh] flex flex-col overflow-hidden"},zf={class:"h-[56px] flex items-center justify-between px-4 border-b border-gray-200"},Pf={class:"text-lg font-semibold text-gray-800"},Lf={class:"flex-1 overflow-y-auto p-6 space-y-5 text-sm text-gray-700"},Mf={class:"space-y-3"},Rf={class:"font-medium text-gray-900"},Df={key:0,class:"grid grid-cols-2 gap-4"},Bf={class:"flex flex-col gap-1 col-span-2"},Of={class:"text-xs text-gray-500"},qf=["disabled"],Ff={value:""},Nf=["value","disabled"],jf={class:"grid grid-cols-2 gap-4"},Hf={class:"flex flex-col gap-1"},Uf={class:"text-xs text-gray-500"},Vf=["disabled"],Wf={value:""},Gf=["value"],Kf={class:"flex flex-col gap-1"},Yf={class:"text-xs text-gray-500"},Xf=["placeholder"],Zf={key:1,class:"text-xs text-red-600"},Jf={key:2,class:"text-xs text-gray-500"},Qf={key:3,class:"text-xs text-gray-500"},em={key:4,class:"text-xs text-gray-500"},tm={class:"grid grid-cols-3 gap-4"},rm={class:"flex flex-col gap-1"},nm={class:"text-xs text-gray-500"},om={class:"flex flex-col gap-1"},sm={class:"text-xs text-gray-500"},am={class:"flex flex-col gap-1"},lm={class:"text-xs text-gray-500"},im=["placeholder"],dm={class:"grid grid-cols-3 gap-4"},um={class:"flex flex-col gap-1"},cm={class:"text-xs text-gray-500"},hm={value:""},pm={value:"odd"},fm={value:"even"},mm={class:"flex flex-col gap-1"},gm={class:"text-xs text-gray-500"},vm={value:"noscale"},bm={value:"shrink"},ym={value:"fit"},wm={class:"flex flex-col gap-1"},xm={class:"text-xs text-gray-500"},_m={value:"portrait"},km={value:"landscape"},Sm={class:"space-y-3"},Cm={class:"font-medium text-gray-900"},Em={class:"grid grid-cols-2 gap-4"},Tm={class:"flex flex-col gap-1"},$m={class:"text-xs text-gray-500"},Im=["disabled"],Am={value:"color"},zm={value:"monochrome"},Pm={class:"flex flex-col gap-1"},Lm={class:"text-xs text-gray-500"},Mm=["disabled"],Rm={value:"simplex"},Dm={value:"duplex"},Bm={value:"duplexshort"},Om={value:"duplexlong"},qm={class:"grid grid-cols-2 gap-4"},Fm={class:"flex flex-col gap-1"},Nm={class:"text-xs text-gray-500"},jm=["value"],Hm=["placeholder"],Um={class:"flex flex-col gap-1"},Vm={class:"text-xs text-gray-500"},Wm=["placeholder"],Gm={class:"p-4 border-t border-gray-200 bg-gray-50 flex justify-end gap-3 rounded-b-lg"},Km=ze({__name:"PrintDialog",props:{show:{type:Boolean},mode:{},options:{}},emits:["update:show","confirm"],setup(r,{emit:e}){const t=r,s=e,{t:n}=Ne(),l=Re(),{localPrinters:i,remotePrinters:d,remoteClients:c,remoteSelectedClientId:g,localPrinterCaps:w,fetchLocalPrinters:m,fetchRemoteClients:_,fetchRemotePrinters:p,fetchLocalPrinterCaps:S}=er(),v=le(!1),k=le(!1),b=le(""),f=le(""),T=yt({printer:"",jobName:"",copies:1,intervalMs:0,pageRange:"",pageSet:"",scale:"fit",orientation:"portrait",colorMode:"color",sidesMode:"simplex",paperSize:"",trayBin:""});Ae(()=>t.show,te=>{te&&(Object.assign(T,JSON.parse(JSON.stringify(t.options))),f.value=g.value||"",I(),l.setDisableGlobalShortcuts(!0))}),Ae(()=>t.show,te=>{te||l.setDisableGlobalShortcuts(!1)}),Ae(()=>t.mode,()=>{t.show&&I()});const D=fe(()=>(t.mode==="remote"?d.value:i.value)||[]),j=fe(()=>c.value||[]),B=fe(()=>{if(!(t.mode!=="local"||!T.printer))return w[T.printer]}),A=fe(()=>{var W;if(t.mode!=="local")return[];const te=B.value,$=(W=te==null?void 0:te.printerPaperNames)!=null&&W.length?te.printerPaperNames:(te==null?void 0:te.paperSizes)||[];return Array.from(new Set($)).filter(Boolean)}),V=fe(()=>D.value.map(te=>{if(t.mode==="local"){const W=te;return{key:W.name,label:W.name}}const $=te;return{key:$.printer_name,label:$.printer_name}})),Y=fe(()=>{var te;return t.mode!=="local"?!0:((te=B.value)==null?void 0:te.colorSupported)!==!1}),se=fe(()=>{var te;return t.mode!=="local"?!0:((te=B.value)==null?void 0:te.duplexSupported)!==!1}),G=fe(()=>{if(t.mode==="remote")return(d.value||[]).find(te=>te.printer_name===T.printer)}),I=async()=>{v.value=!0,b.value="";try{if(t.mode==="remote"?(await _(),(!f.value||!j.value.some(te=>te.client_id===f.value))&&(f.value=g.value||""),f.value?await p(f.value):d.value=[]):t.mode==="local"&&await m(),!T.printer&&D.value.length>0){const te=t.mode==="local"&&D.value.find($=>$.isDefault)||D.value[0];T.printer=t.mode==="local"?te.name:te.printer_name}t.mode==="local"&&T.printer&&await q(T.printer)}catch(te){b.value=te.message||n("printDialog.printerLoadFailed")}finally{v.value=!1}},q=async te=>{if(!(!te||t.mode!=="local")){k.value=!0;try{await S(te)}finally{k.value=!1}}};Ae(f,async(te,$)=>{if(!(!t.show||t.mode!=="remote"||te===$)){g.value=te,T.printer="",v.value=!0,b.value="";try{te?await p(te):d.value=[]}catch(W){b.value=W.message||n("printDialog.printerLoadFailed")}finally{v.value=!1}}}),Ae(()=>T.printer,async(te,$)=>{if(!(!t.show||te===$)){if(t.mode==="local")await q(te),A.value.length&&!T.paperSize&&(T.paperSize=A.value[0]);else if(t.mode==="remote"){const W=(d.value||[]).find(L=>L.printer_name===te);W!=null&&W.paper_spec&&!T.paperSize&&(T.paperSize=W.paper_spec)}}}),Ae(B,te=>{te&&(te.colorSupported===!1&&T.colorMode==="color"&&(T.colorMode="monochrome"),te.duplexSupported===!1&&T.sidesMode.startsWith("duplex")&&(T.sidesMode="simplex"))});const h=()=>{s("update:show",!1)},y=te=>{t.show&&te.key==="Escape"&&(te.preventDefault(),h())},ee=()=>{s("confirm",JSON.parse(JSON.stringify(T)))},K=fe(()=>t.mode==="local"?n("printDialog.titleLocal"):t.mode==="remote"?n("printDialog.titleRemote"):n("printDialog.title"));return We(()=>{window.addEventListener("keydown",y)}),Ge(()=>{window.removeEventListener("keydown",y),t.show&&l.setDisableGlobalShortcuts(!1)}),(te,$)=>(z(),Pe(tt,{to:"body"},[r.show?(z(),F("div",{key:0,class:"fixed inset-0 z-[99999] flex items-center justify-center bg-black/50",onClick:Ke(h,["self"])},[o("div",Af,[o("div",zf,[o("h3",Pf,E(K.value),1),o("button",{onClick:h,class:"p-1 hover:bg-gray-100 rounded-full transition-colors text-gray-500"},[ce(a(vt),{class:"w-4 h-4"})])]),o("div",Lf,[o("div",Mf,[o("div",Rf,E(a(n)("printDialog.sectionBasic")),1),t.mode==="remote"?(z(),F("div",Df,[o("label",Bf,[o("span",Of,E(a(n)("printDialog.remoteClient")),1),$e(o("select",{"onUpdate:modelValue":$[0]||($[0]=W=>f.value=W),class:"w-full px-3 py-2 border rounded bg-white focus:ring-2 focus:ring-blue-600 focus:border-blue-600",disabled:v.value},[o("option",Ff,E(a(n)("printDialog.remoteClientPlaceholder")),1),(z(!0),F(Te,null,Le(j.value,W=>(z(),F("option",{key:W.client_id,value:W.client_id,disabled:W.online===!1},E(W.client_name||W.client_id)+E(W.online===!1?" (offline)":""),9,Nf))),128))],8,qf),[[Je,f.value]])])])):be("",!0),o("div",jf,[o("label",Hf,[o("span",Uf,E(a(n)("printDialog.printer")),1),$e(o("select",{"onUpdate:modelValue":$[1]||($[1]=W=>T.printer=W),class:"w-full px-3 py-2 border rounded bg-white focus:ring-2 focus:ring-blue-600 focus:border-blue-600",disabled:v.value||k.value||t.mode==="remote"&&!f.value},[o("option",Wf,E(a(n)("printDialog.printerSelect")),1),(z(!0),F(Te,null,Le(V.value,W=>(z(),F("option",{key:W.key,value:W.key},E(W.label),9,Gf))),128))],8,Vf),[[Je,T.printer]])]),o("label",Kf,[o("span",Yf,E(a(n)("printDialog.jobName")),1),$e(o("input",{"onUpdate:modelValue":$[2]||($[2]=W=>T.jobName=W),type:"text",class:"w-full px-3 py-2 border rounded focus:ring-2 focus:ring-blue-600 focus:border-blue-600",placeholder:a(n)("printDialog.jobNamePlaceholder")},null,8,Xf),[[De,T.jobName]])])]),b.value?(z(),F("div",Zf,E(b.value),1)):t.mode==="remote"&&j.value.length===0?(z(),F("div",Jf,E(a(n)("printDialog.remoteClientEmpty")),1)):D.value.length===0?(z(),F("div",Qf,E(a(n)("printDialog.printerEmpty")),1)):be("",!0),t.mode==="remote"&&G.value?(z(),F("div",em,E(a(n)("printDialog.remotePrinterInfo",{type:G.value.printer_type||"-",paper:G.value.paper_spec||"-",format:G.value.supported_format||"-"})),1)):be("",!0),o("div",tm,[o("label",rm,[o("span",nm,E(a(n)("printDialog.copies")),1),$e(o("input",{"onUpdate:modelValue":$[3]||($[3]=W=>T.copies=W),type:"number",min:"1",class:"w-full px-3 py-2 border rounded focus:ring-2 focus:ring-blue-600 focus:border-blue-600"},null,512),[[De,T.copies,void 0,{number:!0}]])]),o("label",om,[o("span",sm,E(a(n)("printDialog.intervalMs")),1),$e(o("input",{"onUpdate:modelValue":$[4]||($[4]=W=>T.intervalMs=W),type:"number",min:"0",class:"w-full px-3 py-2 border rounded focus:ring-2 focus:ring-blue-600 focus:border-blue-600"},null,512),[[De,T.intervalMs,void 0,{number:!0}]])]),o("label",am,[o("span",lm,E(a(n)("printDialog.pageRange")),1),$e(o("input",{"onUpdate:modelValue":$[5]||($[5]=W=>T.pageRange=W),type:"text",class:"w-full px-3 py-2 border rounded focus:ring-2 focus:ring-blue-600 focus:border-blue-600",placeholder:a(n)("printDialog.pageRangePlaceholder")},null,8,im),[[De,T.pageRange]])])]),o("div",dm,[o("label",um,[o("span",cm,E(a(n)("printDialog.pageSet")),1),$e(o("select",{"onUpdate:modelValue":$[6]||($[6]=W=>T.pageSet=W),class:"w-full px-3 py-2 border rounded bg-white focus:ring-2 focus:ring-blue-600 focus:border-blue-600"},[o("option",hm,E(a(n)("printDialog.pageSetAll")),1),o("option",pm,E(a(n)("printDialog.pageSetOdd")),1),o("option",fm,E(a(n)("printDialog.pageSetEven")),1)],512),[[Je,T.pageSet]])]),o("label",mm,[o("span",gm,E(a(n)("printDialog.scale")),1),$e(o("select",{"onUpdate:modelValue":$[7]||($[7]=W=>T.scale=W),class:"w-full px-3 py-2 border rounded bg-white focus:ring-2 focus:ring-blue-600 focus:border-blue-600"},[o("option",vm,E(a(n)("printDialog.scaleNo")),1),o("option",bm,E(a(n)("printDialog.scaleShrink")),1),o("option",ym,E(a(n)("printDialog.scaleFit")),1)],512),[[Je,T.scale]])]),o("label",wm,[o("span",xm,E(a(n)("printDialog.orientation")),1),$e(o("select",{"onUpdate:modelValue":$[8]||($[8]=W=>T.orientation=W),class:"w-full px-3 py-2 border rounded bg-white focus:ring-2 focus:ring-blue-600 focus:border-blue-600"},[o("option",_m,E(a(n)("printDialog.portrait")),1),o("option",km,E(a(n)("printDialog.landscape")),1)],512),[[Je,T.orientation]])])])]),o("div",Sm,[o("div",Cm,E(a(n)("printDialog.sectionAdvanced")),1),o("div",Em,[o("label",Tm,[o("span",$m,E(a(n)("printDialog.colorMode")),1),$e(o("select",{"onUpdate:modelValue":$[9]||($[9]=W=>T.colorMode=W),class:"w-full px-3 py-2 border rounded bg-white focus:ring-2 focus:ring-blue-600 focus:border-blue-600",disabled:!Y.value},[o("option",Am,E(a(n)("printDialog.color")),1),o("option",zm,E(a(n)("printDialog.monochrome")),1)],8,Im),[[Je,T.colorMode]])]),o("label",Pm,[o("span",Lm,E(a(n)("printDialog.sidesMode")),1),$e(o("select",{"onUpdate:modelValue":$[10]||($[10]=W=>T.sidesMode=W),class:"w-full px-3 py-2 border rounded bg-white focus:ring-2 focus:ring-blue-600 focus:border-blue-600",disabled:!se.value},[o("option",Rm,E(a(n)("printDialog.simplex")),1),o("option",Dm,E(a(n)("printDialog.duplex")),1),o("option",Bm,E(a(n)("printDialog.duplexShort")),1),o("option",Om,E(a(n)("printDialog.duplexLong")),1)],8,Mm),[[Je,T.sidesMode]])])]),o("div",qm,[o("label",Fm,[o("span",Nm,E(a(n)("printDialog.paperSize")),1),A.value.length?$e((z(),F("select",{key:0,"onUpdate:modelValue":$[11]||($[11]=W=>T.paperSize=W),class:"w-full px-3 py-2 border rounded bg-white focus:ring-2 focus:ring-blue-600 focus:border-blue-600"},[(z(!0),F(Te,null,Le(A.value,W=>(z(),F("option",{key:W,value:W},E(W),9,jm))),128))],512)),[[Je,T.paperSize]]):$e((z(),F("input",{key:1,"onUpdate:modelValue":$[12]||($[12]=W=>T.paperSize=W),type:"text",class:"w-full px-3 py-2 border rounded focus:ring-2 focus:ring-blue-600 focus:border-blue-600",placeholder:a(n)("printDialog.paperSizePlaceholder")},null,8,Hm)),[[De,T.paperSize]])]),o("label",Um,[o("span",Vm,E(a(n)("printDialog.trayBin")),1),$e(o("input",{"onUpdate:modelValue":$[13]||($[13]=W=>T.trayBin=W),type:"text",class:"w-full px-3 py-2 border rounded focus:ring-2 focus:ring-blue-600 focus:border-blue-600",placeholder:a(n)("printDialog.trayBinPlaceholder")},null,8,Wm),[[De,T.trayBin]])])])])]),o("div",Gm,[o("button",{onClick:h,class:"px-4 py-2 border border-gray-300 rounded hover:bg-gray-100 text-sm text-gray-700"},E(a(n)("common.close")),1),o("button",{onClick:ee,class:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 transition-colors text-sm"},E(a(n)("printDialog.confirm")),1)])])])):be("",!0)]))}}),Ym={class:"flex items-center gap-4"},Xm={class:"flex items-center gap-2 bg-gray-100 rounded-lg p-1 px-2"},Zm=["disabled","title"],Jm=["value"],Qm={class:"flex items-center gap-1"},eg=["disabled"],tg=["disabled"],rg=["disabled"],ng=["disabled","title"],og=["disabled","title"],sg=["disabled","title"],ag=["disabled","title"],lg=["disabled","title"],ig=["disabled","title"],dg={class:"w-1 h-3.5 rounded-[1px] border border-gray-300 relative overflow-hidden bg-white"},ug={key:0,class:"absolute inset-0 bg-[url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAIAAADZF8uwAAAAGUlEQVQYV2M4gwZ+5wNisxL//8n04mEeRAAAhNwX869V4DYAAAAASUVORK5CYII=')] opacity-50 bg-repeat bg-[length:6px_6px]"},cg={key:1,class:"absolute inset-0 flex items-center justify-center"},hg=["disabled","title"],pg={class:"flex items-center gap-1 bg-gray-100 rounded-lg p-1"},fg=["disabled","title"],mg=["disabled","title"],gg=["disabled","title"],vg=["disabled","title"],bg=["disabled","title"],yg=["disabled","title"],wg=["disabled","title"],xg={class:"flex items-center gap-1 bg-gray-100 rounded-lg p-1"},_g=["disabled","title"],kg=["disabled","title"],Sg=["disabled","title"],Cg=["disabled","title"],Eg=["disabled","title"],Tg=["disabled","title"],$g={class:"relative"},Ig={class:"flex items-center bg-gray-100 rounded-lg p-1"},Ag=["title"],zg=["title"],Pg=["title"],Lg={key:0,class:"absolute top-full left-0 mt-2 w-64 bg-white border border-gray-200 shadow-xl rounded-lg p-4 z-[1000]"},Mg={class:"text-sm font-semibold text-gray-700 mb-3"},Rg={class:"space-y-3"},Dg={class:"block text-xs text-gray-500 mb-1"},Bg={class:"text-right text-xs text-gray-600 mt-1"},Og={class:"relative"},qg={class:"flex items-center shadow-sm"},Fg=["disabled"],Ng={key:0,class:"absolute top-full right-0 mt-2 w-max min-w-[160px] bg-white border border-gray-200 shadow-xl rounded-lg p-1 z-[1000] flex flex-col gap-1"},jg=ze({__name:"HeaderToolbar",emits:["toggleHelp","toggleSettings"],setup(r,{emit:e}){const t=e,{t:s}=Ne(),n=Re(),l=Jt(),{printMode:i,silentPrint:d,localPrintOptions:c,remotePrintOptions:g}=er(),w=fe(()=>i.value||"browser"),m=le(!1),_=le(""),p=le(""),S=le("json"),v=()=>{const Q={pages:Ee(n.pages),canvasSize:Ee(n.canvasSize),guides:Ee(n.guides),zoom:n.zoom,showGrid:n.showGrid,headerHeight:n.headerHeight,footerHeight:n.footerHeight,showHeaderLine:n.showHeaderLine,showFooterLine:n.showFooterLine,showMinimap:n.showMinimap,canvasBackground:n.canvasBackground};_.value=JSON.stringify(Q,null,2),p.value=s("preview.templateJson"),S.value="json",m.value=!0},k=le(!1),b=le(""),f=le("save"),{getPrintHtml:T,print:D,exportPdf:j,getPdfBlob:B,exportImages:A,getImageBlob:V}=Fl(),Y=async()=>{try{const Q=Array.from(document.querySelectorAll(".print-page")),H=await V(Q),me=new FileReader;me.readAsDataURL(H),me.onloadend=()=>{_.value=me.result,p.value=s("editor.viewImageBlob"),S.value="text",m.value=!0}}catch(Q){console.error(Q),alert("Failed to generate blob")}},se=async()=>{try{const Q=Array.from(document.querySelectorAll(".print-page")),H=await B(Q),me=new FileReader;me.readAsDataURL(H),me.onloadend=()=>{_.value=me.result,p.value=s("editor.viewPdfBlob"),S.value="text",m.value=!0}}catch(Q){console.error(Q),alert("Failed to generate PDF blob")}},G=le(!1),I=le(""),q=le(!1),h=le(!1),y=le(null),ee=fe(()=>i.value==="remote"?g:c),K=le(!1),te=le(Math.round(n.zoom*100)),$=fe({get:()=>n.selectedElement&&n.selectedElement.style.fontFamily||"",set:Q=>{n.updateSelectedElementsStyle({fontFamily:Q})}}),W=fe({get:()=>n.selectedElement&&n.selectedElement.style.fontSize||12,set:Q=>{n.updateSelectedElementsStyle({fontSize:Q})}}),L=fe(()=>{var Q,H;return((Q=n.selectedElement)==null?void 0:Q.style.fontWeight)==="700"||((H=n.selectedElement)==null?void 0:H.style.fontWeight)==="bold"}),O=fe(()=>{var Q;return((Q=n.selectedElement)==null?void 0:Q.style.fontStyle)==="italic"}),re=fe(()=>{var Q;return((Q=n.selectedElement)==null?void 0:Q.style.textDecoration)==="underline"}),Z=fe(()=>{var Q;return((Q=n.selectedElement)==null?void 0:Q.style.writingMode)==="vertical-rl"}),ne=fe({get:()=>{if(n.selectedElement)return n.selectedElement.style.color},set:Q=>{n.updateSelectedElementsStyle({color:Q})}}),ve=fe({get:()=>{if(n.selectedElement)return n.selectedElement.style.backgroundColor},set:Q=>{n.updateSelectedElementsStyle({backgroundColor:Q})}}),we=fe(()=>{var Q;return n.selectedElementIds.length===0?!1:((Q=n.selectedElement)==null?void 0:Q.locked)||!1}),ie=fe(()=>{var Q;return!n.selectedElementId||we.value||((Q=n.selectedElement)==null?void 0:Q.type)===ge.IMAGE}),ke=()=>{n.updateSelectedElementsStyle({fontWeight:L.value?"400":"700"})},_e=()=>{n.updateSelectedElementsStyle({fontStyle:O.value?"normal":"italic"})},oe=()=>{n.updateSelectedElementsStyle({textDecoration:re.value?"none":"underline"})},ue=()=>{n.updateSelectedElementsStyle({writingMode:Z.value?"horizontal-tb":"vertical-rl"})},J=()=>{n.updateSelectedElementsStyle({rotate:0})},u=fe(()=>[{label:s("editor.fonts.default"),value:""},{label:s("editor.fonts.arial"),value:"Arial, sans-serif"},{label:s("editor.fonts.timesNewRoman"),value:'"Times New Roman", serif'},{label:s("editor.fonts.courierNew"),value:'"Courier New", monospace'},{label:s("editor.fonts.simSun"),value:"SimSun, serif"},{label:s("editor.fonts.simHei"),value:"SimHei, sans-serif"}]),U=()=>{const Q=Math.round(n.zoom*100),H=Math.min(Q+10,500);n.setZoom(H/100),te.value=H},P=()=>{const Q=Math.round(n.zoom*100),H=Math.max(Q-10,20);n.setZoom(H/100),te.value=H};Ae(()=>n.zoom,Q=>{te.value=Math.round(Q*100)});const x=()=>{const Q=Math.max(20,Math.min(500,te.value));te.value=Q,n.setZoom(Q/100)},C=async()=>{try{I.value=await T(),G.value=!0}catch(Q){console.error(Q),alert("Preview generation failed")}},N=async()=>{const Q=Array.from(document.querySelectorAll(".print-page"));if(i.value!=="browser"&&!d.value){y.value=Q,h.value=!0;return}await D(Q,{mode:w.value})},M=async Q=>{i.value==="local"&&Object.assign(c,Q),i.value==="remote"&&Object.assign(g,Q);const H=y.value||Array.from(document.querySelectorAll(".print-page"));y.value=null,h.value=!1,await D(H,{mode:w.value,options:Q})},X=async()=>{const Q=pe();await j(void 0,`${Q}.pdf`)},R=async()=>{const Q=pe();await A(void 0,Q)},ae=()=>{if(l.currentTemplateId){const Q=l.templates.find(H=>H.id===l.currentTemplateId);if(Q){l.saveCurrentTemplate(Q.name);return}}f.value="save",b.value="",k.value=!0},he=()=>{f.value="saveAs";const Q=l.templates.find(H=>H.id===l.currentTemplateId);b.value=Q?`${Q.name} Copy`:"",k.value=!0},de=Q=>{f.value==="saveAs"?l.createTemplate(Q):l.saveCurrentTemplate(Q),k.value=!1},pe=()=>{const Q=l.templates.find(Fe=>Fe.id===l.currentTemplateId),me=((Q==null?void 0:Q.name)||"print-design").trim().replace(/[\\/:*?"<>|]/g,"-").replace(/\s+/g," ").trim()||"print-design",Oe=new Date,Be=Oe.getFullYear(),Ue=String(Oe.getMonth()+1).padStart(2,"0"),Ie=String(Oe.getDate()).padStart(2,"0");return`${me}-${Be}${Ue}${Ie}`};return We(()=>{window.addEventListener("designer:preview",C),window.addEventListener("designer:save",ae),window.addEventListener("designer:save-as",he),window.addEventListener("designer:print",N),window.addEventListener("designer:export-pdf",X),window.addEventListener("designer:view-json",v),window.addEventListener("designer:view-blob",Y)}),Ge(()=>{window.removeEventListener("designer:preview",C),window.removeEventListener("designer:save",ae),window.removeEventListener("designer:save-as",he),window.removeEventListener("designer:print",N),window.removeEventListener("designer:export-pdf",X),window.removeEventListener("designer:view-json",v),window.removeEventListener("designer:view-blob",Y)}),(Q,H)=>(z(),F(Te,null,[o("div",Ym,[ce(up),ce(qt,{show:k.value,title:f.value==="saveAs"?a(s)("editor.saveAsTemplate"):a(s)("editor.saveTemplate"),"initial-value":b.value,onClose:H[0]||(H[0]=me=>k.value=!1),onSave:de},null,8,["show","title","initial-value"]),o("div",Xm,[$e(o("select",{"onUpdate:modelValue":H[1]||(H[1]=me=>$.value=me),disabled:ie.value,class:"w-32 text-sm bg-transparent border-none outline-none focus:ring-0 cursor-pointer disabled:cursor-not-allowed disabled:opacity-50",title:a(s)("editor.fontFamily")},[(z(!0),F(Te,null,Le(u.value,me=>(z(),F("option",{key:me.value,value:me.value},E(me.label),9,Jm))),128))],8,Zm),[[Je,$.value]]),H[39]||(H[39]=o("div",{class:"w-px h-4 bg-gray-300"},null,-1)),o("div",Qm,[o("button",{onClick:H[2]||(H[2]=me=>W.value--),disabled:ie.value,class:"w-6 h-6 flex items-center justify-center hover:bg-gray-200 rounded text-sm font-medium disabled:opacity-50 disabled:cursor-not-allowed"},"-",8,eg),$e(o("input",{type:"number","onUpdate:modelValue":H[3]||(H[3]=me=>W.value=me),disabled:ie.value,class:"w-12 text-center text-sm bg-transparent border-none outline-none focus:ring-0 p-0 disabled:opacity-50 disabled:cursor-not-allowed [appearance:textfield] [-moz-appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none",min:"1",max:"200"},null,8,tg),[[De,W.value]]),o("button",{onClick:H[4]||(H[4]=me=>W.value++),disabled:ie.value,class:"w-6 h-6 flex items-center justify-center hover:bg-gray-200 rounded text-sm font-medium disabled:opacity-50 disabled:cursor-not-allowed"},"+",8,rg)]),H[40]||(H[40]=o("div",{class:"w-px h-4 bg-gray-300"},null,-1)),o("button",{onClick:ke,disabled:ie.value,class:xe(["p-1 hover:bg-gray-200 rounded transition-colors disabled:opacity-50 disabled:cursor-not-allowed",{"bg-gray-300 text-blue-700":L.value}]),title:a(s)("editor.bold")},[ce(a(Vu),{class:"w-4 h-4"})],10,ng),o("button",{onClick:_e,disabled:ie.value,class:xe(["p-1 hover:bg-gray-200 rounded transition-colors disabled:opacity-50 disabled:cursor-not-allowed",{"bg-gray-300 text-blue-700":O.value}]),title:a(s)("editor.italic")},[ce(a(Ku),{class:"w-4 h-4"})],10,og),o("button",{onClick:oe,disabled:ie.value,class:xe(["p-1 hover:bg-gray-200 rounded transition-colors disabled:opacity-50 disabled:cursor-not-allowed",{"bg-gray-300 text-blue-700":re.value}]),title:a(s)("editor.underline")},[ce(a(Zu),{class:"w-4 h-4"})],10,sg),o("button",{onClick:ue,disabled:ie.value,class:xe(["p-1 hover:bg-gray-200 rounded transition-colors disabled:opacity-50 disabled:cursor-not-allowed",{"bg-gray-300 text-blue-700":Z.value}]),title:a(s)("editor.verticalText")},[ce(a(ec),{class:"w-4 h-4"})],10,ag),ce(xt,{modelValue:ne.value,"onUpdate:modelValue":H[5]||(H[5]=me=>ne.value=me),disabled:ie.value,"default-color":"#000000"},{trigger:ct(({color:me})=>[o("button",{type:"button",class:"flex items-center gap-1 p-1 hover:bg-gray-200 rounded transition-colors disabled:opacity-50 disabled:cursor-not-allowed",disabled:ie.value,title:a(s)("editor.textColor")},[ce(a(ic),{class:"w-4 h-4"}),o("div",{class:"w-1 h-3.5 rounded-[1px] border border-gray-300",style:ye({backgroundColor:me})},null,4)],8,lg)]),_:1},8,["modelValue","disabled"]),ce(xt,{modelValue:ve.value,"onUpdate:modelValue":H[6]||(H[6]=me=>ve.value=me),disabled:ie.value,"allow-transparent":!0,"default-color":"transparent"},{trigger:ct(({color:me})=>[o("button",{type:"button",class:"flex items-center gap-1 p-1 hover:bg-gray-200 rounded transition-colors disabled:opacity-50 disabled:cursor-not-allowed",disabled:ie.value,title:a(s)("editor.backgroundColor")},[ce(a(cc),{class:"w-4 h-4"}),o("div",dg,[me==="transparent"?(z(),F("div",ug)):be("",!0),o("div",{class:"absolute inset-0",style:ye({backgroundColor:me==="transparent"?"transparent":me})},null,4),me==="transparent"?(z(),F("div",cg,[...H[38]||(H[38]=[o("div",{class:"w-full h-[1px] bg-red-500 rotate-90 transform scale-150"},null,-1)])])):be("",!0)])],8,ig)]),_:1},8,["modelValue","disabled"]),H[41]||(H[41]=o("div",{class:"w-px h-4 bg-gray-300"},null,-1)),o("button",{onClick:J,disabled:we.value||!a(n).selectedElementId,class:"p-1 hover:bg-gray-200 rounded transition-colors disabled:opacity-50 disabled:cursor-not-allowed",title:a(s)("editor.resetRotation")},[ce(a(nc),{class:"w-4 h-4"})],8,hg)]),H[47]||(H[47]=o("div",{class:"h-6 w-px bg-gray-300"},null,-1)),o("div",pg,[o("button",{onClick:H[7]||(H[7]=me=>a(n).alignSelectedElements("left")),disabled:!a(n).selectedElementId||we.value,class:"p-1 hover:bg-gray-200 rounded disabled:opacity-30 disabled:cursor-not-allowed",title:a(s)("editor.alignLeft")},[ce(a(Tu),{class:"w-4 h-4"})],8,fg),o("button",{onClick:H[8]||(H[8]=me=>a(n).alignSelectedElements("center")),disabled:!a(n).selectedElementId||we.value,class:"p-1 hover:bg-gray-200 rounded disabled:opacity-30 disabled:cursor-not-allowed",title:a(s)("editor.alignCenter")},[ce(a(Au),{class:"w-4 h-4"})],8,mg),o("button",{onClick:H[9]||(H[9]=me=>a(n).alignSelectedElements("right")),disabled:!a(n).selectedElementId||we.value,class:"p-1 hover:bg-gray-200 rounded disabled:opacity-30 disabled:cursor-not-allowed",title:a(s)("editor.alignRight")},[ce(a(Lu),{class:"w-4 h-4"})],8,gg),H[43]||(H[43]=o("div",{class:"w-px h-4 bg-gray-300 mx-1"},null,-1)),o("button",{onClick:H[10]||(H[10]=me=>a(n).alignSelectedElements("top")),disabled:!a(n).selectedElementId||we.value,class:"p-1 hover:bg-gray-200 rounded disabled:opacity-30 disabled:cursor-not-allowed",title:a(s)("editor.alignTop")},[ce(a(Du),{class:"w-4 h-4"})],8,vg),o("button",{onClick:H[11]||(H[11]=me=>a(n).alignSelectedElements("middle")),disabled:!a(n).selectedElementId||we.value,class:"p-1 hover:bg-gray-200 rounded disabled:opacity-30 disabled:cursor-not-allowed",title:a(s)("editor.alignMiddle")},[ce(a(qu),{class:"w-4 h-4"})],8,bg),o("button",{onClick:H[12]||(H[12]=me=>a(n).alignSelectedElements("bottom")),disabled:!a(n).selectedElementId||we.value,class:"p-1 hover:bg-gray-200 rounded disabled:opacity-30 disabled:cursor-not-allowed",title:a(s)("editor.alignBottom")},[ce(a(ju),{class:"w-4 h-4"})],8,yg),a(n).selectedElementIds.length>1?(z(),F(Te,{key:0},[H[42]||(H[42]=o("div",{class:"w-px h-4 bg-gray-300 mx-1"},null,-1)),o("button",{onClick:H[13]||(H[13]=me=>a(n).groupSelectedElements()),disabled:we.value,class:"p-1 hover:bg-gray-200 rounded disabled:opacity-30 disabled:cursor-not-allowed",title:a(s)("editor.group")},[ce(a(gc),{class:"w-4 h-4"})],8,wg)],64)):be("",!0)]),H[48]||(H[48]=o("div",{class:"h-6 w-px bg-gray-300"},null,-1)),o("div",xg,[o("button",{onClick:H[14]||(H[14]=me=>a(n).undo()),disabled:a(n).historyPast.length===0,class:"p-1 hover:bg-gray-200 rounded disabled:opacity-30 disabled:cursor-not-allowed",title:a(s)("common.undo")+" ("+a(Me)(["Ctrl","Z"])+")"},[ce(a(Bl),{class:"w-4 h-4"})],8,_g),o("button",{onClick:H[15]||(H[15]=me=>a(n).redo()),disabled:a(n).historyFuture.length===0,class:"p-1 hover:bg-gray-200 rounded disabled:opacity-30 disabled:cursor-not-allowed",title:a(s)("common.redo")+" ("+a(Me)(["Ctrl","Y"])+")"},[ce(a(Ol),{class:"w-4 h-4"})],8,kg),H[44]||(H[44]=o("div",{class:"w-px h-4 bg-gray-300 mx-1"},null,-1)),o("button",{onClick:H[16]||(H[16]=me=>a(n).copy()),disabled:!a(n).selectedElementId||we.value,class:"p-1 hover:bg-gray-200 rounded disabled:opacity-30 disabled:cursor-not-allowed",title:a(s)("common.copy")+" ("+a(Me)(["Ctrl","C"])+")"},[ce(a(Ct),{class:"w-4 h-4"})],8,Sg),o("button",{onClick:H[17]||(H[17]=me=>a(n).paste()),disabled:a(n).clipboard.length===0,class:"p-1 hover:bg-gray-200 rounded disabled:opacity-30 disabled:cursor-not-allowed",title:a(s)("common.paste")+" ("+a(Me)(["Ctrl","V"])+")"},[ce(a($o),{class:"w-4 h-4"})],8,Cg),H[45]||(H[45]=o("div",{class:"w-px h-4 bg-gray-300 mx-1"},null,-1)),o("button",{onClick:H[18]||(H[18]=me=>a(n).toggleLock()),disabled:!a(n).selectedElementId,class:"p-1 hover:bg-gray-200 rounded disabled:opacity-30 disabled:cursor-not-allowed",title:(we.value?a(s)("editor.unlock"):a(s)("editor.lock"))+" ("+a(Me)(["Ctrl","L"])+")"},[we.value?(z(),Pe(a(ql),{key:0,class:"w-4 h-4 text-red-500"})):(z(),Pe(a(Qt),{key:1,class:"w-4 h-4"}))],8,Eg),o("button",{onClick:H[19]||(H[19]=me=>a(n).removeSelectedElements()),disabled:!a(n).selectedElementId||we.value,class:"p-1 hover:bg-gray-200 rounded disabled:opacity-30 disabled:cursor-not-allowed",title:a(s)("common.delete")+" ("+a(Me)(["Del"])+")"},[ce(a(St),{class:"w-4 h-4"})],8,Tg)]),H[49]||(H[49]=o("div",{class:"h-6 w-px bg-gray-300"},null,-1)),ce($f),o("div",$g,[o("div",Ig,[o("button",{onClick:P,class:"p-1 hover:bg-gray-200 rounded",title:a(s)("editor.zoomOut")},[ce(a(Rl),{class:"w-4 h-4"})],8,Ag),o("button",{onClick:H[20]||(H[20]=me=>K.value=!K.value),class:"text-xs w-12 text-center hover:bg-gray-200 rounded px-1 py-0.5",title:a(s)("editor.zoomSettings")},E(Math.round(a(n).zoom*100))+"% ",9,zg),o("button",{onClick:U,class:"p-1 hover:bg-gray-200 rounded",title:a(s)("editor.zoomIn")},[ce(a(Ml),{class:"w-4 h-4"})],8,Pg)]),K.value?(z(),F("div",Lg,[o("h3",Mg,E(a(s)("editor.zoomLevel")),1),o("div",Rg,[o("div",null,[o("label",Dg,E(a(s)("editor.zoomLevel"))+" (20% - 500%)",1),$e(o("input",{type:"range",min:"20",max:"500",step:"10","onUpdate:modelValue":H[21]||(H[21]=me=>te.value=me),onInput:x,class:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer [&::-webkit-slider-thumb]:appearance-none [&::-webkit-slider-thumb]:w-4 [&::-webkit-slider-thumb]:h-4 [&::-webkit-slider-thumb]:bg-blue-600 [&::-webkit-slider-thumb]:rounded-full [&::-webkit-slider-thumb]:cursor-pointer [&::-webkit-slider-thumb]:transition-all [&::-webkit-slider-thumb]:hover:scale-110 [&::-moz-range-thumb]:w-4 [&::-moz-range-thumb]:h-4 [&::-moz-range-thumb]:bg-blue-600 [&::-moz-range-thumb]:border-none [&::-moz-range-thumb]:rounded-full [&::-moz-range-thumb]:cursor-pointer [&::-moz-range-thumb]:transition-all [&::-moz-range-thumb]:hover:scale-110"},null,544),[[De,te.value,void 0,{number:!0}]]),o("div",Bg,E(te.value)+"%",1)])]),o("div",{class:"fixed inset-0 z-[-1]",onClick:H[22]||(H[22]=me=>K.value=!1)})])):be("",!0)]),H[50]||(H[50]=o("div",{class:"h-6 w-px bg-gray-300"},null,-1)),o("div",Og,[o("div",qg,[o("button",{onClick:ae,disabled:a(l).isSaving,class:"flex items-center gap-2 px-3 py-1.5 bg-blue-600 text-white rounded-l-md hover:bg-blue-700 transition-colors text-sm border-r border-blue-500 disabled:opacity-50 disabled:cursor-not-allowed"},[a(l).isSaving?(z(),Pe(a(mu),{key:0,class:"w-4 h-4 animate-spin"})):(z(),Pe(a(To),{key:1,class:"w-4 h-4"})),o("span",null,E(a(s)("common.save")),1)],8,Fg),o("button",{onClick:H[23]||(H[23]=me=>q.value=!q.value),class:"px-2 py-1.5 bg-blue-600 text-white rounded-r-md hover:bg-blue-700 transition-colors text-sm flex items-center"},[ce(a(Io),{class:"w-5 h-5"})])]),q.value?(z(),F("div",Ng,[o("button",{onClick:H[24]||(H[24]=me=>{he(),q.value=!1}),class:"w-full flex items-center gap-2 px-3 py-2 text-gray-700 hover:bg-gray-50 rounded text-sm text-left transition-colors whitespace-nowrap"},[ce(a(Dl),{class:"w-4 h-4 text-gray-500"}),o("span",null,E(a(s)("editor.saveAsTemplate")),1)]),o("button",{onClick:H[25]||(H[25]=me=>{C(),q.value=!1}),class:"w-full flex items-center gap-2 px-3 py-2 text-gray-700 hover:bg-gray-50 rounded text-sm text-left transition-colors whitespace-nowrap"},[ce(a(Xd),{class:"w-4 h-4 text-gray-500"}),o("span",null,E(a(s)("editor.preview")),1)]),o("button",{onClick:H[26]||(H[26]=me=>{N(),q.value=!1}),class:"w-full flex items-center gap-2 px-3 py-2 text-gray-700 hover:bg-gray-50 rounded text-sm text-left transition-colors whitespace-nowrap"},[ce(a(Eo),{class:"w-4 h-4 text-gray-500"}),o("span",null,E(a(s)("editor.print")),1)]),o("button",{onClick:H[27]||(H[27]=me=>{X(),q.value=!1}),class:"w-full flex items-center gap-2 px-3 py-2 text-gray-700 hover:bg-gray-50 rounded text-sm text-left transition-colors whitespace-nowrap"},[ce(a(Vt),{class:"w-4 h-4 text-gray-500"}),o("span",null,E(a(s)("editor.exportPdf")),1)]),o("button",{onClick:H[28]||(H[28]=me=>{R(),q.value=!1}),class:"w-full flex items-center gap-2 px-3 py-2 text-gray-700 hover:bg-gray-50 rounded text-sm text-left transition-colors whitespace-nowrap"},[ce(a(Vt),{class:"w-4 h-4 text-gray-500"}),o("span",null,E(a(s)("editor.exportImage")),1)]),o("button",{onClick:H[29]||(H[29]=me=>{Y(),q.value=!1}),class:"w-full flex items-center gap-2 px-3 py-2 text-gray-700 hover:bg-gray-50 rounded text-sm text-left transition-colors whitespace-nowrap"},[ce(a(ut),{class:"w-4 h-4 text-gray-500"}),o("span",null,E(a(s)("editor.viewImageBlob")),1)]),o("button",{onClick:H[30]||(H[30]=me=>{se(),q.value=!1}),class:"w-full flex items-center gap-2 px-3 py-2 text-gray-700 hover:bg-gray-50 rounded text-sm text-left transition-colors whitespace-nowrap"},[ce(a(ut),{class:"w-4 h-4 text-gray-500"}),o("span",null,E(a(s)("editor.viewPdfBlob")),1)]),o("button",{onClick:H[31]||(H[31]=me=>{v(),q.value=!1}),class:"w-full flex items-center gap-2 px-3 py-2 text-gray-700 hover:bg-gray-50 rounded text-sm text-left transition-colors whitespace-nowrap"},[ce(a(ut),{class:"w-4 h-4 text-gray-500"}),o("span",null,E(a(s)("editor.viewJson")),1)]),H[46]||(H[46]=o("div",{class:"h-px bg-gray-200 my-0.5"},null,-1)),o("button",{onClick:H[32]||(H[32]=me=>{t("toggleHelp"),q.value=!1}),class:"w-full flex items-center gap-2 px-3 py-2 text-gray-700 hover:bg-gray-50 rounded text-sm text-left transition-colors whitespace-nowrap"},[ce(a(Su),{class:"w-4 h-4 text-gray-500"}),o("span",null,E(a(s)("editor.help")),1)]),o("button",{onClick:H[33]||(H[33]=me=>{t("toggleSettings"),q.value=!1}),class:"w-full flex items-center gap-2 px-3 py-2 text-gray-700 hover:bg-gray-50 rounded text-sm text-left transition-colors whitespace-nowrap"},[ce(a(Wt),{class:"w-4 h-4 text-gray-500"}),o("span",null,E(a(s)("editor.settings")),1)])])):be("",!0),q.value?(z(),F("div",{key:1,class:"fixed inset-0 z-[999]",onClick:H[34]||(H[34]=me=>q.value=!1)})):be("",!0)])]),ce(eh,{visible:G.value,"onUpdate:visible":H[35]||(H[35]=me=>G.value=me),"html-content":I.value,width:a(n).canvasSize.width},null,8,["visible","html-content","width"]),ce(Km,{show:h.value,"onUpdate:show":H[36]||(H[36]=me=>h.value=me),mode:w.value,options:ee.value,onConfirm:M},null,8,["show","mode","options"]),ce(Ot,{visible:m.value,"onUpdate:visible":H[37]||(H[37]=me=>m.value=me),title:p.value,value:_.value,language:S.value,"read-only":""},null,8,["visible","title","value","language"])],64))}}),Hl="/Vue-Print-Designer/assets/logo-D22CyW4G.png";var Hg=Jl();const Ug={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function Vg(r,e){return z(),F("svg",Ug,[...e[0]||(e[0]=[o("path",{fill:"currentColor",d:"M4 19q-.825 0-1.412-.587T2 17V7q0-.825.588-1.412T4 5h16q.825 0 1.413.588T22 7v10q0 .825-.587 1.413T20 19zm4-3h8v-2H8zm-3-3h2v-2H5zm3 0h2v-2H8zm3 0h2v-2h-2zm3 0h2v-2h-2zm3 0h2v-2h-2zM5 10h2V8H5zm3 0h2V8H8zm3 0h2V8h-2zm3 0h2V8h-2zm3 0h2V8h-2z"},null,-1)])])}const Wg=Se({name:"material-symbols-keyboard",render:Vg}),Gg={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function Kg(r,e){return z(),F("svg",Gg,[...e[0]||(e[0]=[o("path",{fill:"currentColor",d:"M11 17h2v-6h-2zm1-8q.425 0 .713-.288T13 8t-.288-.712T12 7t-.712.288T11 8t.288.713T12 9m0 13q-2.075 0-3.9-.788t-3.175-2.137T2.788 15.9T2 12t.788-3.9t2.137-3.175T8.1 2.788T12 2t3.9.788t3.175 2.137T21.213 8.1T22 12t-.788 3.9t-2.137 3.175t-3.175 2.138T12 22"},null,-1)])])}const Yg=Se({name:"material-symbols-info",render:Kg}),Xg="vue-print-designer",Zg="0.9.4",Jg={"@guolao/vue-monaco-editor":"^1.6.0",canvg:"^4.0.3","dom-to-image-more":"^3.7.2",jszip:"^3.10.1",jsbarcode:"^3.12.3",jspdf:"^2.5.2",lodash:"^4.17.21",pinia:"^2.3.0",qrcode:"^1.5.4",uuid:"^11.0.3",vue:"^3.5.13","vue-i18n":"^11.2.8"},uo={name:Xg,version:Zg,dependencies:Jg},Qg={class:"bg-white rounded-lg shadow-xl w-[700px] max-w-full h-[500px] flex overflow-hidden"},e0={class:"w-48 bg-gray-50 border-r border-gray-200 flex flex-col"},t0={class:"h-[60px] flex items-center px-4 border-b border-gray-200"},r0={class:"text-lg font-semibold text-gray-800"},n0={class:"flex-1 py-2"},o0={class:"flex-1 flex flex-col min-w-0"},s0={class:"h-[60px] flex items-center justify-between px-4 border-b border-gray-200"},a0={class:"text-lg font-semibold text-gray-800"},l0={class:"flex-1 overflow-y-auto p-6"},i0={key:0,class:"space-y-6"},d0={class:"grid grid-cols-1 gap-6 text-sm"},u0={class:"font-medium text-gray-900 mb-3 border-b pb-1"},c0={class:"space-y-2 text-gray-600"},h0={class:"flex justify-between items-center"},p0={class:"bg-gray-100 px-2 py-0.5 rounded border text-xs"},f0={class:"flex justify-between items-center"},m0={class:"bg-gray-100 px-2 py-0.5 rounded border text-xs"},g0={class:"flex justify-between items-center"},v0={class:"bg-gray-100 px-2 py-0.5 rounded border text-xs"},b0={class:"flex justify-between items-center"},y0={class:"bg-gray-100 px-2 py-0.5 rounded border text-xs"},w0={class:"flex justify-between items-center"},x0={class:"bg-gray-100 px-2 py-0.5 rounded border text-xs"},_0={class:"flex justify-between items-center"},k0={class:"bg-gray-100 px-2 py-0.5 rounded border text-xs"},S0={class:"flex justify-between items-center"},C0={class:"bg-gray-100 px-2 py-0.5 rounded border text-xs"},E0={class:"flex justify-between items-center"},T0={class:"bg-gray-100 px-2 py-0.5 rounded border text-xs"},$0={class:"flex justify-between items-center"},I0={class:"bg-gray-100 px-2 py-0.5 rounded border text-xs"},A0={class:"flex justify-between items-center"},z0={class:"bg-gray-100 px-2 py-0.5 rounded border text-xs"},P0={class:"flex justify-between items-center"},L0={class:"bg-gray-100 px-2 py-0.5 rounded border text-xs"},M0={class:"flex justify-between items-center"},R0={class:"bg-gray-100 px-2 py-0.5 rounded border text-xs"},D0={class:"flex justify-between items-center"},B0={class:"bg-gray-100 px-2 py-0.5 rounded border text-xs"},O0={class:"font-medium text-gray-900 mb-3 border-b pb-1"},q0={class:"space-y-2 text-gray-600"},F0={class:"flex justify-between items-center"},N0={class:"bg-gray-100 px-2 py-0.5 rounded border text-xs"},j0={class:"flex justify-between items-center"},H0={class:"bg-gray-100 px-2 py-0.5 rounded border text-xs"},U0={class:"flex justify-between items-center"},V0={class:"bg-gray-100 px-2 py-0.5 rounded border text-xs"},W0={class:"flex justify-between items-center"},G0={class:"bg-gray-100 px-2 py-0.5 rounded border text-xs"},K0={class:"flex justify-between items-center"},Y0={class:"bg-gray-100 px-2 py-0.5 rounded border text-xs"},X0={class:"flex justify-between items-center"},Z0={class:"bg-gray-100 px-2 py-0.5 rounded border text-xs"},J0={class:"flex justify-between items-center"},Q0={class:"bg-gray-100 px-2 py-0.5 rounded border text-xs"},ev={class:"flex justify-between items-center"},tv={class:"bg-gray-100 px-2 py-0.5 rounded border text-xs"},rv={class:"flex justify-between items-center"},nv={class:"bg-gray-100 px-2 py-0.5 rounded border text-xs"},ov={class:"flex justify-between items-center"},sv={class:"bg-gray-100 px-2 py-0.5 rounded border text-xs"},av={class:"font-medium text-gray-900 mb-3 border-b pb-1"},lv={class:"space-y-2 text-gray-600"},iv={class:"flex justify-between items-center"},dv={class:"bg-gray-100 px-2 py-0.5 rounded border text-xs"},uv={class:"flex justify-between items-center"},cv={class:"bg-gray-100 px-2 py-0.5 rounded border text-xs"},hv={class:"flex justify-between items-center"},pv={class:"bg-gray-100 px-2 py-0.5 rounded border text-xs"},fv={class:"flex justify-between items-center"},mv={class:"bg-gray-100 px-2 py-0.5 rounded border text-xs"},gv={key:1,class:"space-y-6"},vv={class:"text-center mb-8"},bv={class:"text-xl font-bold text-gray-800"},yv={class:"mt-4 flex justify-center"},wv=["title"],xv={class:"text-gray-600"},_v={class:"font-medium text-gray-900 mb-3 border-b pb-1"},kv={class:"bg-gray-50 rounded-lg border border-gray-200 overflow-hidden"},Sv={class:"w-full text-sm text-left"},Cv={class:"bg-gray-100 text-gray-700 font-medium"},Ev={class:"px-4 py-2 border-b"},Tv={class:"px-4 py-2 border-b"},$v={class:"divide-y divide-gray-200"},Iv={class:"px-4 py-2 text-gray-700 font-mono"},Av={class:"px-4 py-2 text-gray-500"},zv={class:"p-4 border-t border-gray-200 bg-gray-50 flex justify-end rounded-br-lg"},Pv=ze({__name:"HelpModal",props:{show:{type:Boolean}},emits:["update:show"],setup(r,{emit:e}){const t=r,s=e,{t:n}=Ne(),l=Re(),i=le("shortcuts"),d=()=>{s("update:show",!1)},c=_=>{t.show&&_.key==="Escape"&&(_.preventDefault(),d())};We(()=>{window.addEventListener("keydown",c)}),Ae(()=>t.show,_=>{l.setDisableGlobalShortcuts(_)}),Ge(()=>{window.removeEventListener("keydown",c),t.show&&l.setDisableGlobalShortcuts(!1)});const g=Object.entries(uo.dependencies).map(([_,p])=>({name:_,version:p})),w=uo.version,m=Hg.startCase(uo.name);return(_,p)=>(z(),Pe(tt,{to:"body"},[r.show?(z(),F("div",{key:0,class:"fixed inset-0 z-[99999] flex items-center justify-center bg-black/50",onClick:Ke(d,["self"])},[o("div",Qg,[o("div",e0,[o("div",t0,[o("h3",r0,E(a(n)("help.title")),1)]),o("div",n0,[o("button",{onClick:p[0]||(p[0]=S=>i.value="shortcuts"),class:xe(["w-full text-left px-4 py-3 flex items-center gap-3 transition-colors text-sm",i.value==="shortcuts"?"bg-white text-blue-600 border-l-4 border-blue-600 font-medium":"text-gray-600 hover:bg-gray-100 border-l-4 border-transparent"])},[ce(a(Wg),{class:"w-5 h-5"}),Ce(" "+E(a(n)("shortcuts.title")),1)],2),o("button",{onClick:p[1]||(p[1]=S=>i.value="about"),class:xe(["w-full text-left px-4 py-3 flex items-center gap-3 transition-colors text-sm",i.value==="about"?"bg-white text-blue-600 border-l-4 border-blue-600 font-medium":"text-gray-600 hover:bg-gray-100 border-l-4 border-transparent"])},[ce(a(Yg),{class:"w-5 h-5"}),Ce(" "+E(a(n)("help.about")),1)],2)])]),o("div",o0,[o("div",s0,[o("h3",a0,E(i.value==="shortcuts"?a(n)("shortcuts.keyboardShortcuts"):a(n)("help.aboutProject",{name:a(m)})),1),o("button",{onClick:d,class:"p-1 hover:bg-gray-100 rounded-full transition-colors text-gray-500"},[ce(a(vt),{class:"w-4 h-4"})])]),o("div",l0,[i.value==="shortcuts"?(z(),F("div",i0,[o("div",d0,[o("div",null,[o("h4",u0,E(a(n)("shortcuts.general")),1),o("ul",c0,[o("li",h0,[o("span",null,E(a(n)("common.save")),1),p[2]||(p[2]=Ce()),o("kbd",p0,E(a(Me)(["Ctrl","S"])),1)]),o("li",f0,[o("span",null,E(a(n)("shortcuts.saveAsTemplate")),1),p[3]||(p[3]=Ce()),o("kbd",m0,E(a(Me)(["Ctrl","Shift","S"])),1)]),o("li",g0,[o("span",null,E(a(n)("editor.print")),1),p[4]||(p[4]=Ce()),o("kbd",v0,E(a(Me)(["Ctrl","P"])),1)]),o("li",b0,[o("span",null,E(a(n)("editor.exportPdf")),1),p[5]||(p[5]=Ce()),o("kbd",y0,E(a(Me)(["Ctrl","Shift","E"])),1)]),o("li",w0,[o("span",null,E(a(n)("editor.preview")),1),p[6]||(p[6]=Ce()),o("kbd",x0,E(a(Me)(["Ctrl","Shift","P"])),1)]),o("li",_0,[o("span",null,E(a(n)("editor.viewJson")),1),p[7]||(p[7]=Ce()),o("kbd",k0,E(a(Me)(["Ctrl","Shift","J"])),1)]),o("li",S0,[o("span",null,E(a(n)("shortcuts.newTemplate")),1),p[8]||(p[8]=Ce()),o("kbd",C0,E(a(Me)(["Ctrl","Alt","N"])),1)]),o("li",E0,[o("span",null,E(a(n)("shortcuts.openSettings")),1),p[9]||(p[9]=Ce()),o("kbd",T0,E(a(Me)(["Ctrl",","])),1)]),o("li",$0,[o("span",null,E(a(n)("common.undo")),1),p[10]||(p[10]=Ce()),o("kbd",I0,E(a(Me)(["Ctrl","Z"])),1)]),o("li",A0,[o("span",null,E(a(n)("common.redo")),1),p[11]||(p[11]=Ce()),o("kbd",z0,E(a(Me)(["Ctrl","Y"])),1)]),o("li",P0,[o("span",null,E(a(n)("shortcuts.openHelp")),1),p[12]||(p[12]=Ce()),o("kbd",L0,E(a(Me)(["Ctrl","H"])),1)]),o("li",M0,[o("span",null,E(a(n)("shortcuts.zoom")),1),p[13]||(p[13]=Ce()),o("kbd",R0,E(a(Me)(["Ctrl","Wheel"])),1)]),o("li",D0,[o("span",null,E(a(n)("shortcuts.closeModal")),1),p[14]||(p[14]=Ce()),o("kbd",B0,E(a(Me)(["Esc"])),1)])])]),o("div",null,[o("h4",O0,E(a(n)("shortcuts.editing")),1),o("ul",q0,[o("li",F0,[o("span",null,E(a(n)("common.copy")),1),p[15]||(p[15]=Ce()),o("kbd",N0,E(a(Me)(["Ctrl","C"])),1)]),o("li",j0,[o("span",null,E(a(n)("common.cut")),1),p[16]||(p[16]=Ce()),o("kbd",H0,E(a(Me)(["Ctrl","X"])),1)]),o("li",U0,[o("span",null,E(a(n)("common.paste")),1),p[17]||(p[17]=Ce()),o("kbd",V0,E(a(Me)(["Ctrl","V"])),1)]),o("li",W0,[o("span",null,E(a(n)("common.delete")),1),p[18]||(p[18]=Ce()),o("kbd",G0,E(a(Me)(["Delete"])),1)]),o("li",K0,[o("span",null,E(a(n)("shortcuts.selectAll")),1),p[19]||(p[19]=Ce()),o("kbd",Y0,E(a(Me)(["Ctrl","A"])),1)]),o("li",X0,[o("span",null,E(a(n)("shortcuts.multiSelect")),1),p[20]||(p[20]=Ce()),o("kbd",Z0,E(a(Me)(["Ctrl","Click"])),1)]),o("li",J0,[o("span",null,E(a(n)("common.lock"))+"/"+E(a(n)("common.unlock")),1),p[21]||(p[21]=Ce()),o("kbd",Q0,E(a(Me)(["Ctrl","L"])),1)]),o("li",ev,[o("span",null,E(a(n)("shortcuts.customEditSave")),1),p[22]||(p[22]=Ce()),o("kbd",tv,E(a(Me)(["Ctrl","S"])),1)]),o("li",rv,[o("span",null,E(a(n)("shortcuts.customEditSaveAs")),1),p[23]||(p[23]=Ce()),o("kbd",nv,E(a(Me)(["Ctrl","Shift","S"])),1)]),o("li",ov,[o("span",null,E(a(n)("shortcuts.customEditExit")),1),p[24]||(p[24]=Ce()),o("kbd",sv,E(a(Me)(["Ctrl","Q"])),1)])])]),o("div",null,[o("h4",av,E(a(n)("shortcuts.manipulation")),1),o("ul",lv,[o("li",iv,[o("span",null,E(a(n)("shortcuts.move")),1),p[25]||(p[25]=Ce()),o("kbd",dv,E(a(n)("shortcuts.arrow")),1)]),o("li",uv,[o("span",null,E(a(n)("shortcuts.fastMove")),1),p[26]||(p[26]=Ce()),o("kbd",cv,E(a(Me)(["Shift",a(n)("shortcuts.arrow")])),1)]),o("li",hv,[o("span",null,E(a(n)("shortcuts.snapRotate")),1),p[27]||(p[27]=Ce()),o("kbd",pv,E(a(Me)(["Shift",a(n)("shortcuts.drag")])),1)]),o("li",fv,[o("span",null,E(a(n)("shortcuts.resize")),1),p[28]||(p[28]=Ce()),o("kbd",mv,E(a(Me)(["Shift",a(n)("shortcuts.resize")])),1)])])])])])):be("",!0),i.value==="about"?(z(),F("div",gv,[o("div",vv,[p[32]||(p[32]=o("img",{src:Hl,alt:"Vue Print Designer",class:"w-12 h-12 mx-auto mb-2"},null,-1)),o("h2",bv,E(a(m)),1),o("div",yv,[o("a",{href:"https://github.com/0ldFive/Vue-Print-Designer",target:"_blank",rel:"noopener noreferrer",class:"group inline-flex items-center gap-2 rounded-full border border-gray-200 bg-gray-50 px-2.5 py-1 text-[11px] text-gray-700 shadow-sm transition-colors hover:border-blue-200 hover:bg-blue-50 hover:text-blue-700",title:a(n)("help.github")},[p[29]||(p[29]=o("span",{class:"inline-flex h-5 w-5 items-center justify-center rounded-full bg-white text-gray-700 shadow-sm transition-colors group-hover:text-blue-700"},[o("svg",{viewBox:"0 0 16 16","aria-hidden":"true",class:"w-3.5 h-3.5"},[o("path",{fill:"currentColor",d:"M8 0C3.58 0 0 3.73 0 8.35c0 3.7 2.29 6.83 5.47 7.94.4.08.55-.18.55-.4 0-.2-.01-.86-.01-1.56-2.01.38-2.53-.5-2.69-.96-.09-.24-.48-.96-.82-1.16-.28-.16-.68-.56-.01-.57.63-.01 1.08.6 1.23.85.72 1.25 1.87.9 2.33.69.07-.54.28-.9.51-1.11-1.78-.21-3.64-.92-3.64-4.08 0-.9.31-1.64.82-2.22-.08-.21-.36-1.06.08-2.2 0 0 .67-.22 2.2.85.64-.18 1.32-.27 2-.27s1.36.09 2 .27c1.53-1.07 2.2-.85 2.2-.85.44 1.14.16 1.99.08 2.2.51.58.82 1.32.82 2.22 0 3.17-1.87 3.87-3.65 4.08.29.26.54.77.54 1.56 0 1.12-.01 2.03-.01 2.32 0 .22.15.48.55.4C13.71 15.18 16 12.04 16 8.35 16 3.73 12.42 0 8 0z"})])],-1)),p[30]||(p[30]=o("span",{class:"text-gray-500 group-hover:text-blue-600"},"0ldFive/Vue-Print-Designer",-1)),p[31]||(p[31]=o("span",{class:"text-gray-400"},"|",-1)),o("span",xv,E(a(n)("help.version"))+" "+E(a(w)),1)],8,wv)])]),o("div",null,[o("h4",_v,E(a(n)("help.dependencies")),1),o("div",kv,[o("table",Sv,[o("thead",Cv,[o("tr",null,[o("th",Ev,E(a(n)("help.package")),1),o("th",Tv,E(a(n)("help.version")),1)])]),o("tbody",$v,[(z(!0),F(Te,null,Le(a(g),S=>(z(),F("tr",{key:S.name,class:"hover:bg-gray-50"},[o("td",Iv,E(S.name),1),o("td",Av,E(S.version),1)]))),128))])])])])])):be("",!0)]),o("div",zv,[o("button",{onClick:d,class:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 transition-colors text-sm"},E(a(n)("common.close")),1)])])])])):be("",!0)]))}}),Lv={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function Mv(r,e){return z(),F("svg",Lv,[...e[0]||(e[0]=[o("path",{fill:"currentColor",d:"m11.9 22l4.55-12h2.1l4.55 12H21l-1.075-3.05h-4.85L14 22zM4 19l-1.4-1.4l5.05-5.05q-.875-.875-1.588-2T4.75 8h2.1q.5.975 1 1.7t1.2 1.45q.825-.825 1.713-2.313T12.1 6H1V4h7V2h2v2h7v2h-2.9q-.525 1.8-1.575 3.7t-2.075 2.9l2.4 2.45l-.75 2.05l-3.05-3.125zm11.7-1.8h3.6l-1.8-5.1z"},null,-1)])])}const Rv=Se({name:"material-symbols-translate",render:Mv}),Dv={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function Bv(r,e){return z(),F("svg",Dv,[...e[0]||(e[0]=[o("path",{fill:"currentColor",d:"M6.5 20q-2.275 0-3.887-1.575T1 14.575q0-1.95 1.175-3.475T5.25 9.15q.625-2.3 2.5-3.725T12 4q2.925 0 4.963 2.038T19 11q1.725.2 2.863 1.488T23 15.5q0 1.875-1.312 3.188T18.5 20z"},null,-1)])])}const Ov=Se({name:"material-symbols-cloud",render:Bv}),qv={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function Fv(r,e){return z(),F("svg",qv,[...e[0]||(e[0]=[o("path",{fill:"currentColor",d:"M11 17H7q-2.075 0-3.537-1.463T2 12t1.463-3.537T7 7h4v2H7q-1.25 0-2.125.875T4 12t.875 2.125T7 15h4zm-3-4v-2h8v2zm5 4v-2h4q1.25 0 2.125-.875T20 12t-.875-2.125T17 9h-4V7h4q2.075 0 3.538 1.463T22 12t-1.463 3.538T17 17z"},null,-1)])])}const Va=Se({name:"material-symbols-link",render:Fv}),Nv={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function jv(r,e){return z(),F("svg",Nv,[...e[0]||(e[0]=[o("path",{fill:"currentColor",d:"m19.25 16.45l-1.5-1.55q1-.275 1.625-1.063T20 12q0-1.25-.875-2.125T17 9h-4V7h4q2.075 0 3.538 1.463T22 12q0 1.425-.737 2.625T19.25 16.45M15.85 13l-2-2H16v2zm3.95 9.6L1.4 4.2l1.4-1.4l18.4 18.4zM11 17H7q-2.075 0-3.537-1.463T2 12q0-1.725 1.05-3.075t2.7-1.775L7.6 9H7q-1.25 0-2.125.875T4 12t.875 2.125T7 15h4zm-3-4v-2h1.625l1.975 2z"},null,-1)])])}const Wa=Se({name:"material-symbols-link-off",render:jv}),Hv={class:"bg-white rounded-lg shadow-xl w-[700px] max-w-full h-[500px] flex overflow-hidden"},Uv={class:"w-48 bg-gray-50 border-r border-gray-200 flex flex-col"},Vv={class:"h-[60px] flex items-center px-4 border-b border-gray-200"},Wv={class:"text-lg font-semibold text-gray-800"},Gv={class:"flex-1 py-2"},Kv={class:"flex-1 flex flex-col min-w-0 relative"},Yv={class:"h-[60px] flex items-center justify-between px-4 border-b border-gray-200"},Xv={class:"text-lg font-semibold text-gray-800"},Zv={class:"flex-1 overflow-y-auto p-6"},Jv={key:0,class:"space-y-4 text-sm text-gray-700"},Qv={class:"mb-2 font-medium text-gray-900"},eb={class:"flex items-center gap-3"},tb={class:"text-xs text-gray-500 mt-2"},rb={class:"border-t border-gray-200 pt-4"},nb={class:"mb-2 font-medium text-gray-900"},ob={class:"flex flex-wrap gap-2"},sb=["onClick"],ab={class:"text-xs text-gray-500 mt-2"},lb={class:"border-t border-gray-200 pt-4"},ib={class:"flex items-center justify-between"},db={class:"font-medium text-gray-900"},ub={class:"sr-only"},cb={class:"text-xs text-gray-500 mt-2"},hb={class:"border-t border-gray-200 pt-4"},pb={class:"flex items-center justify-between"},fb={class:"font-medium text-gray-900"},mb={class:"sr-only"},gb={class:"text-xs text-gray-500 mt-2"},vb={class:"border-t border-gray-200 pt-4 space-y-3"},bb={class:"mb-2 font-medium text-gray-900"},yb={class:"flex items-center gap-3"},wb=["disabled"],xb=["disabled"],_b={class:"text-xs text-gray-500 mt-2"},kb={class:"flex items-center justify-between"},Sb={class:"font-medium text-gray-900"},Cb={class:"sr-only"},Eb={class:"text-xs text-gray-500"},Tb={key:1,class:"space-y-4 text-sm text-gray-700"},$b={class:"mb-2 font-medium text-gray-900"},Ib={class:"flex items-center gap-3"},Ab={class:"text-xs text-gray-500 mt-2"},zb={key:2,class:"space-y-4 text-sm text-gray-700"},Pb={class:"space-y-2"},Lb={class:"font-medium text-gray-900"},Mb={class:"text-xs text-gray-500"},Rb={class:"grid grid-cols-2 gap-4"},Db={class:"flex flex-col gap-1 col-span-2"},Bb={class:"text-xs text-gray-500"},Ob=["placeholder"],qb={class:"flex flex-col gap-1 col-span-2"},Fb={class:"text-xs text-gray-500"},Nb={class:"rounded bg-gray-100 px-3 py-2 text-xs text-gray-600 break-all"},jb={class:"font-medium text-gray-700"},Hb={class:"w-full pt-2"},Ub=["disabled"],Vb={key:0,class:"mt-2 flex items-center justify-between text-xs text-gray-500"},Wb={key:3,class:"space-y-4 text-sm text-gray-700"},Gb={class:"space-y-2"},Kb={class:"font-medium text-gray-900"},Yb={class:"text-xs text-gray-500"},Xb={class:"grid grid-cols-2 gap-4"},Zb={class:"flex flex-col gap-1 col-span-2"},Jb={class:"text-xs text-gray-500"},Qb=["placeholder"],e1={class:"flex flex-col gap-1"},t1={class:"text-xs text-gray-500"},r1={class:"flex flex-col gap-1"},n1={class:"text-xs text-gray-500"},o1={class:"space-y-2 pt-2 border-t border-gray-200"},s1={class:"font-medium text-gray-900"},a1={class:"text-xs text-gray-500"},l1={class:"grid grid-cols-2 gap-4"},i1={class:"flex flex-col gap-1 col-span-2"},d1={class:"text-xs text-gray-500"},u1=["placeholder"],c1={class:"flex flex-col gap-1 col-span-2"},h1={class:"text-xs text-gray-500"},p1=["disabled"],f1={value:""},m1=["value","disabled"],g1={class:"rounded bg-gray-100 px-3 py-2 text-xs text-gray-600 break-all"},v1={class:"font-medium text-gray-700"},b1={class:"text-xs text-gray-500"},y1={class:"w-full pt-2"},w1=["disabled"],x1={key:0,class:"mt-2 flex items-center justify-between text-xs text-gray-500"},_1={class:"p-4 border-t border-gray-200 bg-gray-50 flex justify-end rounded-br-lg"},k1=ze({__name:"SettingsModal",props:{show:{type:Boolean}},emits:["update:show"],setup(r,{emit:e}){const t=r,s=e,{t:n,locale:l}=Ne(),{theme:i,setTheme:d}=Co(),{autoSave:c}=Il(),g=Re(),{printMode:w,silentPrint:m,exportImageMerged:_,localSettings:p,remoteSettings:S,localStatus:v,remoteStatus:k,localRetryCount:b,remoteRetryCount:f,remoteClients:T,remoteSelectedClientId:D,localWsUrl:j,remoteWsUrl:B,cancelLocalRetry:A,cancelRemoteRetry:V,connectLocal:Y,disconnectLocal:se,connectRemote:G,disconnectRemote:I,fetchRemoteClients:q}=er(),h=le("basic"),y=le(l.value),ee=le(localStorage.getItem("print-designer-brand-key")||"default"),K=le(localStorage.getItem("print-designer-brand-custom-hex")||"#3b82f6"),te=fe(()=>v.value||"disconnected"),$=fe(()=>k.value||"disconnected"),W=fe(()=>b.value||0),L=fe(()=>f.value||0),O=fe(()=>T.value||[]),re=fe(()=>te.value==="connected"),Z=fe(()=>$.value==="connected"),ne=fe(()=>te.value==="connecting"),ve=fe(()=>$.value==="connecting"),we=fe(()=>!!p.wsAddress),ie=fe(()=>!!(S.apiBaseUrl&&S.username&&S.password)),ke=fe(()=>re.value?n("settings.status.connected"):n("settings.status.disconnected")),_e=fe(()=>Z.value?n("settings.status.connected"):n("settings.status.disconnected")),oe=pe=>pe==="connected"?"bg-blue-600 hover:bg-blue-700 text-white border border-blue-600":"bg-transparent text-blue-600 border border-blue-600 hover:bg-blue-50",ue=(pe,Q=0,H=255)=>Math.min(Math.max(pe,Q),H),J=(pe,Q,H)=>{const me=Oe=>ue(Math.round(Oe)).toString(16).padStart(2,"0");return`#${me(pe)}${me(Q)}${me(H)}`},u=(pe,Q,H)=>({r:pe.r+(Q.r-pe.r)*H,g:pe.g+(Q.g-pe.g)*H,b:pe.b+(Q.b-pe.b)*H}),U=pe=>{const Q=Mt(pe);if(!Q)return null;const H=Dt(Q.h,Q.s,Q.v),me={r:255,g:255,b:255},Oe={r:0,g:0,b:0},Be=u(H,me,.92),Ue=u(H,me,.84),Ie=u(H,me,.68),Fe=u(H,me,.5),st=u(H,me,.32),Ve=u(H,me,.16),je=u(H,Oe,.12),Ze=u(H,Oe,.24),lt=u(H,Oe,.36),nt=u(H,Oe,.5);return{"--brand-50":J(Be.r,Be.g,Be.b),"--brand-100":J(Ue.r,Ue.g,Ue.b),"--brand-200":J(Ie.r,Ie.g,Ie.b),"--brand-300":J(Fe.r,Fe.g,Fe.b),"--brand-400":J(st.r,st.g,st.b),"--brand-500":J(Ve.r,Ve.g,Ve.b),"--brand-600":J(H.r,H.g,H.b),"--brand-700":J(je.r,je.g,je.b),"--brand-800":J(Ze.r,Ze.g,Ze.b),"--brand-900":J(lt.r,lt.g,lt.b),"--brand-950":J(nt.r,nt.g,nt.b)}},P=fe(()=>U(K.value)||{}),x=fe(()=>[{key:"default",labelKey:"settings.themePresetDefault",colors:{"--brand-50":"#eff6ff","--brand-100":"#dbeafe","--brand-200":"#bfdbfe","--brand-300":"#93c5fd","--brand-400":"#60a5fa","--brand-500":"#3b82f6","--brand-600":"#2563eb","--brand-700":"#1d4ed8","--brand-800":"#1e40af","--brand-900":"#1e3a8a","--brand-950":"#172554"}},{key:"emerald",labelKey:"settings.themePresetEmerald",colors:{"--brand-50":"#ecfdf5","--brand-100":"#d1fae5","--brand-200":"#a7f3d0","--brand-300":"#6ee7b7","--brand-400":"#34d399","--brand-500":"#10b981","--brand-600":"#059669","--brand-700":"#047857","--brand-800":"#065f46","--brand-900":"#064e3b","--brand-950":"#022c22"}},{key:"amber",labelKey:"settings.themePresetAmber",colors:{"--brand-50":"#fffbeb","--brand-100":"#fef3c7","--brand-200":"#fde68a","--brand-300":"#fcd34d","--brand-400":"#fbbf24","--brand-500":"#f59e0b","--brand-600":"#d97706","--brand-700":"#b45309","--brand-800":"#92400e","--brand-900":"#78350f","--brand-950":"#451a03"}},{key:"rose",labelKey:"settings.themePresetRose",colors:{"--brand-50":"#fff1f2","--brand-100":"#ffe4e6","--brand-200":"#fecdd3","--brand-300":"#fda4af","--brand-400":"#fb7185","--brand-500":"#f43f5e","--brand-600":"#e11d48","--brand-700":"#be123c","--brand-800":"#9f1239","--brand-900":"#881337","--brand-950":"#4c0519"}},{key:"custom",labelKey:"settings.themePresetCustom",colors:P.value}]),C=pe=>{const Q=document.documentElement;Object.entries(pe).forEach(([H,me])=>{Q.style.setProperty(H,me)}),window.dispatchEvent(new CustomEvent("brand-theme-updated"))},N=pe=>{localStorage.setItem("print-designer-brand-vars",JSON.stringify(pe))},M=pe=>{const Q=x.value.find(H=>H.key===pe)||x.value[0];Q.colors&&(C(Q.colors),N(Q.colors),localStorage.setItem("print-designer-brand-key",Q.key))};(()=>{const pe=localStorage.getItem("print-designer-brand-vars");if(pe)try{const Q=JSON.parse(pe);Q&&typeof Q=="object"&&C(Q)}catch{}})();const R=async()=>{if(!ne.value){if(re.value){se();return}await Y()}},ae=async()=>{if(!ve.value){if(Z.value){I();return}await G()}};Ae(y,pe=>{l.value=pe,localStorage.setItem("print-designer-language",pe)}),Ae(i,pe=>{d(pe)}),Ae(()=>t.show,pe=>{g.setDisableGlobalShortcuts(pe)}),Ae(K,pe=>{pe&&(localStorage.setItem("print-designer-brand-custom-hex",pe),ee.value==="custom"&&M("custom"))}),Ae(ee,pe=>{M(pe)},{immediate:!0}),Ae([h,k],([pe,Q])=>{pe!=="remote"||Q!=="connected"||q()});const he=()=>{s("update:show",!1)},de=pe=>{t.show&&pe.key==="Escape"&&(pe.preventDefault(),he())};return We(()=>{window.addEventListener("keydown",de)}),Ge(()=>{window.removeEventListener("keydown",de),t.show&&g.setDisableGlobalShortcuts(!1)}),(pe,Q)=>(z(),Pe(tt,{to:"body"},[r.show?(z(),F("div",{key:0,class:"fixed inset-0 z-[99999] flex items-center justify-center bg-black/50",onClick:Ke(he,["self"])},[o("div",Hv,[o("div",Uv,[o("div",Vv,[o("h3",Wv,E(a(n)("settings.title")),1)]),o("div",Gv,[o("button",{onClick:Q[0]||(Q[0]=H=>h.value="basic"),class:xe(["w-full text-left px-4 py-3 flex items-center gap-3 transition-colors text-sm",h.value==="basic"?"bg-white text-blue-600 border-l-4 border-blue-600 font-medium":"text-gray-600 hover:bg-gray-100 border-l-4 border-transparent"])},[ce(a(Wt),{class:"w-5 h-5"}),Ce(" "+E(a(n)("settings.basic")),1)],2),o("button",{onClick:Q[1]||(Q[1]=H=>h.value="language"),class:xe(["w-full text-left px-4 py-3 flex items-center gap-3 transition-colors text-sm",h.value==="language"?"bg-white text-blue-600 border-l-4 border-blue-600 font-medium":"text-gray-600 hover:bg-gray-100 border-l-4 border-transparent"])},[ce(a(Rv),{class:"w-5 h-5"}),Ce(" "+E(a(n)("settings.language")),1)],2),o("button",{onClick:Q[2]||(Q[2]=H=>h.value="local"),class:xe(["w-full text-left px-4 py-3 flex items-center gap-3 transition-colors text-sm",h.value==="local"?"bg-white text-blue-600 border-l-4 border-blue-600 font-medium":"text-gray-600 hover:bg-gray-100 border-l-4 border-transparent"])},[ce(a(Eo),{class:"w-5 h-5"}),Ce(" "+E(a(n)("settings.localConnection")),1)],2),o("button",{onClick:Q[3]||(Q[3]=H=>h.value="remote"),class:xe(["w-full text-left px-4 py-3 flex items-center gap-3 transition-colors text-sm",h.value==="remote"?"bg-white text-blue-600 border-l-4 border-blue-600 font-medium":"text-gray-600 hover:bg-gray-100 border-l-4 border-transparent"])},[ce(a(Ov),{class:"w-5 h-5"}),Ce(" "+E(a(n)("settings.remoteConnection")),1)],2)])]),o("div",Kv,[o("div",Yv,[o("h3",Xv,E(h.value==="basic"?a(n)("settings.basic"):h.value==="language"?a(n)("settings.language"):h.value==="local"?a(n)("settings.localConnection"):a(n)("settings.remoteConnection")),1),o("button",{onClick:he,class:"p-1 hover:bg-gray-100 rounded-full transition-colors text-gray-500"},[ce(a(vt),{class:"w-4 h-4"})])]),o("div",Zv,[h.value==="basic"?(z(),F("div",Jv,[o("div",null,[o("div",Qv,E(a(n)("settings.theme")),1),o("div",eb,[o("label",{class:xe(["flex items-center gap-2 px-3 py-2 border rounded cursor-pointer",a(i)==="system"?"border-blue-600 text-blue-700":"border-gray-300"])},[$e(o("input",{type:"radio",value:"system","onUpdate:modelValue":Q[4]||(Q[4]=H=>ft(i)?i.value=H:null)},null,512),[[it,a(i)]]),o("span",null,E(a(n)("settings.themeSystem")),1)],2),o("label",{class:xe(["flex items-center gap-2 px-3 py-2 border rounded cursor-pointer",a(i)==="light"?"border-blue-600 text-blue-700":"border-gray-300"])},[$e(o("input",{type:"radio",value:"light","onUpdate:modelValue":Q[5]||(Q[5]=H=>ft(i)?i.value=H:null)},null,512),[[it,a(i)]]),o("span",null,E(a(n)("settings.themeLight")),1)],2),o("label",{class:xe(["flex items-center gap-2 px-3 py-2 border rounded cursor-pointer",a(i)==="dark"?"border-blue-600 text-blue-700":"border-gray-300"])},[$e(o("input",{type:"radio",value:"dark","onUpdate:modelValue":Q[6]||(Q[6]=H=>ft(i)?i.value=H:null)},null,512),[[it,a(i)]]),o("span",null,E(a(n)("settings.themeDark")),1)],2)]),o("p",tb,E(a(n)("settings.themeDesc")),1)]),o("div",rb,[o("div",nb,E(a(n)("settings.themeColor")),1),o("div",ob,[(z(!0),F(Te,null,Le(x.value.filter(H=>H.key!=="custom"),H=>(z(),F("button",{key:H.key,type:"button",class:xe(["flex items-center gap-2 px-3 py-2 border rounded text-xs transition-colors",ee.value===H.key?"border-blue-600 text-blue-700":"border-gray-300 text-gray-700 hover:bg-gray-50"]),onClick:me=>ee.value=H.key},[o("span",{class:"inline-block w-3.5 h-3.5 rounded-full",style:ye({backgroundColor:H.colors["--brand-600"]})},null,4),o("span",null,E(a(n)(H.labelKey)),1)],10,sb))),128)),ce(xt,{"model-value":K.value,"onUpdate:modelValue":Q[8]||(Q[8]=H=>{H&&(K.value=H,ee.value="custom")}),"default-color":K.value,"teleport-to-body":!0},{trigger:ct(({color:H,open:me})=>[o("button",{type:"button",class:xe(["flex items-center gap-2 px-3 py-2 border rounded text-xs transition-colors",ee.value==="custom"?"border-blue-600 text-blue-700":"border-gray-300 text-gray-700 hover:bg-gray-50"]),onClick:Q[7]||(Q[7]=Oe=>ee.value="custom")},[o("span",{class:xe(["inline-block w-3.5 h-3.5 rounded-full border border-gray-200",{"ring-2 ring-blue-500 ring-offset-1":me}]),style:ye({backgroundColor:H||K.value})},null,6),o("span",null,E(a(n)("settings.themePresetCustom")),1)],2)]),_:1},8,["model-value","default-color"])]),o("p",ab,E(a(n)("settings.themeColorDesc")),1)]),o("div",lb,[o("div",ib,[o("div",db,E(a(n)("settings.autoSave")),1),o("button",{onClick:Q[9]||(Q[9]=H=>c.value=!a(c)),class:xe(["relative inline-flex h-6 w-11 flex-shrink-0 cursor-pointer rounded-full border-2 border-transparent transition-colors duration-200 ease-in-out focus:outline-none focus:ring-2 focus:ring-blue-600 focus:ring-offset-2",a(c)?"bg-blue-600":"bg-gray-200"])},[o("span",ub,E(a(n)("settings.autoSave")),1),o("span",{"aria-hidden":"true",class:xe(["pointer-events-none inline-block h-5 w-5 transform rounded-full bg-white shadow ring-0 transition duration-200 ease-in-out",a(c)?"translate-x-5":"translate-x-0"])},null,2)],2)]),o("p",cb,E(a(n)("settings.autoSaveDesc")),1)]),o("div",hb,[o("div",pb,[o("div",fb,E(a(n)("settings.exportImageMerged")),1),o("button",{onClick:Q[10]||(Q[10]=H=>_.value=!a(_)),class:xe(["relative inline-flex h-6 w-11 flex-shrink-0 cursor-pointer rounded-full border-2 border-transparent transition-colors duration-200 ease-in-out focus:outline-none focus:ring-2 focus:ring-blue-600 focus:ring-offset-2",a(_)?"bg-blue-600":"bg-gray-200"])},[o("span",mb,E(a(n)("settings.exportImageMerged")),1),o("span",{"aria-hidden":"true",class:xe(["pointer-events-none inline-block h-5 w-5 transform rounded-full bg-white shadow ring-0 transition duration-200 ease-in-out",a(_)?"translate-x-5":"translate-x-0"])},null,2)],2)]),o("p",gb,E(a(n)("settings.exportImageMergedDesc")),1)]),o("div",vb,[o("div",null,[o("div",bb,E(a(n)("settings.printMode")),1),o("div",yb,[o("label",{class:xe(["flex items-center gap-2 px-3 py-2 border rounded cursor-pointer",a(w)==="browser"?"border-blue-600 text-blue-700":"border-gray-300"])},[$e(o("input",{type:"radio",value:"browser","onUpdate:modelValue":Q[11]||(Q[11]=H=>ft(w)?w.value=H:null)},null,512),[[it,a(w)]]),o("span",null,E(a(n)("settings.printModeBrowser")),1)],2),o("label",{class:xe(["flex items-center gap-2 px-3 py-2 border rounded cursor-pointer",a(w)==="local"?"border-blue-600 text-blue-700":"border-gray-300"])},[$e(o("input",{type:"radio",value:"local","onUpdate:modelValue":Q[12]||(Q[12]=H=>ft(w)?w.value=H:null),disabled:!re.value},null,8,wb),[[it,a(w)]]),o("span",null,E(a(n)("settings.printModeLocal")),1)],2),o("label",{class:xe(["flex items-center gap-2 px-3 py-2 border rounded cursor-pointer",a(w)==="remote"?"border-blue-600 text-blue-700":"border-gray-300"])},[$e(o("input",{type:"radio",value:"remote","onUpdate:modelValue":Q[13]||(Q[13]=H=>ft(w)?w.value=H:null),disabled:!Z.value},null,8,xb),[[it,a(w)]]),o("span",null,E(a(n)("settings.printModeRemote")),1)],2)]),o("p",_b,E(a(n)("settings.printModeDesc")),1)]),o("div",kb,[o("div",Sb,E(a(n)("settings.silentPrint")),1),o("button",{onClick:Q[14]||(Q[14]=H=>m.value=!a(m)),class:xe(["relative inline-flex h-6 w-11 flex-shrink-0 cursor-pointer rounded-full border-2 border-transparent transition-colors duration-200 ease-in-out focus:outline-none focus:ring-2 focus:ring-blue-600 focus:ring-offset-2",a(m)?"bg-blue-600":"bg-gray-200"])},[o("span",Cb,E(a(n)("settings.silentPrint")),1),o("span",{"aria-hidden":"true",class:xe(["pointer-events-none inline-block h-5 w-5 transform rounded-full bg-white shadow ring-0 transition duration-200 ease-in-out",a(m)?"translate-x-5":"translate-x-0"])},null,2)],2)]),o("p",Eb,E(a(n)("settings.silentPrintDesc")),1)])])):be("",!0),h.value==="language"?(z(),F("div",Tb,[o("div",$b,E(a(n)("settings.selectLanguage")),1),o("div",Ib,[o("label",{class:xe(["flex items-center gap-2 px-3 py-2 border rounded cursor-pointer",y.value==="zh"?"border-blue-600 text-blue-700":"border-gray-300"])},[$e(o("input",{type:"radio",value:"zh","onUpdate:modelValue":Q[15]||(Q[15]=H=>y.value=H)},null,512),[[it,y.value]]),o("span",null,E(a(n)("settings.zhLabel")),1)],2),o("label",{class:xe(["flex items-center gap-2 px-3 py-2 border rounded cursor-pointer",y.value==="en"?"border-blue-600 text-blue-700":"border-gray-300"])},[$e(o("input",{type:"radio",value:"en","onUpdate:modelValue":Q[16]||(Q[16]=H=>y.value=H)},null,512),[[it,y.value]]),o("span",null,E(a(n)("settings.enLabel")),1)],2)]),o("p",Ab,E(a(n)("settings.languageDesc")),1)])):be("",!0),h.value==="local"?(z(),F("div",zb,[o("div",Pb,[o("div",Lb,E(a(n)("settings.localClientTitle")),1),o("p",Mb,E(a(n)("settings.localClientDesc")),1)]),o("div",Rb,[o("label",Db,[o("span",Bb,E(a(n)("settings.wsAddress")),1),$e(o("input",{"onUpdate:modelValue":Q[17]||(Q[17]=H=>a(p).wsAddress=H),type:"text",class:"w-full px-3 py-2 border rounded focus:ring-2 focus:ring-blue-600 focus:border-blue-600",placeholder:a(n)("settings.localWsAddressPlaceholder")},null,8,Ob),[[De,a(p).wsAddress]])]),o("label",qb,[o("span",Fb,E(a(n)("settings.secretKey")),1),$e(o("input",{"onUpdate:modelValue":Q[18]||(Q[18]=H=>a(p).secretKey=H),type:"text",class:"w-full px-3 py-2 border rounded focus:ring-2 focus:ring-blue-600 focus:border-blue-600"},null,512),[[De,a(p).secretKey]])])]),o("div",Nb,[o("span",jb,E(a(n)("settings.connectionUrl"))+": ",1),o("span",null,E(a(j)),1)]),o("div",Hb,[o("button",{onClick:R,disabled:ne.value||W.value>0||!re.value&&!we.value,class:xe(["w-full inline-flex items-center justify-center gap-2 px-3 h-9 rounded transition-colors text-sm shadow-sm disabled:opacity-50 disabled:pointer-events-none disabled:cursor-not-allowed",oe(te.value)])},[re.value?(z(),Pe(a(Va),{key:0,class:"w-4 h-4"})):(z(),Pe(a(Wa),{key:1,class:"w-4 h-4"})),o("span",null,E(ke.value),1)],10,Ub),W.value>0&&!re.value?(z(),F("div",Vb,[o("span",null,E(a(n)("settings.retrying",{count:W.value,max:10})),1),o("button",{onClick:Q[19]||(Q[19]=(...H)=>a(A)&&a(A)(...H)),class:"text-blue-600 hover:text-blue-700"},E(a(n)("settings.cancelRetry")),1)])):be("",!0)])])):be("",!0),h.value==="remote"?(z(),F("div",Wb,[o("div",Gb,[o("div",Kb,E(a(n)("settings.remoteLoginTitle")),1),o("p",Yb,E(a(n)("settings.remoteLoginDesc")),1)]),o("div",Xb,[o("label",Zb,[o("span",Jb,E(a(n)("settings.apiBaseUrl")),1),$e(o("input",{"onUpdate:modelValue":Q[20]||(Q[20]=H=>a(S).apiBaseUrl=H),type:"text",class:"w-full px-3 py-2 border rounded focus:ring-2 focus:ring-blue-600 focus:border-blue-600",placeholder:a(n)("settings.apiBasePlaceholder")},null,8,Qb),[[De,a(S).apiBaseUrl]])]),o("label",e1,[o("span",t1,E(a(n)("settings.username")),1),$e(o("input",{"onUpdate:modelValue":Q[21]||(Q[21]=H=>a(S).username=H),type:"text",class:"w-full px-3 py-2 border rounded focus:ring-2 focus:ring-blue-600 focus:border-blue-600"},null,512),[[De,a(S).username]])]),o("label",r1,[o("span",n1,E(a(n)("settings.password")),1),$e(o("input",{"onUpdate:modelValue":Q[22]||(Q[22]=H=>a(S).password=H),type:"password",class:"w-full px-3 py-2 border rounded focus:ring-2 focus:ring-blue-600 focus:border-blue-600"},null,512),[[De,a(S).password]])])]),o("div",o1,[o("div",s1,E(a(n)("settings.remoteWsTitle")),1),o("p",a1,E(a(n)("settings.remoteWsDesc")),1)]),o("div",l1,[o("label",i1,[o("span",d1,E(a(n)("settings.wsAddress")),1),$e(o("input",{"onUpdate:modelValue":Q[23]||(Q[23]=H=>a(S).wsAddress=H),type:"text",class:"w-full px-3 py-2 border rounded focus:ring-2 focus:ring-blue-600 focus:border-blue-600",placeholder:a(n)("settings.wsAddressPlaceholder")},null,8,u1),[[De,a(S).wsAddress]])]),o("label",c1,[o("span",h1,E(a(n)("settings.remoteClient")),1),$e(o("select",{"onUpdate:modelValue":Q[24]||(Q[24]=H=>ft(D)?D.value=H:null),class:"w-full px-3 py-2 border rounded bg-white focus:ring-2 focus:ring-blue-600 focus:border-blue-600",disabled:$.value!=="connected"||O.value.length===0},[o("option",f1,E(a(n)("settings.remoteClientPlaceholder")),1),(z(!0),F(Te,null,Le(O.value,H=>(z(),F("option",{key:H.client_id,value:H.client_id,disabled:H.online===!1},E(H.client_name||H.client_id)+E(H.online===!1?" (offline)":""),9,m1))),128))],8,p1),[[Je,a(D)]])])]),o("div",g1,[o("span",v1,E(a(n)("settings.connectionUrl"))+": ",1),o("span",null,E(a(B)),1)]),o("p",b1,E(a(n)("settings.remoteAuthHint")),1),o("div",y1,[o("button",{onClick:ae,disabled:ve.value||L.value>0||!Z.value&&!ie.value,class:xe(["w-full inline-flex items-center justify-center gap-2 px-3 h-9 rounded transition-colors text-sm shadow-sm disabled:opacity-50 disabled:pointer-events-none disabled:cursor-not-allowed",oe($.value)])},[Z.value?(z(),Pe(a(Va),{key:0,class:"w-4 h-4"})):(z(),Pe(a(Wa),{key:1,class:"w-4 h-4"})),o("span",null,E(_e.value),1)],10,w1),L.value>0&&!Z.value?(z(),F("div",x1,[o("span",null,E(a(n)("settings.retrying",{count:L.value,max:10})),1),o("button",{onClick:Q[25]||(Q[25]=(...H)=>a(V)&&a(V)(...H)),class:"text-blue-600 hover:text-blue-700"},E(a(n)("settings.cancelRetry")),1)])):be("",!0)])])):be("",!0)]),o("div",_1,[o("button",{onClick:he,class:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 transition-colors text-sm"},E(a(n)("common.close")),1)])])])])):be("",!0)]))}}),S1={class:"h-14 bg-white border-b border-gray-200 flex items-center justify-between px-4 z-[2000] relative shadow-sm"},C1={class:"flex items-center gap-2"},E1=["src"],T1={key:1,class:"font-semibold text-gray-700"},$1=ze({__name:"Header",setup(r){const{t:e}=Ne(),t=Re(),s=fe(()=>{var d;return((d=t.branding)==null?void 0:d.showLogo)!==!1}),n=fe(()=>{var d;return((d=t.branding)==null?void 0:d.showTitle)!==!1}),l=fe(()=>{var d;return((d=t.branding)==null?void 0:d.logoUrl)||Hl}),i=fe(()=>{var d;return((d=t.branding)==null?void 0:d.title)||e("common.appTitle")});return(d,c)=>(z(),F("header",S1,[o("div",C1,[s.value?(z(),F("img",{key:0,src:l.value,alt:"Logo",class:"w-8 h-8 object-contain"},null,8,E1)):be("",!0),n.value?(z(),F("h1",T1,E(i.value),1)):be("",!0)]),ce(jg,{onToggleHelp:c[0]||(c[0]=g=>a(t).setShowHelp(!0)),onToggleSettings:c[1]||(c[1]=g=>a(t).setShowSettings(!0))}),ce(Pv,{show:a(t).showHelp,"onUpdate:show":c[2]||(c[2]=g=>a(t).setShowHelp(g))},null,8,["show"]),ce(k1,{show:a(t).showSettings,"onUpdate:show":c[3]||(c[3]=g=>a(t).setShowSettings(g))},null,8,["show"])]))}}),I1={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function A1(r,e){return z(),F("svg",I1,[...e[0]||(e[0]=[o("path",{fill:"currentColor",d:"M7 20V7H2V4h13v3h-5v13zm9 0v-8h-3V9h9v3h-3v8z"},null,-1)])])}const Ga=Se({name:"material-symbols-text-fields",render:A1}),z1={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function P1(r,e){return z(),F("svg",z1,[...e[0]||(e[0]=[o("path",{fill:"currentColor",d:"m6 20l1-4H3l.5-2h4l1-4h-4L5 8h4l1-4h2l-1 4h4l1-4h2l-1 4h4l-.5 2h-4l-1 4h4l-.5 2h-4l-1 4h-2l1-4H9l-1 4zm3.5-6h4l1-4h-4z"},null,-1)])])}const Ka=Se({name:"material-symbols-numbers",render:P1}),L1={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function M1(r,e){return z(),F("svg",L1,[...e[0]||(e[0]=[o("path",{fill:"currentColor",d:"M3 8V5q0-.825.588-1.412T5 3h14q.825 0 1.413.588T21 5v3zm2 13q-.825 0-1.412-.587T3 19v-9h4.5v11zm11.5 0V10H21v9q0 .825-.587 1.413T19 21zm-7 0V10h5v11z"},null,-1)])])}const Ya=Se({name:"material-symbols-table-chart",render:M1}),R1={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function D1(r,e){return z(),F("svg",R1,[...e[0]||(e[0]=[o("path",{fill:"currentColor",d:"M1 19V5h2v14zm3 0V5h2v14zm3 0V5h1v14zm3 0V5h2v14zm3 0V5h3v14zm4 0V5h1v14zm3 0V5h3v14z"},null,-1)])])}const Xa=Se({name:"material-symbols-barcode",render:D1}),B1={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function O1(r,e){return z(),F("svg",B1,[...e[0]||(e[0]=[o("path",{fill:"currentColor",d:"M3 11V3h8v8zm2-2h4V5H5zM3 21v-8h8v8zm2-2h4v-4H5zm8-8V3h8v8zm2-2h4V5h-4zm4 12v-2h2v2zm-6-6v-2h2v2zm2 2v-2h2v2zm-2 2v-2h2v2zm2 2v-2h2v2zm2-2v-2h2v2zm0-4v-2h2v2zm2 2v-2h2v2z"},null,-1)])])}const Za=Se({name:"material-symbols-qr-code",render:O1}),q1={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function F1(r,e){return z(),F("svg",q1,[...e[0]||(e[0]=[o("path",{fill:"currentColor",d:"M4 13v-2h16v2z"},null,-1)])])}const Ja=Se({name:"material-symbols-horizontal-rule",render:F1}),N1={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function j1(r,e){return z(),F("svg",N1,[...e[0]||(e[0]=[o("path",{fill:"currentColor",d:"M5 21q-.825 0-1.412-.587T3 19V5q0-.825.588-1.412T5 3h14q.825 0 1.413.588T21 5v14q0 .825-.587 1.413T19 21zm0-2h14V5H5z"},null,-1)])])}const Qa=Se({name:"material-symbols-check-box-outline-blank",render:j1}),H1={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function U1(r,e){return z(),F("svg",H1,[...e[0]||(e[0]=[o("path",{fill:"currentColor",d:"M12 22q-2.075 0-3.9-.788t-3.175-2.137T2.788 15.9T2 12t.788-3.9t2.137-3.175T8.1 2.788T12 2t3.9.788t3.175 2.137T21.213 8.1T22 12t-.788 3.9t-2.137 3.175t-3.175 2.138T12 22m0-2q3.35 0 5.675-2.325T20 12t-2.325-5.675T12 4T6.325 6.325T4 12t2.325 5.675T12 20"},null,-1)])])}const el=Se({name:"material-symbols-radio-button-unchecked",render:U1}),V1={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function W1(r,e){return z(),F("svg",V1,[...e[0]||(e[0]=[o("path",{fill:"currentColor",d:"m5.825 21l1.625-7.025L2 9.25l7.2-.625L12 2l2.8 6.625l7.2.625l-5.45 4.725L18.175 21L12 17.275z"},null,-1)])])}const G1=Se({name:"material-symbols-star",render:W1}),K1={class:"w-64 bg-white border-r border-gray-200 flex flex-col h-full z-40"},Y1={class:"p-4 border-b border-gray-200 bg-gray-50"},X1={class:"font-semibold text-gray-700"},Z1={class:"text-xs text-gray-500 mt-1"},J1={class:"flex border-b border-gray-200 bg-white"},Q1={key:0,class:"absolute bottom-0 left-0 w-full h-0.5 bg-blue-600"},ey={key:0,class:"absolute bottom-0 left-0 w-full h-0.5 bg-blue-600"},ty={class:"flex-1 overflow-y-auto"},ry={class:"text-xs font-semibold text-gray-500 uppercase tracking-wider mb-3 px-1"},ny={class:"grid grid-cols-2 gap-3"},oy=["onDragstart"],sy={class:"text-sm font-medium text-gray-700"},ay={key:0,class:"p-6 text-center"},ly={class:"text-sm text-gray-500"},iy={key:1,class:"p-4 grid grid-cols-2 gap-3"},dy=["onDragstart"],uy=["title"],cy=["onClick","title"],hy=["onClick"],py=["onClick"],fy=["onClick"],my=["onClick"],gy=["onClick"],vy=ze({__name:"Sidebar",setup(r){const{t:e}=Ne(),t=Re(),s=le("standard"),n=fe(()=>t.customElements),l=le(null),i=le({}),d=le(!1),c=le(null),g=le(""),w=le(!1),m=le(""),_=le(null),p=le([]),S=[{title:"sidebar.general",items:[{type:ge.TEXT,label:"sidebar.text",icon:Ga},{type:ge.IMAGE,label:"sidebar.image",icon:Fa},{type:ge.PAGE_NUMBER,label:"sidebar.pagination",icon:Ka}]},{title:"sidebar.dataCodes",items:[{type:ge.TABLE,label:"sidebar.table",icon:Ya},{type:ge.BARCODE,label:"sidebar.barcode",icon:Xa},{type:ge.QRCODE,label:"sidebar.qrcode",icon:Za}]},{title:"sidebar.shapes",items:[{type:ge.LINE,label:"sidebar.line",icon:Ja},{type:ge.RECT,label:"sidebar.rect",icon:Qa},{type:ge.CIRCLE,label:"sidebar.circle",icon:el}]}],v=(I,q)=>{I.dataTransfer&&(I.dataTransfer.setData("application/json",JSON.stringify({type:q})),I.dataTransfer.effectAllowed="copy")},k=(I,q)=>{I.dataTransfer&&(I.dataTransfer.setData("application/json",JSON.stringify({type:q.element.type,payload:q.element})),I.dataTransfer.effectAllowed="copy")},b=I=>{switch(I){case ge.TEXT:return Ga;case ge.IMAGE:return Fa;case ge.TABLE:return Ya;case ge.PAGE_NUMBER:return Ka;case ge.BARCODE:return Xa;case ge.QRCODE:return Za;case ge.LINE:return Ja;case ge.RECT:return Qa;case ge.CIRCLE:return el;default:return G1}},f=(I,q)=>{if(I.stopPropagation(),l.value===q)l.value=null;else{const y=I.currentTarget.getBoundingClientRect();let ee=y.right-128;ee<5&&(ee=y.left),window.innerHeight-y.bottom<210?i.value={bottom:`${window.innerHeight-y.top+5}px`,left:`${ee}px`}:i.value={top:`${y.bottom+5}px`,left:`${ee}px`},l.value=q}},T=()=>{l.value=null},D=I=>{l.value=null,c.value=I.id,g.value=I.name,d.value=!0},j=I=>{c.value&&I&&t.renameCustomElement(c.value,I)},B=I=>{l.value=null,t.addCustomElement(`${I.name} Copy`,I.element)},A=I=>{l.value=null,confirm(e("sidebar.confirmDelete",{name:I.name}))&&t.removeCustomElement(I.id)},V=I=>{if(l.value=null,t.editingCustomElementId!==I.id){if(t.editingCustomElementId&&t.editingCustomElementId!==I.id){const q=t.customElements.find(y=>y.id===t.editingCustomElementId),h=q?q.name:"";if(!confirm(e("sidebar.confirmSwitchEdit",{name:h})))return;t.cancelCustomElementEdit()}t.startCustomElementEdit(I.id)}},Y=I=>jl(I.element),se=I=>{l.value=null,_.value=I;const q=I.testData||{},h=po(I.element,q);p.value=Object.keys(h),m.value=JSON.stringify(h,null,2),w.value=!0},G=()=>{var K;const I=_.value,q=new Set(p.value||[]);if(_.value=null,p.value=[],!I)return;let h=null;try{const te=((K=m.value)==null?void 0:K.trim())||"{}",$=JSON.parse(te);$&&typeof $=="object"&&!Array.isArray($)&&(h=$)}catch{h=null}if(!h){alert(e("common.invalidJson"));return}if(q.size>0){const te=Object.keys(h);if(te.length!==q.size||te.some(W=>!q.has(W))){alert(e("common.testDataKeyChanged"));return}}const y=po(I.element,I.testData||{}),ee={};Object.keys(y).forEach(te=>{(q.size===0||q.has(te))&&(ee[te]=Object.prototype.hasOwnProperty.call(h,te)?h[te]:y[te])}),I.testData=ee,t.saveCustomElements()};return We(()=>{document.addEventListener("click",T)}),Ge(()=>{document.removeEventListener("click",T)}),(I,q)=>(z(),F("aside",K1,[o("div",Y1,[o("h2",X1,E(a(e)("sidebar.elements")),1),o("p",Z1,E(a(e)("sidebar.dragToCanvas")),1)]),o("div",J1,[o("button",{onClick:q[0]||(q[0]=h=>s.value="standard"),class:xe(["flex-1 py-3 text-sm font-medium transition-colors relative",s.value==="standard"?"text-blue-600":"text-gray-500 hover:text-gray-700 hover:bg-gray-50"])},[Ce(E(a(e)("sidebar.standard"))+" ",1),s.value==="standard"?(z(),F("div",Q1)):be("",!0)],2),o("button",{onClick:q[1]||(q[1]=h=>s.value="custom"),class:xe(["flex-1 py-3 text-sm font-medium transition-colors relative",s.value==="custom"?"text-blue-600":"text-gray-500 hover:text-gray-700 hover:bg-gray-50"])},[Ce(E(a(e)("sidebar.custom"))+" ",1),s.value==="custom"?(z(),F("div",ey)):be("",!0)],2)]),o("div",ty,[s.value==="standard"?(z(),F(Te,{key:0},Le(S,h=>o("div",{key:h.title,class:"p-4 border-b border-gray-100 last:border-0"},[o("h3",ry,E(a(e)(h.title)),1),o("div",ny,[(z(!0),F(Te,null,Le(h.items,y=>(z(),F("div",{key:y.type,class:"flex flex-col items-center justify-center p-4 border border-gray-200 rounded-lg theme-hover-border theme-hover-bg cursor-move transition-all",draggable:"true",onDragstart:ee=>v(ee,y.type)},[(z(),Pe(Rt(y.icon),{class:"w-8 h-8 text-gray-600 mb-2"})),o("span",sy,E(a(e)(y.label)),1)],40,oy))),128))])])),64)):be("",!0),s.value==="custom"?(z(),F(Te,{key:1},[n.value.length===0?(z(),F("div",ay,[o("p",ly,E(a(e)("sidebar.noCustomElements")),1)])):(z(),F("div",iy,[(z(!0),F(Te,null,Le(n.value,h=>(z(),F("div",{key:h.id,class:"group relative flex flex-col items-center justify-center p-4 border border-gray-200 rounded-lg theme-hover-border theme-hover-bg cursor-move transition-all",draggable:"true",onDragstart:y=>k(y,h)},[(z(),Pe(Rt(b(h.element.type)),{class:"w-8 h-8 text-gray-600 mb-2"})),o("span",{class:"text-sm font-medium text-gray-700 truncate w-full text-center",title:h.name},E(h.name),9,uy),o("button",{onClick:y=>f(y,h.id),class:xe(["absolute top-1 right-1 p-1 text-gray-400 hover:text-gray-600 rounded-full hover:bg-gray-100 opacity-0 group-hover:opacity-100 transition-opacity",{"opacity-100 bg-gray-100 text-gray-600":l.value===h.id}]),title:a(e)("sidebar.moreOptions")},[ce(a(Nl),{class:"w-4 h-4"})],10,cy)],40,dy))),128))]))],64)):be("",!0)]),(z(),Pe(tt,{to:"body"},[l.value?(z(),F("div",{key:0,class:"fixed w-32 bg-white rounded shadow-lg border border-gray-100 z-[2001] py-1",style:ye(i.value),onClick:q[2]||(q[2]=Ke(()=>{},["stop"]))},[(z(!0),F(Te,null,Le(n.value,h=>(z(),F(Te,{key:h.id},[h.id===l.value?(z(),F(Te,{key:0},[o("button",{onClick:y=>V(h),class:"w-full text-left px-3 py-1.5 text-xs text-gray-700 hover:bg-gray-50 flex items-center gap-2"},[ce(a(ho),{class:"w-3.5 h-3.5"}),Ce(" "+E(a(e)("sidebar.editElement")),1)],8,hy),Y(h)?(z(),F("button",{key:0,onClick:y=>se(h),class:"w-full text-left px-3 py-1.5 text-xs text-gray-700 hover:bg-gray-50 flex items-center gap-2"},[ce(a(ut),{class:"w-3.5 h-3.5"}),Ce(" "+E(a(e)("common.testData")),1)],8,py)):be("",!0),o("button",{onClick:y=>D(h),class:"w-full text-left px-3 py-1.5 text-xs text-gray-700 hover:bg-gray-50 flex items-center gap-2"},[ce(a(ho),{class:"w-3.5 h-3.5"}),Ce(" "+E(a(e)("sidebar.rename")),1)],8,fy),o("button",{onClick:y=>B(h),class:"w-full text-left px-3 py-1.5 text-xs text-gray-700 hover:bg-gray-50 flex items-center gap-2"},[ce(a(Ct),{class:"w-3.5 h-3.5"}),Ce(" "+E(a(e)("sidebar.copy")),1)],8,my),o("button",{onClick:y=>A(h),class:"w-full text-left px-3 py-1.5 text-xs text-red-600 hover:bg-red-50 flex items-center gap-2"},[ce(a(St),{class:"w-3.5 h-3.5"}),Ce(" "+E(a(e)("sidebar.delete")),1)],8,gy)],64)):be("",!0)],64))),128))],4)):be("",!0)])),ce(qt,{show:d.value,"initial-value":g.value,title:a(e)("sidebar.renameModalTitle"),placeholder:a(e)("sidebar.enterNamePlaceholder"),onClose:q[3]||(q[3]=h=>d.value=!1),onSave:j},null,8,["show","initial-value","title","placeholder"]),ce(Ot,{visible:w.value,"onUpdate:visible":q[4]||(q[4]=h=>w.value=h),title:a(e)("common.testData"),value:m.value,language:"json","onUpdate:value":q[5]||(q[5]=h=>m.value=h),onClose:G},null,8,["visible","title","value"])]))}}),by={sections:[{title:"properties.section.content",tab:"properties",fields:[{label:"properties.label.content",type:"textarea",target:"element",key:"content",placeholder:"properties.label.textContentPlaceholder"},{label:"properties.label.variable",type:"text",target:"element",key:"variable",placeholder:"@variable"}]},{title:"properties.section.typography",tab:"style",fields:[{label:"properties.label.writingMode",type:"select",target:"style",key:"writingMode",options:[{label:"properties.option.horizontal",value:"horizontal-tb"},{label:"properties.option.vertical",value:"vertical-rl"}]},{label:"properties.label.fontSize",type:"number",target:"style",key:"fontSize",min:8,max:96,step:1},{label:"properties.label.color",type:"color",target:"style",key:"color"},{label:"properties.label.textAlign",type:"select",target:"style",key:"textAlign",options:[{label:"properties.option.default",value:""},{label:"properties.option.left",value:"left"},{label:"properties.option.center",value:"center"},{label:"properties.option.right",value:"right"}]},{label:"properties.label.fontFamily",type:"select",target:"style",key:"fontFamily",options:[{label:"properties.option.default",value:""},{label:"properties.option.arial",value:"Arial, sans-serif"},{label:"properties.option.timesNewRoman",value:'"Times New Roman", serif'},{label:"properties.option.courierNew",value:'"Courier New", monospace'},{label:"properties.option.simSun",value:"SimSun, serif"},{label:"properties.option.simHei",value:"SimHei, sans-serif"}]},{label:"properties.label.fontWeight",type:"select",target:"style",key:"fontWeight",options:[{label:"properties.option.default",value:""},{label:"properties.option.normal",value:"400"},{label:"properties.option.medium",value:"500"},{label:"properties.option.bold",value:"700"}]}]},{title:"properties.section.border",tab:"style",fields:[{label:"properties.label.borderStyle",type:"select",target:"style",key:"borderStyle",options:[{label:"properties.option.none",value:"none"},{label:"properties.option.solid",value:"solid"},{label:"properties.option.dashed",value:"dashed"},{label:"properties.option.dotted",value:"dotted"}]},{label:"properties.label.borderWidth",type:"number",target:"style",key:"borderWidth",min:0,max:20,step:1},{label:"properties.label.borderColor",type:"color",target:"style",key:"borderColor"}]}]},tl=ze({__name:"TextElement",props:{element:{}},setup(r){const e=r,t=Re(),s=fe(()=>{const n=e.element.variable||"";if(t.isExporting&&n){const l=Ft(n);if(l&&Object.prototype.hasOwnProperty.call(t.testData,l)){const i=t.testData[l];if(i!=null)return String(i)}}return e.element.variable||e.element.content||"Double click to edit"});return(n,l)=>(z(),F("div",{class:"w-full h-full overflow-hidden",style:ye({fontSize:`${r.element.style.fontSize}px`,fontFamily:r.element.style.fontFamily,fontWeight:r.element.style.fontWeight,fontStyle:r.element.style.fontStyle,textAlign:r.element.style.textAlign,textDecoration:r.element.style.textDecoration,color:r.element.style.color,padding:`${r.element.style.padding}px`,writingMode:r.element.style.writingMode||"horizontal-tb"})},E(s.value),5))}}),yy={class:"w-full h-full overflow-hidden bg-gray-50 flex items-center justify-center"},wy=["src"],xy={key:1,class:"text-gray-400 text-xs"},_y={sections:[{title:"properties.section.imageSource",tab:"properties",fields:[{label:"properties.label.imageSource",type:"image",target:"element",key:"content"}]},{title:"properties.section.border",tab:"style",fields:[{label:"properties.label.borderStyle",type:"select",target:"style",key:"borderStyle",options:[{label:"properties.option.none",value:"none"},{label:"properties.option.solid",value:"solid"},{label:"properties.option.dashed",value:"dashed"},{label:"properties.option.dotted",value:"dotted"}]},{label:"properties.label.borderWidth",type:"number",target:"style",key:"borderWidth",min:0,max:20,step:1},{label:"properties.label.borderColor",type:"color",target:"style",key:"borderColor"}]}]},ky=ze({__name:"ImageElement",props:{element:{}},setup(r){return(e,t)=>(z(),F("div",yy,[r.element.content?(z(),F("img",{key:0,src:r.element.content,class:"w-full h-full object-contain pointer-events-none",alt:"Element"},null,8,wy)):(z(),F("span",xy,"No Image"))]))}}),Sy=["data-tfoot-repeat","data-auto-paginate","data-custom-script"],Cy=["onDblclick"],Ey=["onMousedown"],Ty=["rowspan","colspan","data-field","onMousedown","onMouseover"],$y={key:0},Iy=["colspan"],Ay={key:1,class:"h-full border-none bg-transparent"},zy=["colspan"],Py={key:0},Ly=["rowspan","colspan","data-field","data-value","onMousedown","onMouseover","onDblclick"],My={class:"text-sm font-semibold text-gray-700"},Ry={class:"flex flex-col gap-1"},Dy={class:"text-xs text-gray-500"},By=["placeholder"],Oy={class:"flex flex-col gap-1"},qy={class:"text-xs text-gray-500"},Fy=["placeholder"],Ny={class:"flex flex-col gap-1"},jy={class:"text-xs text-gray-500"},Hy=["placeholder"],Uy={class:"flex flex-col gap-1"},Vy={class:"text-xs text-gray-500"},Wy=["placeholder"],Gy={class:"flex justify-end gap-2 mt-1"},Ky={sections:[{title:"properties.section.dataBehavior",tab:"properties",fields:[{label:"properties.label.autoPaginate",type:"switch",target:"element",key:"autoPaginate"},{label:"properties.label.repeatFooter",type:"switch",target:"element",key:"tfootRepeat"},{label:"properties.label.showFooter",type:"switch",target:"element",key:"showFooter"},{label:"properties.label.variable",type:"text",target:"element",key:"variable",placeholder:"@variable"},{label:"properties.label.columns",type:"code",language:"json",target:"element",key:"columns",placeholder:"properties.label.columnsPlaceholder"},{label:"properties.label.data",type:"code",language:"json",target:"element",key:"data",placeholder:"properties.label.dataPlaceholder"},{label:"properties.label.footerData",type:"code",language:"json",target:"element",key:"footerData",placeholder:"properties.label.footerDataPlaceholder"},{label:"properties.label.customScript",type:"code",language:"javascript",target:"element",key:"customScript",placeholder:"properties.label.customScriptPlaceholder"}]},{title:"properties.section.layoutDimensions",tab:"style",fields:[{label:"properties.label.headerHeight",type:"number",target:"style",key:"headerHeight",min:20,max:200,step:1},{label:"properties.label.rowHeight",type:"number",target:"style",key:"rowHeight",min:20,max:200,step:1},{label:"properties.label.footerHeight",type:"number",target:"style",key:"footerHeight",min:20,max:200,step:1}]},{title:"properties.section.appearance",tab:"style",fields:[{label:"properties.label.backgroundColor",type:"color",target:"style",key:"backgroundColor"},{label:"properties.label.textColor",type:"color",target:"style",key:"color"}]},{title:"properties.section.headerStyle",tab:"style",fields:[{label:"properties.label.background",type:"color",target:"style",key:"headerBackgroundColor"},{label:"properties.label.textColor",type:"color",target:"style",key:"headerColor"},{label:"properties.label.fontSize",type:"number",target:"style",key:"headerFontSize",min:8,max:72,step:1}]},{title:"properties.section.footerStyle",tab:"style",fields:[{label:"properties.label.background",type:"color",target:"style",key:"footerBackgroundColor"},{label:"properties.label.textColor",type:"color",target:"style",key:"footerColor"},{label:"properties.label.fontSize",type:"number",target:"style",key:"footerFontSize",min:8,max:72,step:1}]},{title:"properties.section.border",tab:"style",fields:[{label:"properties.label.borderStyle",type:"select",target:"style",key:"borderStyle",options:[{label:"properties.option.none",value:"none"},{label:"properties.option.solid",value:"solid"},{label:"properties.option.dashed",value:"dashed"},{label:"properties.option.dotted",value:"dotted"}]},{label:"properties.label.borderWidth",type:"number",target:"style",key:"borderWidth",min:0,max:20,step:1},{label:"properties.label.borderColor",type:"color",target:"style",key:"borderColor"}]}]},Yy=ze({__name:"TableElement",props:{element:{}},setup(r){const e=r,{t}=Ne(),s=Re();function n($,W,L="body"){var O;return s.tableSelection&&s.tableSelection.elementId!==e.element.id?!1:((O=s.tableSelection)==null?void 0:O.cells.some(re=>re.rowIndex===$&&re.colField===W&&(re.section||"body")===L))??!1}const l=le(null),i=le(null),d=le({header:"",field:"",value:"",variable:""}),c=le({top:0,left:0}),g=le(null),w=async($,W)=>{if(s.selectedElementId!==e.element.id||e.element.locked)return;const L=b.value.columns[W];if(L){if(l.value=W,i.value=null,d.value={header:L.header,field:L.field,value:"",variable:""},c.value={top:$.clientY+10,left:$.clientX+10},await Xe(),g.value){const O=g.value.getBoundingClientRect(),re=window.innerWidth,Z=window.innerHeight;c.value.left+O.width>re&&(c.value.left=re-O.width-20),c.value.top+O.height>Z&&(c.value.top=Z-O.height-20)}setTimeout(()=>{window.addEventListener("click",_)},100)}},m=async($,W,L)=>{if(s.selectedElementId!==e.element.id||e.element.locked)return;const O=b.value.footerData[W];if(!O)return;const re=O[L];let Z="",ne="";if(re&&typeof re=="object"&&(Z=re.value||"",ne=re.field||""),i.value={rowIndex:W,colField:L},l.value=null,d.value={header:"",field:L,value:Z,variable:ne},c.value={top:$.clientY+10,left:$.clientX+10},await Xe(),g.value){const ve=g.value.getBoundingClientRect(),we=window.innerWidth,ie=window.innerHeight;c.value.left+ve.width>we&&(c.value.left=we-ve.width-20),c.value.top+ve.height>ie&&(c.value.top=ie-ve.height-20)}setTimeout(()=>{window.addEventListener("click",_)},100)},_=$=>{g.value&&!g.value.contains($.target)&&p()},p=()=>{l.value=null,i.value=null,window.removeEventListener("click",_)},S=()=>{if(l.value!==null){const $=e.element.columns?[...e.element.columns]:[];if($.length===0&&b.value.columns.length>0){const W=JSON.parse(JSON.stringify(b.value.columns));W[l.value]&&(W[l.value].header=d.value.header,W[l.value].field=d.value.field,s.updateElement(e.element.id,{columns:W})),p();return}l.value<$.length&&($[l.value]={...$[l.value],header:d.value.header,field:d.value.field},s.updateElement(e.element.id,{columns:$}))}else if(i.value){const{rowIndex:$,colField:W}=i.value,L=e.element.footerData?JSON.parse(JSON.stringify(e.element.footerData)):[];if(!L[$])return;const O=L[$],re=O[W];re&&typeof re=="object"?(re.value=d.value.value,re.field=d.value.variable):O[W]={value:d.value.value,field:d.value.variable},s.updateElement(e.element.id,{footerData:L})}p()},v=le(!1),k=le(null),b=fe(()=>{const $=e.element.columns||[];let W=e.element.data||[],L=e.element.footerData||[];if(s.isExporting&&e.element.variable){const Z=Ft(e.element.variable),ne=s.testData||{},ve=Z?ne[Z]:void 0;Array.isArray(ve)&&(W=Ee(ve))}if(e.element.customScript)try{const ne=new Function("data","footerData","columns","type",e.element.customScript)(Ee(W),Ee(L),Ee($),"global");if(ne&&(ne.data&&(W=ne.data),ne.footerData&&(L=ne.footerData),ne.columns))return{...ne,columns:ne.columns}}catch(Z){console.error("Custom script error",Z)}const O=Ee(L),re=$.map(Z=>Z.field);return O.forEach(Z=>{Object.keys(Z).forEach(ne=>{const ve=Z[ne];if(ve&&typeof ve=="object"&&ve.field&&re.includes(ve.field)){const we=ve.field,ie=W.reduce((ke,_e)=>{const oe=parseFloat(_e[we]);return ke+(isNaN(oe)?0:oe)},0);ve.result=ie}})}),{columns:$,data:W,footerData:O}}),f=fe(()=>({color:e.element.style.color||"#000000",fontFamily:e.element.style.fontFamily,borderColor:e.element.style.borderColor||"#000",borderWidth:(e.element.style.borderWidth||1)+"px",borderStyle:e.element.style.borderStyle||"solid"})),T=($,W)=>{if(!$)return"";const L=$[W];if(L&&typeof L=="object"){const O=L.value||"",re=L.printValue!==void 0?L.printValue:L.result!==void 0?L.result:"";return O+re}return L},D=($,W)=>{if(!$)return"";const L=$[W];if(L&&typeof L=="object"){const O=L.value||"",re=L.result!==void 0?L.result:L.printValue!==void 0?L.printValue:"";return O+re}return L},j=($,W)=>{const L=$[W];return L&&typeof L=="object"&&"rowSpan"in L?L.rowSpan:1},B=($,W)=>{const L=$[W];return L&&typeof L=="object"&&"colSpan"in L?L.colSpan:1},A=($,W)=>{const L=$[W];return!(L&&typeof L=="object"&&(L.rowSpan===0||L.colSpan===0))},V=($,W)=>{const L=$[W];return L&&typeof L=="object"&&L.style?L.style:{}},Y=le({}),se=le(null),G=le(0),I=le(0),q=($,W)=>{if(e.element.locked)return;$.preventDefault(),$.stopPropagation(),se.value=W,G.value=$.clientX;const L=b.value.columns[W];I.value=L.width||100,window.addEventListener("mousemove",h),window.addEventListener("mouseup",y)},h=$=>{if(se.value===null)return;const W=$.clientX-G.value,L=Math.max(20,I.value+W),O=b.value.columns[se.value];Y.value[O.field]=L},y=()=>{if(se.value!==null){const $=b.value.columns[se.value],W=Y.value[$.field];if(W){const L=[...e.element.columns||[]];L[se.value]&&(L[se.value]={...L[se.value],width:W},s.updateElement(e.element.id,{columns:L}))}}se.value=null,Y.value={},window.removeEventListener("mousemove",h),window.removeEventListener("mouseup",y)},ee=($,W,L,O="body")=>{s.selectedElementId===e.element.id&&($.stopPropagation(),v.value=!0,k.value={rowIndex:W,colField:L,section:O},s.setTableSelection(e.element.id,{rowIndex:W,colField:L,section:O},!1))},K=($,W,L="body")=>{if(!v.value||!k.value||k.value.section!==L)return;const O=k.value.rowIndex,re=$,Z=b.value.columns.findIndex(oe=>oe.field===k.value.colField),ne=b.value.columns.findIndex(oe=>oe.field===W);if(Z===-1||ne===-1)return;const ve=Math.min(O,re),we=Math.max(O,re),ie=Math.min(Z,ne),ke=Math.max(Z,ne),_e=[];for(let oe=ve;oe<=we;oe++)for(let ue=ie;ue<=ke;ue++)_e.push({rowIndex:oe,colField:b.value.columns[ue].field,section:L});s.setTableSelectionCells(e.element.id,_e)},te=()=>{v.value=!1,k.value=null};return We(()=>{window.addEventListener("mouseup",te)}),Ge(()=>{window.removeEventListener("mouseup",te)}),($,W)=>(z(),F("div",{class:"w-full h-full overflow-hidden",style:ye({backgroundColor:r.element.style.backgroundColor||"transparent"})},[o("table",{class:xe(["w-full border-collapse",{"h-full":!a(s).isExporting}]),"data-tfoot-repeat":r.element.tfootRepeat,"data-auto-paginate":r.element.autoPaginate,"data-custom-script":r.element.customScript},[o("thead",null,[o("tr",null,[(z(!0),F(Te,null,Le(b.value.columns,(L,O)=>(z(),F("th",{key:L.field,class:"p-1 text-left font-bold text-sm relative group select-none",style:ye({...f.value,width:`${Y.value[L.field]||L.width}px`,height:r.element.style.headerHeight?`${r.element.style.headerHeight}px`:void 0,backgroundColor:r.element.style.headerBackgroundColor||"#f3f4f6",color:r.element.style.headerColor||"#000000",fontSize:r.element.style.headerFontSize?`${r.element.style.headerFontSize}px`:void 0,cursor:a(s).selectedElementId===r.element.id?"pointer":"default"}),onDblclick:re=>w(re,O)},[Ce(E(L.header)+" ",1),a(s).selectedElementId===r.element.id&&O<b.value.columns.length-1&&!r.element.locked?(z(),F("div",{key:0,class:xe(["absolute -right-1 top-0 bottom-0 w-2 cursor-col-resize hover:bg-blue-400 opacity-0 hover:opacity-100 z-10 transition-opacity",{"bg-blue-400 opacity-100":se.value===O}]),onMousedown:re=>q(re,O),onClick:W[0]||(W[0]=Ke(()=>{},["stop"]))},null,42,Ey)):be("",!0)],44,Cy))),128))])]),o("tbody",null,[(z(!0),F(Te,null,Le(a(s).isExporting?b.value.data:b.value.data.slice(0,5),(L,O)=>(z(),F("tr",{key:O},[(z(!0),F(Te,null,Le(b.value.columns,re=>(z(),F(Te,{key:re.field},[A(L,re.field)?(z(),F("td",{key:0,class:xe(["p-1 text-sm select-none",{"bg-blue-100 ring-1 ring-blue-400":n(O,re.field)}]),style:ye({...f.value,...V(L,re.field),height:r.element.style.rowHeight?`${r.element.style.rowHeight}px`:void 0}),rowspan:j(L,re.field),colspan:B(L,re.field),"data-field":re.field,onMousedown:Z=>ee(Z,O,re.field),onMouseover:Z=>K(O,re.field)},E(D(L,re.field)),47,Ty)):be("",!0)],64))),128))]))),128)),!a(s).isExporting&&b.value.data.length>5?(z(),F("tr",$y,[o("td",{colspan:b.value.columns.length,class:"p-1 text-center text-gray-500 select-none",style:ye({...f.value,height:r.element.style.rowHeight?`${r.element.style.rowHeight}px`:void 0})}," ... ",12,Iy)])):be("",!0),a(s).isExporting?be("",!0):(z(),F("tr",Ay,[o("td",{colspan:b.value.columns.length||1,class:"border-none p-0"},null,8,zy)]))]),r.element.showFooter?(z(),F("tfoot",Py,[(z(!0),F(Te,null,Le(b.value.footerData,(L,O)=>(z(),F("tr",{key:O},[(z(!0),F(Te,null,Le(b.value.columns,re=>(z(),F(Te,{key:re.field},[A(L,re.field)?(z(),F("td",{key:0,class:xe(["p-1 text-sm font-bold select-none",{"!bg-blue-100 ring-1 ring-blue-400":n(O,re.field,"footer")}]),style:ye({...f.value,...V(L,re.field),height:r.element.style.footerHeight?`${r.element.style.footerHeight}px`:void 0,backgroundColor:r.element.style.footerBackgroundColor||"#f9fafb",color:r.element.style.footerColor||"#000000",fontSize:r.element.style.footerFontSize?`${r.element.style.footerFontSize}px`:void 0,cursor:a(s).selectedElementId===r.element.id?"pointer":"default"}),rowspan:j(L,re.field),colspan:B(L,re.field),"data-field":re.field,"data-value":T(L,re.field),onMousedown:Z=>ee(Z,O,re.field,"footer"),onMouseover:Z=>K(O,re.field,"footer"),onDblclick:Z=>m(Z,O,re.field)},E(D(L,re.field)),47,Ly)):be("",!0)],64))),128))]))),128))])):be("",!0)],10,Sy),(z(),Pe(tt,{to:"body"},[l.value!==null||i.value?(z(),F("div",{key:0,ref_key:"editFormRef",ref:g,class:"fixed z-[9999] bg-white shadow-xl border border-gray-200 rounded-lg p-4 w-64 flex flex-col gap-3",style:ye({top:`${c.value.top}px`,left:`${c.value.left}px`}),onClick:W[5]||(W[5]=Ke(()=>{},["stop"]))},[o("h4",My,E(i.value?a(t)("properties.label.editCell"):a(t)("properties.label.editColumn")),1),l.value!==null?(z(),F(Te,{key:0},[o("div",Ry,[o("label",Dy,E(a(t)("properties.label.headerText")),1),$e(o("input",{"onUpdate:modelValue":W[1]||(W[1]=L=>d.value.header=L),class:"border border-gray-300 rounded px-2 py-1 text-sm focus:border-blue-500 focus:outline-none",placeholder:a(t)("properties.label.headerNamePlaceholder"),onKeydown:wt(S,["enter"]),autoFocus:""},null,40,By),[[De,d.value.header]])]),o("div",Oy,[o("label",qy,E(a(t)("properties.label.fieldKey")),1),$e(o("input",{"onUpdate:modelValue":W[2]||(W[2]=L=>d.value.field=L),class:"border border-gray-300 rounded px-2 py-1 text-sm focus:border-blue-500 focus:outline-none",placeholder:a(t)("properties.label.fieldKey"),onKeydown:wt(S,["enter"])},null,40,Fy),[[De,d.value.field]])])],64)):be("",!0),i.value?(z(),F(Te,{key:1},[o("div",Ny,[o("label",jy,E(a(t)("properties.label.content")),1),$e(o("input",{"onUpdate:modelValue":W[3]||(W[3]=L=>d.value.value=L),class:"border border-gray-300 rounded px-2 py-1 text-sm focus:border-blue-500 focus:outline-none",placeholder:a(t)("properties.label.displayTextPlaceholder"),onKeydown:wt(S,["enter"]),autoFocus:""},null,40,Hy),[[De,d.value.value]])]),o("div",Uy,[o("label",Vy,E(a(t)("properties.label.variableField")),1),$e(o("input",{"onUpdate:modelValue":W[4]||(W[4]=L=>d.value.variable=L),class:"border border-gray-300 rounded px-2 py-1 text-sm focus:border-blue-500 focus:outline-none",placeholder:a(t)("properties.label.dataFieldPlaceholder"),onKeydown:wt(S,["enter"])},null,40,Wy),[[De,d.value.variable]])])],64)):be("",!0),o("div",Gy,[o("button",{onClick:p,class:"px-3 py-1 text-xs text-gray-600 hover:bg-gray-100 rounded"},E(a(t)("common.cancel")),1),o("button",{onClick:S,class:"px-3 py-1 text-xs bg-blue-600 text-white hover:bg-blue-700 rounded"},E(a(t)("common.save")),1)])],4)):be("",!0)]))],4))}}),Xy={class:"page-number-text"},Zy={sections:[{title:"properties.section.labelContent",tab:"properties",fields:[{label:"properties.label.labelText",type:"text",target:"element",key:"labelText",placeholder:"properties.label.labelTextPlaceholder"},{label:"properties.label.labelPosition",type:"select",target:"element",key:"labelPosition",options:[{label:"properties.option.before",value:"before"},{label:"properties.option.after",value:"after"}]},{label:"properties.label.pageFormat",type:"select",target:"element",key:"format",options:[{label:"properties.option.numberOnly",value:"1"},{label:"properties.option.page1",value:"Page 1"},{label:"properties.option.oneTotal",value:"1/Total"}]}]},{title:"properties.section.paginationTypography",tab:"style",fields:[{label:"properties.label.fontSize",type:"number",target:"style",key:"fontSize",min:8,max:96,step:1},{label:"properties.label.color",type:"color",target:"style",key:"color"},{label:"properties.label.textAlign",type:"select",target:"style",key:"textAlign",options:[{label:"properties.option.default",value:""},{label:"properties.option.left",value:"left"},{label:"properties.option.center",value:"center"},{label:"properties.option.right",value:"right"}]},{label:"properties.label.fontFamily",type:"select",target:"style",key:"fontFamily",options:[{label:"properties.option.default",value:""},{label:"properties.option.arial",value:"Arial, sans-serif"},{label:"properties.option.timesNewRoman",value:'"Times New Roman", serif'},{label:"properties.option.courierNew",value:'"Courier New", monospace'},{label:"properties.option.simSun",value:"SimSun, serif"},{label:"properties.option.simHei",value:"SimHei, sans-serif"}]},{label:"properties.label.fontWeight",type:"select",target:"style",key:"fontWeight",options:[{label:"properties.option.default",value:""},{label:"properties.option.normal",value:"400"},{label:"properties.option.medium",value:"500"},{label:"properties.option.bold",value:"700"}]}]},{title:"properties.section.labelStyle",tab:"style",fields:[{label:"properties.label.labelFontSize",type:"number",target:"element",key:"labelFontSize",min:8,max:96,step:1},{label:"properties.label.labelColor",type:"color",target:"element",key:"labelColor"},{label:"properties.label.labelFontFamily",type:"select",target:"element",key:"labelFontFamily",options:[{label:"properties.option.default",value:""},{label:"properties.option.arial",value:"Arial, sans-serif"},{label:"properties.option.timesNewRoman",value:'"Times New Roman", serif'},{label:"properties.option.courierNew",value:'"Courier New", monospace'},{label:"properties.option.simSun",value:"SimSun, serif"},{label:"properties.option.simHei",value:"SimHei, sans-serif"}]},{label:"properties.label.labelFontWeight",type:"select",target:"element",key:"labelFontWeight",options:[{label:"properties.option.default",value:""},{label:"properties.option.normal",value:"400"},{label:"properties.option.medium",value:"500"},{label:"properties.option.bold",value:"700"}]},{label:"properties.label.labelBackgroundColor",type:"color",target:"element",key:"labelBackgroundColor"},{label:"properties.label.labelBorderStyle",type:"select",target:"element",key:"labelBorderStyle",options:[{label:"properties.option.none",value:""},{label:"properties.option.solid",value:"solid"},{label:"properties.option.dashed",value:"dashed"},{label:"properties.option.dotted",value:"dotted"}]},{label:"properties.label.labelBorderWidth",type:"number",target:"element",key:"labelBorderWidth",min:0,max:20,step:1},{label:"properties.label.labelBorderColor",type:"color",target:"element",key:"labelBorderColor"}]},{title:"properties.section.frameBorder",tab:"style",fields:[{label:"properties.label.borderStyle",type:"select",target:"style",key:"borderStyle",options:[{label:"properties.option.none",value:"none"},{label:"properties.option.solid",value:"solid"},{label:"properties.option.dashed",value:"dashed"},{label:"properties.option.dotted",value:"dotted"}]},{label:"properties.label.borderWidth",type:"number",target:"style",key:"borderWidth",min:0,max:20,step:1},{label:"properties.label.borderColor",type:"color",target:"style",key:"borderColor"}]}]},Jy=ze({__name:"PageNumberElement",props:{element:{},pageIndex:{},totalPages:{}},setup(r){const e=r,{t}=Ne(),s=fe(()=>{const n=e.pageIndex+1,l=e.totalPages||1;switch(e.element.format||"1/Total"){case"1":return`${n}`;case"Page 1":return t("properties.option.page1").replace("1",n.toString());case"1/Total":return`${n}/${l}`;default:return`${n}/${l}`}});return(n,l)=>(z(),F("div",{class:"w-full h-full overflow-hidden","data-print-type":"page-number",style:ye({fontSize:`${r.element.style.fontSize}px`,fontFamily:r.element.style.fontFamily,fontWeight:r.element.style.fontWeight,fontStyle:r.element.style.fontStyle,textAlign:r.element.style.textAlign,color:r.element.style.color,padding:`${r.element.style.padding||0}px`})},[r.element.labelText&&r.element.labelPosition!=="after"?(z(),F("span",{key:0,style:ye({fontSize:r.element.labelFontSize?`${r.element.labelFontSize}px`:void 0,fontFamily:r.element.labelFontFamily||void 0,fontWeight:r.element.labelFontWeight||void 0,color:r.element.labelColor||void 0,backgroundColor:r.element.labelBackgroundColor||"transparent",borderStyle:r.element.labelBorderStyle||"none",borderWidth:`${r.element.labelBorderWidth||0}px`,borderColor:r.element.labelBorderColor||"transparent",marginRight:"4px",padding:"0 4px"})},E(r.element.labelText),5)):be("",!0),o("span",Xy,E(s.value),1),r.element.labelText&&r.element.labelPosition==="after"?(z(),F("span",{key:1,style:ye({fontSize:r.element.labelFontSize?`${r.element.labelFontSize}px`:void 0,fontFamily:r.element.labelFontFamily||void 0,fontWeight:r.element.labelFontWeight||void 0,color:r.element.labelColor||void 0,backgroundColor:r.element.labelBackgroundColor||"transparent",borderStyle:r.element.labelBorderStyle||"none",borderWidth:`${r.element.labelBorderWidth||0}px`,borderColor:r.element.labelBorderColor||"transparent",marginLeft:"4px",padding:"0 4px"})},E(r.element.labelText),5)):be("",!0)],4))}});var Qy=ti();const Ul=_t(Qy),e2={class:"w-full h-full flex items-center justify-center overflow-hidden"},t2={sections:[{title:"properties.section.content",tab:"properties",fields:[{label:"properties.label.content",type:"text",target:"element",key:"content",placeholder:"properties.label.barcodeContentPlaceholder"},{label:"properties.label.variable",type:"text",target:"element",key:"variable",placeholder:"@variable"}]},{title:"properties.section.barcodeSettings",tab:"style",fields:[{label:"properties.label.format",type:"select",target:"style",key:"barcodeFormat",options:[{label:"properties.option.code128",value:"CODE128"},{label:"properties.option.ean13",value:"EAN13"},{label:"properties.option.upc",value:"UPC"},{label:"properties.option.code39",value:"CODE39"},{label:"properties.option.itf14",value:"ITF14"},{label:"properties.option.msi",value:"MSI"},{label:"properties.option.pharmacode",value:"pharmacode"}]},{label:"properties.label.showText",type:"select",target:"style",key:"showText",options:[{label:"properties.option.yes",value:!0},{label:"properties.option.no",value:!1}]},{label:"properties.label.color",type:"color",target:"style",key:"color"},{label:"properties.label.lineWidth",type:"number",target:"style",key:"barcodeWidth",placeholder:"2"},{label:"properties.label.barcodeHeight",type:"number",target:"style",key:"barcodeHeight",placeholder:"40"},{label:"properties.label.margin",type:"number",target:"style",key:"margin",placeholder:"0"},{label:"properties.label.fontSize",type:"number",target:"style",key:"fontSize",placeholder:"20"},{label:"properties.label.textPosition",type:"select",target:"style",key:"textPosition",options:[{label:"properties.option.bottom",value:"bottom"},{label:"properties.option.top",value:"top"}]},{label:"properties.label.textAlign",type:"select",target:"style",key:"textAlign",options:[{label:"properties.option.left",value:"left"},{label:"properties.option.center",value:"center"},{label:"properties.option.right",value:"right"}]}]}]},r2=ze({__name:"BarcodeElement",props:{element:{}},setup(r){const e=r,t=Re(),s=le(null),n=fe(()=>{const i=e.element.variable||"";if(t.isExporting&&i){const d=Ft(i);if(d&&Object.prototype.hasOwnProperty.call(t.testData,d)){const c=t.testData[d];if(c!=null)return String(c)}}return e.element.variable||e.element.content||"12345678"}),l=()=>{if(s.value)try{const i=n.value,d=e.element.style;Ul(s.value,i,{format:d.barcodeFormat||"CODE128",lineColor:d.color||"#000000",width:Number(d.barcodeWidth)||2,height:Number(d.barcodeHeight)||40,displayValue:d.showText!==!1&&d.showText!=="false",fontOptions:d.fontOptions||"",font:d.font||"monospace",textAlign:d.textAlign||"center",textPosition:d.textPosition||"bottom",textMargin:Number(d.textMargin)||2,fontSize:Number(d.fontSize)||20,background:"transparent",margin:Number(d.margin)||0})}catch(i){console.error("Barcode render error",i)}};return We(()=>{Xe(l)}),Ae(()=>[e.element.content,e.element.variable,e.element.style,t.isExporting,t.testData],()=>{Xe(l)},{deep:!0}),(i,d)=>(z(),F("div",e2,[o("img",{ref_key:"barcodeRef",ref:s,class:"w-full h-full object-contain pointer-events-none"},null,512)]))}});var n2=ri();const Vl=_t(n2),o2={class:"w-full h-full flex items-center justify-center overflow-hidden"},s2=["src"],a2={sections:[{title:"properties.section.content",tab:"properties",fields:[{label:"properties.label.content",type:"text",target:"element",key:"content",placeholder:"properties.label.qrContentPlaceholder"},{label:"properties.label.variable",type:"text",target:"element",key:"variable",placeholder:"@variable"}]},{title:"properties.section.qrSettings",tab:"style",fields:[{label:"properties.label.errorCorrection",type:"select",target:"style",key:"qrErrorCorrection",options:[{label:"properties.option.eccLow",value:"L"},{label:"properties.option.eccMedium",value:"M"},{label:"properties.option.eccQuartile",value:"Q"},{label:"properties.option.eccHigh",value:"H"}]},{label:"properties.label.color",type:"color",target:"style",key:"color"}]}]},l2=ze({__name:"QRCodeElement",props:{element:{}},setup(r){const e=r,t=Re(),s=le(""),n=fe(()=>{const i=e.element.variable||"";if(t.isExporting&&i){const d=Ft(i);if(d&&Object.prototype.hasOwnProperty.call(t.testData,d)){const c=t.testData[d];if(c!=null)return String(c)}}return e.element.variable||e.element.content||"https://example.com"}),l=async()=>{try{const i=n.value;s.value=await Vl.toDataURL(i,{margin:0,color:{dark:e.element.style.color||"#000000",light:"#00000000"},errorCorrectionLevel:e.element.style.qrErrorCorrection||"M"})}catch(i){console.error("QR render error",i)}};return We(()=>Xe(l)),Ae(()=>[e.element.content,e.element.variable,e.element.style,t.isExporting,t.testData],()=>Xe(l),{deep:!0}),(i,d)=>(z(),F("div",o2,[s.value?(z(),F("img",{key:0,src:s.value,class:"w-full h-full object-contain pointer-events-none",draggable:"false"},null,8,s2)):be("",!0)]))}}),i2={class:"w-full h-full flex items-center justify-center"},d2={sections:[{title:"properties.section.lineStyle",tab:"style",fields:[{label:"properties.label.color",type:"color",target:"style",key:"borderColor",defaultValue:"#000000"},{label:"properties.label.thickness",type:"number",target:"style",key:"borderWidth",min:1,max:100,step:1,defaultValue:1},{label:"properties.label.borderStyle",type:"select",target:"style",key:"borderStyle",defaultValue:"solid",options:[{label:"properties.option.solid",value:"solid"},{label:"properties.option.dashed",value:"dashed"},{label:"properties.option.dotted",value:"dotted"}]}]}]},u2=ze({__name:"LineElement",props:{element:{}},setup(r){return(e,t)=>(z(),F("div",i2,[o("div",{class:"w-full",style:ye({borderTopWidth:`${r.element.style.borderWidth||1}px`,borderTopStyle:r.element.style.borderStyle||"solid",borderTopColor:r.element.style.borderColor||"#000000"})},null,4)]))}}),c2={sections:[{title:"properties.section.appearance",tab:"style",fields:[{label:"properties.label.background",type:"color",target:"style",key:"backgroundColor",defaultValue:"transparent"},{label:"properties.label.borderColor",type:"color",target:"style",key:"borderColor",defaultValue:"#000000"},{label:"properties.label.borderWidth",type:"number",target:"style",key:"borderWidth",min:0,max:100,defaultValue:1},{label:"properties.label.borderStyle",type:"select",target:"style",key:"borderStyle",defaultValue:"solid",options:[{label:"properties.option.none",value:"none"},{label:"properties.option.solid",value:"solid"},{label:"properties.option.dashed",value:"dashed"},{label:"properties.option.dotted",value:"dotted"}]},{label:"properties.label.cornerRadius",type:"number",target:"style",key:"borderRadius",min:0,max:1e3}]}]},h2=ze({__name:"RectElement",props:{element:{}},setup(r){return(e,t)=>(z(),F("div",{class:"w-full h-full",style:ye({backgroundColor:r.element.style.backgroundColor||"transparent",borderWidth:`${r.element.style.borderWidth||1}px`,borderStyle:r.element.style.borderStyle||"solid",borderColor:r.element.style.borderColor||"#000000",borderRadius:`${r.element.style.borderRadius||0}px`})},null,4))}}),p2={sections:[{title:"properties.section.appearance",tab:"style",fields:[{label:"properties.label.background",type:"color",target:"style",key:"backgroundColor",defaultValue:"transparent"},{label:"properties.label.borderColor",type:"color",target:"style",key:"borderColor",defaultValue:"#000000"},{label:"properties.label.borderWidth",type:"number",target:"style",key:"borderWidth",min:0,max:100,defaultValue:1},{label:"properties.label.borderStyle",type:"select",target:"style",key:"borderStyle",defaultValue:"solid",options:[{label:"properties.option.none",value:"none"},{label:"properties.option.solid",value:"solid"},{label:"properties.option.dashed",value:"dashed"},{label:"properties.option.dotted",value:"dotted"}]}]}]},f2=ze({__name:"CircleElement",props:{element:{}},setup(r){return(e,t)=>(z(),F("div",{class:"w-full h-full rounded-full",style:ye({backgroundColor:r.element.style.backgroundColor||"transparent",borderWidth:`${r.element.style.borderWidth||1}px`,borderStyle:r.element.style.borderStyle||"solid",borderColor:r.element.style.borderColor||"#000000"})},null,4))}}),m2={key:0,class:"flex items-center justify-between"},g2={class:"text-sm text-gray-700 font-medium"},v2=["disabled"],b2={class:"sr-only"},y2={key:1},w2={class:"block text-xs text-gray-500 mb-1"},x2=["value","disabled","placeholder"],_2=["type","value","disabled","placeholder","min","max","step"],$t=ze({__name:"PropertyInput",props:{label:{},value:{type:[String,Number,Boolean]},type:{},placeholder:{},min:{},max:{},step:{},disabled:{type:Boolean}},emits:["update:value"],setup(r,{emit:e}){const t=e,s=n=>{const l=n.target;t("update:value",l.value)};return(n,l)=>r.type==="switch"?(z(),F("div",m2,[o("label",g2,E(r.label),1),o("button",{type:"button",disabled:r.disabled,onClick:l[0]||(l[0]=i=>n.$emit("update:value",!r.value)),class:xe(["relative inline-flex h-6 w-11 flex-shrink-0 cursor-pointer rounded-full border-2 border-transparent transition-colors duration-200 ease-in-out focus:outline-none focus:ring-2 focus:ring-blue-600 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed",r.value?"bg-blue-600":"bg-gray-200"])},[o("span",b2,"Toggle "+E(r.label),1),o("span",{"aria-hidden":"true",class:xe(["pointer-events-none inline-block h-5 w-5 transform rounded-full bg-white shadow ring-0 transition duration-200 ease-in-out",r.value?"translate-x-5":"translate-x-0"])},null,2)],10,v2)])):(z(),F("div",y2,[o("label",w2,E(r.label),1),r.type==="textarea"?(z(),F("textarea",{key:0,value:r.value===void 0||r.value===null?"":String(r.value),disabled:r.disabled,placeholder:r.placeholder,onInput:s,class:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:border-blue-500 outline-none h-24 resize-y disabled:bg-gray-100 disabled:text-gray-500"},null,40,x2)):(z(),F("input",{key:1,type:r.type||"text",value:r.value===void 0||r.value===null?"":String(r.value),disabled:r.disabled,placeholder:r.placeholder,min:r.min,max:r.max,step:r.step,onInput:s,class:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:border-blue-500 outline-none disabled:bg-gray-100 disabled:text-gray-500"},null,40,_2))]))}}),k2={class:"block text-xs text-gray-500 mb-1"},S2=["value","disabled"],C2=["value"],E2=ze({__name:"PropertySelect",props:{label:{},value:{type:[String,Number,Boolean]},options:{},disabled:{type:Boolean}},emits:["update:value"],setup(r,{emit:e}){const t=r,s=e,n=l=>{const d=l.target.value,c=t.options.find(g=>String(g.value)===d);s("update:value",c?c.value:d)};return(l,i)=>(z(),F("div",null,[o("label",k2,E(r.label),1),o("select",{value:r.value,disabled:r.disabled,onChange:n,class:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:border-blue-500 outline-none disabled:bg-gray-100 disabled:text-gray-500"},[(z(!0),F(Te,null,Le(r.options,d=>(z(),F("option",{key:String(d.value),value:d.value},E(d.label),9,C2))),128))],40,S2)]))}}),T2={class:"flex items-center justify-between"},$2={class:"text-xs text-gray-500"},I2={class:"flex items-center gap-2"},A2={key:0,class:"absolute inset-0 flex items-center justify-center"},rl=ze({__name:"PropertyColor",props:{label:{},value:{},disabled:{type:Boolean}},emits:["update:value"],setup(r,{emit:e}){const t=e;return(s,n)=>(z(),F("div",T2,[o("label",$2,E(r.label),1),o("div",I2,[ce(xt,{"model-value":r.value,"onUpdate:modelValue":n[0]||(n[0]=l=>t("update:value",l)),disabled:r.disabled,"allow-transparent":!0},{trigger:ct(({color:l,open:i})=>[o("div",{class:xe(["w-8 h-6 rounded border border-gray-300 cursor-pointer relative overflow-hidden hover:border-blue-500 transition-colors",{"ring-2 ring-blue-500 ring-offset-1":i,"opacity-50 cursor-not-allowed":r.disabled}])},[n[2]||(n[2]=o("div",{class:"absolute inset-0 bg-[url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAIAAADZF8uwAAAAGUlEQVQYV2M4gwZ+5wNisxL//8n04mEeRAAAhNwX869V4DYAAAAASUVORK5CYII=')] opacity-50"},null,-1)),o("div",{class:"absolute inset-0",style:ye({backgroundColor:l==="transparent"?"transparent":l})},null,4),l==="transparent"?(z(),F("div",A2,[...n[1]||(n[1]=[o("div",{class:"w-full h-[1px] bg-red-500 rotate-45"},null,-1)])])):be("",!0)],2)]),_:1},8,["model-value","disabled"])])]))}}),z2={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function P2(r,e){return z(),F("svg",z2,[...e[0]||(e[0]=[o("path",{fill:"currentColor",d:"M3 21v-8h2v4.6L17.6 5H13V3h8v8h-2V6.4L6.4 19H11v2z"},null,-1)])])}const L2=Se({name:"material-symbols-open-in-full",render:P2}),M2={class:"flex flex-col gap-1"},R2={class:"flex justify-between items-center"},D2={class:"text-xs text-gray-500 font-medium"},B2={class:"flex items-center gap-2"},O2={class:"text-[10px] text-gray-400 uppercase"},q2=ze({__name:"PropertyCode",props:{label:{},value:{},language:{},disabled:{type:Boolean},height:{}},emits:["update:value"],setup(r,{emit:e}){const t=e;Re();const{isDark:s}=Co(),n=le(!1),l=fe(()=>({minimap:{enabled:!1},lineNumbers:"on",glyphMargin:!1,folding:!0,wordWrap:"on",automaticLayout:!0,scrollBeyondLastLine:!1,theme:s.value?"vs-dark":"vs",fontSize:12,fontFamily:'Consolas, "Courier New", monospace',renderLineHighlight:"none",overviewRulerLanes:0,hideCursorInOverviewRuler:!0,contextmenu:!1})),i=w=>{t("update:value",w||"")},d=()=>{n.value=!n.value},c=()=>{n.value=!1},g=w=>{t("update:value",w)};return(w,m)=>(z(),F("div",M2,[o("div",R2,[o("label",D2,E(r.label),1),o("div",B2,[o("span",O2,E(r.language),1),o("button",{onClick:d,class:"text-gray-400 hover:text-blue-600 transition-colors p-0.5 rounded hover:bg-gray-100",title:"Expand Editor"},[ce(a(L2),{class:"w-3.5 h-3.5"})])])]),o("div",{class:"border border-gray-300 rounded overflow-hidden focus-within:border-blue-500 focus-within:ring-1 focus-within:ring-blue-500 resize-y relative group",style:ye({height:`${r.height||200}px`,minHeight:"100px",maxHeight:"600px"})},[ce(a(cl),{value:r.value,language:r.language,options:{...l.value,readOnly:r.disabled},"onUpdate:value":i,class:"w-full h-full"},null,8,["value","language","options"]),m[1]||(m[1]=o("div",{class:"absolute bottom-0 right-0 w-3 h-3 cursor-ns-resize pointer-events-none bg-gradient-to-tl from-gray-300 to-transparent opacity-50 group-hover:opacity-100"},null,-1))],4),ce(Ot,{visible:n.value,"onUpdate:visible":m[0]||(m[0]=_=>n.value=_),title:r.label,value:r.value,language:r.language,"read-only":r.disabled,"onUpdate:value":g,onClose:c},null,8,["visible","title","value","language","read-only"])]))}}),F2=Et(q2,[["__scopeId","data-v-44208768"]]),N2={class:"block text-xs text-gray-500 mb-1"},j2={class:"space-y-2"},H2=["value","disabled","placeholder"],U2={class:"flex flex-col gap-1"},V2=["disabled"],W2={class:"text-[10px] text-gray-400 text-center"},G2={key:0,class:"text-xs text-red-500 mt-1"},K2=ze({__name:"PropertyImage",props:{label:{},value:{},disabled:{type:Boolean},placeholder:{}},emits:["update:value"],setup(r,{emit:e}){const t=r,s=e,{t:n}=Ne(),l=le(null),i=le(""),d=()=>{var w;t.disabled||(w=l.value)==null||w.click()},c=w=>{var S;const m=w.target,_=(S=m.files)==null?void 0:S[0];if(!_)return;if(i.value="",_.size>2*1024*1024){i.value=n("properties.image.sizeError"),m.value="";return}const p=new FileReader;p.onload=v=>{var b;const k=(b=v.target)==null?void 0:b.result;s("update:value",k)},p.onerror=()=>{i.value=n("properties.image.readError")},p.readAsDataURL(_),m.value=""},g=w=>{const m=w.target;s("update:value",m.value)};return(w,m)=>(z(),F("div",null,[o("label",N2,E(r.label),1),o("div",j2,[o("input",{type:"text",value:r.value||"",disabled:r.disabled,placeholder:r.placeholder||a(n)("properties.image.urlPlaceholder"),onInput:g,class:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:border-blue-500 outline-none disabled:bg-gray-100 disabled:text-gray-500"},null,40,H2),o("div",U2,[o("button",{type:"button",onClick:d,disabled:r.disabled,class:"w-full py-1.5 px-3 bg-white text-gray-700 text-sm border border-gray-300 rounded hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2"},[m[0]||(m[0]=o("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12"})],-1)),Ce(" "+E(a(n)("properties.image.uploadBtn")),1)],8,V2),o("span",W2,E(a(n)("properties.image.uploadTip")),1)]),i.value?(z(),F("p",G2,E(i.value),1)):be("",!0),o("input",{ref_key:"fileInput",ref:l,type:"file",accept:"image/*",class:"hidden",onChange:c},null,544)])]))}}),Y2={class:"p-4 border-b border-gray-200 bg-gray-50 flex items-center justify-between"},X2={class:"font-semibold text-gray-700"},Z2={class:"text-xs text-gray-500 mt-1"},J2={key:0,class:"flex items-center text-red-500 gap-1 text-xs font-medium bg-red-50 px-2 py-1 rounded border border-red-100"},Q2={key:0,class:"p-6 text-center"},ew={class:"mb-4"},tw={class:"text-lg font-semibold text-gray-900"},rw={class:"text-sm text-gray-500 mt-2"},nw={class:"font-medium"},ow={key:1,class:"flex flex-col h-full overflow-hidden"},sw={class:"flex border-b border-gray-200 bg-white"},aw=["onClick"],lw={key:0,class:"absolute bottom-0 left-0 w-full h-0.5 bg-blue-600"},iw={class:"p-4 space-y-6 overflow-y-auto flex-1 custom-scrollbar"},dw={key:0,class:"space-y-3"},uw={class:"text-xs font-bold text-gray-500 uppercase tracking-wider"},cw={class:"grid grid-cols-2 gap-3"},hw={key:1,class:"space-y-3 pt-2 border-t border-gray-100"},pw={class:"text-xs font-bold text-gray-500 uppercase tracking-wider"},fw={class:"grid grid-cols-2 gap-3"},mw=["disabled"],gw=["disabled"],vw={class:"text-xs font-bold text-gray-500 uppercase tracking-wider"},bw={class:"space-y-3"},yw={key:0},ww=["onClick","disabled"],xw={key:6},_w={class:"block text-xs text-gray-500 mb-1 font-medium"},kw=["placeholder","disabled","value","onChange"],Sw={key:2,class:"space-y-3 pt-2 border-t border-gray-100"},Cw={class:"text-xs font-bold text-gray-500 uppercase tracking-wider"},Ew={key:3,class:"space-y-4"},Tw={class:"p-4 bg-gray-50 rounded border border-gray-200"},$w={class:"text-sm font-medium text-gray-700 mb-3"},Iw={class:"space-y-3"},Aw={class:"text-xs text-gray-500 mb-1.5 font-medium"},zw={class:"flex items-center gap-2 bg-white border border-gray-200 rounded px-2 py-1.5 hover:border-blue-400 transition-colors"},Pw=["title"],Lw=["title"],Mw={class:"text-xs text-gray-500 flex items-center justify-between border-t border-gray-100 pt-2"},Rw={class:"font-medium"},Dw={class:"px-2 py-0.5 bg-gray-100 rounded text-gray-600"},Bw=["disabled"],Ow={key:2,class:"p-6 text-center"},qw={class:"mb-4"},Fw={class:"text-lg font-semibold text-gray-900"},Nw={class:"text-sm text-gray-500 mt-2"},jw=ze({__name:"PropertiesPanel",setup(r){const{t:e}=Ne(),t=Re(),s=fe(()=>t.selectedElement),n=fe(()=>t.selectedElementIds.length>1),l=fe(()=>{var Z;return((Z=s.value)==null?void 0:Z.locked)||!1}),i=le(!1),d=le(""),c=fe(()=>s.value?[ge.LINE,ge.RECT,ge.CIRCLE].includes(s.value.type):!1),g=fe(()=>t.tableSelection?t.tableSelection.cells.length>1:!1),w=fe(()=>{if(!t.tableSelection||t.tableSelection.cells.length!==1)return!1;const Z=t.tableSelection.cells[0],ne=t.selectedElement;if(!ne||ne.type!==ge.TABLE)return!1;const we=(Z.section||"body")==="footer"?ne.footerData:ne.data;if(!we)return!1;const ie=we[Z.rowIndex];if(!ie)return!1;const ke=ie[Z.colField];return ke&&typeof ke=="object"?(ke.rowSpan||1)>1||(ke.colSpan||1)>1:!1}),m=le("properties"),_=le(!1),p=fe(()=>t.unit||"mm"),S=fe(()=>t.unit||"mm"),v=new Set(["fontSize","borderWidth","barcodeWidth","barcodeHeight","margin","borderRadius","headerHeight","rowHeight","footerHeight","labelFontSize","labelBorderWidth"]),k=Z=>Z.type!=="number"||!Z.key?!1:v.has(Z.key),b=Z=>{const ne=e(Z.label);return k(Z)?`${ne} (${S.value})`:ne},f=Z=>{const ne=te(Z);return k(Z)&&typeof ne=="number"?ot(ne,p.value):ne},T=(Z,ne)=>k(Z)?Ye(Number(ne),p.value):ne,D=Z=>{if(!(Z.min===void 0||Z.min===null))return k(Z)?ot(Z.min,p.value):Z.min},j=Z=>{if(!(Z.max===void 0||Z.max===null))return k(Z)?ot(Z.max,p.value):Z.max},B=Z=>{if(!(Z.step===void 0||Z.step===null))return k(Z)?ot(Z.step,p.value):Z.step},A=()=>{s.value&&(navigator.clipboard.writeText(s.value.id),_.value=!0,setTimeout(()=>{_.value=!1},2e3))},V=()=>{s.value&&(d.value=s.value.type,i.value=!0)},Y=Z=>{s.value&&Z&&t.addCustomElement(Z,s.value)},se=(Z,ne)=>{s.value&&t.updateElement(s.value.id,{[Z]:ne})},G=(Z,ne)=>{s.value&&t.updateElement(s.value.id,{style:{...s.value.style,[Z]:ne}})},I=(Z,ne)=>{try{const ve=ne.target.value;se(Z,JSON.parse(ve))}catch{window.alert("Invalid JSON")}},q=Z=>{const ne=te(Z);return Z.language==="json"&&typeof ne=="object"?JSON.stringify(ne,null,2):ne||""},h=(Z,ne)=>{if(Z.language==="json")try{const ve=JSON.parse(ne);se(Z.key,ve)}catch{}else se(Z.key,ne)},y=Z=>{switch(Z){case ge.TEXT:return by;case ge.IMAGE:return _y;case ge.TABLE:return Ky;case ge.PAGE_NUMBER:return Zy;case ge.BARCODE:return t2;case ge.QRCODE:return a2;case ge.LINE:return d2;case ge.RECT:return c2;case ge.CIRCLE:return p2;default:return null}},ee=fe(()=>s.value?y(s.value.type):null),K=fe(()=>ee.value?ee.value.sections.filter(Z=>(Z.tab||"properties")===m.value):[]),te=Z=>s.value?(Z.target==="style"?s.value.style:s.value)[Z.key]??Z.defaultValue:Z.defaultValue,$=(Z,ne)=>{s.value&&(Z.target==="style"&&Z.key?G(Z.key,ne):Z.target==="element"&&Z.key&&se(Z.key,ne))},W=Z=>{!s.value||!Z.actionName||(Z.actionName==="paginateTable"?t.paginateTable(s.value.id):Z.actionName==="removeBorder"&&t.updateElement(s.value.id,{style:{...s.value.style,borderStyle:void 0,borderWidth:void 0,borderColor:void 0,border:"none"}}))},L=()=>{n.value?t.removeSelectedElements():s.value&&t.removeElement(s.value.id)},O=Z=>{Z.relatedTarget&&Z.currentTarget.contains(Z.relatedTarget)||t.setDisableGlobalShortcuts(!0)},re=Z=>{Z.relatedTarget&&Z.currentTarget.contains(Z.relatedTarget)||t.setDisableGlobalShortcuts(!1)};return(Z,ne)=>(z(),F(Te,null,[o("aside",{class:"w-[380px] bg-white border-l border-gray-200 flex flex-col h-full z-40 overflow-hidden",onFocusin:O,onFocusout:re},[o("div",Y2,[o("div",null,[o("h2",X2,E(a(e)("properties.title")),1),o("p",Z2,E(a(e)("properties.subtitle")),1)]),l.value?(z(),F("div",J2,[ce(a(Qt),{class:"w-3 h-3"}),o("span",null,E(a(e)("properties.locked")),1)])):be("",!0)]),n.value?(z(),F("div",Q2,[o("div",ew,[o("h3",tw,E(a(e)("properties.multiSelectMode")),1),o("p",rw,[o("span",nw,E(a(t).selectedElementIds.length),1),Ce(" "+E(a(e)("properties.selectedElements",{n:""}).replace("{n}","")),1)])]),o("button",{onClick:L,class:"w-full py-2 bg-red-50 text-red-600 rounded border border-red-200 hover:bg-red-100 transition-colors text-sm font-medium"},E(a(e)("properties.deleteSelected")),1)])):s.value?(z(),F("div",ow,[o("div",sw,[(z(),F(Te,null,Le(["properties","style","advanced"],ve=>o("button",{key:ve,onClick:we=>m.value=ve,class:xe(["flex-1 py-3 text-sm font-medium transition-colors relative",m.value===ve?"text-blue-600":"text-gray-500 hover:text-gray-700 hover:bg-gray-50"])},[Ce(E(a(e)(`properties.tab.${ve}`))+" ",1),m.value===ve?(z(),F("div",lw)):be("",!0)],10,aw)),64))]),o("div",iw,[m.value==="properties"?(z(),F("div",dw,[o("h3",uw,E(a(e)("properties.section.positionSize")),1),o("div",cw,[ce($t,{label:`${a(e)("properties.label.x")} (${S.value})`,type:"number",disabled:l.value,value:a(ot)(s.value.x,p.value),"onUpdate:value":ne[0]||(ne[0]=ve=>se("x",a(Ye)(Number(ve),p.value)))},null,8,["label","disabled","value"]),ce($t,{label:`${a(e)("properties.label.y")} (${S.value})`,type:"number",disabled:l.value,value:a(ot)(s.value.y,p.value),"onUpdate:value":ne[1]||(ne[1]=ve=>se("y",a(Ye)(Number(ve),p.value)))},null,8,["label","disabled","value"]),ce($t,{label:`${a(e)("properties.label.width")} (${S.value})`,type:"number",disabled:l.value,value:a(ot)(s.value.width,p.value),"onUpdate:value":ne[2]||(ne[2]=ve=>se("width",a(Ye)(Number(ve),p.value)))},null,8,["label","disabled","value"]),ce($t,{label:`${a(e)("properties.label.height")} (${S.value})`,type:"number",disabled:l.value,value:a(ot)(s.value.height,p.value),"onUpdate:value":ne[3]||(ne[3]=ve=>se("height",a(Ye)(Number(ve),p.value)))},null,8,["label","disabled","value"])])])):be("",!0),m.value==="properties"&&s.value.type==="table"&&a(t).tableSelection?(z(),F("div",hw,[o("h3",pw,E(a(e)("properties.section.cellOperations")),1),o("div",fw,[o("button",{onClick:ne[4]||(ne[4]=ve=>a(t).mergeSelectedCells()),disabled:!g.value||l.value,class:"w-full py-2 bg-blue-50 text-blue-600 rounded border border-blue-200 hover:bg-blue-100 transition-colors text-xs font-medium disabled:opacity-50 disabled:cursor-not-allowed disabled:bg-gray-50 disabled:text-gray-400 disabled:border-gray-200"},E(a(e)("properties.action.mergeCells")),9,mw),o("button",{onClick:ne[5]||(ne[5]=ve=>a(t).splitSelectedCells()),disabled:!w.value||l.value,class:"w-full py-2 bg-white text-gray-600 rounded border border-gray-200 hover:bg-gray-50 transition-colors text-xs font-medium disabled:opacity-50 disabled:cursor-not-allowed"},E(a(e)("properties.action.splitCells")),9,gw)])])):be("",!0),(z(!0),F(Te,null,Le(K.value,(ve,we)=>(z(),F("div",{key:we,class:"space-y-3 pt-2 first:pt-0 border-t first:border-0 border-gray-100"},[o("h3",vw,E(a(e)(ve.title)),1),o("div",bw,[(z(!0),F(Te,null,Le(ve.fields,(ie,ke)=>(z(),F(Te,{key:ke},[ie.type==="action"?(z(),F("div",yw,[o("button",{onClick:_e=>W(ie),disabled:l.value,class:"w-full py-2 bg-blue-600 text-white rounded hover:bg-blue-700 transition-colors text-sm font-medium shadow-sm disabled:opacity-50 disabled:cursor-not-allowed disabled:bg-gray-400"},E(a(e)(ie.label)),9,ww)])):ie.type==="text"||ie.type==="number"||ie.type==="switch"?(z(),Pe($t,{key:1,label:b(ie),type:ie.type,min:D(ie),max:j(ie),step:B(ie),disabled:l.value,placeholder:ie.placeholder?ie.placeholder.startsWith("properties.")?a(e)(ie.placeholder):ie.placeholder:"",value:f(ie),"onUpdate:value":_e=>$(ie,T(ie,_e))},null,8,["label","type","min","max","step","disabled","placeholder","value","onUpdate:value"])):ie.type==="select"?(z(),Pe(E2,{key:2,label:a(e)(ie.label),options:(ie.options||[]).map(_e=>({..._e,label:a(e)(_e.label)})),disabled:l.value,value:te(ie),"onUpdate:value":_e=>$(ie,_e)},null,8,["label","options","disabled","value","onUpdate:value"])):ie.type==="color"?(z(),Pe(rl,{key:3,label:a(e)(ie.label),disabled:l.value,value:te(ie),"onUpdate:value":_e=>$(ie,_e)},null,8,["label","disabled","value","onUpdate:value"])):ie.type==="image"?(z(),Pe(K2,{key:4,label:a(e)(ie.label),disabled:l.value,placeholder:ie.placeholder?ie.placeholder.startsWith("properties.")?a(e)(ie.placeholder):ie.placeholder:void 0,value:te(ie),"onUpdate:value":_e=>$(ie,_e)},null,8,["label","disabled","placeholder","value","onUpdate:value"])):ie.type==="code"?(z(),Pe(F2,{key:5,label:a(e)(ie.label),language:ie.language||"javascript",disabled:l.value,value:q(ie),"onUpdate:value":_e=>h(ie,_e)},null,8,["label","language","disabled","value","onUpdate:value"])):ie.type==="textarea"?(z(),F("div",xw,[o("label",_w,E(a(e)(ie.label)),1),o("textarea",{placeholder:ie.placeholder?ie.placeholder.startsWith("properties.")?a(e)(ie.placeholder):ie.placeholder:"",disabled:l.value,value:["data","columns","footerData"].includes(ie.key)?JSON.stringify(s.value[ie.key],null,2):te(ie),onChange:_e=>["data","columns","footerData"].includes(ie.key)?I(ie.key,_e):$(ie,_e.target.value),class:"w-full px-3 py-2 text-sm border border-gray-300 rounded focus:border-blue-500 outline-none h-24 resize-y font-mono disabled:bg-gray-100 disabled:text-gray-500"},null,40,kw)])):be("",!0)],64))),128))])]))),128)),m.value==="style"&&!c.value?(z(),F("div",Sw,[o("h3",Cw,E(a(e)("properties.section.appearance")),1),ce(rl,{label:a(e)("properties.label.backgroundColor"),disabled:l.value,value:s.value.style.backgroundColor||"#ffffff","onUpdate:value":ne[6]||(ne[6]=ve=>G("backgroundColor",ve))},null,8,["label","disabled","value"])])):be("",!0),m.value==="advanced"?(z(),F("div",Ew,[o("div",Tw,[o("h4",$w,E(a(e)("properties.section.elementInfo")),1),o("div",Iw,[o("div",null,[o("p",Aw,E(a(e)("properties.label.id")),1),o("div",zw,[o("span",{class:"font-mono text-xs text-gray-600 flex-1 truncate select-all",title:s.value.id},E(s.value.id),9,Pw),o("button",{onClick:A,class:"text-gray-400 hover:text-blue-600 transition-colors p-1 rounded hover:bg-gray-100 flex-shrink-0",title:_.value?a(e)("properties.action.copied"):a(e)("properties.action.copyId")},[_.value?(z(),Pe(a(nh),{key:0,class:"w-3.5 h-3.5 text-green-500"})):(z(),Pe(a(Ct),{key:1,class:"w-3.5 h-3.5"}))],8,Lw)])]),o("div",Mw,[o("span",Rw,E(a(e)("properties.label.type")),1),o("span",Dw,E(a(e)("elements."+s.value.type)),1)])])]),o("button",{onClick:V,class:"w-full py-2 bg-white text-blue-600 rounded border border-blue-200 hover:bg-blue-50 transition-colors text-sm font-medium flex items-center justify-center gap-2 mb-2 disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:bg-white"},[ce(a(To),{class:"w-4 h-4"}),Ce(" "+E(a(e)("properties.action.saveCustom")),1)]),o("button",{onClick:L,disabled:l.value,class:"w-full py-2 bg-white text-red-600 rounded border border-red-200 hover:bg-red-50 transition-colors text-sm font-medium flex items-center justify-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:bg-white"},[ce(a(St),{class:"w-4 h-4"}),Ce(" "+E(a(e)("properties.action.deleteElement")),1)],8,Bw)])):be("",!0)])])):(z(),F("div",Ow,[o("div",qw,[o("h3",Fw,E(a(e)("properties.empty.noSelection")),1),o("p",Nw,E(a(e)("properties.empty.selectInstruction")),1)])]))],32),ce(qt,{show:i.value,"initial-value":d.value,title:a(e)("properties.action.saveCustomModal"),placeholder:a(e)("sidebar.enterNamePlaceholder"),onClose:ne[7]||(ne[7]=ve=>i.value=!1),onSave:Y},null,8,["show","initial-value","title","placeholder"])],64))}}),Hw=Et(jw,[["__scopeId","data-v-35d350fc"]]),Uw={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function Vw(r,e){return z(),F("svg",Uw,[...e[0]||(e[0]=[o("path",{fill:"currentColor",d:"M13.05 22v-2.05q.85-.125 1.663-.45t1.537-.85l1.4 1.45q-1.05.8-2.2 1.287t-2.4.613m-2 0q-3.45-.45-5.725-2.988T3.05 13.05q0-1.875.713-3.512t1.925-2.85t2.85-1.925t3.512-.713h.15L10.65 2.5l1.4-1.45l4 4l-4 4l-1.4-1.4l1.6-1.6h-.2q-2.925 0-4.962 2.038T5.05 13.05q0 2.6 1.7 4.563t4.3 2.337zm8.05-3.35l-1.45-1.4q.525-.725.85-1.537t.45-1.663H21q-.125 1.25-.612 2.4t-1.288 2.2m1.9-6.6h-2.05q-.125-.85-.45-1.662t-.85-1.538l1.45-1.4q.8.975 1.275 2.15T21 12.05"},null,-1)])])}const Ww=Se({name:"material-symbols-rotate-right",render:Vw}),Gw={key:0,"data-print-exclude":"true",class:"absolute -top-3 -right-3 bg-red-500 rounded-full p-1 shadow-md z-50"},Kw=["title"],nl=ze({__name:"ElementWrapper",props:{element:{},isSelected:{type:Boolean},zoom:{},pageIndex:{},readOnly:{type:Boolean}},setup(r){const e=r,{t}=Ne(),s=Re(),n=le(null),l=fe(()=>{const D=!e.isSelected&&s.selectedElementIds.includes(e.element.id),j=!e.readOnly&&(e.isSelected||D),B={left:`${e.element.x}px`,top:`${e.element.y}px`,width:`${e.element.width}px`,height:`${e.element.height}px`,zIndex:e.element.style.zIndex||1,transform:`rotate(${e.element.style.rotate||0}deg)`,...e.element.style},A=[ge.TABLE,ge.LINE,ge.RECT,ge.CIRCLE];return A.includes(e.element.type)&&(delete B.backgroundColor,delete B.border,delete B.borderWidth,delete B.borderStyle,delete B.borderColor,delete B.borderRadius),j?B.border=e.element.locked?"2px solid #ef4444":"2px solid var(--brand-500)":!A.includes(e.element.type)&&e.element.style.borderStyle&&e.element.style.borderStyle!=="none"?(B.borderStyle=e.element.style.borderStyle,B.borderWidth=`${e.element.style.borderWidth||1}px`,B.borderColor=e.element.style.borderColor||"#000",delete B.border):!A.includes(e.element.type)&&e.element.style.border?B.border=e.element.style.border:B.border="1px dashed transparent",B});let i=0,d=0,c=0,g=0,w=!1,m=!1;const _=D=>{e.readOnly||D.button!==0||D.target.closest(".resize-handle")||D.target.closest(".rotate-handle")||(D.ctrlKey||D.metaKey?s.selectElement(e.element.id,!0):s.selectedElementIds.includes(e.element.id)||s.selectElement(e.element.id,!1),e.element.locked)||(w=!0,s.setDragging(!0),m=!1,i=D.clientX,d=D.clientY,c=e.element.x,g=e.element.y,window.addEventListener("mousemove",p),window.addEventListener("mouseup",S))},p=D=>{if(!w)return;const j=(D.clientX-i)/e.zoom,B=(D.clientY-d)/e.zoom;(Math.abs(j)>2||Math.abs(B)>2)&&(m||(s.snapshot(),m=!0),s.selectedElementIds.length>1&&s.selectedElementIds.includes(e.element.id)?s.moveSelectedElements(e.element.id,c+j,g+B,!1,!1):s.moveElementWithSnap(e.element.id,c+j,g+B,!1,!1))},S=D=>{if(w&&m){const B=document.elementsFromPoint(D.clientX,D.clientY).find(A=>A.classList.contains("print-page"));if(B){const A=B.id,V=parseInt(A.replace("page-",""),10);if(!isNaN(V)&&V!==e.pageIndex){const Y=document.getElementById(`page-${e.pageIndex}`);if(Y){const se=Y.getBoundingClientRect(),G=B.getBoundingClientRect(),I=(se.left-G.left)/e.zoom,q=(se.top-G.top)/e.zoom;(s.selectedElementIds.length>1&&s.selectedElementIds.includes(e.element.id)?[...s.selectedElementIds]:[e.element.id]).forEach(y=>{const K=s.pages[e.pageIndex].elements.find(te=>te.id===y);K&&s.moveElementToPage(y,V,K.x+I,K.y+q)})}}else s.selectedElementIds.length>1&&s.selectedElementIds.includes(e.element.id)?s.moveSelectedElements(e.element.id,e.element.x,e.element.y,!1,!0):s.moveElementWithSnap(e.element.id,e.element.x,e.element.y,!1,!0)}}w&&!m&&(D.ctrlKey||D.metaKey||s.selectElement(e.element.id,!1)),w=!1,s.setDragging(!1),window.removeEventListener("mousemove",p),window.removeEventListener("mouseup",S),s.setHighlightedGuide(null),s.setHighlightedEdge(null)},v=le(!1),k=le(!1),b=le(0),f=D=>{if(D.stopPropagation(),D.preventDefault(),!n.value)return;v.value=!0,k.value=!1,m=!1,b.value=e.element.style.rotate||0;const j=n.value.getBoundingClientRect(),B=j.left+j.width/2,A=j.top+j.height/2,V=Math.atan2(D.clientY-A,D.clientX-B),Y=e.element.style.rotate||0,se=I=>{const h=(Math.atan2(I.clientY-A,I.clientX-B)-V)*(180/Math.PI);let y=Y+h;if(y=y%360,y<0&&(y+=360),k.value=!1,I.shiftKey)y=Math.round(y/45)*45,k.value=!0;else if(!I.ctrlKey){const K=[0,90,180,270,360];for(const te of K)if(Math.abs(y-te)<=5){y=te===360?0:te,k.value=!0;break}}y=Math.round(y),y===360&&(y=0),b.value=y,m||(s.snapshot(),m=!0),s.updateElement(e.element.id,{style:{...e.element.style,rotate:y}},!1)},G=()=>{v.value=!1,window.removeEventListener("mousemove",se),window.removeEventListener("mouseup",G)};window.addEventListener("mousemove",se),window.addEventListener("mouseup",G)},T=D=>{D.stopPropagation(),D.preventDefault();const j=D.clientX,B=D.clientY,A=e.element.width,V=e.element.height;m=!1;const Y=G=>{const I=(G.clientX-j)/e.zoom,q=(G.clientY-B)/e.zoom;m||(s.snapshot(),m=!0);let h=A+I,y=V+q;if(G.shiftKey){const ee=A/V;Math.abs(h/A-1)>Math.abs(y/V-1)?y=h/ee:h=y*ee}s.updateElement(e.element.id,{width:Math.max(10,h),height:Math.max(10,y)},!1)},se=()=>{window.removeEventListener("mousemove",Y),window.removeEventListener("mouseup",se)};window.addEventListener("mousemove",Y),window.addEventListener("mouseup",se)};return(D,j)=>(z(),F("div",{ref_key:"elementRef",ref:n,class:xe(["element-wrapper absolute select-none",[r.readOnly?"cursor-not-allowed":"group theme-outline-hover",!r.readOnly&&r.element.locked?"cursor-not-allowed":"",!r.readOnly&&!r.element.locked?"cursor-move":""]]),style:ye(l.value),onMousedown:_},[ul(D.$slots,"default"),!r.readOnly&&r.element.locked&&r.isSelected?(z(),F("div",Gw,[ce(a(Qt),{class:"w-3 h-3 text-white"})])):be("",!0),!r.readOnly&&r.isSelected&&a(s).selectedElementIds.length<=1&&!r.element.locked?(z(),F(Te,{key:1},[o("div",{"data-print-exclude":"true",class:"resize-handle absolute bottom-0 right-0 w-3 h-3 bg-blue-600 cursor-se-resize z-50",onMousedown:T},null,32),o("div",{"data-print-exclude":"true",class:"rotate-handle absolute -top-4 -right-5 w-5 h-5 flex items-center justify-center cursor-grab z-50 theme-text theme-text-hover",title:a(t)("common.rotate"),onMousedown:f},[ce(a(Ww),{class:"w-3 h-3"}),v.value?(z(),F("div",{key:0,class:xe(["absolute top-6 left-1/2 transform -translate-x-1/2 text-xs px-2 py-1 rounded whitespace-nowrap z-50 pointer-events-none font-sans font-normal not-italic leading-none tracking-normal normal-case",k.value?"theme-bg-strong text-white":"theme-bg-soft text-white"])},E(b.value)+"° ",3)):be("",!0)],40,Kw)],64)):be("",!0)],38))}}),Yw={class:"absolute top-0 -right-12 flex flex-col gap-2 z-10"},Xw=["title"],Zw=["title","onClick"],Jw=["title","onClick"],Qw=["title","onClick"],ex=["id","onDrop","onMousedown","onContextmenu"],tx={key:0,"data-print-exclude":"true",class:"absolute inset-0 pointer-events-none opacity-50",style:{"background-image":"linear-gradient(#e5e7eb 1px, transparent 1px), linear-gradient(90deg, #e5e7eb 1px, transparent 1px)","background-size":"20px 20px"}},rx=["onMousedown"],nx=["onMousedown"],ox={key:5,"data-print-exclude":"true",class:"marker absolute inset-0 pointer-events-none z-50 opacity-50"},Wl=ze({__name:"Canvas",setup(r){const e=Re(),{t}=Ne(),s=fe(()=>e.pages),n=fe(()=>e.zoom),l=fe(()=>e.pageSpacingY||0),i=fe(()=>e.pageSpacingX||0),d=fe(()=>e.pageSpacingX||0),c=fe(()=>e.pageSpacingY||0),g=fe(()=>e.pageSpacingY||0),w=le(!1),m=le(null),_=le(null),p=($,W)=>{$.preventDefault(),$.stopPropagation(),w.value=!0,m.value=W;const L=$.target;_.value=L.closest(".print-page"),window.addEventListener("mousemove",S),window.addEventListener("mouseup",v)},S=$=>{if(!w.value||!_.value)return;const W=_.value.getBoundingClientRect(),L=($.clientY-W.top)/e.zoom,O=Math.max(0,Math.min(e.canvasSize.height,L));m.value==="header"?e.setHeaderHeight(Math.round(O)):m.value==="footer"&&e.setFooterHeight(Math.round(e.canvasSize.height-O))},v=()=>{w.value=!1,m.value=null,_.value=null,window.removeEventListener("mousemove",S),window.removeEventListener("mouseup",v)};Ge(()=>{window.removeEventListener("mousemove",S),window.removeEventListener("mouseup",v)});const k=fe(()=>{const $={width:`${e.canvasSize.width}px`,height:`${e.canvasSize.height}px`,backgroundColor:e.canvasBackground};return f.value?{...$,...f.value}:$}),b=$=>$.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;"),f=fe(()=>{const $=e.watermark;if(!$||!$.enabled||!$.text)return null;const W=b($.text),L=Number.isFinite($.angle)?$.angle:-30,O=Math.max(6,$.size||24),re=Math.max(40,$.density||160),Z=$.color||"#000000",ne=Math.min(1,Math.max(0,$.opacity??.1)),ve=`<?xml version="1.0" encoding="UTF-8"?><svg xmlns="http://www.w3.org/2000/svg" width="${re}" height="${re}"><text x="50%" y="50%" dominant-baseline="middle" text-anchor="middle" fill="${Z}" fill-opacity="${ne}" font-size="${O}" transform="rotate(${L} ${re/2} ${re/2})">${W}</text></svg>`;return{backgroundImage:`url("data:image/svg+xml,${encodeURIComponent(ve)}")`,backgroundRepeat:"repeat",backgroundSize:`${re}px ${re}px`}}),T=fe(()=>!e.isDragging||!e.selectedElementId?-1:e.pages.findIndex($=>$.elements.some(W=>W.id===e.selectedElementId))),D=le(!1),j=le({x:0,y:0}),B=le({x:0,y:0}),A=le(null),V=le(!1),Y=fe(()=>{if(!D.value)return{display:"none"};const $=Math.min(j.value.x,B.value.x),W=Math.min(j.value.y,B.value.y),L=Math.abs(B.value.x-j.value.x),O=Math.abs(B.value.y-j.value.y);return{position:"absolute",left:`${$}px`,top:`${W}px`,width:`${L}px`,height:`${O}px`,border:"1px solid var(--brand-500)",backgroundColor:"var(--brand-500-alpha-10)",pointerEvents:"none",zIndex:1e3}}),se=$=>{switch($){case ge.TEXT:return tl;case ge.IMAGE:return ky;case ge.TABLE:return Yy;case ge.PAGE_NUMBER:return Jy;case ge.BARCODE:return r2;case ge.QRCODE:return l2;case ge.LINE:return u2;case ge.RECT:return h2;case ge.CIRCLE:return f2;default:return tl}},G=($,W)=>{var _e;$.preventDefault();const L=(_e=$.dataTransfer)==null?void 0:_e.getData("application/json");if(!L)return;const{type:O,payload:re}=JSON.parse(L),Z=$.currentTarget.getBoundingClientRect(),ne=($.clientX-Z.left)/e.zoom,ve=($.clientY-Z.top)/e.zoom;if(re){e.addElement({...re,x:ne,y:ve,locked:!1},W);return}const we={[ge.PAGE_NUMBER]:52,[ge.BARCODE]:200,[ge.QRCODE]:100,[ge.LINE]:200,[ge.RECT]:100,[ge.CIRCLE]:100},ie={[ge.PAGE_NUMBER]:20,[ge.BARCODE]:80,[ge.QRCODE]:100,[ge.TABLE]:150,[ge.LINE]:20,[ge.RECT]:100,[ge.CIRCLE]:100},ke={type:O,x:ne,y:ve,width:we[O]||200,height:ie[O]||100,variable:"",style:{fontSize:14,color:"#000000",...O===ge.RECT||O===ge.CIRCLE||O===ge.PAGE_NUMBER?{backgroundColor:"transparent"}:{},...O===ge.TABLE?{headerBackgroundColor:"#f3f4f6",headerColor:"#000000",footerBackgroundColor:"#f9fafb",footerColor:"#000000"}:{}},content:O===ge.TEXT?t("canvas.newText"):O===ge.BARCODE?"12345678":O===ge.QRCODE?"https://example.com":"",format:O===ge.PAGE_NUMBER?"1/Total":void 0,columns:O===ge.TABLE?[{field:"id",header:t("canvas.defaultTableHeaders.id"),width:50},{field:"name",header:t("canvas.defaultTableHeaders.name"),width:100},{field:"qty",header:t("canvas.defaultTableHeaders.qty"),width:60},{field:"price",header:t("canvas.defaultTableHeaders.price"),width:80},{field:"total",header:t("canvas.defaultTableHeaders.total"),width:80}]:void 0,data:O===ge.TABLE?Array.from({length:30},(oe,ue)=>({id:ue+1,name:`${t("canvas.defaultTableData.item")} ${ue+1}`,qty:ue%5+1,price:100+ue*10,total:(ue%5+1)*(100+ue*10)})):void 0,showFooter:O===ge.TABLE?!0:void 0,tfootRepeat:O===ge.TABLE?!0:void 0,autoPaginate:O===ge.TABLE?!0:void 0,footerData:O===ge.TABLE?[{id:{value:t("canvas.defaultTableData.pageSum")},qty:{value:"",field:"{#pageQty}"},total:{value:"",field:"{#pageSum}"}},{id:{value:t("canvas.defaultTableData.total")},qty:{value:"",field:"{#totalQty}"},total:{value:"",field:"{#totalSum}"}},{id:{value:t("canvas.defaultTableData.inWords")},total:{value:"",field:"{#totalCap}"}}]:void 0,customScript:O===ge.TABLE?`// RMB Uppercase Conversion
try {
  function digitUppercase(n) {
      var fraction = ['角', '分'];
      var digit = [
          '零', '壹', '贰', '叁', '肆',
          '伍', '陆', '柒', '捌', '玖'
      ];
      var unit = [
          ['元', '万', '亿'],
          ['', '拾', '佰', '仟']
      ];
      var head = n < 0 ? '欠' : '';
      n = Math.abs(n);
      var s = '';
      for (var i = 0; i < fraction.length; i++) {
          s += (digit[Math.floor(n * 10 * Math.pow(10, i)) % 10] + fraction[i]).replace(/零./, '');
      }
      s = s || '整';
      n = Math.floor(n);
      for (var i = 0; i < unit[0].length && n > 0; i++) {
          var p = '';
          for (var j = 0; j < unit[1].length && n > 0; j++) {
              p = digit[n % 10] + unit[1][j] + p;
              n = Math.floor(n / 10);
          }
          s = p.replace(/(零.)*零$/, '').replace(/^$/, '零') + unit[0][i] + s;
      }
      return head + s.replace(/(零.)*零元/, '元')
          .replace(/(零.)+/g, '零')
          .replace(/^整$/, '零元整');
  }

  // 1. Calculate Total (works for both Global and Page data)
  let totalAmount = 0;
  let totalQty = 0;
  if (data && Array.isArray(data)) {
    data.forEach(row => {
      // Ensure numeric values
      const val = Number(row.total) || 0;
      const qty = Number(row.qty) || 0;
      totalAmount += val;
      totalQty += qty;
    });
  }

  // 2. Update Footer Data
  if (footerData && Array.isArray(footerData)) {
    footerData.forEach(row => {
      Object.keys(row).forEach(key => {
        const val = row[key];
        const processValue = (v) => {
           if (typeof v !== 'string') return v;
           
           // Global replacements (Grand Total)
           if (typeof type === 'undefined' || type !== 'page') {
               if (v.includes('{#totalSum}')) return v.replace('{#totalSum}', totalAmount.toFixed(2));
               if (v.includes('{#totalQty}')) return v.replace('{#totalQty}', String(totalQty));
               if (v.includes('{#totalCap}')) return v.replace('{#totalCap}', digitUppercase(totalAmount));
               
               // For {#pageSum}, we want to show the Grand Total in the Designer (visual feedback),
               // but pass the original {#pageSum} token to the Print logic (via data-value).
               if (v.includes('{#pageSum}')) {
                   const displayVal = v.replace('{#pageSum}', totalAmount.toFixed(2));
                   // printValue keeps {#pageSum} but resolves other globals
                   const printVal = v.replace('{#totalSum}', totalAmount.toFixed(2))
                                   .replace('{#totalQty}', String(totalQty))
                                   .replace('{#totalCap}', digitUppercase(totalAmount)); 
                   
                   return { value: displayVal, printValue: printVal };
               }

               // For {#pageQty}
               if (v.includes('{#pageQty}')) {
                   const displayVal = v.replace('{#pageQty}', String(totalQty));
                   // printValue keeps {#pageQty} but resolves other globals
                   const printVal = v.replace('{#totalSum}', totalAmount.toFixed(2))
                                   .replace('{#totalQty}', String(totalQty))
                                   .replace('{#totalCap}', digitUppercase(totalAmount)); 
                   
                   return { value: displayVal, printValue: printVal };
               }
           }
           
           // Page replacements (Page Sum)
           if (typeof type !== 'undefined' && type === 'page') {
               if (v.includes('{#pageSum}')) return v.replace('{#pageSum}', totalAmount.toFixed(2));
               if (v.includes('{#pageQty}')) return v.replace('{#pageQty}', String(totalQty));
           }
           return v;
        };

        // Handle object values
        if (val && typeof val === 'object') {
           // If it has a 'field' property, check if it contains a variable
           if (val.field && typeof val.field === 'string') {
               const processed = processValue(val.field);
               // If processed is different from field (meaning a replacement happened)
               // OR if processValue returned an object (for {#pageSum})
               if (processed !== val.field || typeof processed === 'object') {
                   if (typeof processed === 'object') {
                       val.result = processed.value; // Store in result, keep val.value as text
                       val.printValue = processed.printValue;
                   } else {
                       val.result = processed;
                   }
               }
           }
           // Also check 'value' if it was set manually and looks like a variable
           else if (val.value && typeof val.value === 'string') {
               // Only process if value looks like a variable, otherwise it's just text
               if (val.value.includes('{#')) {
                  const processed = processValue(val.value);
                  if (typeof processed === 'object') {
                       val.result = processed.value;
                       val.printValue = processed.printValue;
                   } else {
                       val.result = processed;
                   }
               }
           }
        }
      });
    });
  }

  return { data, footerData };
} catch (e) {
  console.error('Script Execution Error:', e);
  return { data, footerData };
}`:void 0};e.addElement(ke,W)},I=$=>{$.preventDefault()},q=$=>{!$.ctrlKey&&!$.metaKey&&!V.value&&e.selectElement(null)},h=($,W)=>{if($.button!==0||$.ctrlKey||$.metaKey||$.target.closest(".element-wrapper"))return;$.preventDefault(),D.value=!0,A.value=W;const re=$.currentTarget.getBoundingClientRect();j.value={x:($.clientX-re.left)/n.value,y:($.clientY-re.top)/n.value},B.value={...j.value},window.addEventListener("mousemove",y),window.addEventListener("mouseup",ee)},y=$=>{if(!D.value||A.value===null)return;const W=document.getElementById(`page-${A.value}`);if(!W)return;const L=W.getBoundingClientRect();B.value={x:($.clientX-L.left)/n.value,y:($.clientY-L.top)/n.value}},ee=()=>{if(!D.value)return;const $=Math.min(j.value.x,B.value.x),W=Math.min(j.value.y,B.value.y),L=Math.abs(B.value.x-j.value.x),O=Math.abs(B.value.y-j.value.y),re=[];if(A.value!==null){const Z=s.value[A.value];if(Z)for(const ne of Z.elements){const ve=ne.x+ne.width,we=ne.y+ne.height,ie=$+L,ke=W+O;ne.x<ie&&ve>$&&ne.y<ke&&we>W&&re.push(ne.id)}}e.setSelection(re),D.value=!1,A.value=null,V.value=!0,setTimeout(()=>{V.value=!1},50),window.removeEventListener("mousemove",y),window.removeEventListener("mouseup",ee)},K=($,W)=>{var ie;const O=$.currentTarget.getBoundingClientRect(),re=($.clientX-O.left)/n.value,Z=($.clientY-O.top)/n.value,ne=s.value[W];if(!ne)return;let ve=null,we=-1/0;for(let ke=0;ke<ne.elements.length;ke++){const _e=ne.elements[ke];if(re>=_e.x&&re<=_e.x+_e.width&&Z>=_e.y&&Z<=_e.y+_e.height){const ue=((ie=_e.style)==null?void 0:ie.zIndex)??1;ue>=we&&(we=ue,ve=_e.id)}}ve&&e.selectElement(ve,!1)},te=()=>s.value.length===0?[]:s.value[0].elements.filter(W=>e.showHeaderLine&&W.y<e.headerHeight||e.showFooterLine&&W.y>=e.canvasSize.height-e.footerHeight);return($,W)=>(z(),F("div",{class:"flex flex-col",style:ye({transform:`scale(${n.value})`,transformOrigin:"top left",width:"fit-content",rowGap:`${l.value}px`})},[(z(!0),F(Te,null,Le(s.value,(L,O)=>(z(),F("div",{key:L.id,class:"relative group"},[o("div",Yw,[o("button",{class:"w-8 h-8 flex items-center justify-center bg-white border border-gray-200 rounded shadow hover:bg-blue-50 hover:text-blue-600 text-gray-600 transition-colors",title:a(t)("canvas.addPage"),onClick:W[0]||(W[0]=re=>a(e).addPage())},[ce(a(Ao))],8,Xw),o("button",{class:"w-8 h-8 flex items-center justify-center bg-white border border-gray-200 rounded shadow hover:bg-blue-50 hover:text-blue-600 text-gray-600 transition-colors",title:a(t)("canvas.copyPage"),onClick:re=>a(e).copyPage(O)},[ce(a(Ct))],8,Zw),a(e).copiedPage?(z(),F("button",{key:0,class:"w-8 h-8 flex items-center justify-center bg-white border border-gray-200 rounded shadow hover:bg-blue-50 hover:text-blue-600 text-gray-600 transition-colors",title:a(t)("canvas.pastePage"),onClick:re=>a(e).pastePage(O)},[ce(a($o))],8,Jw)):be("",!0),O>0?(z(),F("button",{key:1,class:"w-8 h-8 flex items-center justify-center bg-white border border-gray-200 rounded shadow hover:bg-red-50 hover:text-red-600 text-gray-600 transition-colors",title:a(t)("canvas.deletePage"),onClick:re=>a(e).removePage(O)},[ce(a(St))],8,Qw)):be("",!0)]),o("div",{id:`page-${O}`,class:"print-page shadow-lg relative overflow-hidden transition-all",style:ye([k.value,{overflow:T.value===O?"visible":"hidden",zIndex:T.value===O?50:1}]),onDrop:re=>G(re,O),onDragover:I,onMousedown:re=>h(re,O),onContextmenu:re=>K(re,O),onClick:Ke(q,["self"])},[a(e).showGrid?(z(),F("div",tx)):be("",!0),D.value&&A.value===O?(z(),F("div",{key:1,"data-print-exclude":"true",style:ye(Y.value)},null,4)):be("",!0),a(e).showHeaderLine?(z(),F("div",{key:2,"data-print-exclude":"true",class:xe(["absolute left-0 w-full z-20 group flex flex-col justify-center items-center",O===0?"cursor-row-resize":"cursor-default"]),style:ye({top:`${a(e).headerHeight}px`,height:"12px",marginTop:"-6px"}),onMousedown:re=>O===0&&p(re,"header")},[o("div",{class:"w-full h-px",style:ye({backgroundImage:O===0?"linear-gradient(to right, #f87171 60%, transparent 40%)":"linear-gradient(to right, #d1d5db 60%, transparent 40%)",backgroundSize:"20px 1px",backgroundRepeat:"repeat-x"})},null,4),o("div",{class:xe(["absolute right-0 -top-4 text-xs bg-white/80 px-1 pointer-events-none",O===0?"text-red-400":"text-gray-400"])},E(a(t)("canvas.headerLabel")),3)],46,rx)):be("",!0),a(e).showFooterLine?(z(),F("div",{key:3,"data-print-exclude":"true",class:xe(["absolute left-0 w-full z-20 group flex flex-col justify-center items-center",O===0?"cursor-row-resize":"cursor-default"]),style:ye({bottom:`${a(e).footerHeight}px`,height:"12px",marginBottom:"-6px"}),onMousedown:re=>O===0&&p(re,"footer")},[o("div",{class:"w-full h-px",style:ye({backgroundImage:O===0?"linear-gradient(to right, #f87171 60%, transparent 40%)":"linear-gradient(to right, #d1d5db 60%, transparent 40%)",backgroundSize:"20px 1px",backgroundRepeat:"repeat-x"})},null,4),o("div",{class:xe(["absolute right-0 -bottom-4 text-xs bg-white/80 px-1 pointer-events-none",O===0?"text-red-400":"text-gray-400"])},E(a(t)("canvas.footerLabel")),3)],46,nx)):be("",!0),O>0&&s.value.length>0?(z(!0),F(Te,{key:4},Le(te(),re=>(z(),Pe(nl,{key:`global-${re.id}`,element:re,"is-selected":a(e).selectedElementId===re.id||a(e).selectedElementIds.includes(re.id),zoom:n.value,"page-index":0,"read-only":!0},{default:ct(()=>[(z(),Pe(Rt(se(re.type)),{element:re,"page-index":O,"total-pages":s.value.length},null,8,["element","page-index","total-pages"]))]),_:2},1032,["element","is-selected","zoom"]))),128)):be("",!0),(z(!0),F(Te,null,Le(L.elements,re=>(z(),Pe(nl,{key:re.id,element:re,"is-selected":a(e).selectedElementId===re.id||a(e).selectedElementIds.includes(re.id),zoom:n.value,"page-index":O},{default:ct(()=>[(z(),Pe(Rt(se(re.type)),{element:re,"page-index":O,"total-pages":s.value.length},null,8,["element","page-index","total-pages"]))]),_:2},1032,["element","is-selected","zoom","page-index"]))),128)),a(e).showCornerMarkers?(z(),F("div",ox,[o("div",{class:"absolute w-3 h-3 border-t-2 border-l-2 border-gray-300",style:ye({top:`${c.value}px`,left:`${i.value}px`})},null,4),o("div",{class:"absolute w-3 h-3 border-t-2 border-r-2 border-gray-300",style:ye({top:`${c.value}px`,right:`${d.value}px`})},null,4),o("div",{class:"absolute w-3 h-3 border-b-2 border-l-2 border-gray-300",style:ye({bottom:`${g.value}px`,left:`${i.value}px`})},null,4),o("div",{class:"absolute w-3 h-3 border-b-2 border-r-2 border-gray-300",style:ye({bottom:`${g.value}px`,right:`${d.value}px`})},null,4)])):be("",!0)],44,ex)]))),128))],4))}}),ol=ze({__name:"Ruler",props:{type:{},zoom:{},scroll:{},offset:{},thick:{},indicators:{},unit:{}},emits:["guide-drag-start"],setup(r,{emit:e}){const t=r,s=le(null),n=t.thick||20;let l=null;const i=()=>{const w=s.value;if(!w)return;const m=w.getContext("2d");if(!m)return;const _=w.width,p=w.height,{zoom:S,scroll:v,offset:k,type:b,indicators:f}=t,T=document.documentElement.classList.contains("dark");if(m.clearRect(0,0,_,p),m.fillStyle=T?"#1f2937":"#F9FAFB",m.fillRect(0,0,_,p),f&&f.length>0)for(const h of f){const y=k+h.position*S-v;m.fillStyle=h.color,b==="horizontal"?m.fillRect(y-2,0,4,n):m.fillRect(0,y-2,n,4)}m.strokeStyle=T?"#6b7280":"#9CA3AF",m.fillStyle=T?"#9ca3af":"#6B7280",m.lineWidth=1,m.font="10px sans-serif",m.beginPath();const D=t.unit==="mm"?Pl:t.unit==="pt"?Ll:1,A=50/(D*S),V=[1,2,5,10,20,50,100,200,500,1e3];let Y=V[V.length-1];for(const h of V)if(h>=A-.001){Y=h;break}const se=b==="horizontal"?_:p,G=(-k+v)/(S*D),I=(se-k+v)/(S*D),q=Math.floor(G/Y)*Y;for(let h=q;h<=I;h+=Y){const y=k+h*D*S-v,ee=Number(h.toFixed(1)).toString();b==="horizontal"?(m.moveTo(y,0),m.lineTo(y,n),m.fillText(ee,y+2,10)):(m.moveTo(0,y),m.lineTo(n,y),m.save(),m.translate(10,y+2),m.rotate(-Math.PI/2),m.fillText(ee,0,0),m.restore());const K=Y/5;for(let te=1;te<5;te++){const $=h+K*te,W=k+$*D*S-v;b==="horizontal"?(m.moveTo(W,n-5),m.lineTo(W,n)):(m.moveTo(n-5,W),m.lineTo(n,W))}}m.stroke()},d=new ResizeObserver(w=>{for(const m of w){const _=s.value;if(_){const{width:p,height:S}=m.contentRect;_.width=p,_.height=S,i()}}});We(()=>{s.value&&(d.observe(s.value.parentElement),i()),l=new MutationObserver(()=>{i()}),l.observe(document.documentElement,{attributes:!0,attributeFilter:["class"]})}),Ge(()=>{l==null||l.disconnect(),l=null}),Ae(()=>[t.zoom,t.scroll,t.offset,t.indicators,t.unit],i,{deep:!0});const c=e,g=w=>{c("guide-drag-start",w)};return(w,m)=>(z(),F("div",{class:"w-full h-full overflow-hidden bg-gray-50 relative",onMousedown:g},[o("canvas",{ref_key:"canvasRef",ref:s,class:"block"},null,512)],32))}}),sx={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function ax(r,e){return z(),F("svg",sx,[...e[0]||(e[0]=[o("path",{fill:"currentColor",d:"m19 21l-7-7l-2.35 2.35q.2.375.275.8T10 18q0 1.65-1.175 2.825T6 22t-2.825-1.175T2 18t1.175-2.825T6 14q.425 0 .85.075t.8.275L10 12L7.65 9.65q-.375.2-.8.275T6 10q-1.65 0-2.825-1.175T2 6t1.175-2.825T6 2t2.825 1.175T10 6q0 .425-.075.85t-.275.8L22 20v1zm-4-10l-2-2l6-6h3v1zM6 8q.825 0 1.413-.587T8 6t-.587-1.412T6 4t-1.412.588T4 6t.588 1.413T6 8m6 4.5q.2 0 .35-.15t.15-.35t-.15-.35t-.35-.15t-.35.15t-.15.35t.15.35t.35.15M6 20q.825 0 1.413-.587T8 18t-.587-1.412T6 16t-1.412.588T4 18t.588 1.413T6 20"},null,-1)])])}const lx=Se({name:"material-symbols-content-cut",render:ax}),ix={class:"bg-white border border-gray-200 shadow-xl rounded-md min-w-[160px] py-1"},dx=["disabled"],ux=["disabled"],cx=["disabled"],hx=["disabled"],px=["disabled"],fx=ze({__name:"Shortcuts",setup(r){const{t:e}=Ne(),t=Re(),s=le(!1),n=le(0),l=le(0),i=le(0),d=le(0),c=le(null),g=le(!1),w=le(0),m=le(0),_=f=>{w.value=f.clientX,m.value=f.clientY},p=(f,T)=>{const D=document.querySelectorAll(".print-page");if(D.length===0)return;let j=null,B=1/0,A=0;for(let V=0;V<D.length;V++){const Y=D[V],se=Y.getBoundingClientRect();if(f>=se.left&&f<=se.right&&T>=se.top&&T<=se.bottom)return{pageIndex:V,x:(f-se.left)/t.zoom,y:(T-se.top)/t.zoom};const G=Math.max(se.left-f,0,f-se.right),I=Math.max(se.top-T,0,T-se.bottom),q=Math.sqrt(G*G+I*I);q<B&&(B=q,j=Y,A=V)}if(j){const V=j.getBoundingClientRect();let Y=(f-V.left)/t.zoom,se=(T-V.top)/t.zoom;return Y=Math.max(0,Math.min(t.canvasSize.width,Y)),se=Math.max(0,Math.min(t.canvasSize.height,se)),{pageIndex:A,x:Y,y:se}}},S=f=>{if(t.disableGlobalShortcuts)return;if((f.ctrlKey||f.metaKey)&&f.altKey&&f.key.toLowerCase()==="n"){f.preventDefault(),f.stopPropagation(),window.dispatchEvent(new CustomEvent("designer:new-template"));return}if((f.ctrlKey||f.metaKey)&&f.key===","){f.preventDefault(),f.stopPropagation(),t.setShowSettings(!0);return}const T=f.target;if(T&&T.closest('input, textarea, select, [contenteditable="true"]'))return;if(["ArrowLeft","ArrowRight","ArrowUp","ArrowDown"].includes(f.key)){const B=f.shiftKey?10:1;if(t.selectedGuideId){const A=t.guides.find(V=>V.id===t.selectedGuideId);if(A){f.preventDefault();const V=A.position;let Y=V;if(A.type==="vertical")if(f.key==="ArrowLeft")Y-=B;else if(f.key==="ArrowRight")Y+=B;else return;else if(f.key==="ArrowUp")Y-=B;else if(f.key==="ArrowDown")Y+=B;else return;(V>0&&Y<0||V<0&&Y>0||Y===0)&&(Y=0),t.updateGuide(A.id,Y),t.setHighlightedGuide(A.id)}}else if(t.selectedElementIds.length>0){f.preventDefault();const A=f.key==="ArrowLeft"?-B:f.key==="ArrowRight"?B:0,V=f.key==="ArrowUp"?-B:f.key==="ArrowDown"?B:0;t.nudgeSelectedElements(A,V)}return}if((f.ctrlKey||f.metaKey)&&f.key.toLowerCase()==="a"){if(f.preventDefault(),t.pages[t.currentPageIndex]){const B=t.pages[t.currentPageIndex].elements.map(A=>A.id);t.setSelection(B)}return}if(f.key==="Delete"){t.selectedElementIds.length>1?(f.preventDefault(),t.removeSelectedElements()):t.selectedElementId?(f.preventDefault(),t.removeElement(t.selectedElementId)):t.selectedGuideId&&(f.preventDefault(),t.removeGuide(t.selectedGuideId));return}if((f.ctrlKey||f.metaKey)&&f.key.toLowerCase()==="c"){t.selectedElementId&&(f.preventDefault(),t.copy());return}if((f.ctrlKey||f.metaKey)&&f.key.toLowerCase()==="x"){t.selectedElementId&&(f.preventDefault(),t.cut());return}if((f.ctrlKey||f.metaKey)&&f.key.toLowerCase()==="v"){t.clipboard.length>0&&(f.preventDefault(),t.paste(p(w.value,m.value)));return}if((f.ctrlKey||f.metaKey)&&f.key.toLowerCase()==="h"){f.preventDefault(),t.setShowHelp(!0);return}if(t.showHelp&&f.key==="Escape"){f.preventDefault(),t.setShowHelp(!1);return}if((f.ctrlKey||f.metaKey)&&f.key.toLowerCase()==="z"&&!f.shiftKey){f.preventDefault(),t.undo();return}if((f.ctrlKey||f.metaKey)&&(f.key.toLowerCase()==="y"||f.key.toLowerCase()==="z"&&f.shiftKey)){f.preventDefault(),t.redo();return}if((f.ctrlKey||f.metaKey)&&f.key.toLowerCase()==="l"){f.preventDefault(),t.toggleLock();return}if((f.ctrlKey||f.metaKey)&&f.shiftKey&&f.key.toLowerCase()==="p"){f.preventDefault(),window.dispatchEvent(new CustomEvent("designer:preview"));return}const D=f.ctrlKey||f.metaKey,j=f.key.toLowerCase();if(!(t.editingCustomElementId&&D&&(j==="s"||j==="q"))){if(D&&f.shiftKey&&j==="s"){f.preventDefault(),window.dispatchEvent(new CustomEvent("designer:save-as"));return}if(D&&j==="s"){f.preventDefault(),window.dispatchEvent(new CustomEvent("designer:save"));return}if((f.ctrlKey||f.metaKey)&&f.key.toLowerCase()==="p"&&!f.shiftKey){f.preventDefault(),window.dispatchEvent(new CustomEvent("designer:print"));return}if((f.ctrlKey||f.metaKey)&&f.shiftKey&&f.key.toLowerCase()==="e"){f.preventDefault(),window.dispatchEvent(new CustomEvent("designer:export-pdf"));return}if((f.ctrlKey||f.metaKey)&&f.shiftKey&&f.key.toLowerCase()==="j"){f.preventDefault(),window.dispatchEvent(new CustomEvent("designer:view-json"));return}}},v=f=>{["ArrowLeft","ArrowRight","ArrowUp","ArrowDown"].includes(f.key)&&(t.setHighlightedGuide(null),t.setHighlightedEdge(null))},k=async f=>{const T=f.target,D=document.querySelector(".overflow-auto");if(!D||!D.contains(T))return;if(f.preventDefault(),s.value=!0,n.value=f.clientX,l.value=f.clientY,i.value=f.clientX,d.value=f.clientY,await Xe(),c.value){const A=c.value.getBoundingClientRect(),V=window.innerWidth,Y=window.innerHeight;f.clientX+A.width>V&&(n.value=V-A.width-5),f.clientY+A.height>Y&&(l.value=Y-A.height-5)}const j=document.querySelectorAll(".print-page");let B=!1;j.forEach(A=>{const V=A.getBoundingClientRect();f.clientX>=V.left&&f.clientX<=V.right&&f.clientY>=V.top&&f.clientY<=V.bottom&&(B=!0)}),g.value=B,window.addEventListener("click",b)},b=()=>{s.value=!1,window.removeEventListener("click",b)};return We(()=>{window.addEventListener("keydown",S,{capture:!0}),window.addEventListener("contextmenu",k),window.addEventListener("keyup",v),window.addEventListener("mousemove",_)}),Ge(()=>{window.removeEventListener("keydown",S,{capture:!0}),window.removeEventListener("contextmenu",k),window.removeEventListener("click",b),window.removeEventListener("keyup",v),window.removeEventListener("mousemove",_)}),(f,T)=>{var D,j,B,A,V;return s.value?(z(),F("div",{key:0,ref_key:"menuRef",ref:c,class:"fixed z-[9999]",style:ye({left:`${n.value}px`,top:`${l.value}px`})},[o("div",ix,[o("button",{class:"w-full text-left px-3 py-2 text-sm hover:bg-gray-100 disabled:opacity-50 flex items-center gap-2",disabled:a(t).selectedElementIds.length===0&&!a(t).selectedGuideId||((D=a(t).selectedElement)==null?void 0:D.locked),onClick:T[0]||(T[0]=()=>{a(t).selectedElementIds.length>1?a(t).removeSelectedElements():a(t).selectedElementId?a(t).removeElement(a(t).selectedElementId):a(t).selectedGuideId&&a(t).removeGuide(a(t).selectedGuideId),s.value=!1})},[ce(a(St),{class:"w-4 h-4"}),o("span",null,E(a(e)("common.delete"))+E(a(t).selectedElementIds.length>1?` (${a(t).selectedElementIds.length})`:""),1)],8,dx),o("button",{class:"w-full text-left px-3 py-2 text-sm hover:bg-gray-100 disabled:opacity-50 flex items-center gap-2",disabled:!a(t).selectedElementId||((j=a(t).selectedElement)==null?void 0:j.locked),onClick:T[1]||(T[1]=()=>{a(t).cut(),s.value=!1})},[ce(a(lx),{class:"w-4 h-4"}),o("span",null,E(a(e)("common.cut")),1)],8,ux),o("button",{class:"w-full text-left px-3 py-2 text-sm hover:bg-gray-100 disabled:opacity-50 flex items-center gap-2",disabled:!a(t).selectedElementId||((B=a(t).selectedElement)==null?void 0:B.locked),onClick:T[2]||(T[2]=()=>{a(t).copy(),s.value=!1})},[ce(a(Ct),{class:"w-4 h-4"}),o("span",null,E(a(e)("common.copy")),1)],8,cx),o("button",{class:"w-full text-left px-3 py-2 text-sm hover:bg-gray-100 disabled:opacity-50 flex items-center gap-2",disabled:a(t).clipboard.length===0,onClick:T[3]||(T[3]=()=>{a(t).paste(p(i.value,d.value)),s.value=!1})},[ce(a($o),{class:"w-4 h-4"}),o("span",null,E(a(e)("common.paste")),1)],8,hx),o("button",{class:"w-full text-left px-3 py-2 text-sm hover:bg-gray-100 disabled:opacity-50 flex items-center gap-2",disabled:a(t).selectedElementIds.length===0,onClick:T[4]||(T[4]=()=>{a(t).toggleLock(),s.value=!1})},[(z(),Pe(Rt((A=a(t).selectedElement)!=null&&A.locked?a(ql):a(Qt)),{class:"w-4 h-4"})),o("span",null,E((V=a(t).selectedElement)!=null&&V.locked?a(e)("common.unlock"):a(e)("common.lock")),1)],8,px),T[7]||(T[7]=o("div",{class:"border-t border-gray-200 my-1"},null,-1)),o("button",{class:"w-full text-left px-3 py-2 text-sm hover:bg-gray-100 flex items-center gap-2",onClick:T[5]||(T[5]=Y=>{a(t).undo(),s.value=!1})},[ce(a(Bl),{class:"w-4 h-4"}),o("span",null,E(a(e)("common.undo")),1)]),o("button",{class:"w-full text-left px-3 py-2 text-sm hover:bg-gray-100 flex items-center gap-2",onClick:T[6]||(T[6]=Y=>{a(t).redo(),s.value=!1})},[ce(a(Ol),{class:"w-4 h-4"}),o("span",null,E(a(e)("common.redo")),1)])])],4)):be("",!0)}}}),mx={class:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 text-sm leading-none text-gray-300 z-10"},gx={key:2,class:"w-full h-full bg-gray-200 flex items-center justify-center overflow-hidden"},vx=["src"],bx={key:3,class:"w-full h-full bg-gray-100 flex items-center justify-center overflow-hidden"},yx=["src"],wx={key:4,class:"w-full h-full bg-gray-100 flex items-center justify-center overflow-hidden"},xx=["src"],_x={key:2,class:"w-full h-full bg-gray-200 flex items-center justify-center overflow-hidden"},kx=["src"],Sx={key:3,class:"w-full h-full bg-gray-100 flex items-center justify-center overflow-hidden"},Cx=["src"],Ex={key:4,class:"w-full h-full bg-gray-100 flex items-center justify-center overflow-hidden"},Tx=["src"],sl=180,al=120,ll=300,$x=32,Ix=ze({__name:"Minimap",props:{scrollWidth:{},scrollHeight:{},viewportWidth:{},viewportHeight:{},scrollLeft:{},scrollTop:{},pages:{},pageWidth:{},pageHeight:{},zoom:{},contentOffsetX:{},contentOffsetY:{},canvasBackground:{},showHeaderLine:{type:Boolean},showFooterLine:{type:Boolean},headerHeight:{},footerHeight:{},watermark:{}},emits:["update:scroll"],setup(r,{emit:e}){const t=r,s=e,n=fe(()=>{if(t.scrollWidth<=0||t.scrollHeight<=0)return .1;let G=sl/t.scrollWidth;return t.scrollHeight*G>ll&&(G=ll/t.scrollHeight),t.scrollWidth*G<al&&(G=al/t.scrollWidth),G}),l=fe(()=>t.scrollHeight*n.value),i=fe(()=>({left:`${t.scrollLeft*n.value}px`,top:`${t.scrollTop*n.value}px`,width:`${t.viewportWidth*n.value}px`,height:`${t.viewportHeight*n.value}px`})),d=G=>G.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;"),c=fe(()=>{const G=t.watermark;if(!G||!G.enabled||!G.text)return null;const I=d(G.text),q=Number.isFinite(G.angle)?G.angle:-30,h=Math.max(6,G.size||24),y=Math.max(40,G.density||160),ee=G.color||"#000000",K=Math.min(1,Math.max(0,G.opacity??.1)),te=`<?xml version="1.0" encoding="UTF-8"?><svg xmlns="http://www.w3.org/2000/svg" width="${y}" height="${y}"><text x="50%" y="50%" dominant-baseline="middle" text-anchor="middle" fill="${ee}" fill-opacity="${K}" font-size="${h}" transform="rotate(${q} ${y/2} ${y/2})">${I}</text></svg>`;return{backgroundImage:`url("data:image/svg+xml,${encodeURIComponent(te)}")`,backgroundRepeat:"repeat",backgroundSize:`${y}px ${y}px`}}),g=G=>{const I={left:`${t.contentOffsetX*n.value}px`,top:`${(t.contentOffsetY+G*(t.pageHeight+$x)*t.zoom)*n.value}px`,width:`${t.pageWidth*t.zoom*n.value}px`,height:`${t.pageHeight*t.zoom*n.value}px`,backgroundColor:t.canvasBackground||"#ffffff"};return c.value?{...I,...c.value}:I},w=()=>{if(!t.pages||t.pages.length===0)return[];const G=t.pages[0];return G!=null&&G.elements?G.elements.filter(I=>t.showHeaderLine&&I.y<t.headerHeight||t.showFooterLine&&I.y>=t.pageHeight-t.footerHeight):[]},m=G=>{const I=Math.max(1,G.width*t.zoom*n.value),q=Math.max(1,G.height*t.zoom*n.value);return{width:I,height:q}},_=G=>{var y,ee,K,te,$,W,L,O,re,Z,ne,ve;const{width:I,height:q}=m(G),h={left:`${G.x*t.zoom*n.value}px`,top:`${G.y*t.zoom*n.value}px`,width:`${I}px`,height:`${q}px`,fontSize:`${(((y=G.style)==null?void 0:y.fontSize)||12)*t.zoom*n.value}px`,zIndex:((ee=G.style)==null?void 0:ee.zIndex)||1,transform:`rotate(${((K=G.style)==null?void 0:K.rotate)||0}deg)`};if(G.type===ge.LINE){const we=((te=G.style)==null?void 0:te.borderColor)||"#111827",ie=Math.max(1,((($=G.style)==null?void 0:$.borderWidth)||1)*t.zoom*n.value);return{...h,height:`${ie}px`,backgroundColor:we,top:`${G.y*t.zoom*n.value+(q-ie)/2}px`}}if(G.type===ge.RECT||G.type===ge.CIRCLE){const we=((W=G.style)==null?void 0:W.borderColor)||"#111827",ie=Math.max(1,(((L=G.style)==null?void 0:L.borderWidth)||1)*t.zoom*n.value);return{...h,backgroundColor:((O=G.style)==null?void 0:O.backgroundColor)||"transparent",borderColor:we,borderWidth:`${ie}px`,borderStyle:((re=G.style)==null?void 0:re.borderStyle)||"solid",borderRadius:G.type===ge.CIRCLE?"9999px":`${((Z=G.style)==null?void 0:Z.borderRadius)||0}px`}}return G.type===ge.BARCODE||G.type===ge.QRCODE?{...h,backgroundColor:"rgba(17, 24, 39, 0.15)",border:"1px solid rgba(17, 24, 39, 0.3)"}:G.type===ge.PAGE_NUMBER?{...h,color:((ne=G.style)==null?void 0:ne.color)||"#111827",backgroundColor:((ve=G.style)==null?void 0:ve.backgroundColor)||"transparent"}:{...h,backgroundColor:G.type===ge.IMAGE?"#e5e7eb":void 0}},p=(G,I)=>{var ee;const q=I+1,h=((ee=t.pages)==null?void 0:ee.length)||1,y=G.format||"1/Total";return y==="1"?`${q}`:y==="Page 1"?`Page ${q}`:`${q}/${h}`},S=G=>{const I=G.style?JSON.stringify(G.style):"";return`${G.id}:${G.type}:${G.variable||""}:${G.content||""}:${I}`},v=le({}),k=le({});let b=0;const f=G=>G.type===ge.BARCODE?G.variable||G.content||"12345678":G.type===ge.QRCODE?G.variable||G.content||"https://example.com":G.variable||G.content||"",T=G=>{try{const I=document.createElement("canvas"),q=G.style||{};return Ul(I,f(G),{format:q.barcodeFormat||"CODE128",lineColor:q.color||"#000000",width:Number(q.barcodeWidth)||2,height:Number(q.barcodeHeight)||40,displayValue:q.showText!==!1&&q.showText!=="false",fontOptions:q.fontOptions||"",font:q.font||"monospace",textAlign:q.textAlign||"center",textPosition:q.textPosition||"bottom",textMargin:Number(q.textMargin)||2,fontSize:Number(q.fontSize)||20,background:"transparent",margin:Number(q.margin)||0}),I.toDataURL("image/png")}catch{return""}},D=async G=>{var I,q;try{return await Vl.toDataURL(f(G),{margin:0,color:{dark:((I=G.style)==null?void 0:I.color)||"#000000",light:"#00000000"},errorCorrectionLevel:((q=G.style)==null?void 0:q.qrErrorCorrection)||"M"})}catch{return""}},j=async()=>{const G=++b,I={},q={},h=t.pages||[];for(const y of h){const ee=(y==null?void 0:y.elements)||[];for(const K of ee){const te=S(K);if(K.type===ge.BARCODE){const $=T(K);$&&(I[te]=$)}else if(K.type===ge.QRCODE){const $=await D(K);$&&(q[te]=$)}}}G===b&&(v.value=I,k.value=q)},B=G=>v.value[S(G)]||"",A=G=>k.value[S(G)]||"";Ae(()=>t.pages,()=>{j()},{deep:!0,immediate:!0});const V=le(!1),Y=le(null);Ae(()=>t.scrollTop,()=>{if(!Y.value)return;const G=t.scrollTop*n.value,I=t.viewportHeight*n.value,q=Y.value.clientHeight,h=Y.value.scrollTop;G<h?Y.value.scrollTop=G:G+I>h+q&&(Y.value.scrollTop=G+I-q)});const se=G=>{G.preventDefault();const I=G.currentTarget,q=I.getBoundingClientRect(),h=G.clientX-q.left,y=G.clientY-q.top,ee=t.scrollLeft*n.value,K=t.scrollTop*n.value,te=t.viewportWidth*n.value,$=t.viewportHeight*n.value;let W=0,L=0;if(h>=ee&&h<=ee+te&&y>=K&&y<=K+$)W=h-ee,L=y-K;else{const Z=h/n.value-t.viewportWidth/2,ne=y/n.value-t.viewportHeight/2;s("update:scroll",{left:Z,top:ne}),W=te/2,L=$/2}V.value=!0;const O=Z=>{const ne=I.getBoundingClientRect(),ve=Z.clientX-ne.left,we=Z.clientY-ne.top,ie=ve-W,ke=we-L;s("update:scroll",{left:ie/n.value,top:ke/n.value})},re=()=>{V.value=!1,window.removeEventListener("mousemove",O),window.removeEventListener("mouseup",re)};window.addEventListener("mousemove",O),window.addEventListener("mouseup",re)};return(G,I)=>(z(),F("div",{ref_key:"scrollContainer",ref:Y,class:"bg-white border border-gray-200 shadow-lg rounded max-h-[300px] overflow-y-auto overflow-x-hidden box-content no-scrollbar",style:ye({width:`${t.scrollWidth*n.value}px`,maxWidth:`${sl}px`})},[o("div",{class:"relative select-none box-content overflow-hidden",style:ye({width:`${t.scrollWidth*n.value}px`,height:`${l.value}px`}),onMousedown:se},[I[0]||(I[0]=o("div",{class:"absolute inset-0 bg-gray-100"},null,-1)),(z(!0),F(Te,null,Le(r.pages,(q,h)=>(z(),F("div",{key:h,class:"absolute shadow-sm border border-gray-300 overflow-hidden",style:ye(g(h))},[o("div",mx,E(h+1),1),(z(!0),F(Te,null,Le(q.elements,y=>{var ee,K;return z(),F("div",{key:y.id,class:"absolute",style:ye(_(y))},[y.type===a(ge).TEXT?(z(),F("div",{key:0,class:"w-full h-full overflow-hidden whitespace-nowrap",style:ye({color:y.style.color||"#000000",fontFamily:y.style.fontFamily,fontWeight:y.style.fontWeight,fontStyle:y.style.fontStyle,textAlign:y.style.textAlign,lineHeight:1})},E(y.variable||y.content),5)):y.type===a(ge).PAGE_NUMBER?(z(),F("div",{key:1,class:"w-full h-full overflow-hidden whitespace-nowrap",style:ye({color:y.style.color||"#000000",fontFamily:y.style.fontFamily,fontWeight:y.style.fontWeight,fontStyle:y.style.fontStyle,textAlign:y.style.textAlign,lineHeight:1})},E(p(y,h)),5)):y.type===a(ge).IMAGE?(z(),F("div",gx,[y.content?(z(),F("img",{key:0,src:y.content,class:"w-full h-full object-cover"},null,8,vx)):be("",!0)])):y.type===a(ge).BARCODE?(z(),F("div",bx,[B(y)?(z(),F("img",{key:0,src:B(y),class:"w-full h-full object-contain"},null,8,yx)):be("",!0)])):y.type===a(ge).QRCODE?(z(),F("div",wx,[A(y)?(z(),F("img",{key:0,src:A(y),class:"w-full h-full object-contain"},null,8,xx)):be("",!0)])):y.type===a(ge).TABLE?(z(),F("div",{key:5,class:"w-full h-full border border-gray-300 bg-white grid",style:ye({gridTemplateColumns:`repeat(${((ee=y.columns)==null?void 0:ee.length)||2}, 1fr)`})},[(z(!0),F(Te,null,Le(Math.min(6,(((K=y.columns)==null?void 0:K.length)||2)*2),te=>(z(),F("div",{key:te,class:"border-[0.5px] border-gray-100"}))),128))],4)):be("",!0)],4)}),128)),h>0?(z(!0),F(Te,{key:0},Le(w(),y=>{var ee,K;return z(),F("div",{key:`global-${h}-${y.id}`,class:"absolute",style:ye(_(y))},[y.type===a(ge).TEXT?(z(),F("div",{key:0,class:"w-full h-full overflow-hidden whitespace-nowrap",style:ye({color:y.style.color||"#000000",fontFamily:y.style.fontFamily,fontWeight:y.style.fontWeight,fontStyle:y.style.fontStyle,textAlign:y.style.textAlign,lineHeight:1})},E(y.variable||y.content),5)):y.type===a(ge).PAGE_NUMBER?(z(),F("div",{key:1,class:"w-full h-full overflow-hidden whitespace-nowrap",style:ye({color:y.style.color||"#000000",fontFamily:y.style.fontFamily,fontWeight:y.style.fontWeight,fontStyle:y.style.fontStyle,textAlign:y.style.textAlign,lineHeight:1})},E(p(y,h)),5)):y.type===a(ge).IMAGE?(z(),F("div",_x,[y.content?(z(),F("img",{key:0,src:y.content,class:"w-full h-full object-cover"},null,8,kx)):be("",!0)])):y.type===a(ge).BARCODE?(z(),F("div",Sx,[B(y)?(z(),F("img",{key:0,src:B(y),class:"w-full h-full object-contain"},null,8,Cx)):be("",!0)])):y.type===a(ge).QRCODE?(z(),F("div",Ex,[A(y)?(z(),F("img",{key:0,src:A(y),class:"w-full h-full object-contain"},null,8,Tx)):be("",!0)])):y.type===a(ge).TABLE?(z(),F("div",{key:5,class:"w-full h-full border border-gray-300 bg-white grid",style:ye({gridTemplateColumns:`repeat(${((ee=y.columns)==null?void 0:ee.length)||2}, 1fr)`})},[(z(!0),F(Te,null,Le(Math.min(6,(((K=y.columns)==null?void 0:K.length)||2)*2),te=>(z(),F("div",{key:te,class:"border-[0.5px] border-gray-100"}))),128))],4)):be("",!0)],4)}),128)):be("",!0)],4))),128)),o("div",{class:"absolute border-2 border-blue-500 bg-blue-500/10 cursor-move z-[1000]",style:ye(i.value)},null,4)],36)],4))}}),Ax=Et(Ix,[["__scopeId","data-v-8d64f846"]]),zx={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function Px(r,e){return z(),F("svg",zx,[...e[0]||(e[0]=[o("path",{fill:"currentColor",d:"M5 21q-.825 0-1.412-.587T3 19V5q0-.825.588-1.412T5 3h7v2H5v14h7v2zm11-4l-1.375-1.45l2.55-2.55H9v-2h8.175l-2.55-2.55L16 7l5 5z"},null,-1)])])}const Lx=Se({name:"material-symbols-logout",render:Px}),Mx={class:"flex-1 flex overflow-hidden"},Rx={class:"flex-1 overflow-hidden relative flex flex-col"},Dx={key:0,class:"flex items-center justify-between px-4 py-2 bg-blue-50 border-b border-blue-200 text-blue-900 dark:bg-blue-950 dark:border-blue-800 dark:text-blue-100"},Bx={class:"text-sm font-medium"},Ox={class:"flex items-center gap-2"},qx={class:"relative w-full h-full flex flex-col overflow-hidden"},Fx={class:"flex-none h-5 bg-gray-50 border-b border-gray-300 flex z-20"},Nx={class:"flex-1 relative overflow-hidden"},jx={class:"flex-1 flex overflow-hidden relative"},Hx={class:"w-5 flex-none bg-gray-50 border-r border-gray-300 h-full relative z-20 overflow-hidden"},Ux=["onMousedown"],Vx={class:"absolute left-2 -top-4 theme-bg text-white text-[10px] px-1 rounded opacity-0 group-hover:opacity-100 pointer-events-none whitespace-nowrap"},Wx=["onMousedown"],Gx={class:"absolute top-2 -left-4 theme-bg text-white text-[10px] px-1 rounded opacity-0 group-hover:opacity-100 pointer-events-none whitespace-nowrap"},Kx={key:2,class:"absolute pointer-events-none"},Yx={key:1,class:"absolute bottom-4 right-4 z-50"},Xx=ze({__name:"PrintDesigner",setup(r){const e=Re(),t=Jt(),{autoSave:s}=Il(),{t:n}=Ne(),l=le(null),i=le(null),d=le(null),c=le(null),g=le(!1),w=le(0),m=()=>{w.value+=1},_=(J,u)=>{const U=getComputedStyle(document.documentElement).getPropertyValue(J).trim(),P=Mt(U);return P?Vd(P.h,P.s,P.v,u):`rgba(59, 130, 246, ${u})`},p=fe(()=>e.editingCustomElement),S=fe(()=>p.value?`${p.value.name} Copy`:"");We(()=>{Xe(()=>{K()}),window.addEventListener("resize",K),window.addEventListener("keydown",we),window.addEventListener("keydown",D),window.addEventListener("keyup",we),window.addEventListener("blur",ie),window.addEventListener("brand-theme-updated",m),Ae([()=>e.pages.length,()=>e.canvasSize.width,()=>e.canvasSize.height,()=>e.zoom,()=>e.showMinimap],()=>{Xe(K)}),Ae([()=>e.pages,()=>e.canvasSize,()=>e.guides,()=>e.headerHeight,()=>e.footerHeight,()=>e.showHeaderLine,()=>e.showFooterLine,()=>e.canvasBackground,()=>e.pageSpacingX,()=>e.pageSpacingY,()=>e.watermark,()=>e.showMinimap],()=>{v()},{deep:!0})});const v=qd(()=>{if(!e.editingCustomElementId&&s.value&&t.currentTemplateId&&!t.isSaving){const J=t.templates.find(u=>u.id===t.currentTemplateId);J&&t.saveCurrentTemplate(J.name)}},1e3),k=()=>{if(!e.commitCustomElementEdit()){alert(n("sidebar.editSaveFailed"));return}e.cancelCustomElementEdit()},b=J=>{const u=J.trim();if(!u)return;if(!e.saveCustomElementEditAs(u)){alert(n("sidebar.editSaveFailed"));return}e.cancelCustomElementEdit()},f=()=>{confirm(n("sidebar.confirmExitEdit"))&&(e.cancelCustomElementEdit(),requestAnimationFrame(()=>{var J,u;(u=(J=l.value)==null?void 0:J.focus)==null||u.call(J)}))},T=J=>{var P;const u=J;if(!u)return!1;if(u.isContentEditable)return!0;const U=(P=u.tagName)==null?void 0:P.toLowerCase();return U==="input"||U==="textarea"||U==="select"},D=J=>{if(e.disableGlobalShortcuts||!e.editingCustomElementId||g.value||T(J.target)||!(J.ctrlKey||J.metaKey))return;const U=J.key.toLowerCase();if(U==="s"&&J.shiftKey){J.preventDefault(),J.stopPropagation(),g.value=!0;return}if(U==="s"){J.preventDefault(),J.stopPropagation(),k();return}U==="q"&&(J.preventDefault(),J.stopPropagation(),f())},j=le(0),B=le(0),A=le(0),V=le(0),Y=J=>{const u=J.target;j.value=u.scrollLeft,B.value=u.scrollTop},se=le(0),G=le(0),I=le(0),q=le(0),h=fe(()=>e.unit||"mm"),y=J=>{const u=ot(J,e.unit||"mm");return e.unit==="px"?Math.round(u):Number(u.toFixed(1))},ee=fe(()=>{const J=e.pages.length,u=e.canvasSize.height,U=e.canvasSize.width,P=e.pageSpacingY||0,x=J>0?J*u+(J-1)*P:0;return{width:`${U*e.zoom}px`,height:`${x*e.zoom}px`}}),K=()=>{if(l.value&&c.value){const J=l.value.clientWidth,u=l.value.clientHeight;I.value=J,q.value=u;const U=parseFloat(ee.value.width),P=parseFloat(ee.value.height),x=64,C=64;se.value=Math.max(J,U+x),G.value=Math.max(u,P+C),U+x<=J&&(se.value=J),P+C<=u&&(G.value=u);const N=l.value.getBoundingClientRect(),M=c.value.getBoundingClientRect();j.value=l.value.scrollLeft,B.value=l.value.scrollTop,A.value=M.left-N.left+l.value.scrollLeft,V.value=M.top-N.top+l.value.scrollTop}};Ge(()=>{var J;v.cancel(),window.removeEventListener("resize",K),window.removeEventListener("mousemove",Z),window.removeEventListener("mouseup",ne),window.removeEventListener("keydown",we),window.removeEventListener("keydown",D),window.removeEventListener("keyup",we),window.removeEventListener("blur",ie),window.removeEventListener("brand-theme-updated",m),(J=l.value)==null||J.removeEventListener("wheel",ve)});const te=le(!1),$=le(null),W=le("horizontal"),L=le(0),O=(J,u,U=null)=>{te.value=!0,$.value=U,W.value=u,re(J),window.addEventListener("mousemove",Z),window.addEventListener("mouseup",ne)},re=J=>{if(!l.value)return;const u=l.value.getBoundingClientRect(),U=e.zoom;if(W.value==="horizontal"){const P=J.clientY-u.top+l.value.scrollTop;L.value=(P-V.value)/U}else{const P=J.clientX-u.left+l.value.scrollLeft;L.value=(P-A.value)/U}},Z=J=>{te.value&&(J.preventDefault(),re(J),$.value&&e.updateGuide($.value,L.value))},ne=J=>{if(!te.value)return;const u=l.value.getBoundingClientRect();let U=!1;W.value==="horizontal"?J.clientY<u.top&&(U=!0):J.clientX<u.left&&(U=!0),U?$.value&&e.removeGuide($.value):$.value?e.updateGuide($.value,L.value):e.addGuide({type:W.value,position:L.value}),te.value=!1,$.value=null,window.removeEventListener("mousemove",Z),window.removeEventListener("mouseup",ne)},ve=J=>{J.ctrlKey&&(J.preventDefault(),J.deltaY<0?e.setZoom(Math.min(5,e.zoom+.1)):e.setZoom(Math.max(.2,e.zoom-.1)))},we=J=>{var u,U;e.disableGlobalShortcuts||(J.key==="Control"||J.key==="Meta")&&(J.type==="keydown"&&!J.repeat?(u=l.value)==null||u.addEventListener("wheel",ve,{passive:!1}):J.type==="keyup"&&((U=l.value)==null||U.removeEventListener("wheel",ve)))},ie=()=>{var J;(J=l.value)==null||J.removeEventListener("wheel",ve)},ke=J=>{l.value&&l.value.scrollTo({left:J.left,top:J.top,behavior:"auto"})},_e=J=>{var de;const u=((de=J.style)==null?void 0:de.rotate)||0;if(u===0)return{minX:J.x,maxX:J.x+J.width,minY:J.y,maxY:J.y+J.height};const U=J.x+J.width/2,P=J.y+J.height/2,x=u*Math.PI/180,C=Math.cos(x),N=Math.sin(x),M=[{x:J.x,y:J.y},{x:J.x+J.width,y:J.y},{x:J.x,y:J.y+J.height},{x:J.x+J.width,y:J.y+J.height}];let X=1/0,R=-1/0,ae=1/0,he=-1/0;for(const pe of M){const Q=U+(pe.x-U)*C-(pe.y-P)*N,H=P+(pe.x-U)*N+(pe.y-P)*C;Q<X&&(X=Q),Q>R&&(R=Q),H<ae&&(ae=H),H>he&&(he=H)}return{minX:X,maxX:R,minY:ae,maxY:he}},oe=fe(()=>{if(!e.isDragging||e.selectedElementIds.length===0)return null;const J=[];for(const M of e.selectedElementIds)for(const X of e.pages){const R=X.elements.find(ae=>ae.id===M);R&&J.push(R)}if(J.length===0)return null;let u=1/0,U=-1/0,P=1/0,x=-1/0;for(const M of J){const X=_e(M);X.minX<u&&(u=X.minX),X.maxX>U&&(U=X.maxX),X.minY<P&&(P=X.minY),X.maxY>x&&(x=X.maxY)}const C=(u+U)/2,N=(P+x)/2;return{minX:u,maxX:U,minY:P,maxY:x,centerX:C,centerY:N}}),ue=fe(()=>{if(!oe.value)return{h:[],v:[]};w.value;const J=_("--brand-500",.5),{minX:u,maxX:U,minY:P,maxY:x}=oe.value;return{h:[{position:u,color:J},{position:U,color:J}],v:[{position:P,color:J},{position:x,color:J}]}});return(J,u)=>{var U;return z(),F("div",{ref_key:"rootContainer",ref:i,class:"h-full w-full flex flex-col bg-gray-100 overflow-hidden"},[ce($1),o("div",Mx,[ce(vy),o("main",Rx,[a(e).editingCustomElementId?(z(),F("div",Dx,[o("div",Bx,E(a(n)("sidebar.editingElement",{name:((U=p.value)==null?void 0:U.name)||""})),1),o("div",Ox,[o("button",{onClick:k,class:"px-3 py-1.5 text-xs font-medium bg-blue-600 text-white rounded hover:bg-blue-700 dark:bg-blue-500 dark:hover:bg-blue-400 inline-flex items-center gap-1.5"},[ce(a(To),{class:"w-4 h-4"}),Ce(" "+E(a(n)("sidebar.saveEdit")),1)]),o("button",{onClick:u[0]||(u[0]=P=>g.value=!0),class:"px-3 py-1.5 text-xs font-medium bg-blue-200 text-blue-900 rounded hover:bg-blue-300 dark:bg-blue-700 dark:hover:bg-blue-600 dark:text-white inline-flex items-center gap-1.5"},[ce(a(Dl),{class:"w-4 h-4"}),Ce(" "+E(a(n)("sidebar.saveAs")),1)]),o("button",{onClick:f,class:"px-3 py-1.5 text-xs font-medium bg-slate-200 text-slate-900 rounded hover:bg-slate-300 dark:bg-slate-700 dark:hover:bg-slate-600 dark:text-slate-100 inline-flex items-center gap-1.5"},[ce(a(Lx),{class:"w-4 h-4"}),Ce(" "+E(a(n)("sidebar.exitEdit")),1)])])])):be("",!0),ce(fx),o("div",qx,[o("div",Fx,[u[5]||(u[5]=o("div",{class:"w-5 flex-none bg-gray-100 border-r border-gray-300"},null,-1)),o("div",Nx,[ce(ol,{type:"horizontal",zoom:a(e).zoom,scroll:j.value,offset:A.value,thick:20,unit:a(e).unit||"mm",indicators:ue.value.h,onGuideDragStart:u[1]||(u[1]=P=>O(P,"horizontal"))},null,8,["zoom","scroll","offset","unit","indicators"])])]),o("div",jx,[o("div",Hx,[ce(ol,{type:"vertical",zoom:a(e).zoom,scroll:B.value,offset:V.value,thick:20,unit:a(e).unit||"mm",indicators:ue.value.v,onGuideDragStart:u[2]||(u[2]=P=>O(P,"vertical"))},null,8,["zoom","scroll","offset","unit","indicators"])]),o("div",{ref_key:"scrollContainer",ref:l,tabindex:"-1",class:"flex-1 overflow-auto p-8 flex relative canvas-scroll bg-gray-100 focus:outline-none",onScroll:Y,onClick:u[3]||(u[3]=P=>{(P.target===l.value||P.target===P.currentTarget)&&a(e).selectGuide(null)})},[o("div",{ref_key:"canvasWrapper",ref:c,style:ye(ee.value),class:"mx-auto relative"},[ce(Wl,{ref_key:"canvasContainer",ref:d,class:"absolute top-0 left-0"},null,512)],4),o("div",{class:"absolute top-0 left-0 pointer-events-none z-50",style:ye({width:`${se.value}px`,height:`${G.value}px`})},[oe.value?(z(),F(Te,{key:0},[o("div",{class:"absolute w-full border-t border-blue-500 border-dashed",style:ye({top:`${V.value+oe.value.minY*a(e).zoom}px`,left:0})},[o("div",{class:"absolute -top-6 bg-blue-500 text-white text-xs px-1.5 py-0.5 rounded shadow-sm",style:ye({left:`${j.value+10}px`})},E(y(oe.value.minY))+" "+E(h.value),5)],4),o("div",{class:"absolute w-full border-t border-dashed theme-border",style:ye({top:`${V.value+oe.value.maxY*a(e).zoom}px`,left:0})},[o("div",{class:"absolute -top-6 theme-bg text-white text-xs px-1.5 py-0.5 rounded shadow-sm",style:ye({left:`${j.value+10}px`})},E(y(oe.value.maxY))+" "+E(h.value),5)],4),o("div",{class:"absolute h-full border-l border-dashed theme-border",style:ye({left:`${A.value+oe.value.minX*a(e).zoom}px`,top:0})},[o("div",{class:"absolute -left-2 transform -translate-x-full theme-bg text-white text-xs px-1.5 py-0.5 rounded shadow-sm whitespace-nowrap",style:ye({top:`${B.value+10}px`})},E(y(oe.value.minX))+" "+E(h.value),5)],4),o("div",{class:"absolute h-full border-l border-dashed theme-border",style:ye({left:`${A.value+oe.value.maxX*a(e).zoom}px`,top:0})},[o("div",{class:"absolute -left-2 transform -translate-x-full theme-bg text-white text-xs px-1.5 py-0.5 rounded shadow-sm whitespace-nowrap",style:ye({top:`${B.value+10}px`})},E(y(oe.value.maxX))+" "+E(h.value),5)],4)],64)):be("",!0),(z(!0),F(Te,null,Le(a(e).guides,P=>(z(),F(Te,{key:P.id},[P.type==="horizontal"?(z(),F("div",{key:0,class:"absolute left-0 w-full h-3 -mt-1.5 cursor-row-resize pointer-events-auto group flex flex-col justify-center",style:ye({top:`${V.value+P.position*a(e).zoom}px`}),onMousedown:Ke(x=>{a(e).selectGuide(P.id),O(x,"horizontal",P.id)},["stop"])},[o("div",{class:xe(["w-full",a(e).highlightedGuideId===P.id?"border-t-2 theme-border-strong":"border-t theme-border","theme-border-hover"])},null,2),o("div",Vx,E(y(P.position))+E(h.value),1)],44,Ux)):(z(),F("div",{key:1,class:"absolute top-0 h-full w-3 -ml-1.5 cursor-col-resize pointer-events-auto group flex flex-row justify-center",style:ye({left:`${A.value+P.position*a(e).zoom}px`}),onMousedown:Ke(x=>{a(e).selectGuide(P.id),O(x,"vertical",P.id)},["stop"])},[o("div",{class:xe(["h-full",a(e).highlightedGuideId===P.id?"border-l-2 theme-border-strong":"border-l theme-border","theme-border-hover"])},null,2),o("div",Gx,E(y(P.position))+E(h.value),1)],44,Wx))],64))),128)),te.value&&!$.value?(z(),F("div",{key:1,class:xe(["absolute border-dashed pointer-events-none theme-border",W.value==="horizontal"?"left-0 w-full border-t":"top-0 h-full border-l"]),style:ye({top:W.value==="horizontal"?`${V.value+L.value*a(e).zoom}px`:void 0,left:W.value==="vertical"?`${A.value+L.value*a(e).zoom}px`:void 0})},[o("div",{class:xe(["absolute theme-bg text-white text-[10px] px-1 rounded",W.value==="horizontal"?"left-2 -top-4":"top-2 -left-4"])},E(y(L.value))+E(h.value),3)],6)):be("",!0),a(e).highlightedEdge?(z(),F("div",Kx,[a(e).highlightedEdge==="top"?(z(),F("div",{key:0,class:"absolute left-0 w-full border-t theme-border",style:ye({top:`${V.value}px`})},null,4)):a(e).highlightedEdge==="bottom"?(z(),F("div",{key:1,class:"absolute left-0 w-full border-t theme-border",style:ye({top:`${V.value+a(e).canvasSize.height*a(e).zoom}px`})},null,4)):a(e).highlightedEdge==="left"?(z(),F("div",{key:2,class:"absolute top-0 h-full border-l theme-border",style:ye({left:`${A.value}px`})},null,4)):a(e).highlightedEdge==="right"?(z(),F("div",{key:3,class:"absolute top-0 h-full border-l theme-border",style:ye({left:`${A.value+a(e).canvasSize.width*a(e).zoom}px`})},null,4)):be("",!0)])):be("",!0)],4)],544)])]),a(e).showMinimap?(z(),F("div",Yx,[ce(Ax,{"scroll-width":se.value,"scroll-height":G.value,"viewport-width":I.value,"viewport-height":q.value,"scroll-left":j.value,"scroll-top":B.value,pages:a(e).pages,"page-width":a(e).canvasSize.width,"page-height":a(e).canvasSize.height,zoom:a(e).zoom,"content-offset-x":A.value,"content-offset-y":V.value,"canvas-background":a(e).canvasBackground,"show-header-line":a(e).showHeaderLine,"show-footer-line":a(e).showFooterLine,"header-height":a(e).headerHeight,"footer-height":a(e).footerHeight,watermark:a(e).watermark||null,"onUpdate:scroll":ke},null,8,["scroll-width","scroll-height","viewport-width","viewport-height","scroll-left","scroll-top","pages","page-width","page-height","zoom","content-offset-x","content-offset-y","canvas-background","show-header-line","show-footer-line","header-height","footer-height","watermark"])])):be("",!0)]),ce(Hw)]),ce(qt,{show:g.value,"initial-value":S.value,title:a(n)("sidebar.saveAsCustomElement"),placeholder:a(n)("sidebar.enterNamePlaceholder"),onClose:u[4]||(u[4]=P=>g.value=!1),onSave:b},null,8,["show","initial-value","title","placeholder"])],512)}}}),Zx={class:"print-renderer"},Jx=ze({__name:"PrintRenderer",setup(r){const e=Re(),t=new URLSearchParams(window.location.search).get("printToken")||"",s=window.location.origin,n=g=>{window.parent&&window.parent.postMessage({type:g,token:t},s)},l=async(g=2e3)=>{const w=document.fonts;!w||!w.ready||await Promise.race([w.ready,new Promise(m=>setTimeout(m,g))])},i=async(g=2e3)=>{const m=Array.from(document.images||[]).filter(_=>!_.complete);m.length!==0&&await Promise.race([Promise.all(m.map(_=>new Promise(p=>{const S=()=>{_.removeEventListener("load",S),_.removeEventListener("error",S),p()};_.addEventListener("load",S,{once:!0}),_.addEventListener("error",S,{once:!0})}))),new Promise(_=>setTimeout(_,g))])},d=async g=>{e.$patch({pages:Ee(g.pages||[]),canvasSize:g.canvasSize||e.canvasSize,canvasBackground:g.canvasBackground||e.canvasBackground,headerHeight:g.headerHeight??e.headerHeight,footerHeight:g.footerHeight??e.footerHeight,showHeaderLine:g.showHeaderLine??!1,showFooterLine:g.showFooterLine??!1,showGrid:!1,showCornerMarkers:!1,zoom:1,currentPageIndex:0,selectedElementId:null,selectedElementIds:[],guides:[],testData:g.testData||{}}),g.watermark&&(e.watermark=Ee(g.watermark)),g.unit&&(e.unit=g.unit),e.setIsExporting(!0),document.body.classList.add("exporting"),await Xe(),await l(),await i(),requestAnimationFrame(()=>{n("print-renderer-rendered")})},c=g=>{if(g.origin!==s)return;const w=g.data;!w||w.type!=="print-renderer-payload"||w.token!==t||d(w.payload||{})};return We(()=>{document.body.style.margin="0",document.body.style.background="#ffffff",window.addEventListener("message",c),n("print-renderer-ready")}),Ge(()=>{window.removeEventListener("message",c)}),(g,w)=>(z(),F("div",Zx,[ce(Wl)]))}}),Qx=Et(Jx,[["__scopeId","data-v-e32c25e7"]]),e5={key:1,class:"h-screen w-screen overflow-hidden"},t5=ze({__name:"App",setup(r){const e=new URLSearchParams(window.location.search).get("print")==="1";return(t,s)=>e?(z(),Pe(Qx,{key:0})):(z(),F("div",e5,[ce(Xx)]))}}),r5=Yl(),zo=Xl(t5),n5=()=>{const r=localStorage.getItem("print-designer-brand-vars");if(r)try{const e=JSON.parse(r);if(!e||typeof e!="object")return;const t=document.documentElement;Object.entries(e).forEach(([s,n])=>{t.style.setProperty(s,n)})}catch{}};n5();zo.use(r5);zo.use(li);zo.mount("#app");
