import{b as Vl,e as ll,r as ce,w as Ae,c as ve,m as Se,f as P,g as q,i as o,j as mt,n as Xe,d as Le,u as je,a as Ve,o as We,k as Pe,T as et,l as Ke,t as S,p as fe,q as a,v as xe,F as Te,x as $e,y as Be,z as _e,A as Ce,B as il,C as Me,D as ke,E as gt,G as Ze,H as it,I as st,J as ut,K as Pt,L as Wl,M as Gl}from"./vendor-57TSdUMR.js";import{c as at,g as bt,C as Kl}from"./canvg-0PdlMh_v.js";import{v as Ne,r as Yl}from"./utils-CRAcIz2K.js";import{r as Xl,E as Zl}from"./pdf-DGXcMhCb.js";import{V as dl}from"./monaco-BtpKTOhI.js";import{r as Jl,a as Ql}from"./barcode-BoWGE6Vo.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))s(n);new MutationObserver(n=>{for(const l of n)if(l.type==="childList")for(const i of l.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&s(i)}).observe(document,{childList:!0,subtree:!0});function t(n){const l={};return n.integrity&&(l.integrity=n.integrity),n.referrerPolicy&&(l.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?l.credentials="include":n.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function s(n){if(n.ep)return;n.ep=!0;const l=t(n);fetch(n.href,l)}})();const ei={common:{save:"Save",cancel:"Cancel",confirm:"Confirm",close:"Close",delete:"Delete",edit:"Edit",copy:"Copy",cut:"Cut",paste:"Paste",undo:"Undo",redo:"Redo",rename:"Rename",loading:"Loading...",success:"Success",input:"Input",actions:"Actions",width:"Width",height:"Height",mm:"mm",px:"px",pt:"pt",rotate:"Rotate",lock:"Lock",unlock:"Unlock",appTitle:"Print Designer",testData:"Test Data",invalidJson:"Invalid JSON. Changes were not saved.",testDataKeyChanged:"Test data keys cannot be changed. Please only edit values."},template:{select:"Select Template",noTemplates:"No templates yet",new:"New Template",rename:"Rename Template",confirmDelete:'Are you sure you want to delete "{name}"?'},editor:{preview:"Print Preview",exportPdf:"Export PDF",exportImage:"Export Image",print:"Print",viewJson:"View JSON",viewBlob:"View Blob",viewImageBlob:"View Image Blob",viewPdfBlob:"View PDF Blob",zoomIn:"Zoom In",zoomOut:"Zoom Out",zoomLevel:"Zoom Level",zoomSettings:"Zoom Settings",unit:"Unit",advancedSettings:"Advanced Settings",watermark:"Watermark",watermarkEnable:"Enable",watermarkText:"Text",watermarkTextPlaceholder:"Enter watermark text",watermarkAngle:"Angle",watermarkColor:"Color",watermarkOpacity:"Opacity (%)",watermarkSize:"Size",watermarkDensity:"Density",template:"Template",newTemplate:"New Template",saveTemplate:"Save Template",saveAsTemplate:"Save As Template",templates:"Templates",shortcuts:"Shortcuts",help:"Help",about:"About",paperSettings:"Paper Settings",sizePreset:"Size Preset",custom:"Custom",spacingX:"Horizontal Margin",spacingY:"Vertical Margin",showCornerMarkers:"Show Corner Markers",showGrid:"Show Grid",showMinimap:"Show Minimap",headerFooter:"Header & Footer",headerLine:"Header Line",footerLine:"Footer Line",addNewPage:"Add New Page",fonts:{default:"Default",arial:"Arial",timesNewRoman:"Times New Roman",courierNew:"Courier New",simSun:"SimSun (宋体)",simHei:"SimHei (黑体)"},bold:"Bold",italic:"Italic",underline:"Underline",verticalText:"Vertical Text",textColor:"Text Color",backgroundColor:"Background Color",resetRotation:"Reset Rotation",alignLeft:"Align Left",alignCenter:"Align Center",alignRight:"Align Right",alignTop:"Align Top",alignMiddle:"Align Middle",alignBottom:"Align Bottom",group:"Group",lock:"Lock",unlock:"Unlock",fontFamily:"Font Family",settings:"Settings"},canvas:{addPage:"Add Page",copyPage:"Copy Page",pastePage:"Paste Page",deletePage:"Delete Page",newText:"New Text",headerLabel:"Header",footerLabel:"Footer",defaultTableHeaders:{id:"ID",name:"Name",qty:"Qty",price:"Price",total:"Total"},defaultTableData:{item:"Item",pageSum:"Page Sum",total:"Total",inWords:"In Words"}},sidebar:{elements:"Elements",dragToCanvas:"Drag elements to the canvas",standard:"Standard",custom:"Custom",general:"General",dataCodes:"Data & Codes",shapes:"Shapes",text:"Text",image:"Image",pagination:"Pagination",table:"Table",barcode:"Barcode",qrcode:"QR Code",line:"Line",rect:"Rect",circle:"Circle",noCustomElements:"No custom elements saved yet.",moreOptions:"More options",editElement:"Edit Element",rename:"Rename",copy:"Copy",delete:"Delete",renameModalTitle:"Rename Custom Element",enterNamePlaceholder:"Enter element name...",confirmDelete:'Are you sure you want to delete "{name}"?',confirmSwitchEdit:'Exit current edit for "{name}"?',confirmExitEdit:"You have unsaved changes. Exit anyway?",editingElement:"Editing custom element: {name}",saveEdit:"Save",saveAs:"Save As",exitEdit:"Exit",saveAsCustomElement:"Save as Custom Element",editSaveFailed:"Nothing to save. Please select an element."},elements:{text:"Text",image:"Image",table:"Table",line:"Line",rect:"Rect",circle:"Circle",barcode:"Barcode",qrcode:"QR Code",pageNumber:"Page Number",custom:"Custom",layers:"Layers"},properties:{title:"Properties",subtitle:"Edit element properties",locked:"Locked",multiSelectMode:"Multi-select mode",selectedElements:"{n} elements selected",deleteSelected:"Delete Selected Elements",tab:{properties:"Properties",style:"Style",advanced:"Advanced"},section:{positionSize:"Position & Size",dataBehavior:"Data & Behavior",layoutDimensions:"Layout & Dimensions",headerStyle:"Header Style",footerStyle:"Footer Style",cellOperations:"Cell Operations",appearance:"Appearance",elementInfo:"Element Info",content:"Content",typography:"Typography",border:"Border",barcodeSettings:"Barcode Settings",qrSettings:"QR Settings",labelContent:"Label Content",paginationTypography:"Pagination Typography",labelStyle:"Label Style",frameBorder:"Frame Border",lineStyle:"Line Style",imageSource:"Image Source"},action:{mergeCells:"Merge Cells",splitCells:"Split Cells",copyId:"Copy ID",copied:"Copied!",saveCustom:"Save as Custom Element",deleteElement:"Delete Current Element",saveCustomModal:"Save Custom Element"},empty:{noSelection:"No Selection",selectInstruction:"Select an element to edit properties"},label:{type:"Type",x:"X",y:"Y",width:"Width",height:"Height",content:"Content",variable:"Variable",writingMode:"Writing Mode",fontSize:"Font Size",color:"Color",textAlign:"Text Align",fontFamily:"Font Family",fontWeight:"Font Weight",borderStyle:"Border Style",borderWidth:"Border Width",borderColor:"Border Color",backgroundColor:"Background Color",imageSource:"Image Source",format:"Format",showText:"Show Text",lineWidth:"Line Width",barcodeHeight:"Height",margin:"Margin",textPosition:"Text Position",errorCorrection:"Error Correction",thickness:"Thickness",cornerRadius:"Corner Radius",background:"Background",autoPaginate:"Auto Paginate",repeatFooter:"Repeat Footer",showFooter:"Show Footer",columns:"Columns (JSON)",data:"Data (JSON)",footerData:"Footer Data (JSON)",customScript:"Custom Script",headerHeight:"Header Height",rowHeight:"Row Height",footerHeight:"Footer Height",textColor:"Text Color",editCell:"Edit Cell",editColumn:"Edit Column",headerText:"Header Text",fieldKey:"Field Key",variableField:"Variable Field",headerNamePlaceholder:"Header Name",displayTextPlaceholder:"Display Text (e.g. Total:)",dataFieldPlaceholder:"Data Field (e.g. {#amount})",id:"ID",labelBorderColor:"Label Border Color",barcodeContentPlaceholder:"Barcode Value",qrContentPlaceholder:"QR Code Value",textContentPlaceholder:"Enter text content",variablePlaceholder:"Variable Name (e.g. @name)",labelText:"Label Text",labelPosition:"Label Position",labelFontSize:"Label Font Size",labelColor:"Label Color",labelFontFamily:"Label Font Family",labelFontWeight:"Label Font Weight",labelBackgroundColor:"Label Background Color",labelBorderStyle:"Label Border Style",labelBorderWidth:"Label Border Width",pageFormat:"Page Format",labelTextPlaceholder:"e.g. Page",columnsPlaceholder:'[{ "field": "name", "header": "Name", "width": 100 }]',dataPlaceholder:"[{...}]",footerDataPlaceholder:'[{ "id": { "value": "Total" }, "amount": { "value": "Total:", "field": "{#sum}" } }]',customScriptPlaceholder:"return { data: ... };",fontStyle:"Font Style",padding:"Padding (px)"},option:{horizontal:"Horizontal",vertical:"Vertical",default:"Default",left:"Left",center:"Center",right:"Right",normal:"Normal",medium:"Medium",bold:"Bold",none:"None",solid:"Solid",dashed:"Dashed",dotted:"Dotted",yes:"Yes",no:"No",top:"Top",bottom:"Bottom",before:"Before",after:"After",eccLow:"Low (7%)",eccMedium:"Medium (15%)",eccQuartile:"Quartile (25%)",eccHigh:"High (30%)",arial:"Arial",timesNewRoman:"Times New Roman",courierNew:"Courier New",simSun:"SimSun (宋体)",simHei:"SimHei (黑体)",page1:"Page 1",oneTotal:"1/Total",code128:"CODE128",ean13:"EAN-13",upc:"UPC",code39:"CODE39",itf14:"ITF-14",msi:"MSI",pharmacode:"Pharmacode",numberOnly:"Number (1)"},image:{urlPlaceholder:"https://... or data:image/...",uploadBtn:"Upload Image",uploadTip:"Max 2MB, converts to Base64",sizeError:"Image size must be less than 2MB",readError:"Failed to read file"}},shortcuts:{title:"Shortcuts",keyboardShortcuts:"Keyboard Shortcuts",general:"General",editing:"Editing",manipulation:"Manipulation",newTemplate:"New Template",openSettings:"Open Settings",openHelp:"Open Help",zoom:"Zoom In/Out",closeModal:"Close Modal",selectAll:"Select All",multiSelect:"Multi-select",move:"Move",fastMove:"Fast Move",snapRotate:"Snap Rotate",resize:"Proportional Resize",saveAsTemplate:"Save As Template",customEditSave:"Save Custom Edit",customEditSaveAs:"Save Custom Edit As",customEditExit:"Exit Custom Edit",ctrl:"Ctrl",shift:"Shift",alt:"Alt",esc:"Esc",del:"Delete",enter:"Enter",arrow:"Arrow Keys",drag:"Drag",click:"Click",wheel:"Wheel"},help:{title:"Help Center",about:"About",aboutProject:"About {name}",github:"Project URL",dependencies:"Open Source Dependencies",package:"Package",version:"Version"},colorPicker:{clear:"Clear",transparent:"Transparent"},settings:{title:"Settings",basic:"Basic",language:"Language",connection:"Connections",themeColor:"Theme Color",themeColorDesc:"Pick a preset theme color and apply instantly.",themePresetDefault:"Blue",themePresetEmerald:"Emerald",themePresetAmber:"Amber",themePresetRose:"Rose",themePresetCustom:"Custom",theme:"Theme",themeSystem:"Follow System",themeLight:"Light",themeDark:"Dark",themeDesc:"Defaults to following system; you can force Light or Dark.",autoSave:"Auto Save",autoSaveDesc:"Automatically save changes (saved templates only).",exportImageMerged:"Export Image As Single",exportImageMergedDesc:"When off, export each page as a separate image inside a ZIP file.",languageDesc:"Choose the interface language.",connectionDesc:"Connection settings placeholder.",printMode:"Print Mode",printModeLocal:"Local Client",printModeRemote:"Remote Cloud",printModeBrowser:"Browser",printModeDesc:"Local and remote options require a successful connection test.",silentPrint:"Silent Print",silentPrintDesc:"When enabled, skip the custom print dialog; browser print still uses the browser dialog.",localConnection:"Local Client Print",remoteConnection:"Remote Cloud Print",host:"Host",port:"Port",wsPath:"WS Path",protocol:"Protocol",wsAddress:"WS Address",wsAddressPlaceholder:"ws://host:port/ws/request",localWsAddressPlaceholder:"ws://host:port/ws",secretKey:"Secret Key",connectionUrl:"Connection URL",connect:"Connect",disconnect:"Disconnect",connecting:"Connecting...",connectionTesting:"Testing connection...",connectionOk:"Connection OK",connectionOkWithUser:"Connection OK (User: {userId})",connectionFailed:"Connection failed",connectionTimeout:"Connection timeout",connectionMissingFields:"Please fill in API URL, username, and password.",connectionMissingToken:"Login succeeded but token is missing.",apiBaseUrl:"Login URL",apiBasePlaceholder:"http://host:port/api/login",username:"Username",password:"Password",remoteLoginTitle:"Login (HTTP)",remoteLoginDesc:"Used to obtain the JWT token. Enter the full login URL.",remoteWsTitle:"WebSocket (Print Relay)",remoteWsDesc:"Used for printing and client/printer queries. Token is appended to the WS URL.",localClientTitle:"Local Client",localClientDesc:"Configure the local client WebSocket and secret key for on-device printing.",remoteClient:"Default Client",remoteClientPlaceholder:"Select a client",remoteAuthHint:"Remote WS URL appends ?token=JWT for browser WebSocket authentication.",status:{connected:"Connected",connecting:"Connecting",disconnected:"Disconnected",error:"Error"},retrying:"Retrying ({count}/{max})",cancelRetry:"Cancel Retry",selectLanguage:"Select Language",zhLabel:"Chinese",enLabel:"English"},printDialog:{title:"Print Options",titleLocal:"Local Client Print Options",titleRemote:"Remote Cloud Print Options",sectionBasic:"Basic",sectionAdvanced:"Advanced",printer:"Printer",printerSelect:"Select printer",printerEmpty:"No printers found.",remoteClient:"Client",remoteClientPlaceholder:"Select client",remoteClientEmpty:"No clients found.",remotePrinterInfo:"Type: {type} | Paper: {paper} | Formats: {format}",printerPlaceholder:"Printer name",jobName:"Job Name",jobNamePlaceholder:"Optional job name",copies:"Copies",intervalMs:"Interval (ms)",pageRange:"Page Range",pageRangePlaceholder:"e.g. 1-3,5",pageSet:"Page Set",pageSetAll:"All",pageSetOdd:"Odd",pageSetEven:"Even",scale:"Scale",scaleNo:"No Scale",scaleShrink:"Shrink",scaleFit:"Fit",orientation:"Orientation",portrait:"Portrait",landscape:"Landscape",colorMode:"Color Mode",color:"Color",monochrome:"Monochrome",sidesMode:"Duplex",simplex:"Simplex",duplex:"Duplex",duplexShort:"Duplex (Short Edge)",duplexLong:"Duplex (Long Edge)",paperSize:"Paper Size",paperSizePlaceholder:"e.g. A4",trayBin:"Tray",trayBinPlaceholder:"e.g. 2 or Manual",confirm:"Print"},preview:{title:"Print Preview",templateJson:"Template JSON",zoomIn:"Zoom In",zoomOut:"Zoom Out"},input:{title:"Input",placeholder:"Enter value..."}},ti={common:{save:"保存",cancel:"取消",confirm:"确认",close:"关闭",delete:"删除",edit:"编辑",copy:"复制",cut:"剪切",paste:"粘贴",undo:"撤销",redo:"重做",rename:"重命名",loading:"加载中...",success:"成功",input:"输入",actions:"操作",width:"宽度",height:"高度",mm:"毫米",px:"像素",pt:"磅",rotate:"旋转",lock:"锁定",unlock:"解锁",appTitle:"打印设计器",testData:"测试数据",invalidJson:"JSON 无效，未保存更改。",testDataKeyChanged:"测试数据的键不允许修改，请仅编辑值。"},template:{select:"选择模版",noTemplates:"暂无模版",new:"新建模版",rename:"重命名模版",confirmDelete:'确定要删除 "{name}" 吗？'},editor:{preview:"打印预览",exportPdf:"导出 PDF",exportImage:"导出图片",print:"打印",viewJson:"查看 JSON",viewBlob:"查看 Blob",viewImageBlob:"查看图片 Blob",viewPdfBlob:"查看 PDF Blob",zoomIn:"放大",zoomOut:"缩小",zoomLevel:"缩放级别",zoomSettings:"缩放设置",unit:"单位",advancedSettings:"高级设置",watermark:"水印",watermarkEnable:"启用",watermarkText:"文字",watermarkTextPlaceholder:"请输入水印文字",watermarkAngle:"方向",watermarkColor:"颜色",watermarkOpacity:"透明度（%）",watermarkSize:"大小",watermarkDensity:"密度",template:"模版",newTemplate:"新建模版",saveTemplate:"保存模版",saveAsTemplate:"另存为模版",templates:"模版列表",shortcuts:"快捷键",help:"帮助",about:"关于",paperSettings:"页面设置",sizePreset:"纸张尺寸",custom:"自定义",spacingX:"水平边距",spacingY:"垂直边距",showCornerMarkers:"显示角标",showGrid:"显示网格",showMinimap:"显示缩略图",headerFooter:"页眉页脚",headerLine:"页眉线",footerLine:"页脚线",addNewPage:"添加新页",fonts:{default:"默认",arial:"Arial",timesNewRoman:"Times New Roman",courierNew:"Courier New",simSun:"宋体",simHei:"黑体"},bold:"加粗",italic:"斜体",underline:"下划线",verticalText:"竖排文本",textColor:"文本颜色",backgroundColor:"背景颜色",resetRotation:"重置旋转",alignLeft:"左对齐",alignCenter:"水平居中",alignRight:"右对齐",alignTop:"顶部对齐",alignMiddle:"垂直居中",alignBottom:"底部对齐",group:"组合",lock:"锁定",unlock:"解锁",fontFamily:"字体",settings:"设置"},canvas:{addPage:"添加页",copyPage:"复制页",pastePage:"粘贴页",deletePage:"删除页",newText:"新文本",headerLabel:"页眉",footerLabel:"页脚",defaultTableHeaders:{id:"ID",name:"名称",qty:"数量",price:"单价",total:"合计"},defaultTableData:{item:"商品",pageSum:"本页合计",total:"总计",inWords:"大写金额"}},sidebar:{custom:"自定义",elements:"组件库",dragToCanvas:"拖拽组件到画布",standard:"标准组件",general:"通用",dataCodes:"数据 & 条码",shapes:"图形",text:"文本",image:"图片",pagination:"页码",table:"表格",barcode:"条形码",qrcode:"二维码",line:"直线",rect:"矩形",circle:"圆形",noCustomElements:"暂无自定义组件",moreOptions:"更多选项",editElement:"编辑元素",rename:"重命名",copy:"复制",delete:"删除",renameModalTitle:"重命名自定义组件",enterNamePlaceholder:"输入组件名称...",confirmDelete:'确定要删除 "{name}" 吗？',confirmSwitchEdit:'退出当前对 "{name}" 的编辑？',confirmExitEdit:"存在未保存的更改，确定退出吗？",editingElement:"正在编辑自定义元素：{name}",saveEdit:"保存",saveAs:"另存为",exitEdit:"退出",saveAsCustomElement:"另存为自定义元素",editSaveFailed:"没有可保存的元素，请先选中一个元素。"},elements:{text:"文本",image:"图片",table:"表格",line:"直线",rect:"矩形",circle:"圆形",barcode:"条形码",qrcode:"二维码",pageNumber:"页码",custom:"自定义",layers:"图层"},properties:{title:"属性面板",subtitle:"编辑组件属性",locked:"已锁定",multiSelectMode:"多选模式",selectedElements:"已选择 {n} 个组件",deleteSelected:"删除选中组件",tab:{properties:"属性",style:"样式",advanced:"高级"},section:{positionSize:"位置 & 尺寸",dataBehavior:"数据 & 行为",layoutDimensions:"布局 & 尺寸",headerStyle:"表头样式",footerStyle:"表脚样式",cellOperations:"单元格操作",appearance:"外观",elementInfo:"组件信息",content:"内容",typography:"排版",border:"边框",barcodeSettings:"条形码设置",qrSettings:"二维码设置",labelContent:"标签内容",paginationTypography:"页码排版",labelStyle:"标签样式",frameBorder:"框架边框",lineStyle:"线条样式",imageSource:"图片来源"},action:{mergeCells:"合并单元格",splitCells:"拆分单元格",copyId:"复制 ID",copied:"已复制!",saveCustom:"保存为自定义组件",deleteElement:"删除当前组件",saveCustomModal:"保存自定义组件"},empty:{noSelection:"未选择",selectInstruction:"选择一个组件以编辑属性"},label:{type:"类型",x:"X",y:"Y",width:"宽度",height:"高度",content:"内容",variable:"变量",writingMode:"书写模式",fontSize:"字号",color:"颜色",textAlign:"对齐方式",fontFamily:"字体",fontWeight:"字重",borderStyle:"边框样式",borderWidth:"边框宽度",borderColor:"边框颜色",backgroundColor:"背景颜色",imageSource:"图片来源",format:"格式",showText:"显示文本",lineWidth:"线宽",barcodeHeight:"高度",margin:"边距",textPosition:"文本位置",errorCorrection:"纠错等级",thickness:"粗细",cornerRadius:"圆角半径",background:"背景",autoPaginate:"自动分页",repeatFooter:"重复表脚",showFooter:"显示表脚",columns:"列定义 (JSON)",data:"数据 (JSON)",footerData:"表脚数据 (JSON)",customScript:"自定义脚本",headerHeight:"表头高度",rowHeight:"行高",footerHeight:"表脚高度",textColor:"文本颜色",editCell:"编辑单元格",editColumn:"编辑列",headerText:"表头文本",fieldKey:"字段键",variableField:"变量字段",headerNamePlaceholder:"表头名称",displayTextPlaceholder:"显示文本 (如: 合计:)",dataFieldPlaceholder:"数据字段 (如: {#amount})",id:"ID",labelBorderColor:"标签边框颜色",barcodeContentPlaceholder:"条码内容",qrContentPlaceholder:"二维码内容",textContentPlaceholder:"请输入文本内容",variablePlaceholder:"变量名 (例如 @name)",labelText:"标签文本",labelPosition:"标签位置",labelFontSize:"标签字号",labelColor:"标签颜色",labelFontFamily:"标签字体",labelFontWeight:"标签字重",labelBackgroundColor:"标签背景颜色",labelBorderStyle:"标签边框样式",labelBorderWidth:"标签边框宽度",pageFormat:"页码格式",labelTextPlaceholder:"例如：第",columnsPlaceholder:'[{ "field": "name", "header": "姓名", "width": 100 }]',dataPlaceholder:"[{...}]",footerDataPlaceholder:'[{ "id": { "value": "合计" }, "amount": { "value": "合计:", "field": "{#sum}" } }]',customScriptPlaceholder:"return { data: ... };",fontStyle:"字体样式",padding:"内边距 (px)"},option:{horizontal:"水平",vertical:"垂直",default:"默认",left:"左对齐",center:"居中",right:"右对齐",normal:"常规",medium:"中等",bold:"加粗",none:"无",solid:"实线",dashed:"虚线",dotted:"点线",yes:"是",no:"否",top:"顶部",bottom:"底部",before:"之前",after:"之后",eccLow:"低 (7%)",eccMedium:"中 (15%)",eccQuartile:"四分 (25%)",eccHigh:"高 (30%)",arial:"Arial",timesNewRoman:"Times New Roman",courierNew:"Courier New",simSun:"宋体",simHei:"黑体",page1:"第 1 页",oneTotal:"1/共几页",code128:"CODE128",ean13:"EAN-13",upc:"UPC",code39:"CODE39",itf14:"ITF-14",msi:"MSI",pharmacode:"Pharmacode",numberOnly:"数字 (1)"},image:{urlPlaceholder:"请输入图片地址或 Base64...",uploadBtn:"上传图片",uploadTip:"最大 2MB，自动转换为 Base64",sizeError:"图片大小不能超过 2MB",readError:"读取文件失败"}},shortcuts:{title:"快捷键",keyboardShortcuts:"键盘快捷键",general:"通用",editing:"编辑",manipulation:"操作",themeColor:"主题色",themeColorDesc:"选择一个预设主题色，立即生效。",themePresetDefault:"蓝色",themePresetEmerald:"绿色",themePresetAmber:"橙色",themePresetRose:"玫红",themePresetCustom:"自定义",newTemplate:"新建模版",openSettings:"打开设置",openHelp:"打开帮助",zoom:"缩放",closeModal:"关闭弹窗",selectAll:"全选",multiSelect:"多选",move:"移动",fastMove:"快速移动",snapRotate:"吸附旋转",resize:"等比缩放",saveAsTemplate:"另存为模版",customEditSave:"保存自定义编辑",customEditSaveAs:"另存自定义编辑",customEditExit:"退出自定义编辑",ctrl:"Ctrl",shift:"Shift",alt:"Alt",esc:"Esc",del:"Delete",enter:"Enter",arrow:"方向键",drag:"拖拽",click:"点击",wheel:"滚轮"},help:{title:"帮助中心",about:"关于",aboutProject:"关于 {name}",github:"项目地址",dependencies:"开源依赖",package:"依赖包",version:"版本"},colorPicker:{clear:"清除",transparent:"透明"},settings:{title:"设置",basic:"基础",language:"语言",connection:"连接",themeColor:"主题色",themeColorDesc:"选择一个预设主题色，立即生效。",themePresetDefault:"蓝色",themePresetEmerald:"绿色",themePresetAmber:"橙色",themePresetRose:"玫红",themePresetCustom:"自定义",theme:"主题",themeSystem:"跟随系统",themeLight:"亮色",themeDark:"暗色",themeDesc:"默认跟随系统；可手动切换为亮色或暗色。",autoSave:"自动保存",autoSaveDesc:"当模版发生变更时自动保存（仅对已保存过的模版生效）。",exportImageMerged:"导出为整张图片",exportImageMergedDesc:"关闭后将每一页导出为单张图片，并打包为 ZIP。",languageDesc:"选择界面的显示语言。",connectionDesc:"连接设置占位内容。",printMode:"打印方式",printModeLocal:"本地客户端打印",printModeRemote:"远程云打印",printModeBrowser:"浏览器打印",printModeDesc:"本地/远程需连接测试成功后才能启用。",silentPrint:"静默打印",silentPrintDesc:"开启后跳过自定义打印对话框；浏览器打印仍会弹出浏览器打印设置。",localConnection:"本地客户端打印",remoteConnection:"远程云打印",host:"主机",port:"端口",wsPath:"WS 路径",protocol:"协议",wsAddress:"WS 地址",wsAddressPlaceholder:"ws://host:port/ws/request",localWsAddressPlaceholder:"ws://host:port/ws",secretKey:"密钥",connectionUrl:"连接地址",connect:"连接",disconnect:"断开",connecting:"连接中...",connectionTesting:"正在测试连接...",connectionOk:"连接成功",connectionOkWithUser:"连接成功（用户：{userId}）",connectionFailed:"连接失败",connectionTimeout:"连接超时",connectionMissingFields:"请填写 API 地址、用户名和密码。",connectionMissingToken:"登录成功但未返回 Token。",apiBaseUrl:"登录地址",apiBasePlaceholder:"http://host:port/api/login",username:"用户名",password:"密码",remoteLoginTitle:"登录（HTTP）",remoteLoginDesc:"用于获取 JWT，请填写完整的登录地址。",remoteWsTitle:"WebSocket（打印中转）",remoteWsDesc:"用于打印与查询客户端/打印机，Token 会拼到 WS 地址。",localClientTitle:"本地客户端",localClientDesc:"配置本地客户端的 WebSocket 与密钥，用于本机打印。",remoteClient:"默认客户端",remoteClientPlaceholder:"请选择客户端",remoteAuthHint:"远程 WS 地址会附加 ?token=JWT 以便浏览器鉴权。",status:{connected:"已连接",connecting:"连接中",disconnected:"未连接",error:"错误"},retrying:"重试中（{count}/{max}）",cancelRetry:"停止重试",selectLanguage:"选择语言",zhLabel:"中文",enLabel:"English"},printDialog:{title:"打印参数",titleLocal:"本地客户端打印参数",titleRemote:"远程云打印参数",sectionBasic:"基础",sectionAdvanced:"高级",printer:"打印机",printerSelect:"请选择打印机",printerEmpty:"未获取到打印机。",remoteClient:"客户端",remoteClientPlaceholder:"请选择客户端",remoteClientEmpty:"未获取到客户端。",remotePrinterInfo:"类型：{type} | 纸张：{paper} | 格式：{format}",printerPlaceholder:"打印机名称",jobName:"任务名称",jobNamePlaceholder:"可选任务名称",copies:"打印份数",intervalMs:"份数间隔(ms)",pageRange:"页码范围",pageRangePlaceholder:"如 1-3,5",pageSet:"奇偶页",pageSetAll:"全部",pageSetOdd:"奇数页",pageSetEven:"偶数页",scale:"缩放",scaleNo:"不缩放",scaleShrink:"缩小",scaleFit:"适应",orientation:"方向",portrait:"纵向",landscape:"横向",colorMode:"颜色模式",color:"彩色",monochrome:"黑白",sidesMode:"单双面",simplex:"单面",duplex:"双面",duplexShort:"双面（短边翻转）",duplexLong:"双面（长边翻转）",paperSize:"纸张",paperSizePlaceholder:"如 A4",trayBin:"纸盒",trayBinPlaceholder:"如 2 或 Manual",confirm:"打印"},preview:{title:"打印预览",templateJson:"模版 JSON",zoomIn:"放大",zoomOut:"缩小"},input:{title:"输入",placeholder:"请输入..."}},ri={en:ei,zh:ti},ni=()=>{const r=localStorage.getItem("print-designer-language");return r&&(r==="zh"||r==="en")?r:navigator.language.toLowerCase().startsWith("zh")?"zh":"en"},oi=Vl({legacy:!1,locale:ni(),fallbackLocale:"en",messages:ri});var Jt,Ao;function si(){if(Ao)return Jt;Ao=1;function r(){this.__data__=[],this.size=0}return Jt=r,Jt}var Qt,zo;function ul(){if(zo)return Qt;zo=1;function r(e,t){return e===t||e!==e&&t!==t}return Qt=r,Qt}var er,Po;function Ut(){if(Po)return er;Po=1;var r=ul();function e(t,s){for(var n=t.length;n--;)if(r(t[n][0],s))return n;return-1}return er=e,er}var tr,Lo;function ai(){if(Lo)return tr;Lo=1;var r=Ut(),e=Array.prototype,t=e.splice;function s(n){var l=this.__data__,i=r(l,n);if(i<0)return!1;var d=l.length-1;return i==d?l.pop():t.call(l,i,1),--this.size,!0}return tr=s,tr}var rr,Mo;function li(){if(Mo)return rr;Mo=1;var r=Ut();function e(t){var s=this.__data__,n=r(s,t);return n<0?void 0:s[n][1]}return rr=e,rr}var nr,Ro;function ii(){if(Ro)return nr;Ro=1;var r=Ut();function e(t){return r(this.__data__,t)>-1}return nr=e,nr}var or,Do;function di(){if(Do)return or;Do=1;var r=Ut();function e(t,s){var n=this.__data__,l=r(n,t);return l<0?(++this.size,n.push([t,s])):n[l][1]=s,this}return or=e,or}var sr,Bo;function Vt(){if(Bo)return sr;Bo=1;var r=si(),e=ai(),t=li(),s=ii(),n=di();function l(i){var d=-1,u=i==null?0:i.length;for(this.clear();++d<u;){var g=i[d];this.set(g[0],g[1])}}return l.prototype.clear=r,l.prototype.delete=e,l.prototype.get=t,l.prototype.has=s,l.prototype.set=n,sr=l,sr}var ar,Oo;function ui(){if(Oo)return ar;Oo=1;var r=Vt();function e(){this.__data__=new r,this.size=0}return ar=e,ar}var lr,qo;function ci(){if(qo)return lr;qo=1;function r(e){var t=this.__data__,s=t.delete(e);return this.size=t.size,s}return lr=r,lr}var ir,Fo;function hi(){if(Fo)return ir;Fo=1;function r(e){return this.__data__.get(e)}return ir=r,ir}var dr,jo;function pi(){if(jo)return dr;jo=1;function r(e){return this.__data__.has(e)}return dr=r,dr}var ur,No;function cl(){if(No)return ur;No=1;var r=typeof at=="object"&&at&&at.Object===Object&&at;return ur=r,ur}var cr,Ho;function tt(){if(Ho)return cr;Ho=1;var r=cl(),e=typeof self=="object"&&self&&self.Object===Object&&self,t=r||e||Function("return this")();return cr=t,cr}var hr,Uo;function uo(){if(Uo)return hr;Uo=1;var r=tt(),e=r.Symbol;return hr=e,hr}var pr,Vo;function fi(){if(Vo)return pr;Vo=1;var r=uo(),e=Object.prototype,t=e.hasOwnProperty,s=e.toString,n=r?r.toStringTag:void 0;function l(i){var d=t.call(i,n),u=i[n];try{i[n]=void 0;var g=!0}catch{}var y=s.call(i);return g&&(d?i[n]=u:delete i[n]),y}return pr=l,pr}var fr,Wo;function mi(){if(Wo)return fr;Wo=1;var r=Object.prototype,e=r.toString;function t(s){return e.call(s)}return fr=t,fr}var mr,Go;function Mt(){if(Go)return mr;Go=1;var r=uo(),e=fi(),t=mi(),s="[object Null]",n="[object Undefined]",l=r?r.toStringTag:void 0;function i(d){return d==null?d===void 0?n:s:l&&l in Object(d)?e(d):t(d)}return mr=i,mr}var gr,Ko;function ct(){if(Ko)return gr;Ko=1;function r(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}return gr=r,gr}var vr,Yo;function hl(){if(Yo)return vr;Yo=1;var r=Mt(),e=ct(),t="[object AsyncFunction]",s="[object Function]",n="[object GeneratorFunction]",l="[object Proxy]";function i(d){if(!e(d))return!1;var u=r(d);return u==s||u==n||u==t||u==l}return vr=i,vr}var br,Xo;function gi(){if(Xo)return br;Xo=1;var r=tt(),e=r["__core-js_shared__"];return br=e,br}var yr,Zo;function vi(){if(Zo)return yr;Zo=1;var r=gi(),e=(function(){var s=/[^.]+$/.exec(r&&r.keys&&r.keys.IE_PROTO||"");return s?"Symbol(src)_1."+s:""})();function t(s){return!!e&&e in s}return yr=t,yr}var wr,Jo;function pl(){if(Jo)return wr;Jo=1;var r=Function.prototype,e=r.toString;function t(s){if(s!=null){try{return e.call(s)}catch{}try{return s+""}catch{}}return""}return wr=t,wr}var xr,Qo;function bi(){if(Qo)return xr;Qo=1;var r=hl(),e=vi(),t=ct(),s=pl(),n=/[\\^$.*+?()[\]{}|]/g,l=/^\[object .+?Constructor\]$/,i=Function.prototype,d=Object.prototype,u=i.toString,g=d.hasOwnProperty,y=RegExp("^"+u.call(g).replace(n,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function m(x){if(!t(x)||e(x))return!1;var p=r(x)?y:l;return p.test(s(x))}return xr=m,xr}var _r,es;function yi(){if(es)return _r;es=1;function r(e,t){return e==null?void 0:e[t]}return _r=r,_r}var kr,ts;function ht(){if(ts)return kr;ts=1;var r=bi(),e=yi();function t(s,n){var l=e(s,n);return r(l)?l:void 0}return kr=t,kr}var Sr,rs;function co(){if(rs)return Sr;rs=1;var r=ht(),e=tt(),t=r(e,"Map");return Sr=t,Sr}var Cr,ns;function Wt(){if(ns)return Cr;ns=1;var r=ht(),e=r(Object,"create");return Cr=e,Cr}var Er,os;function wi(){if(os)return Er;os=1;var r=Wt();function e(){this.__data__=r?r(null):{},this.size=0}return Er=e,Er}var Tr,ss;function xi(){if(ss)return Tr;ss=1;function r(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}return Tr=r,Tr}var $r,as;function _i(){if(as)return $r;as=1;var r=Wt(),e="__lodash_hash_undefined__",t=Object.prototype,s=t.hasOwnProperty;function n(l){var i=this.__data__;if(r){var d=i[l];return d===e?void 0:d}return s.call(i,l)?i[l]:void 0}return $r=n,$r}var Ir,ls;function ki(){if(ls)return Ir;ls=1;var r=Wt(),e=Object.prototype,t=e.hasOwnProperty;function s(n){var l=this.__data__;return r?l[n]!==void 0:t.call(l,n)}return Ir=s,Ir}var Ar,is;function Si(){if(is)return Ar;is=1;var r=Wt(),e="__lodash_hash_undefined__";function t(s,n){var l=this.__data__;return this.size+=this.has(s)?0:1,l[s]=r&&n===void 0?e:n,this}return Ar=t,Ar}var zr,ds;function Ci(){if(ds)return zr;ds=1;var r=wi(),e=xi(),t=_i(),s=ki(),n=Si();function l(i){var d=-1,u=i==null?0:i.length;for(this.clear();++d<u;){var g=i[d];this.set(g[0],g[1])}}return l.prototype.clear=r,l.prototype.delete=e,l.prototype.get=t,l.prototype.has=s,l.prototype.set=n,zr=l,zr}var Pr,us;function Ei(){if(us)return Pr;us=1;var r=Ci(),e=Vt(),t=co();function s(){this.size=0,this.__data__={hash:new r,map:new(t||e),string:new r}}return Pr=s,Pr}var Lr,cs;function Ti(){if(cs)return Lr;cs=1;function r(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}return Lr=r,Lr}var Mr,hs;function Gt(){if(hs)return Mr;hs=1;var r=Ti();function e(t,s){var n=t.__data__;return r(s)?n[typeof s=="string"?"string":"hash"]:n.map}return Mr=e,Mr}var Rr,ps;function $i(){if(ps)return Rr;ps=1;var r=Gt();function e(t){var s=r(this,t).delete(t);return this.size-=s?1:0,s}return Rr=e,Rr}var Dr,fs;function Ii(){if(fs)return Dr;fs=1;var r=Gt();function e(t){return r(this,t).get(t)}return Dr=e,Dr}var Br,ms;function Ai(){if(ms)return Br;ms=1;var r=Gt();function e(t){return r(this,t).has(t)}return Br=e,Br}var Or,gs;function zi(){if(gs)return Or;gs=1;var r=Gt();function e(t,s){var n=r(this,t),l=n.size;return n.set(t,s),this.size+=n.size==l?0:1,this}return Or=e,Or}var qr,vs;function Pi(){if(vs)return qr;vs=1;var r=Ei(),e=$i(),t=Ii(),s=Ai(),n=zi();function l(i){var d=-1,u=i==null?0:i.length;for(this.clear();++d<u;){var g=i[d];this.set(g[0],g[1])}}return l.prototype.clear=r,l.prototype.delete=e,l.prototype.get=t,l.prototype.has=s,l.prototype.set=n,qr=l,qr}var Fr,bs;function Li(){if(bs)return Fr;bs=1;var r=Vt(),e=co(),t=Pi(),s=200;function n(l,i){var d=this.__data__;if(d instanceof r){var u=d.__data__;if(!e||u.length<s-1)return u.push([l,i]),this.size=++d.size,this;d=this.__data__=new t(u)}return d.set(l,i),this.size=d.size,this}return Fr=n,Fr}var jr,ys;function Mi(){if(ys)return jr;ys=1;var r=Vt(),e=ui(),t=ci(),s=hi(),n=pi(),l=Li();function i(d){var u=this.__data__=new r(d);this.size=u.size}return i.prototype.clear=e,i.prototype.delete=t,i.prototype.get=s,i.prototype.has=n,i.prototype.set=l,jr=i,jr}var Nr,ws;function Ri(){if(ws)return Nr;ws=1;function r(e,t){for(var s=-1,n=e==null?0:e.length;++s<n&&t(e[s],s,e)!==!1;);return e}return Nr=r,Nr}var Hr,xs;function Di(){if(xs)return Hr;xs=1;var r=ht(),e=(function(){try{var t=r(Object,"defineProperty");return t({},"",{}),t}catch{}})();return Hr=e,Hr}var Ur,_s;function fl(){if(_s)return Ur;_s=1;var r=Di();function e(t,s,n){s=="__proto__"&&r?r(t,s,{configurable:!0,enumerable:!0,value:n,writable:!0}):t[s]=n}return Ur=e,Ur}var Vr,ks;function ml(){if(ks)return Vr;ks=1;var r=fl(),e=ul(),t=Object.prototype,s=t.hasOwnProperty;function n(l,i,d){var u=l[i];(!(s.call(l,i)&&e(u,d))||d===void 0&&!(i in l))&&r(l,i,d)}return Vr=n,Vr}var Wr,Ss;function Kt(){if(Ss)return Wr;Ss=1;var r=ml(),e=fl();function t(s,n,l,i){var d=!l;l||(l={});for(var u=-1,g=n.length;++u<g;){var y=n[u],m=i?i(l[y],s[y],y,l,s):void 0;m===void 0&&(m=s[y]),d?e(l,y,m):r(l,y,m)}return l}return Wr=t,Wr}var Gr,Cs;function Bi(){if(Cs)return Gr;Cs=1;function r(e,t){for(var s=-1,n=Array(e);++s<e;)n[s]=t(s);return n}return Gr=r,Gr}var Kr,Es;function yt(){if(Es)return Kr;Es=1;function r(e){return e!=null&&typeof e=="object"}return Kr=r,Kr}var Yr,Ts;function Oi(){if(Ts)return Yr;Ts=1;var r=Mt(),e=yt(),t="[object Arguments]";function s(n){return e(n)&&r(n)==t}return Yr=s,Yr}var Xr,$s;function qi(){if($s)return Xr;$s=1;var r=Oi(),e=yt(),t=Object.prototype,s=t.hasOwnProperty,n=t.propertyIsEnumerable,l=r((function(){return arguments})())?r:function(i){return e(i)&&s.call(i,"callee")&&!n.call(i,"callee")};return Xr=l,Xr}var Zr,Is;function ho(){if(Is)return Zr;Is=1;var r=Array.isArray;return Zr=r,Zr}var Et={exports:{}},Jr,As;function Fi(){if(As)return Jr;As=1;function r(){return!1}return Jr=r,Jr}Et.exports;var zs;function gl(){return zs||(zs=1,(function(r,e){var t=tt(),s=Fi(),n=e&&!e.nodeType&&e,l=n&&!0&&r&&!r.nodeType&&r,i=l&&l.exports===n,d=i?t.Buffer:void 0,u=d?d.isBuffer:void 0,g=u||s;r.exports=g})(Et,Et.exports)),Et.exports}var Qr,Ps;function ji(){if(Ps)return Qr;Ps=1;var r=9007199254740991,e=/^(?:0|[1-9]\d*)$/;function t(s,n){var l=typeof s;return n=n??r,!!n&&(l=="number"||l!="symbol"&&e.test(s))&&s>-1&&s%1==0&&s<n}return Qr=t,Qr}var en,Ls;function vl(){if(Ls)return en;Ls=1;var r=9007199254740991;function e(t){return typeof t=="number"&&t>-1&&t%1==0&&t<=r}return en=e,en}var tn,Ms;function Ni(){if(Ms)return tn;Ms=1;var r=Mt(),e=vl(),t=yt(),s="[object Arguments]",n="[object Array]",l="[object Boolean]",i="[object Date]",d="[object Error]",u="[object Function]",g="[object Map]",y="[object Number]",m="[object Object]",x="[object RegExp]",p="[object Set]",_="[object String]",v="[object WeakMap]",k="[object ArrayBuffer]",b="[object DataView]",f="[object Float32Array]",C="[object Float64Array]",M="[object Int8Array]",F="[object Int16Array]",R="[object Int32Array]",z="[object Uint8Array]",H="[object Uint8ClampedArray]",Y="[object Uint16Array]",se="[object Uint32Array]",W={};W[f]=W[C]=W[M]=W[F]=W[R]=W[z]=W[H]=W[Y]=W[se]=!0,W[s]=W[n]=W[k]=W[l]=W[b]=W[i]=W[d]=W[u]=W[g]=W[y]=W[m]=W[x]=W[p]=W[_]=W[v]=!1;function E(B){return t(B)&&e(B.length)&&!!W[r(B)]}return tn=E,tn}var rn,Rs;function po(){if(Rs)return rn;Rs=1;function r(e){return function(t){return e(t)}}return rn=r,rn}var Tt={exports:{}};Tt.exports;var Ds;function fo(){return Ds||(Ds=1,(function(r,e){var t=cl(),s=e&&!e.nodeType&&e,n=s&&!0&&r&&!r.nodeType&&r,l=n&&n.exports===s,i=l&&t.process,d=(function(){try{var u=n&&n.require&&n.require("util").types;return u||i&&i.binding&&i.binding("util")}catch{}})();r.exports=d})(Tt,Tt.exports)),Tt.exports}var nn,Bs;function Hi(){if(Bs)return nn;Bs=1;var r=Ni(),e=po(),t=fo(),s=t&&t.isTypedArray,n=s?e(s):r;return nn=n,nn}var on,Os;function bl(){if(Os)return on;Os=1;var r=Bi(),e=qi(),t=ho(),s=gl(),n=ji(),l=Hi(),i=Object.prototype,d=i.hasOwnProperty;function u(g,y){var m=t(g),x=!m&&e(g),p=!m&&!x&&s(g),_=!m&&!x&&!p&&l(g),v=m||x||p||_,k=v?r(g.length,String):[],b=k.length;for(var f in g)(y||d.call(g,f))&&!(v&&(f=="length"||p&&(f=="offset"||f=="parent")||_&&(f=="buffer"||f=="byteLength"||f=="byteOffset")||n(f,b)))&&k.push(f);return k}return on=u,on}var sn,qs;function mo(){if(qs)return sn;qs=1;var r=Object.prototype;function e(t){var s=t&&t.constructor,n=typeof s=="function"&&s.prototype||r;return t===n}return sn=e,sn}var an,Fs;function yl(){if(Fs)return an;Fs=1;function r(e,t){return function(s){return e(t(s))}}return an=r,an}var ln,js;function Ui(){if(js)return ln;js=1;var r=yl(),e=r(Object.keys,Object);return ln=e,ln}var dn,Ns;function Vi(){if(Ns)return dn;Ns=1;var r=mo(),e=Ui(),t=Object.prototype,s=t.hasOwnProperty;function n(l){if(!r(l))return e(l);var i=[];for(var d in Object(l))s.call(l,d)&&d!="constructor"&&i.push(d);return i}return dn=n,dn}var un,Hs;function wl(){if(Hs)return un;Hs=1;var r=hl(),e=vl();function t(s){return s!=null&&e(s.length)&&!r(s)}return un=t,un}var cn,Us;function go(){if(Us)return cn;Us=1;var r=bl(),e=Vi(),t=wl();function s(n){return t(n)?r(n):e(n)}return cn=s,cn}var hn,Vs;function Wi(){if(Vs)return hn;Vs=1;var r=Kt(),e=go();function t(s,n){return s&&r(n,e(n),s)}return hn=t,hn}var pn,Ws;function Gi(){if(Ws)return pn;Ws=1;function r(e){var t=[];if(e!=null)for(var s in Object(e))t.push(s);return t}return pn=r,pn}var fn,Gs;function Ki(){if(Gs)return fn;Gs=1;var r=ct(),e=mo(),t=Gi(),s=Object.prototype,n=s.hasOwnProperty;function l(i){if(!r(i))return t(i);var d=e(i),u=[];for(var g in i)g=="constructor"&&(d||!n.call(i,g))||u.push(g);return u}return fn=l,fn}var mn,Ks;function vo(){if(Ks)return mn;Ks=1;var r=bl(),e=Ki(),t=wl();function s(n){return t(n)?r(n,!0):e(n)}return mn=s,mn}var gn,Ys;function Yi(){if(Ys)return gn;Ys=1;var r=Kt(),e=vo();function t(s,n){return s&&r(n,e(n),s)}return gn=t,gn}var $t={exports:{}};$t.exports;var Xs;function Xi(){return Xs||(Xs=1,(function(r,e){var t=tt(),s=e&&!e.nodeType&&e,n=s&&!0&&r&&!r.nodeType&&r,l=n&&n.exports===s,i=l?t.Buffer:void 0,d=i?i.allocUnsafe:void 0;function u(g,y){if(y)return g.slice();var m=g.length,x=d?d(m):new g.constructor(m);return g.copy(x),x}r.exports=u})($t,$t.exports)),$t.exports}var vn,Zs;function Zi(){if(Zs)return vn;Zs=1;function r(e,t){var s=-1,n=e.length;for(t||(t=Array(n));++s<n;)t[s]=e[s];return t}return vn=r,vn}var bn,Js;function Ji(){if(Js)return bn;Js=1;function r(e,t){for(var s=-1,n=e==null?0:e.length,l=0,i=[];++s<n;){var d=e[s];t(d,s,e)&&(i[l++]=d)}return i}return bn=r,bn}var yn,Qs;function xl(){if(Qs)return yn;Qs=1;function r(){return[]}return yn=r,yn}var wn,ea;function bo(){if(ea)return wn;ea=1;var r=Ji(),e=xl(),t=Object.prototype,s=t.propertyIsEnumerable,n=Object.getOwnPropertySymbols,l=n?function(i){return i==null?[]:(i=Object(i),r(n(i),function(d){return s.call(i,d)}))}:e;return wn=l,wn}var xn,ta;function Qi(){if(ta)return xn;ta=1;var r=Kt(),e=bo();function t(s,n){return r(s,e(s),n)}return xn=t,xn}var _n,ra;function _l(){if(ra)return _n;ra=1;function r(e,t){for(var s=-1,n=t.length,l=e.length;++s<n;)e[l+s]=t[s];return e}return _n=r,_n}var kn,na;function kl(){if(na)return kn;na=1;var r=yl(),e=r(Object.getPrototypeOf,Object);return kn=e,kn}var Sn,oa;function Sl(){if(oa)return Sn;oa=1;var r=_l(),e=kl(),t=bo(),s=xl(),n=Object.getOwnPropertySymbols,l=n?function(i){for(var d=[];i;)r(d,t(i)),i=e(i);return d}:s;return Sn=l,Sn}var Cn,sa;function ed(){if(sa)return Cn;sa=1;var r=Kt(),e=Sl();function t(s,n){return r(s,e(s),n)}return Cn=t,Cn}var En,aa;function Cl(){if(aa)return En;aa=1;var r=_l(),e=ho();function t(s,n,l){var i=n(s);return e(s)?i:r(i,l(s))}return En=t,En}var Tn,la;function td(){if(la)return Tn;la=1;var r=Cl(),e=bo(),t=go();function s(n){return r(n,t,e)}return Tn=s,Tn}var $n,ia;function rd(){if(ia)return $n;ia=1;var r=Cl(),e=Sl(),t=vo();function s(n){return r(n,t,e)}return $n=s,$n}var In,da;function nd(){if(da)return In;da=1;var r=ht(),e=tt(),t=r(e,"DataView");return In=t,In}var An,ua;function od(){if(ua)return An;ua=1;var r=ht(),e=tt(),t=r(e,"Promise");return An=t,An}var zn,ca;function sd(){if(ca)return zn;ca=1;var r=ht(),e=tt(),t=r(e,"Set");return zn=t,zn}var Pn,ha;function ad(){if(ha)return Pn;ha=1;var r=ht(),e=tt(),t=r(e,"WeakMap");return Pn=t,Pn}var Ln,pa;function yo(){if(pa)return Ln;pa=1;var r=nd(),e=co(),t=od(),s=sd(),n=ad(),l=Mt(),i=pl(),d="[object Map]",u="[object Object]",g="[object Promise]",y="[object Set]",m="[object WeakMap]",x="[object DataView]",p=i(r),_=i(e),v=i(t),k=i(s),b=i(n),f=l;return(r&&f(new r(new ArrayBuffer(1)))!=x||e&&f(new e)!=d||t&&f(t.resolve())!=g||s&&f(new s)!=y||n&&f(new n)!=m)&&(f=function(C){var M=l(C),F=M==u?C.constructor:void 0,R=F?i(F):"";if(R)switch(R){case p:return x;case _:return d;case v:return g;case k:return y;case b:return m}return M}),Ln=f,Ln}var Mn,fa;function ld(){if(fa)return Mn;fa=1;var r=Object.prototype,e=r.hasOwnProperty;function t(s){var n=s.length,l=new s.constructor(n);return n&&typeof s[0]=="string"&&e.call(s,"index")&&(l.index=s.index,l.input=s.input),l}return Mn=t,Mn}var Rn,ma;function id(){if(ma)return Rn;ma=1;var r=tt(),e=r.Uint8Array;return Rn=e,Rn}var Dn,ga;function wo(){if(ga)return Dn;ga=1;var r=id();function e(t){var s=new t.constructor(t.byteLength);return new r(s).set(new r(t)),s}return Dn=e,Dn}var Bn,va;function dd(){if(va)return Bn;va=1;var r=wo();function e(t,s){var n=s?r(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.byteLength)}return Bn=e,Bn}var On,ba;function ud(){if(ba)return On;ba=1;var r=/\w*$/;function e(t){var s=new t.constructor(t.source,r.exec(t));return s.lastIndex=t.lastIndex,s}return On=e,On}var qn,ya;function cd(){if(ya)return qn;ya=1;var r=uo(),e=r?r.prototype:void 0,t=e?e.valueOf:void 0;function s(n){return t?Object(t.call(n)):{}}return qn=s,qn}var Fn,wa;function hd(){if(wa)return Fn;wa=1;var r=wo();function e(t,s){var n=s?r(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.length)}return Fn=e,Fn}var jn,xa;function pd(){if(xa)return jn;xa=1;var r=wo(),e=dd(),t=ud(),s=cd(),n=hd(),l="[object Boolean]",i="[object Date]",d="[object Map]",u="[object Number]",g="[object RegExp]",y="[object Set]",m="[object String]",x="[object Symbol]",p="[object ArrayBuffer]",_="[object DataView]",v="[object Float32Array]",k="[object Float64Array]",b="[object Int8Array]",f="[object Int16Array]",C="[object Int32Array]",M="[object Uint8Array]",F="[object Uint8ClampedArray]",R="[object Uint16Array]",z="[object Uint32Array]";function H(Y,se,W){var E=Y.constructor;switch(se){case p:return r(Y);case l:case i:return new E(+Y);case _:return e(Y,W);case v:case k:case b:case f:case C:case M:case F:case R:case z:return n(Y,W);case d:return new E;case u:case m:return new E(Y);case g:return t(Y);case y:return new E;case x:return s(Y)}}return jn=H,jn}var Nn,_a;function fd(){if(_a)return Nn;_a=1;var r=ct(),e=Object.create,t=(function(){function s(){}return function(n){if(!r(n))return{};if(e)return e(n);s.prototype=n;var l=new s;return s.prototype=void 0,l}})();return Nn=t,Nn}var Hn,ka;function md(){if(ka)return Hn;ka=1;var r=fd(),e=kl(),t=mo();function s(n){return typeof n.constructor=="function"&&!t(n)?r(e(n)):{}}return Hn=s,Hn}var Un,Sa;function gd(){if(Sa)return Un;Sa=1;var r=yo(),e=yt(),t="[object Map]";function s(n){return e(n)&&r(n)==t}return Un=s,Un}var Vn,Ca;function vd(){if(Ca)return Vn;Ca=1;var r=gd(),e=po(),t=fo(),s=t&&t.isMap,n=s?e(s):r;return Vn=n,Vn}var Wn,Ea;function bd(){if(Ea)return Wn;Ea=1;var r=yo(),e=yt(),t="[object Set]";function s(n){return e(n)&&r(n)==t}return Wn=s,Wn}var Gn,Ta;function yd(){if(Ta)return Gn;Ta=1;var r=bd(),e=po(),t=fo(),s=t&&t.isSet,n=s?e(s):r;return Gn=n,Gn}var Kn,$a;function wd(){if($a)return Kn;$a=1;var r=Mi(),e=Ri(),t=ml(),s=Wi(),n=Yi(),l=Xi(),i=Zi(),d=Qi(),u=ed(),g=td(),y=rd(),m=yo(),x=ld(),p=pd(),_=md(),v=ho(),k=gl(),b=vd(),f=ct(),C=yd(),M=go(),F=vo(),R=1,z=2,H=4,Y="[object Arguments]",se="[object Array]",W="[object Boolean]",E="[object Date]",B="[object Error]",c="[object Function]",w="[object GeneratorFunction]",G="[object Map]",ee="[object Number]",J="[object Object]",$="[object RegExp]",N="[object Set]",L="[object String]",O="[object Symbol]",ne="[object WeakMap]",T="[object ArrayBuffer]",D="[object DataView]",oe="[object Float32Array]",de="[object Float64Array]",te="[object Int8Array]",ue="[object Int16Array]",ie="[object Int32Array]",he="[object Uint8Array]",Q="[object Uint8ClampedArray]",ae="[object Uint16Array]",h="[object Uint32Array]",U={};U[Y]=U[se]=U[T]=U[D]=U[W]=U[E]=U[oe]=U[de]=U[te]=U[ue]=U[ie]=U[G]=U[ee]=U[J]=U[$]=U[N]=U[L]=U[O]=U[he]=U[Q]=U[ae]=U[h]=!0,U[B]=U[c]=U[ne]=!1;function Z(A,I,X,K,le,V){var pe,we=I&R,ge=I&z,me=I&H;if(X&&(pe=le?X(A,K,le,V):X(A)),pe!==void 0)return pe;if(!f(A))return A;var re=v(A);if(re){if(pe=x(A),!we)return i(A,pe)}else{var j=m(A),be=j==c||j==w;if(k(A))return l(A,we);if(j==J||j==Y||be&&!le){if(pe=ge||be?{}:_(A),!we)return ge?u(A,n(pe,A)):d(A,s(pe,A))}else{if(!U[j])return le?A:{};pe=p(A,j,we)}}V||(V=new r);var ze=V.get(A);if(ze)return ze;V.set(A,pe),C(A)?A.forEach(function(Ie){pe.add(Z(Ie,I,X,Ie,A,V))}):b(A)&&A.forEach(function(Ie,Fe){pe.set(Fe,Z(Ie,I,X,Fe,A,V))});var Oe=me?ge?y:g:ge?F:M,He=re?void 0:Oe(A);return e(He||A,function(Ie,Fe){He&&(Fe=Ie,Ie=A[Fe]),t(pe,Fe,Z(Ie,I,X,Fe,A,V))}),pe}return Kn=Z,Kn}var Yn,Ia;function xd(){if(Ia)return Yn;Ia=1;var r=wd(),e=1,t=4;function s(n){return r(n,e|t)}return Yn=s,Yn}var _d=xd();const Ee=bt(_d);var ye=(r=>(r.TEXT="text",r.IMAGE="image",r.TABLE="table",r.PAGE_NUMBER="pageNumber",r.BARCODE="barcode",r.QRCODE="qrcode",r.LINE="line",r.RECT="rect",r.CIRCLE="circle",r))(ye||{});const kd={mode:"local",endpoints:{baseUrl:"",templates:{list:"/api/print/templates",get:"/api/print/templates/{id}",upsert:"/api/print/templates",delete:"/api/print/templates/{id}"},customElements:{list:"/api/print/custom-elements",get:"/api/print/custom-elements/{id}",upsert:"/api/print/custom-elements",delete:"/api/print/custom-elements/{id}"}},headers:{"Content-Type":"application/json"}};let It={...kd};const Sd=(r,e)=>({...r}),Je=()=>({mode:It.mode,endpoints:Sd(It.endpoints),headers:{...It.headers||{}},fetcher:It.fetcher}),Cd=r=>{const e=It.endpoints.baseUrl||"";return r?/^https?:\/\//i.test(r)||!e?r:r.startsWith("/")?`${e.replace(/\/+$/,"")}${r}`:`${e.replace(/\/+$/,"")}/${r}`:e||""},Qe=(r,e)=>{const t=r||"",s=e?t.replace("{id}",e):t;return Cd(s)},At={enabled:!1,text:"",angle:-30,color:"#000000",opacity:.1,size:24,density:160},Ed={title:"",logoUrl:"",showTitle:!0,showLogo:!0},Td=()=>{const r=localStorage.getItem("print-designer-watermark");if(!r)return{...At};try{return{...At,...JSON.parse(r)}}catch{return{...At}}},De=ll("designer",{state:()=>({unit:localStorage.getItem("print-designer-unit")||"mm",watermark:Td(),branding:{...Ed},pages:[{id:Ne(),elements:[]}],currentPageIndex:0,customElements:JSON.parse(localStorage.getItem("print-designer-custom-elements")||"[]"),testData:{},editingCustomElementId:null,customElementEditSnapshot:null,selectedElementId:null,selectedElementIds:[],selectedGuideId:null,highlightedGuideId:null,highlightedEdge:null,canvasSize:{width:794,height:1123},zoom:1,isDragging:!1,showGrid:!0,showCornerMarkers:!0,headerHeight:100,footerHeight:100,showHeaderLine:!1,showFooterLine:!1,showMinimap:!1,showHelp:!1,showSettings:!1,canvasBackground:"#ffffff",pageSpacingX:32,pageSpacingY:32,guides:[],historyPast:[],historyFuture:[],clipboard:[],copiedPage:null,isExporting:!1,disableGlobalShortcuts:!1,disableShortcutsCount:0,tableSelection:null}),actions:{setBranding(r){if(!r||typeof r!="object")return;const e={...this.branding,...r};r.showTitle!==void 0&&(e.showTitle=!!r.showTitle),r.showLogo!==void 0&&(e.showLogo=!!r.showLogo),this.branding=e},setWatermark(r){this.watermark={...this.watermark||At,...r},localStorage.setItem("print-designer-watermark",JSON.stringify(this.watermark))},setUnit(r){this.unit=r,localStorage.setItem("print-designer-unit",r)},setDragging(r){this.isDragging=r},setDisableGlobalShortcuts(r){const e=this.disableShortcutsCount||0;r?this.disableShortcutsCount=e+1:this.disableShortcutsCount=Math.max(0,e-1),this.disableGlobalShortcuts=this.disableShortcutsCount>0},setIsExporting(r){this.isExporting=r},setPageSpacingX(r){this.pageSpacingX=Math.max(0,Math.round(r))},setPageSpacingY(r){this.pageSpacingY=Math.max(0,Math.round(r))},resetCanvas(){this.watermark={...At},localStorage.setItem("print-designer-watermark",JSON.stringify(this.watermark)),this.pages=[{id:Ne(),elements:[]}],this.currentPageIndex=0,this.testData={},this.selectedElementId=null,this.selectedElementIds=[],this.selectedGuideId=null,this.guides=[],this.historyPast=[],this.historyFuture=[],this.headerHeight=100,this.footerHeight=100,this.showHeaderLine=!1,this.showFooterLine=!1,this.canvasBackground="#ffffff",this.pageSpacingX=32,this.pageSpacingY=32,this.canvasSize={width:794,height:1123},this.zoom=1,this.showGrid=!0,this.showCornerMarkers=!0,this.showMinimap=!1,this.showHelp=!1,this.showSettings=!1,this.copiedPage=null},startCustomElementEdit(r){const e=this.customElements.find(s=>s.id===r);if(!e)return;this.customElementEditSnapshot||(this.customElementEditSnapshot={pages:Ee(this.pages),historyPast:Ee(this.historyPast),historyFuture:Ee(this.historyFuture),canvasSize:Ee(this.canvasSize),guides:Ee(this.guides),zoom:this.zoom,showGrid:this.showGrid,headerHeight:this.headerHeight,footerHeight:this.footerHeight,showHeaderLine:this.showHeaderLine,showFooterLine:this.showFooterLine,showMinimap:this.showMinimap,canvasBackground:this.canvasBackground,pageSpacingX:this.pageSpacingX,pageSpacingY:this.pageSpacingY,unit:this.unit,watermark:Ee(this.watermark),testData:Ee(this.testData),currentPageIndex:this.currentPageIndex,selectedElementId:this.selectedElementId,selectedElementIds:Ee(this.selectedElementIds),selectedGuideId:this.selectedGuideId,highlightedGuideId:this.highlightedGuideId,highlightedEdge:this.highlightedEdge}),this.editingCustomElementId=r,this.resetCanvas();const t=Ee(e.element);t.id=Ne(),this.pages=[{id:Ne(),elements:[t]}],this.currentPageIndex=0,this.selectedElementId=t.id,this.selectedElementIds=[t.id],this.historyPast=[],this.historyFuture=[],this.guides=[],this.tableSelection=null},cancelCustomElementEdit(){const r=this.customElementEditSnapshot;this.editingCustomElementId=null,this.customElementEditSnapshot=null,r&&(this.pages=r.pages,this.historyPast=r.historyPast||[],this.historyFuture=r.historyFuture||[],this.canvasSize=r.canvasSize,this.guides=r.guides,this.zoom=r.zoom,this.showGrid=r.showGrid,this.headerHeight=r.headerHeight,this.footerHeight=r.footerHeight,this.showHeaderLine=r.showHeaderLine,this.showFooterLine=r.showFooterLine,this.showMinimap=r.showMinimap,this.canvasBackground=r.canvasBackground,this.pageSpacingX=r.pageSpacingX??this.pageSpacingX,this.pageSpacingY=r.pageSpacingY??this.pageSpacingY,this.unit=r.unit||this.unit,r.unit&&localStorage.setItem("print-designer-unit",r.unit),r.watermark&&(this.watermark=Ee(r.watermark),localStorage.setItem("print-designer-watermark",JSON.stringify(this.watermark))),this.testData=r.testData||{},this.currentPageIndex=r.currentPageIndex,this.selectedElementId=r.selectedElementId,this.selectedElementIds=r.selectedElementIds,this.selectedGuideId=r.selectedGuideId,this.highlightedGuideId=r.highlightedGuideId,this.highlightedEdge=r.highlightedEdge,this.tableSelection=null)},commitCustomElementEdit(){var t;if(!this.editingCustomElementId)return!1;const r=this.customElements.find(s=>s.id===this.editingCustomElementId);if(!r)return!1;const e=this.selectedElement||((t=this.pages[0])==null?void 0:t.elements[0]);return e?(r.element=Ee(e),this.saveCustomElements(),!0):!1},saveCustomElementEditAs(r){var t;const e=this.selectedElement||((t=this.pages[0])==null?void 0:t.elements[0]);return e?(this.addCustomElement(r,e),!0):!1},copyPage(r){const e=this.pages[r];e&&(this.copiedPage=Ee(e))},pastePage(r){if(!this.copiedPage)return;this.snapshot();const e=Ee(this.copiedPage);e.id=Ne(),e.elements.forEach(t=>{t.id=Ne()}),this.pages.splice(r+1,0,e),this.currentPageIndex=r+1},addPage(){this.snapshot(),this.pages.push({id:Ne(),elements:[]}),this.currentPageIndex=this.pages.length-1},removePage(r){this.pages.length<=1||(this.snapshot(),this.pages.splice(r,1),this.currentPageIndex>=this.pages.length&&(this.currentPageIndex=this.pages.length-1))},setTableSelection(r,e,t){if(this.tableSelection&&this.tableSelection.elementId!==r){this.tableSelection={elementId:r,cells:[e]};return}if(!this.tableSelection){this.tableSelection={elementId:r,cells:[e]};return}if(t){const s=this.tableSelection.cells.findIndex(n=>n.rowIndex===e.rowIndex&&n.colField===e.colField&&n.section===e.section);s>=0?(this.tableSelection.cells.splice(s,1),this.tableSelection.cells.length===0&&(this.tableSelection=null)):this.tableSelection.cells.length>0&&this.tableSelection.cells[0].section!==e.section?this.tableSelection={elementId:r,cells:[e]}:this.tableSelection.cells.push(e)}else this.tableSelection={elementId:r,cells:[e]}},setTableSelectionCells(r,e){this.tableSelection={elementId:r,cells:e}},clearTableSelection(){this.tableSelection=null},mergeSelectedCells(){if(!this.tableSelection||this.tableSelection.cells.length<2)return;const{elementId:r,cells:e}=this.tableSelection,t=e[0].section||"body";let s=null,n=-1,l=-1;for(let b=0;b<this.pages.length;b++){const f=this.pages[b].elements.findIndex(C=>C.id===r);if(f!==-1){s=this.pages[b].elements[f],n=b,l=f;break}}if(!s||!s.columns)return;const i=t==="footer"?"footerData":"data";if(!s[i])return;const d=e.map(b=>b.rowIndex),u=Math.min(...d),g=Math.max(...d),y=s.columns.map(b=>b.field),m=e.map(b=>y.indexOf(b.colField)).filter(b=>b!==-1);if(m.length!==e.length)return;const x=Math.min(...m),p=Math.max(...m),_=g-u+1,v=p-x+1;this.snapshot();const k=Ee(s[i]);for(let b=u;b<=g;b++)for(let f=x;f<=p;f++){const C=y[f],M=k[b];M&&(typeof M[C]!="object"||M[C]===null?M[C]={value:M[C]}:"value"in M[C],b===u&&f===x?(M[C].rowSpan=_,M[C].colSpan=v):(M[C].rowSpan=0,M[C].colSpan=0,M[C].value=""))}this.pages[n].elements[l]={...s,[i]:k},this.tableSelection=null},splitSelectedCells(){if(!this.tableSelection||this.tableSelection.cells.length!==1)return;const{elementId:r,cells:e}=this.tableSelection,t=e[0],s=t.section||"body";let n=null,l=-1,i=-1;for(let v=0;v<this.pages.length;v++){const k=this.pages[v].elements.findIndex(b=>b.id===r);if(k!==-1){n=this.pages[v].elements[k],l=v,i=k;break}}if(!n||!n.columns)return;const d=s==="footer"?"footerData":"data";if(!n[d])return;const u=n[d][t.rowIndex];if(!u)return;const g=u[t.colField];if(!g||typeof g!="object"||!g.rowSpan&&!g.colSpan)return;const y=g.rowSpan||1,m=g.colSpan||1;if(y<=1&&m<=1)return;this.snapshot();const x=Ee(n[d]),p=n.columns.map(v=>v.field),_=p.indexOf(t.colField);for(let v=t.rowIndex;v<t.rowIndex+y;v++)for(let k=_;k<_+m;k++){const b=p[k],f=x[v];f&&f[b]&&typeof f[b]=="object"&&(f[b].rowSpan=1,f[b].colSpan=1)}this.pages[l].elements[i]={...n,[d]:x},this.tableSelection=null},setHeaderHeight(r){this.headerHeight=r},setFooterHeight(r){this.footerHeight=r},setShowHeaderLine(r){this.showHeaderLine=r},setShowFooterLine(r){this.showFooterLine=r},setShowMinimap(r){this.showMinimap=r},setShowHelp(r){this.showHelp=r},setShowSettings(r){this.showSettings=r},setCanvasBackground(r){this.canvasBackground=r},snapshot(){this.historyPast.length>=20&&this.historyPast.shift(),this.historyPast.push(Ee(this.pages)),this.historyFuture=[]},undo(){if(this.historyPast.length===0)return;const r=this.historyPast.pop();this.historyFuture.push(Ee(this.pages)),this.pages=Ee(r),this.selectedElementId&&(this.pages.some(t=>t.elements.some(s=>s.id===this.selectedElementId))||(this.selectedElementId=null,this.selectedElementIds=[])),this.selectedElementIds=this.selectedElementIds.filter(e=>this.pages.some(t=>t.elements.some(s=>s.id===e))),this.currentPageIndex>=this.pages.length&&(this.currentPageIndex=Math.max(0,this.pages.length-1))},redo(){if(this.historyFuture.length===0)return;const r=this.historyFuture.pop();this.historyPast.push(Ee(this.pages)),this.pages=Ee(r),this.currentPageIndex>=this.pages.length&&(this.currentPageIndex=Math.max(0,this.pages.length-1))},addGuide(r){this.guides.push({...r,id:Ne()})},updateGuide(r,e){const t=this.guides.find(s=>s.id===r);t&&(t.position=e)},removeGuide(r){const e=this.guides.findIndex(t=>t.id===r);e!==-1&&(this.guides.splice(e,1),this.selectedGuideId===r&&(this.selectedGuideId=null))},clearGuides(){this.guides=[]},selectGuide(r){this.selectedGuideId=r,r&&(this.selectedElementId=null,this.selectedElementIds=[],this.tableSelection=null)},setHighlightedGuide(r){this.highlightedGuideId=r},setHighlightedEdge(r){this.highlightedEdge=r},setShowCornerMarkers(r){this.showCornerMarkers=r},getSnapPosition(r,e,t,s=!1,n=!0,l=-1){let d=e,u=t,g=null,y=null;const m=(f,C,M)=>{const F=Math.abs(f-M);if(F>5)return!1;if(s){const R=Math.abs(C-M);return F<R}return!0},x=Math.max(0,this.canvasSize.width-r.width),p=Math.max(0,this.canvasSize.height-r.height);m(d,r.x,0)?(d=0,y="left"):m(d+r.width,r.x+r.width,this.canvasSize.width)&&(d=x,y="right"),m(u,r.y,0)?(u=0,y=y||"top"):m(u+r.height,r.y+r.height,this.canvasSize.height)&&(u=p,y=y||"bottom");for(const f of this.guides)f.type==="vertical"?m(d,r.x,f.position)?(d=f.position,g=f.id):m(d+r.width,r.x+r.width,f.position)&&(d=f.position-r.width,g=f.id):m(u,r.y,f.position)?(u=f.position,g=f.id):m(u+r.height,r.y+r.height,f.position)&&(u=f.position-r.height,g=f.id);let _=n,v=n,k=!1,b=!1;return n||(this.pages.length<=1?(_=!0,v=!0):(_=!0,l===0&&(k=!0),l===this.pages.length-1&&(b=!0))),_&&(d=Math.min(Math.max(0,d),x)),v?u=Math.min(Math.max(0,u),p):(k&&(u=Math.max(0,u)),b&&(u=Math.min(u,p))),{x:d,y:u,highlightedGuideId:g,highlightedEdge:y}},moveElementWithSnap(r,e,t,s=!0,n=!0){for(let l=0;l<this.pages.length;l++){const i=this.pages[l],d=i.elements.findIndex(u=>u.id===r);if(d!==-1){const u=i.elements[d];if(u.locked)return;const g=this.getSnapPosition(u,e,t,!1,n,l);this.setHighlightedGuide(g.highlightedGuideId||null),this.setHighlightedEdge(g.highlightedEdge||null),this.updateElement(r,{x:g.x,y:g.y},s);return}}},moveSelectedElements(r,e,t,s=!0,n=!0){s&&this.snapshot();let l=null,i=-1;const d=[],u=new Set(this.selectedElementIds);for(let _=0;_<this.pages.length;_++){const v=this.pages[_];for(let k=0;k<v.elements.length;k++){const b=v.elements[k];b.id===r&&(l=b,i=_),u.has(b.id)&&!b.locked&&d.push({pageIndex:_,elementIndex:k,element:b})}}if(!l||l.locked)return;const g=this.getSnapPosition(l,e,t,!1,n,i);this.setHighlightedGuide(g.highlightedGuideId||null),this.setHighlightedEdge(g.highlightedEdge||null);let y=g.x-l.x,m=g.y-l.y;if(y===0&&m===0)return;let x=n,p=n;if(n||(this.pages.length<=1?(x=!0,p=!0):(x=!0,p=!1)),x||p||!p&&this.pages.length>1)for(const _ of d){const v=_.element,k=_.pageIndex;if(x)if(y>0){const b=this.canvasSize.width-v.width;v.x+y>b&&(y=b-v.x)}else y<0&&v.x+y<0&&(y=-v.x);if(p)if(m>0){const b=this.canvasSize.height-v.height;v.y+m>b&&(m=b-v.y)}else m<0&&v.y+m<0&&(m=-v.y);else if(k===0&&m<0&&v.y+m<0&&(m=-v.y),k===this.pages.length-1&&m>0){const b=this.canvasSize.height-v.height;v.y+m>b&&(m=b-v.y)}}if(!(y===0&&m===0))for(const _ of d){const{pageIndex:v,elementIndex:k,element:b}=_;this.pages[v].elements[k]={...b,x:b.x+y,y:b.y+m}}},nudgeSelectedElements(r,e){if(this.selectedElementIds.length===0)return;const t=this.selectedElementIds.filter(y=>{for(const m of this.pages){const x=m.elements.find(p=>p.id===y);if(x&&!x.locked)return!0}return!1});if(t.length===0)return;this.snapshot();let s=this.selectedElementId;(!s||!t.includes(s))&&(s=t[0]);let n=null;for(const y of this.pages){const m=y.elements.find(x=>x.id===s);if(m){n=m;break}}if(!n)return;const l=n.x+r,i=n.y+e,d=this.getSnapPosition(n,l,i,!0);this.setHighlightedGuide(d.highlightedGuideId||null),this.setHighlightedEdge(d.highlightedEdge||null);let u=d.x-n.x,g=d.y-n.y;for(const y of t)for(const m of this.pages){const x=m.elements.find(p=>p.id===y);if(x){if(u>0){const p=this.canvasSize.width-x.width;x.x+u>p&&(u=p-x.x)}else u<0&&x.x+u<0&&(u=-x.x);if(g>0){const p=this.canvasSize.height-x.height;x.y+g>p&&(g=p-x.y)}else g<0&&x.y+g<0&&(g=-x.y)}}if(!(u===0&&g===0))for(const y of t)for(const m of this.pages){const x=m.elements.findIndex(p=>p.id===y);if(x!==-1){const p=m.elements[x];m.elements[x]={...p,x:p.x+u,y:p.y+g};break}}},addElement(r,e){this.snapshot();const t={...r,id:Ne()},s=e!==void 0&&e>=0&&e<this.pages.length?e:this.currentPageIndex;this.pages[s].elements.push(t),this.selectedElementId=t.id,this.currentPageIndex=s},moveElementToPage(r,e,t,s){this.snapshot();let n=-1,l=-1,i;for(let d=0;d<this.pages.length;d++){const u=this.pages[d].elements.findIndex(g=>g.id===r);if(u!==-1){n=d,l=u,i=this.pages[d].elements[u];break}}!i||n===-1||(this.pages[n].elements.splice(l,1),i.x=t,i.y=s,e>=0&&e<this.pages.length?(this.pages[e].elements.push(i),this.currentPageIndex=e):this.pages[n].elements.push(i))},updateElement(r,e,t=!0){t&&this.snapshot();for(const s of this.pages){const n=s.elements.findIndex(l=>l.id===r);if(n!==-1){if(s.elements[n].locked&&e.locked===void 0)return;s.elements[n]={...s.elements[n],...e};return}}},removeElement(r){for(const e of this.pages){const t=e.elements.find(s=>s.id===r);if(t&&t.locked)return}this.snapshot();for(const e of this.pages){const t=e.elements.findIndex(s=>s.id===r);if(t!==-1){e.elements.splice(t,1),this.selectedElementId===r&&(this.selectedElementId=null),this.tableSelection&&this.tableSelection.elementId===r&&(this.tableSelection=null);const s=this.selectedElementIds.indexOf(r);s!==-1&&this.selectedElementIds.splice(s,1);return}}},selectElement(r,e=!1){if(r&&(this.selectedGuideId=null),this.tableSelection&&(this.tableSelection=null),e&&r){if(this.selectedElementIds.includes(r)){const t=this.selectedElementIds.indexOf(r);this.selectedElementIds.splice(t,1)}else this.selectedElementIds.push(r);this.selectedElementId=this.selectedElementIds.length>0?this.selectedElementIds[this.selectedElementIds.length-1]:null}else this.selectedElementId=r,this.selectedElementIds=r?[r]:[];if(r){const t=this.pages.findIndex(s=>s.elements.some(n=>n.id===r));t!==-1&&(this.currentPageIndex=t)}},clearSelection(){this.selectedElementId=null,this.selectedElementIds=[],this.tableSelection=null},setSelection(r){if(this.tableSelection=null,r.length>0&&(this.selectedGuideId=null),this.selectedElementIds=r,this.selectedElementId=r.length>0?r[r.length-1]:null,r.length>0){const e=this.pages.findIndex(t=>t.elements.some(s=>s.id===this.selectedElementId));e!==-1&&(this.currentPageIndex=e)}},removeSelectedElements(){if(this.selectedElementIds.length===0)return;const r=this.selectedElementIds.filter(e=>{for(const t of this.pages){const s=t.elements.find(n=>n.id===e);if(s&&!s.locked)return!0}return!1});if(r.length!==0){this.snapshot();for(const e of r)for(const t of this.pages){const s=t.elements.findIndex(n=>n.id===e);if(s!==-1){t.elements.splice(s,1);break}}this.selectedElementId=null,this.selectedElementIds=[],this.tableSelection=null}},alignSelectedElements(r){if(this.selectedElementIds.length===0)return;const e=[];for(const t of this.selectedElementIds)for(const s of this.pages){const n=s.elements.find(l=>l.id===t);if(n&&!n.locked){e.push(n);break}}if(e.length!==0)if(this.snapshot(),e.length===1){const t=e[0],s=this.canvasSize.width,n=this.canvasSize.height;switch(r){case"left":t.x=0;break;case"center":t.x=(s-t.width)/2;break;case"right":t.x=s-t.width;break;case"top":t.y=0;break;case"middle":t.y=(n-t.height)/2;break;case"bottom":t.y=n-t.height;break}}else{const t=Math.min(...e.map(u=>u.x)),s=Math.max(...e.map(u=>u.x+u.width)),n=Math.min(...e.map(u=>u.y)),l=Math.max(...e.map(u=>u.y+u.height)),i=(t+s)/2,d=(n+l)/2;e.forEach(u=>{switch(r){case"left":u.x=t;break;case"center":u.x=i-u.width/2;break;case"right":u.x=s-u.width;break;case"top":u.y=n;break;case"middle":u.y=d-u.height/2;break;case"bottom":u.y=l-u.height;break}})}},resizeSelectedElements(r,e){if(this.selectedElementIds.length===0)return;const t=this.selectedElementIds.filter(s=>{for(const n of this.pages){const l=n.elements.find(i=>i.id===s);if(l&&!l.locked)return!0}return!1});if(t.length!==0){this.snapshot();for(const s of t)for(const n of this.pages){const l=n.elements.findIndex(i=>i.id===s);if(l!==-1){const i=n.elements[l],d=Math.max(10,i.width+r),u=Math.max(10,i.height+e);n.elements[l]={...i,width:d,height:u};break}}}},updateSelectedElementsStyle(r){if(this.selectedElementIds.length===0)return;this.selectedElementIds.some(t=>{for(const s of this.pages){const n=s.elements.find(l=>l.id===t);if(n&&n.locked)return!0}return!1});const e=this.selectedElementIds.filter(t=>{for(const s of this.pages){const n=s.elements.find(l=>l.id===t);if(n&&!n.locked)return!0}return!1});if(e.length!==0){this.snapshot();for(const t of e)for(const s of this.pages){const n=s.elements.findIndex(l=>l.id===t);if(n!==-1){const l=s.elements[n];s.elements[n]={...l,style:{...l.style,...r}};break}}}},toggleLock(){if(this.selectedElementIds.length===0)return;this.snapshot();let r=!0;const e=this.selectedElement;e&&(r=!e.locked);for(const t of this.selectedElementIds)for(const s of this.pages){const n=s.elements.findIndex(l=>l.id===t);if(n!==-1){s.elements[n].locked=r;break}}},setZoom(r){this.zoom=r},setCanvasSize(r,e){this.snapshot(),this.canvasSize={width:r,height:e}},setShowGrid(r){this.showGrid=r},deletePage(r){this.pages.length>1&&(this.snapshot(),this.pages.splice(r,1),this.currentPageIndex>=this.pages.length&&(this.currentPageIndex=this.pages.length-1))},copy(){if(this.selectedElementIds.length===0)return;const r=[];for(const e of this.selectedElementIds)for(const t of this.pages){const s=t.elements.find(n=>n.id===e);if(s&&!s.locked){r.push(Ee(s));break}}this.clipboard=r},cut(){this.selectedElementIds.length!==0&&(this.copy(),this.removeSelectedElements())},paste(r){if(this.clipboard.length===0)return;this.snapshot();const e=[],t=(r==null?void 0:r.pageIndex)??this.currentPageIndex;let s=1/0,n=1/0;if(r)for(const l of this.clipboard)s=Math.min(s,l.x),n=Math.min(n,l.y);for(const l of this.clipboard){const i=Ee(l);if(i.id=Ne(),r){const d=l.x-s,u=l.y-n;i.x=r.x+d,i.y=r.y+u}else i.x+=20,i.y+=20;i.x+i.width>this.canvasSize.width&&(i.x=Math.max(0,this.canvasSize.width-i.width)),i.y+i.height>this.canvasSize.height&&(i.y=Math.max(0,this.canvasSize.height-i.height)),i.x=Math.max(0,i.x),i.y=Math.max(0,i.y),this.pages[t]?this.pages[t].elements.push(i):this.pages[this.currentPageIndex].elements.push(i),e.push(i.id)}t!==this.currentPageIndex&&this.pages[t]&&(this.currentPageIndex=t),this.setSelection(e)},paginateTable(r){this.snapshot();let e=-1,t;for(let v=0;v<this.pages.length;v++){const k=this.pages[v].elements.findIndex(b=>b.id===r);if(k!==-1){e=v,t=this.pages[v].elements[k];break}}if(!t||t.type!==ye.TABLE||!t.data)return;const s=this.canvasSize.height,n=50,l=t.style.headerHeight||40,i=t.style.rowHeight||30,d=t.y,g=s-d-n-l,y=Math.floor(Math.max(0,g)/i);if(y>=t.data.length)return;const m=t.data.slice(0,y),x=t.data.slice(y);this.updateElement(t.id,{data:m,height:l+m.length*i});const p=e+1;p>=this.pages.length&&this.addPage();const _={...Ee(t),id:Ne(),y:50,data:x,height:l+x.length*i};this.pages[p].elements.push(_),this.paginateTable(_.id)},groupSelectedElements(){this.selectedElementIds.length<2||(console.log("Group selected elements:",this.selectedElementIds),alert("Grouping feature is under development"))},async loadCustomElements(){var n;const{mode:r,endpoints:e,headers:t,fetcher:s}=Je();if(r==="remote")try{const l=Qe(((n=e.customElements)==null?void 0:n.list)||""),d=await(await(s||fetch)(l,{headers:t})).json(),u=Array.isArray(d)?d:(d==null?void 0:d.customElements)||[];this.customElements=u.filter(g=>g&&typeof g.id=="string"&&typeof g.name=="string"&&g.element).map(g=>({id:g.id,name:g.name,element:Ee(g.element)}))}catch(l){console.error("Failed to load custom elements",l)}},async addCustomElement(r,e){var d;const{mode:t,endpoints:s,headers:n,fetcher:l}=Je(),i={id:Ne(),name:r,element:Ee(e)};if(t==="remote")try{const u=Qe(((d=s.customElements)==null?void 0:d.upsert)||""),y=await(await(l||fetch)(u,{method:"POST",headers:n,body:JSON.stringify(i)})).json();i.id=(y==null?void 0:y.id)||i.id}catch(u){console.error("Failed to add custom element",u)}this.customElements.push(i),t!=="remote"&&this.saveCustomElements()},async removeCustomElement(r){var i;const{mode:e,endpoints:t,headers:s,fetcher:n}=Je(),l=this.customElements.findIndex(d=>d.id===r);if(l!==-1){if(this.customElements.splice(l,1),e==="remote"){try{const d=Qe(((i=t.customElements)==null?void 0:i.delete)||"",r);await(n||fetch)(d,{method:"DELETE",headers:s})}catch(d){console.error("Failed to remove custom element",d)}return}this.saveCustomElements()}},async renameCustomElement(r,e){var d;const{mode:t,endpoints:s,headers:n,fetcher:l}=Je(),i=this.customElements.find(u=>u.id===r);if(i){if(i.name=e,t==="remote"){try{const u=Qe(((d=s.customElements)==null?void 0:d.upsert)||"");await(l||fetch)(u,{method:"POST",headers:n,body:JSON.stringify(i)})}catch(u){console.error("Failed to rename custom element",u)}return}this.saveCustomElements()}},saveCustomElements(){localStorage.setItem("print-designer-custom-elements",JSON.stringify(this.customElements))}},getters:{selectedElement:r=>{if(!r.selectedElementId)return null;for(const e of r.pages){const t=e.elements.find(s=>s.id===r.selectedElementId);if(t)return t}return null},currentPage:r=>r.pages[r.currentPageIndex],editingCustomElement:r=>r.editingCustomElementId&&r.customElements.find(e=>e.id===r.editingCustomElementId)||null}}),Yt=ll("templates",{state:()=>({templates:[],currentTemplateId:null,isSaving:!1}),actions:{async loadTemplates(){var l;const{mode:r,endpoints:e,headers:t,fetcher:s}=Je();if(r==="remote")try{const i=Qe(((l=e.templates)==null?void 0:l.list)||""),u=await(await(s||fetch)(i,{headers:t})).json(),g=Array.isArray(u)?u:(u==null?void 0:u.templates)||[];this.templates=g.filter(y=>y&&typeof y.id=="string"&&typeof y.name=="string").map(y=>({id:y.id,name:y.name,data:y.data||{},updatedAt:y.updatedAt||Date.now()})).sort((y,m)=>m.updatedAt-y.updatedAt);return}catch(i){console.error("Failed to load templates",i)}const n=localStorage.getItem("print-designer-templates");if(n)try{this.templates=JSON.parse(n),this.templates.sort((i,d)=>d.updatedAt-i.updatedAt)}catch(i){console.error("Failed to parse templates",i),this.templates=[]}},saveToLocalStorage(){localStorage.setItem("print-designer-templates",JSON.stringify(this.templates))},async saveCurrentTemplate(r){var u;const{mode:e,endpoints:t,headers:s,fetcher:n}=Je(),l=De(),i=this.currentTemplateId,d={pages:Ee(l.pages),canvasSize:Ee(l.canvasSize),guides:Ee(l.guides),zoom:l.zoom,showGrid:l.showGrid,headerHeight:l.headerHeight,footerHeight:l.footerHeight,showHeaderLine:l.showHeaderLine,showFooterLine:l.showFooterLine,showMinimap:l.showMinimap,canvasBackground:l.canvasBackground,pageSpacingX:l.pageSpacingX,pageSpacingY:l.pageSpacingY,unit:l.unit,watermark:Ee(l.watermark),testData:Ee(l.testData||{})};this.isSaving=!0;try{if(e==="remote"){const g={id:i||Ne(),name:r,data:d,updatedAt:Date.now()},y=Qe(((u=t.templates)==null?void 0:u.upsert)||""),x=await(await(n||fetch)(y,{method:"POST",headers:s,body:JSON.stringify(g)})).json(),p=(x==null?void 0:x.id)||g.id,_=this.templates.findIndex(k=>k.id===p),v={...g,id:p};_>=0?this.templates[_]=v:this.templates.unshift(v),this.currentTemplateId=p;return}if(i){const g=this.templates.findIndex(y=>y.id===i);g!==-1?(this.templates[g].data=d,this.templates[g].name=r,this.templates[g].updatedAt=Date.now()):this.createTemplate(r,d)}else this.createTemplate(r,d);this.saveToLocalStorage()}finally{this.isSaving=!1}},async createTemplate(r,e){var g;const{mode:t,endpoints:s,headers:n,fetcher:l}=Je(),i=De(),d=e||{pages:i.pages,canvasSize:i.canvasSize,pageSpacingX:i.pageSpacingX,pageSpacingY:i.pageSpacingY,unit:i.unit,watermark:i.watermark,testData:Ee(i.testData||{})},u={id:Ne(),name:r,data:d,updatedAt:Date.now()};if(t==="remote")try{const y=Qe(((g=s.templates)==null?void 0:g.upsert)||""),x=await(await(l||fetch)(y,{method:"POST",headers:n,body:JSON.stringify(u)})).json(),p=(x==null?void 0:x.id)||u.id;u.id=p}catch(y){console.error("Failed to create template",y)}this.templates.unshift(u),this.currentTemplateId=u.id,t!=="remote"&&this.saveToLocalStorage()},async deleteTemplate(r){var l;const{mode:e,endpoints:t,headers:s,fetcher:n}=Je();if(this.templates=this.templates.filter(i=>i.id!==r),this.currentTemplateId===r&&(this.currentTemplateId=null),e==="remote"){try{const i=Qe(((l=t.templates)==null?void 0:l.delete)||"",r);await(n||fetch)(i,{method:"DELETE",headers:s})}catch(i){console.error("Failed to delete template",i)}return}this.saveToLocalStorage()},async renameTemplate(r,e){var d;const{mode:t,endpoints:s,headers:n,fetcher:l}=Je(),i=this.templates.find(u=>u.id===r);if(i){if(i.name=e,i.updatedAt=Date.now(),t==="remote"){try{const u=Qe(((d=s.templates)==null?void 0:d.upsert)||"");await(l||fetch)(u,{method:"POST",headers:n,body:JSON.stringify(i)})}catch(u){console.error("Failed to rename template",u)}return}this.saveToLocalStorage()}},async copyTemplate(r){var i;const{mode:e,endpoints:t,headers:s,fetcher:n}=Je(),l=this.templates.find(d=>d.id===r);if(l){const d={id:Ne(),name:`${l.name} Copy`,data:JSON.parse(JSON.stringify(l.data)),updatedAt:Date.now()};if(e==="remote")try{const u=Qe(((i=t.templates)==null?void 0:i.upsert)||""),y=await(await(n||fetch)(u,{method:"POST",headers:s,body:JSON.stringify(d)})).json();d.id=(y==null?void 0:y.id)||d.id}catch(u){console.error("Failed to copy template",u)}this.templates.unshift(d),e!=="remote"&&this.saveToLocalStorage()}},async loadTemplate(r){var i;const{mode:e,endpoints:t,headers:s,fetcher:n}=Je();if(e==="remote")try{const d=Qe(((i=t.templates)==null?void 0:i.get)||"",r),g=await(await(n||fetch)(d,{headers:s})).json(),y=(g==null?void 0:g.template)||g;if(!y)return;const m=De();m.resetCanvas();const x=y.data||{};x.pages&&(m.pages=x.pages),x.canvasSize&&(m.canvasSize=x.canvasSize),x.guides&&(m.guides=x.guides),x.zoom!==void 0&&(m.zoom=x.zoom),x.showGrid!==void 0&&(m.showGrid=x.showGrid),x.headerHeight!==void 0&&(m.headerHeight=x.headerHeight),x.footerHeight!==void 0&&(m.footerHeight=x.footerHeight),x.showHeaderLine!==void 0&&(m.showHeaderLine=x.showHeaderLine),x.showFooterLine!==void 0&&(m.showFooterLine=x.showFooterLine),x.showMinimap!==void 0&&(m.showMinimap=x.showMinimap),x.canvasBackground!==void 0&&(m.canvasBackground=x.canvasBackground),x.pageSpacingX!==void 0&&(m.pageSpacingX=x.pageSpacingX),x.pageSpacingY!==void 0&&(m.pageSpacingY=x.pageSpacingY),x.unit!==void 0&&(m.unit=x.unit),x.watermark!==void 0&&(m.watermark=x.watermark),m.testData=x.testData||{},m.selectedElementId=null,m.selectedGuideId=null,m.historyPast=[],m.historyFuture=[],this.currentTemplateId=y.id||r;return}catch(d){console.error("Failed to load template",d);return}const l=this.templates.find(d=>d.id===r);if(l){const d=De();d.resetCanvas();const u=l.data;u.pages&&(d.pages=u.pages),u.canvasSize&&(d.canvasSize=u.canvasSize),u.guides&&(d.guides=u.guides),u.zoom!==void 0&&(d.zoom=u.zoom),u.showGrid!==void 0&&(d.showGrid=u.showGrid),u.headerHeight!==void 0&&(d.headerHeight=u.headerHeight),u.footerHeight!==void 0&&(d.footerHeight=u.footerHeight),u.showHeaderLine!==void 0&&(d.showHeaderLine=u.showHeaderLine),u.showFooterLine!==void 0&&(d.showFooterLine=u.showFooterLine),u.showMinimap!==void 0&&(d.showMinimap=u.showMinimap),u.canvasBackground!==void 0&&(d.canvasBackground=u.canvasBackground),u.pageSpacingX!==void 0&&(d.pageSpacingX=u.pageSpacingX),u.pageSpacingY!==void 0&&(d.pageSpacingY=u.pageSpacingY),u.unit!==void 0&&(d.unit=u.unit),u.watermark!==void 0&&(d.watermark=u.watermark),d.testData=u.testData||{},d.selectedElementId=null,d.selectedGuideId=null,d.historyPast=[],d.historyFuture=[],this.currentTemplateId=r}}}}),El=ce(localStorage.getItem("print-designer-autosave")!=="false");Ae(El,r=>{localStorage.setItem("print-designer-autosave",String(r))});function Tl(){return{autoSave:El}}const Nt=ce(localStorage.getItem("print-designer-theme")||"system"),$l=ce(window.matchMedia("(prefers-color-scheme: dark)").matches),Xn=window.matchMedia("(prefers-color-scheme: dark)");var al;(al=Xn.addEventListener)==null||al.call(Xn,"change",r=>{$l.value=r.matches});const Il=ve(()=>Nt.value==="dark"?!0:Nt.value==="light"?!1:$l.value),$d=r=>{Nt.value=r,localStorage.setItem("print-designer-theme",r)};Ae(Il,r=>{document.documentElement.classList.toggle("dark",r)},{immediate:!0});function xo(){return{theme:Nt,isDark:Il,setTheme:$d}}var Zn,Aa;function Id(){if(Aa)return Zn;Aa=1;var r=tt(),e=function(){return r.Date.now()};return Zn=e,Zn}var Jn,za;function Ad(){if(za)return Jn;za=1;var r=/\s/;function e(t){for(var s=t.length;s--&&r.test(t.charAt(s)););return s}return Jn=e,Jn}var Qn,Pa;function zd(){if(Pa)return Qn;Pa=1;var r=Ad(),e=/^\s+/;function t(s){return s&&s.slice(0,r(s)+1).replace(e,"")}return Qn=t,Qn}var eo,La;function Pd(){if(La)return eo;La=1;var r=Mt(),e=yt(),t="[object Symbol]";function s(n){return typeof n=="symbol"||e(n)&&r(n)==t}return eo=s,eo}var to,Ma;function Ld(){if(Ma)return to;Ma=1;var r=zd(),e=ct(),t=Pd(),s=NaN,n=/^[-+]0x[0-9a-f]+$/i,l=/^0b[01]+$/i,i=/^0o[0-7]+$/i,d=parseInt;function u(g){if(typeof g=="number")return g;if(t(g))return s;if(e(g)){var y=typeof g.valueOf=="function"?g.valueOf():g;g=e(y)?y+"":y}if(typeof g!="string")return g===0?g:+g;g=r(g);var m=l.test(g);return m||i.test(g)?d(g.slice(2),m?2:8):n.test(g)?s:+g}return to=u,to}var ro,Ra;function Md(){if(Ra)return ro;Ra=1;var r=ct(),e=Id(),t=Ld(),s="Expected a function",n=Math.max,l=Math.min;function i(d,u,g){var y,m,x,p,_,v,k=0,b=!1,f=!1,C=!0;if(typeof d!="function")throw new TypeError(s);u=t(u)||0,r(g)&&(b=!!g.leading,f="maxWait"in g,x=f?n(t(g.maxWait)||0,u):x,C="trailing"in g?!!g.trailing:C);function M(B){var c=y,w=m;return y=m=void 0,k=B,p=d.apply(w,c),p}function F(B){return k=B,_=setTimeout(H,u),b?M(B):p}function R(B){var c=B-v,w=B-k,G=u-c;return f?l(G,x-w):G}function z(B){var c=B-v,w=B-k;return v===void 0||c>=u||c<0||f&&w>=x}function H(){var B=e();if(z(B))return Y(B);_=setTimeout(H,R(B))}function Y(B){return _=void 0,C&&y?M(B):(y=m=void 0,p)}function se(){_!==void 0&&clearTimeout(_),k=0,y=v=m=_=void 0}function W(){return _===void 0?p:Y(e())}function E(){var B=e(),c=z(B);if(y=arguments,m=this,v=B,c){if(_===void 0)return F(v);if(f)return clearTimeout(_),_=setTimeout(H,u),M(v)}return _===void 0&&(_=setTimeout(H,u)),p}return E.cancel=se,E.flush=W,E}return ro=i,ro}var Rd=Md();const Dd=bt(Rd),Al=96/25.4,Bd=25.4/96,zl=96/72,Od=72/96;function ao(r){return Number((r*Bd).toFixed(1))}function qd(r){return Math.round(r*Al)}function Fd(r){return Number((r*Od).toFixed(1))}function jd(r){return Math.round(r*zl)}function nt(r,e){return e==="mm"?ao(r):e==="pt"?Fd(r):Math.round(r)}function Ye(r,e){return e==="mm"?qd(r):e==="pt"?jd(r):Math.round(r)}function Lt(r,e,t){r=r%360,r<0&&(r+=360),e=Math.max(0,Math.min(1,e)),t=Math.max(0,Math.min(1,t));const s=t*e,n=s*(1-Math.abs(r/60%2-1)),l=t-s;let i=0,d=0,u=0;return r>=0&&r<60?(i=s,d=n,u=0):r>=60&&r<120?(i=n,d=s,u=0):r>=120&&r<180?(i=0,d=s,u=n):r>=180&&r<240?(i=0,d=n,u=s):r>=240&&r<300?(i=n,d=0,u=s):(i=s,d=0,u=n),{r:Math.round((i+l)*255),g:Math.round((d+l)*255),b:Math.round((u+l)*255)}}function Da(r,e,t){r/=255,e/=255,t/=255;const s=Math.max(r,e,t),n=Math.min(r,e,t),l=s-n;let i=0;const d=s===0?0:l/s,u=s;if(s!==n){switch(s){case r:i=(e-t)/l+(e<t?6:0);break;case e:i=(t-r)/l+2;break;case t:i=(r-e)/l+4;break}i/=6}return{h:i*360,s:d,v:u}}function zt(r){if(!r)return null;if(r==="transparent")return{h:0,s:0,v:0,a:0};if(r.startsWith("#")){const e=r.slice(1);let t=0,s=0,n=0,l=1;if(e.length===3)t=parseInt(e[0]+e[0],16),s=parseInt(e[1]+e[1],16),n=parseInt(e[2]+e[2],16);else if(e.length===6)t=parseInt(e.substring(0,2),16),s=parseInt(e.substring(2,4),16),n=parseInt(e.substring(4,6),16);else if(e.length===8)t=parseInt(e.substring(0,2),16),s=parseInt(e.substring(2,4),16),n=parseInt(e.substring(4,6),16),l=parseInt(e.substring(6,8),16)/255;else return null;return{...Da(t,s,n),a:l}}if(r.startsWith("rgb")){const e=r.match(/rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*([\d.]+))?\)/);if(e){const t=parseInt(e[1]),s=parseInt(e[2]),n=parseInt(e[3]),l=e[4]!==void 0?parseFloat(e[4]):1;return{...Da(t,s,n),a:l}}}return null}function Ba(r,e,t,s=1){const{r:n,g:l,b:i}=Lt(r,e,t),d=u=>{const g=Math.round(u).toString(16);return g.length===1?"0"+g:g};if(s>=1)return`#${d(n)}${d(l)}${d(i)}`;{const u=Math.round(s*255);return`#${d(n)}${d(l)}${d(i)}${d(u)}`}}function Nd(r,e,t,s=1){const{r:n,g:l,b:i}=Lt(r,e,t);return`rgba(${n}, ${l}, ${i}, ${parseFloat(s.toFixed(2))})`}const Hd={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function Ud(r,e){return P(),q("svg",Hd,[...e[0]||(e[0]=[o("path",{fill:"currentColor",d:"M18 7H6V3h12zm0 5.5q.425 0 .713-.288T19 11.5t-.288-.712T18 10.5t-.712.288T17 11.5t.288.713t.712.287M16 19v-4H8v4zm2 2H6v-4H2v-6q0-1.275.875-2.137T5 8h14q1.275 0 2.138.863T22 11v6h-4z"},null,-1)])])}const _o=Se({name:"material-symbols-print",render:Ud}),Vd={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function Wd(r,e){return P(),q("svg",Vd,[...e[0]||(e[0]=[o("path",{fill:"currentColor",d:"M5 21q-.825 0-1.412-.587T3 19V5q0-.825.588-1.412T5 3h14q.825 0 1.413.588T21 5v14q0 .825-.587 1.413T19 21zm0-2h14V7H5zm7-2q-2.05 0-3.662-1.112T6 13q.725-1.775 2.338-2.887T12 9t3.663 1.113T18 13q-.725 1.775-2.337 2.888T12 17m0-2.5q-.625 0-1.062-.437T10.5 13t.438-1.062T12 11.5t1.063.438T13.5 13t-.437 1.063T12 14.5m0 1q1.05 0 1.775-.725T14.5 13t-.725-1.775T12 10.5t-1.775.725T9.5 13t.725 1.775T12 15.5"},null,-1)])])}const Gd=Se({name:"material-symbols-preview",render:Wd}),Kd={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function Yd(r,e){return P(),q("svg",Kd,[...e[0]||(e[0]=[o("path",{fill:"currentColor",d:"m12 16l-5-5l1.4-1.45l2.6 2.6V4h2v8.15l2.6-2.6L17 11zm-6 4q-.825 0-1.412-.587T4 18v-3h2v3h12v-3h2v3q0 .825-.587 1.413T18 20z"},null,-1)])])}const Ht=Se({name:"material-symbols-file-download",render:Yd}),Xd={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function Zd(r,e){return P(),q("svg",Xd,[...e[0]||(e[0]=[o("path",{fill:"currentColor",d:"M9 12.5h1v-2h1q.425 0 .713-.288T12 9.5v-1q0-.425-.288-.712T11 7.5H9zm1-3v-1h1v1zm3 3h2q.425 0 .713-.288T16 11.5v-3q0-.425-.288-.712T15 7.5h-2zm1-1v-3h1v3zm3 1h1v-2h1v-1h-1v-1h1v-1h-2zM8 18q-.825 0-1.412-.587T6 16V4q0-.825.588-1.412T8 2h12q.825 0 1.413.588T22 4v12q0 .825-.587 1.413T20 18zm-4 4q-.825 0-1.412-.587T2 20V6h2v14h14v2z"},null,-1)])])}Se({name:"material-symbols-picture-as-pdf",render:Zd});const Jd={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function Qd(r,e){return P(),q("svg",Jd,[...e[0]||(e[0]=[o("path",{fill:"currentColor",d:"M5 21q-.825 0-1.412-.587T3 19V5q0-.825.588-1.412T5 3h14q.825 0 1.413.588T21 5v14q0 .825-.587 1.413T19 21zm1-4h12l-3.75-5l-3 4L9 13z"},null,-1)])])}const Oa=Se({name:"material-symbols-image",render:Qd}),eu={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function tu(r,e){return P(),q("svg",eu,[...e[0]||(e[0]=[o("path",{fill:"currentColor",d:"m19.6 21l-6.3-6.3q-.75.6-1.725.95T9.5 16q-2.725 0-4.612-1.888T3 9.5t1.888-4.612T9.5 3t4.613 1.888T16 9.5q0 1.1-.35 2.075T14.7 13.3l6.3 6.3zM9.5 14q1.875 0 3.188-1.312T14 9.5t-1.312-3.187T9.5 5T6.313 6.313T5 9.5t1.313 3.188T9.5 14m-1-1.5v-2h-2v-2h2v-2h2v2h2v2h-2v2z"},null,-1)])])}const Pl=Se({name:"material-symbols-zoom-in",render:tu}),ru={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function nu(r,e){return P(),q("svg",ru,[...e[0]||(e[0]=[o("path",{fill:"currentColor",d:"m19.6 21l-6.3-6.3q-.75.6-1.725.95T9.5 16q-2.725 0-4.612-1.888T3 9.5t1.888-4.612T9.5 3t4.613 1.888T16 9.5q0 1.1-.35 2.075T14.7 13.3l6.3 6.3zM9.5 14q1.875 0 3.188-1.312T14 9.5t-1.312-3.187T9.5 5T6.313 6.313T5 9.5t1.313 3.188T9.5 14M7 10.5v-2h5v2z"},null,-1)])])}const Ll=Se({name:"material-symbols-zoom-out",render:nu}),ou={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function su(r,e){return P(),q("svg",ou,[...e[0]||(e[0]=[o("path",{fill:"currentColor",d:"m9.25 22l-.4-3.2q-.325-.125-.612-.3t-.563-.375L4.7 19.375l-2.75-4.75l2.575-1.95Q4.5 12.5 4.5 12.338v-.675q0-.163.025-.338L1.95 9.375l2.75-4.75l2.975 1.25q.275-.2.575-.375t.6-.3l.4-3.2h5.5l.4 3.2q.325.125.613.3t.562.375l2.975-1.25l2.75 4.75l-2.575 1.95q.025.175.025.338v.674q0 .163-.05.338l2.575 1.95l-2.75 4.75l-2.95-1.25q-.275.2-.575.375t-.6.3l-.4 3.2zm2.8-6.5q1.45 0 2.475-1.025T15.55 12t-1.025-2.475T12.05 8.5q-1.475 0-2.488 1.025T8.55 12t1.013 2.475T12.05 15.5"},null,-1)])])}const ko=Se({name:"material-symbols-settings",render:su}),au={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function lu(r,e){return P(),q("svg",au,[...e[0]||(e[0]=[o("path",{fill:"currentColor",d:"M21 7v12q0 .825-.587 1.413T19 21H5q-.825 0-1.412-.587T3 19V5q0-.825.588-1.412T5 3h12zm-9 11q1.25 0 2.125-.875T15 15t-.875-2.125T12 12t-2.125.875T9 15t.875 2.125T12 18m-6-8h9V6H6z"},null,-1)])])}const So=Se({name:"material-symbols-save",render:lu}),iu={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function du(r,e){return P(),q("svg",iu,[...e[0]||(e[0]=[o("path",{fill:"currentColor",d:"M13 23v-3.075l5.525-5.5q.225-.225.5-.325t.55-.1q.3 0 .575.113t.5.337l.925.925q.2.225.313.5t.112.55t-.1.563t-.325.512l-5.5 5.5zM6 10h9V6H6zm13.575 7.4l.925-.975l-.925-.925l-.95.95zM11 21H5q-.825 0-1.412-.587T3 19V5q0-.825.588-1.412T5 3h12l4 4v5.3q-.475-.2-.987-.262T19 12.05t-.975.313t-.875.612L15 15.125V15q0-1.25-.875-2.125T12 12t-2.125.875T9 15t.875 2.125T12 18h.1L11 19.1z"},null,-1)])])}const Ml=Se({name:"material-symbols-save-as",render:du}),uu={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function cu(r,e){return P(),q("svg",uu,[...e[0]||(e[0]=[o("path",{fill:"currentColor",d:"M12 22q-2.05 0-3.875-.788t-3.187-2.15t-2.15-3.187T2 12q0-2.075.788-3.887t2.15-3.175t3.187-2.15T12 2q.425 0 .713.288T13 3t-.288.713T12 4Q8.675 4 6.337 6.338T4 12t2.338 5.663T12 20t5.663-2.337T20 12q0-.425.288-.712T21 11t.713.288T22 12q0 2.05-.788 3.875t-2.15 3.188t-3.175 2.15T12 22"},null,-1)])])}const hu=Se({name:"material-symbols-progress-activity",render:cu}),pu={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function fu(r,e){return P(),q("svg",pu,[...e[0]||(e[0]=[o("path",{fill:"currentColor",d:"M7 19v-2h7.1q1.575 0 2.738-1T18 13.5T16.838 11T14.1 10H7.8l2.6 2.6L9 14L4 9l5-5l1.4 1.4L7.8 8h6.3q2.425 0 4.163 1.575T20 13.5t-1.737 3.925T14.1 19z"},null,-1)])])}const Rl=Se({name:"material-symbols-undo",render:fu}),mu={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function gu(r,e){return P(),q("svg",mu,[...e[0]||(e[0]=[o("path",{fill:"currentColor",d:"M9.9 19q-2.425 0-4.163-1.575T4 13.5t1.738-3.925T9.9 8h6.3l-2.6-2.6L15 4l5 5l-5 5l-1.4-1.4l2.6-2.6H9.9q-1.575 0-2.738 1T6 13.5T7.163 16T9.9 17H17v2z"},null,-1)])])}const Dl=Se({name:"material-symbols-redo",render:gu}),vu={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function bu(r,e){return P(),q("svg",vu,[...e[0]||(e[0]=[o("path",{fill:"currentColor",d:"M7 21q-.825 0-1.412-.587T5 19V6H4V4h5V3h6v1h5v2h-1v13q0 .825-.587 1.413T17 21zm2-4h2V8H9zm4 0h2V8h-2z"},null,-1)])])}const wt=Se({name:"material-symbols-delete",render:bu}),yu={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function wu(r,e){return P(),q("svg",yu,[...e[0]||(e[0]=[o("path",{fill:"currentColor",d:"M11.95 18q.525 0 .888-.363t.362-.887t-.362-.888t-.888-.362t-.887.363t-.363.887t.363.888t.887.362m-.9-3.85h1.85q0-.825.188-1.3t1.062-1.3q.65-.65 1.025-1.238T15.55 8.9q0-1.4-1.025-2.15T12.1 6q-1.425 0-2.312.75T8.55 8.55l1.65.65q.125-.45.563-.975T12.1 7.7q.8 0 1.2.438t.4.962q0 .5-.3.938t-.75.812q-1.1.975-1.35 1.475t-.25 1.825M12 22q-2.075 0-3.9-.787t-3.175-2.138T2.788 15.9T2 12t.788-3.9t2.137-3.175T8.1 2.788T12 2t3.9.788t3.175 2.137T21.213 8.1T22 12t-.788 3.9t-2.137 3.175t-3.175 2.138T12 22"},null,-1)])])}const xu=Se({name:"material-symbols-help",render:wu}),_u={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function ku(r,e){return P(),q("svg",_u,[...e[0]||(e[0]=[o("path",{fill:"currentColor",d:"M3 21v-2h18v2zm0-4v-2h12v2zm0-4v-2h18v2zm0-4V7h12v2zm0-4V3h18v2z"},null,-1)])])}const Su=Se({name:"material-symbols-format-align-left",render:ku}),Cu={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function Eu(r,e){return P(),q("svg",Cu,[...e[0]||(e[0]=[o("path",{fill:"currentColor",d:"M3 21v-2h18v2zm4-4v-2h10v2zm-4-4v-2h18v2zm4-4V7h10v2zM3 5V3h18v2z"},null,-1)])])}const Tu=Se({name:"material-symbols-format-align-center",render:Eu}),$u={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function Iu(r,e){return P(),q("svg",$u,[...e[0]||(e[0]=[o("path",{fill:"currentColor",d:"M3 5V3h18v2zm6 4V7h12v2zm-6 4v-2h18v2zm6 4v-2h12v2zm-6 4v-2h18v2z"},null,-1)])])}const Au=Se({name:"material-symbols-format-align-right",render:Iu}),zu={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function Pu(r,e){return P(),q("svg",zu,[...e[0]||(e[0]=[o("path",{fill:"currentColor",d:"M4 5V3h16v2zm7 16V10.8l-2.6 2.6L7 12l5-5l5 5l-1.4 1.4l-2.6-2.6V21z"},null,-1)])])}const Lu=Se({name:"material-symbols-vertical-align-top",render:Pu}),Mu={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function Ru(r,e){return P(),q("svg",Mu,[...e[0]||(e[0]=[o("path",{fill:"currentColor",d:"M11 22v-4.2l-1.6 1.6L8 18l4-4l4 4l-1.4 1.4l-1.6-1.6V22zm-7-9v-2h16v2zm8-3L8 6l1.4-1.4L11 6.2V2h2v4.2l1.6-1.6L16 6z"},null,-1)])])}const Du=Se({name:"material-symbols-vertical-align-center",render:Ru}),Bu={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function Ou(r,e){return P(),q("svg",Bu,[...e[0]||(e[0]=[o("path",{fill:"currentColor",d:"M4 21v-2h16v2zm8-4l-5-5l1.4-1.4l2.6 2.6V3h2v10.2l2.6-2.6L17 12z"},null,-1)])])}const qu=Se({name:"material-symbols-vertical-align-bottom",render:Ou}),Fu={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function ju(r,e){return P(),q("svg",Fu,[...e[0]||(e[0]=[o("path",{fill:"currentColor",d:"M6.8 19V5h5.525q1.625 0 3 1T16.7 8.775q0 1.275-.575 1.963t-1.075.987q.625.275 1.388 1.025T17.2 15q0 2.225-1.625 3.113t-3.05.887zm3.025-2.8h2.6q1.2 0 1.463-.612t.262-.888t-.262-.887t-1.538-.613H9.825zm0-5.7h2.325q.825 0 1.2-.425t.375-.95q0-.6-.425-.975t-1.1-.375H9.825z"},null,-1)])])}const Nu=Se({name:"material-symbols-format-bold",render:ju}),Hu={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function Uu(r,e){return P(),q("svg",Hu,[...e[0]||(e[0]=[o("path",{fill:"currentColor",d:"M5 19v-2.5h4l3-9H8V5h10v2.5h-3.5l-3 9H15V19z"},null,-1)])])}const Vu=Se({name:"material-symbols-format-italic",render:Uu}),Wu={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function Gu(r,e){return P(),q("svg",Wu,[...e[0]||(e[0]=[o("path",{fill:"currentColor",d:"M5 21v-2h14v2zm7-4q-2.525 0-3.925-1.575t-1.4-4.175V3H9.25v8.4q0 1.4.7 2.275t2.05.875t2.05-.875t.7-2.275V3h2.575v8.25q0 2.6-1.4 4.175T12 17"},null,-1)])])}const Ku=Se({name:"material-symbols-format-underlined",render:Gu}),Yu={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function Xu(r,e){return P(),q("svg",Yu,[...e[0]||(e[0]=[o("path",{fill:"currentColor",d:"M10.9 16L15 5h2l4.1 11h-1.9l-1-2.8h-4.4l-1 2.8zm3.45-4.4h3.3l-1.6-4.55h-.1zM6 20l-3.5-3.5l1.4-1.4L5 16.15V3h2v13.15l1.1-1.05l1.4 1.4z"},null,-1)])])}const Zu=Se({name:"material-symbols-text-rotate-vertical",render:Xu}),Ju={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function Qu(r,e){return P(),q("svg",Ju,[...e[0]||(e[0]=[o("path",{fill:"currentColor",d:"M11 22q-1.25-.125-2.4-.612T6.4 20.1l1.4-1.45q.725.525 1.538.85t1.662.45zm2 0v-2.05q2.6-.375 4.3-2.337T19 13.05q0-2.925-2.037-4.962T12 6.05h-.2l1.6 1.6l-1.4 1.4l-4-4l4-4l1.4 1.45l-1.55 1.55H12q1.875 0 3.513.713t2.85 1.925t1.925 2.85T21 13.05q0 3.425-2.275 5.963T13 22m-8.05-3.35q-.8-1.05-1.288-2.2t-.612-2.4H5.1q.125.85.45 1.663t.85 1.537zm-1.9-6.6q.15-1.275.625-2.45T4.95 7.45l1.45 1.4q-.525.725-.85 1.538T5.1 12.05z"},null,-1)])])}const ec=Se({name:"material-symbols-rotate-left",render:Qu}),tc={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function rc(r,e){return P(),q("svg",tc,[...e[0]||(e[0]=[o("path",{fill:"currentColor",d:"M9 18q-.825 0-1.412-.587T7 16V4q0-.825.588-1.412T9 2h9q.825 0 1.413.588T20 4v12q0 .825-.587 1.413T18 18zm-4 4q-.825 0-1.412-.587T3 20V6h2v14h11v2z"},null,-1)])])}const xt=Se({name:"material-symbols-content-copy",render:rc}),nc={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function oc(r,e){return P(),q("svg",nc,[...e[0]||(e[0]=[o("path",{fill:"currentColor",d:"M6.4 18h2.1l1.1-3.05h4.8L15.5 18h2.1L13.05 6h-2.1zm3.8-4.8l1.75-4.95h.1l1.75 4.95zM4 22q-.825 0-1.412-.587T2 20V4q0-.825.588-1.412T4 2h16q.825 0 1.413.588T22 4v16q0 .825-.587 1.413T20 22z"},null,-1)])])}const sc=Se({name:"material-symbols-font-download",render:oc}),ac={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function lc(r,e){return P(),q("svg",ac,[...e[0]||(e[0]=[o("path",{fill:"currentColor",d:"M6.175 1.4L7.6 0l8.575 8.575q.575.575.575 1.425t-.575 1.425l-4.75 4.75q-.575.575-1.425.575t-1.425-.575l-4.75-4.75Q3.25 10.85 3.25 10t.575-1.425L8.575 3.8zM10 5.225L5.225 10h9.55zM19 17q-.825 0-1.412-.587T17 15q0-.525.313-1.125T18 12.75q.225-.3.475-.625T19 11.5q.275.3.525.625t.475.625q.375.525.688 1.125T21 15q0 .825-.587 1.413T19 17M2 24v-4h20v4z"},null,-1)])])}const ic=Se({name:"material-symbols-format-color-fill",render:lc}),dc={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function uc(r,e){return P(),q("svg",dc,[...e[0]||(e[0]=[o("path",{fill:"currentColor",d:"M5 21q-.825 0-1.412-.587T3 19V5q0-.825.588-1.412T5 3h4.175q.275-.875 1.075-1.437T12 1q1 0 1.788.563T14.85 3H19q.825 0 1.413.588T21 5v14q0 .825-.587 1.413T19 21zm0-2h14V5h-2v3H7V5H5zm7-14q.425 0 .713-.288T13 4t-.288-.712T12 3t-.712.288T11 4t.288.713T12 5"},null,-1)])])}const Co=Se({name:"material-symbols-content-paste",render:uc}),cc={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function hc(r,e){return P(),q("svg",cc,[...e[0]||(e[0]=[o("path",{fill:"currentColor",d:"M8 16q.825 0 1.413-.587T10 14t-.587-1.412T8 12t-1.412.588T6 14t.588 1.413T8 16m8 0q.825 0 1.413-.587T18 14t-.587-1.412T16 12t-1.412.588T14 14t.588 1.413T16 16m-4-6q.825 0 1.413-.587T14 8t-.587-1.412T12 6t-1.412.588T10 8t.588 1.413T12 10m0 12q-2.075 0-3.9-.788t-3.175-2.137T2.788 15.9T2 12t.788-3.9t2.137-3.175T8.1 2.788T12 2t3.9.788t3.175 2.137T21.213 8.1T22 12t-.788 3.9t-2.137 3.175t-3.175 2.138T12 22"},null,-1)])])}const pc=Se({name:"material-symbols-group-work",render:hc}),fc={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function mc(r,e){return P(),q("svg",fc,[...e[0]||(e[0]=[o("path",{fill:"currentColor",d:"M6 22q-.825 0-1.412-.587T4 20V10q0-.825.588-1.412T6 8h1V6q0-2.075 1.463-3.537T12 1t3.538 1.463T17 6v2h1q.825 0 1.413.588T20 10v10q0 .825-.587 1.413T18 22zm6-5q.825 0 1.413-.587T14 15t-.587-1.412T12 13t-1.412.588T10 15t.588 1.413T12 17M9 8h6V6q0-1.25-.875-2.125T12 3t-2.125.875T9 6z"},null,-1)])])}const Xt=Se({name:"material-symbols-lock",render:mc}),gc={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function vc(r,e){return P(),q("svg",gc,[...e[0]||(e[0]=[o("path",{fill:"currentColor",d:"M6 8h9V6q0-1.25-.875-2.125T12 3t-2.125.875T9 6H7q0-2.075 1.463-3.537T12 1t3.538 1.463T17 6v2h1q.825 0 1.413.588T20 10v10q0 .825-.587 1.413T18 22H6q-.825 0-1.412-.587T4 20V10q0-.825.588-1.412T6 8m6 9q.825 0 1.413-.587T14 15t-.587-1.412T12 13t-1.412.588T10 15t.588 1.413T12 17"},null,-1)])])}const Bl=Se({name:"material-symbols-lock-open",render:vc}),bc={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function yc(r,e){return P(),q("svg",bc,[...e[0]||(e[0]=[o("path",{fill:"currentColor",d:"m12 15.375l-6-6l1.4-1.4l4.6 4.6l4.6-4.6l1.4 1.4z"},null,-1)])])}const Eo=Se({name:"material-symbols-expand-more",render:yc});var wc=Xl();const xc=bt(wc);function qt(r){throw new Error('Could not dynamically require "'+r+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var no={exports:{}};/*!

JSZip v3.10.1 - A JavaScript class for generating and reading zip files
<http://stuartk.com/jszip>

(c) 2009-2016 Stuart Knightley <stuart [at] stuartk.com>
Dual licenced under the MIT license or GPLv3. See https://raw.github.com/Stuk/jszip/main/LICENSE.markdown.

JSZip uses the library pako released under the MIT license :
https://github.com/nodeca/pako/blob/main/LICENSE
*/var qa;function _c(){return qa||(qa=1,(function(r,e){(function(t){r.exports=t()})(function(){return(function t(s,n,l){function i(g,y){if(!n[g]){if(!s[g]){var m=typeof qt=="function"&&qt;if(!y&&m)return m(g,!0);if(d)return d(g,!0);var x=new Error("Cannot find module '"+g+"'");throw x.code="MODULE_NOT_FOUND",x}var p=n[g]={exports:{}};s[g][0].call(p.exports,function(_){var v=s[g][1][_];return i(v||_)},p,p.exports,t,s,n,l)}return n[g].exports}for(var d=typeof qt=="function"&&qt,u=0;u<l.length;u++)i(l[u]);return i})({1:[function(t,s,n){var l=t("./utils"),i=t("./support"),d="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";n.encode=function(u){for(var g,y,m,x,p,_,v,k=[],b=0,f=u.length,C=f,M=l.getTypeOf(u)!=="string";b<u.length;)C=f-b,m=M?(g=u[b++],y=b<f?u[b++]:0,b<f?u[b++]:0):(g=u.charCodeAt(b++),y=b<f?u.charCodeAt(b++):0,b<f?u.charCodeAt(b++):0),x=g>>2,p=(3&g)<<4|y>>4,_=1<C?(15&y)<<2|m>>6:64,v=2<C?63&m:64,k.push(d.charAt(x)+d.charAt(p)+d.charAt(_)+d.charAt(v));return k.join("")},n.decode=function(u){var g,y,m,x,p,_,v=0,k=0,b="data:";if(u.substr(0,b.length)===b)throw new Error("Invalid base64 input, it looks like a data url.");var f,C=3*(u=u.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(u.charAt(u.length-1)===d.charAt(64)&&C--,u.charAt(u.length-2)===d.charAt(64)&&C--,C%1!=0)throw new Error("Invalid base64 input, bad content length.");for(f=i.uint8array?new Uint8Array(0|C):new Array(0|C);v<u.length;)g=d.indexOf(u.charAt(v++))<<2|(x=d.indexOf(u.charAt(v++)))>>4,y=(15&x)<<4|(p=d.indexOf(u.charAt(v++)))>>2,m=(3&p)<<6|(_=d.indexOf(u.charAt(v++))),f[k++]=g,p!==64&&(f[k++]=y),_!==64&&(f[k++]=m);return f}},{"./support":30,"./utils":32}],2:[function(t,s,n){var l=t("./external"),i=t("./stream/DataWorker"),d=t("./stream/Crc32Probe"),u=t("./stream/DataLengthProbe");function g(y,m,x,p,_){this.compressedSize=y,this.uncompressedSize=m,this.crc32=x,this.compression=p,this.compressedContent=_}g.prototype={getContentWorker:function(){var y=new i(l.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new u("data_length")),m=this;return y.on("end",function(){if(this.streamInfo.data_length!==m.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),y},getCompressedWorker:function(){return new i(l.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},g.createWorkerFrom=function(y,m,x){return y.pipe(new d).pipe(new u("uncompressedSize")).pipe(m.compressWorker(x)).pipe(new u("compressedSize")).withStreamInfo("compression",m)},s.exports=g},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(t,s,n){var l=t("./stream/GenericWorker");n.STORE={magic:"\0\0",compressWorker:function(){return new l("STORE compression")},uncompressWorker:function(){return new l("STORE decompression")}},n.DEFLATE=t("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(t,s,n){var l=t("./utils"),i=(function(){for(var d,u=[],g=0;g<256;g++){d=g;for(var y=0;y<8;y++)d=1&d?3988292384^d>>>1:d>>>1;u[g]=d}return u})();s.exports=function(d,u){return d!==void 0&&d.length?l.getTypeOf(d)!=="string"?(function(g,y,m,x){var p=i,_=x+m;g^=-1;for(var v=x;v<_;v++)g=g>>>8^p[255&(g^y[v])];return-1^g})(0|u,d,d.length,0):(function(g,y,m,x){var p=i,_=x+m;g^=-1;for(var v=x;v<_;v++)g=g>>>8^p[255&(g^y.charCodeAt(v))];return-1^g})(0|u,d,d.length,0):0}},{"./utils":32}],5:[function(t,s,n){n.base64=!1,n.binary=!1,n.dir=!1,n.createFolders=!0,n.date=null,n.compression=null,n.compressionOptions=null,n.comment=null,n.unixPermissions=null,n.dosPermissions=null},{}],6:[function(t,s,n){var l=null;l=typeof Promise<"u"?Promise:t("lie"),s.exports={Promise:l}},{lie:37}],7:[function(t,s,n){var l=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",i=t("pako"),d=t("./utils"),u=t("./stream/GenericWorker"),g=l?"uint8array":"array";function y(m,x){u.call(this,"FlateWorker/"+m),this._pako=null,this._pakoAction=m,this._pakoOptions=x,this.meta={}}n.magic="\b\0",d.inherits(y,u),y.prototype.processChunk=function(m){this.meta=m.meta,this._pako===null&&this._createPako(),this._pako.push(d.transformTo(g,m.data),!1)},y.prototype.flush=function(){u.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},y.prototype.cleanUp=function(){u.prototype.cleanUp.call(this),this._pako=null},y.prototype._createPako=function(){this._pako=new i[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var m=this;this._pako.onData=function(x){m.push({data:x,meta:m.meta})}},n.compressWorker=function(m){return new y("Deflate",m)},n.uncompressWorker=function(){return new y("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(t,s,n){function l(p,_){var v,k="";for(v=0;v<_;v++)k+=String.fromCharCode(255&p),p>>>=8;return k}function i(p,_,v,k,b,f){var C,M,F=p.file,R=p.compression,z=f!==g.utf8encode,H=d.transformTo("string",f(F.name)),Y=d.transformTo("string",g.utf8encode(F.name)),se=F.comment,W=d.transformTo("string",f(se)),E=d.transformTo("string",g.utf8encode(se)),B=Y.length!==F.name.length,c=E.length!==se.length,w="",G="",ee="",J=F.dir,$=F.date,N={crc32:0,compressedSize:0,uncompressedSize:0};_&&!v||(N.crc32=p.crc32,N.compressedSize=p.compressedSize,N.uncompressedSize=p.uncompressedSize);var L=0;_&&(L|=8),z||!B&&!c||(L|=2048);var O=0,ne=0;J&&(O|=16),b==="UNIX"?(ne=798,O|=(function(D,oe){var de=D;return D||(de=oe?16893:33204),(65535&de)<<16})(F.unixPermissions,J)):(ne=20,O|=(function(D){return 63&(D||0)})(F.dosPermissions)),C=$.getUTCHours(),C<<=6,C|=$.getUTCMinutes(),C<<=5,C|=$.getUTCSeconds()/2,M=$.getUTCFullYear()-1980,M<<=4,M|=$.getUTCMonth()+1,M<<=5,M|=$.getUTCDate(),B&&(G=l(1,1)+l(y(H),4)+Y,w+="up"+l(G.length,2)+G),c&&(ee=l(1,1)+l(y(W),4)+E,w+="uc"+l(ee.length,2)+ee);var T="";return T+=`
\0`,T+=l(L,2),T+=R.magic,T+=l(C,2),T+=l(M,2),T+=l(N.crc32,4),T+=l(N.compressedSize,4),T+=l(N.uncompressedSize,4),T+=l(H.length,2),T+=l(w.length,2),{fileRecord:m.LOCAL_FILE_HEADER+T+H+w,dirRecord:m.CENTRAL_FILE_HEADER+l(ne,2)+T+l(W.length,2)+"\0\0\0\0"+l(O,4)+l(k,4)+H+w+W}}var d=t("../utils"),u=t("../stream/GenericWorker"),g=t("../utf8"),y=t("../crc32"),m=t("../signature");function x(p,_,v,k){u.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=_,this.zipPlatform=v,this.encodeFileName=k,this.streamFiles=p,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}d.inherits(x,u),x.prototype.push=function(p){var _=p.meta.percent||0,v=this.entriesCount,k=this._sources.length;this.accumulate?this.contentBuffer.push(p):(this.bytesWritten+=p.data.length,u.prototype.push.call(this,{data:p.data,meta:{currentFile:this.currentFile,percent:v?(_+100*(v-k-1))/v:100}}))},x.prototype.openedSource=function(p){this.currentSourceOffset=this.bytesWritten,this.currentFile=p.file.name;var _=this.streamFiles&&!p.file.dir;if(_){var v=i(p,_,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:v.fileRecord,meta:{percent:0}})}else this.accumulate=!0},x.prototype.closedSource=function(p){this.accumulate=!1;var _=this.streamFiles&&!p.file.dir,v=i(p,_,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(v.dirRecord),_)this.push({data:(function(k){return m.DATA_DESCRIPTOR+l(k.crc32,4)+l(k.compressedSize,4)+l(k.uncompressedSize,4)})(p),meta:{percent:100}});else for(this.push({data:v.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},x.prototype.flush=function(){for(var p=this.bytesWritten,_=0;_<this.dirRecords.length;_++)this.push({data:this.dirRecords[_],meta:{percent:100}});var v=this.bytesWritten-p,k=(function(b,f,C,M,F){var R=d.transformTo("string",F(M));return m.CENTRAL_DIRECTORY_END+"\0\0\0\0"+l(b,2)+l(b,2)+l(f,4)+l(C,4)+l(R.length,2)+R})(this.dirRecords.length,v,p,this.zipComment,this.encodeFileName);this.push({data:k,meta:{percent:100}})},x.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},x.prototype.registerPrevious=function(p){this._sources.push(p);var _=this;return p.on("data",function(v){_.processChunk(v)}),p.on("end",function(){_.closedSource(_.previous.streamInfo),_._sources.length?_.prepareNextSource():_.end()}),p.on("error",function(v){_.error(v)}),this},x.prototype.resume=function(){return!!u.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},x.prototype.error=function(p){var _=this._sources;if(!u.prototype.error.call(this,p))return!1;for(var v=0;v<_.length;v++)try{_[v].error(p)}catch{}return!0},x.prototype.lock=function(){u.prototype.lock.call(this);for(var p=this._sources,_=0;_<p.length;_++)p[_].lock()},s.exports=x},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(t,s,n){var l=t("../compressions"),i=t("./ZipFileWorker");n.generateWorker=function(d,u,g){var y=new i(u.streamFiles,g,u.platform,u.encodeFileName),m=0;try{d.forEach(function(x,p){m++;var _=(function(f,C){var M=f||C,F=l[M];if(!F)throw new Error(M+" is not a valid compression method !");return F})(p.options.compression,u.compression),v=p.options.compressionOptions||u.compressionOptions||{},k=p.dir,b=p.date;p._compressWorker(_,v).withStreamInfo("file",{name:x,dir:k,date:b,comment:p.comment||"",unixPermissions:p.unixPermissions,dosPermissions:p.dosPermissions}).pipe(y)}),y.entriesCount=m}catch(x){y.error(x)}return y}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(t,s,n){function l(){if(!(this instanceof l))return new l;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var i=new l;for(var d in this)typeof this[d]!="function"&&(i[d]=this[d]);return i}}(l.prototype=t("./object")).loadAsync=t("./load"),l.support=t("./support"),l.defaults=t("./defaults"),l.version="3.10.1",l.loadAsync=function(i,d){return new l().loadAsync(i,d)},l.external=t("./external"),s.exports=l},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(t,s,n){var l=t("./utils"),i=t("./external"),d=t("./utf8"),u=t("./zipEntries"),g=t("./stream/Crc32Probe"),y=t("./nodejsUtils");function m(x){return new i.Promise(function(p,_){var v=x.decompressed.getContentWorker().pipe(new g);v.on("error",function(k){_(k)}).on("end",function(){v.streamInfo.crc32!==x.decompressed.crc32?_(new Error("Corrupted zip : CRC32 mismatch")):p()}).resume()})}s.exports=function(x,p){var _=this;return p=l.extend(p||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:d.utf8decode}),y.isNode&&y.isStream(x)?i.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):l.prepareContent("the loaded zip file",x,!0,p.optimizedBinaryString,p.base64).then(function(v){var k=new u(p);return k.load(v),k}).then(function(v){var k=[i.Promise.resolve(v)],b=v.files;if(p.checkCRC32)for(var f=0;f<b.length;f++)k.push(m(b[f]));return i.Promise.all(k)}).then(function(v){for(var k=v.shift(),b=k.files,f=0;f<b.length;f++){var C=b[f],M=C.fileNameStr,F=l.resolve(C.fileNameStr);_.file(F,C.decompressed,{binary:!0,optimizedBinaryString:!0,date:C.date,dir:C.dir,comment:C.fileCommentStr.length?C.fileCommentStr:null,unixPermissions:C.unixPermissions,dosPermissions:C.dosPermissions,createFolders:p.createFolders}),C.dir||(_.file(F).unsafeOriginalName=M)}return k.zipComment.length&&(_.comment=k.zipComment),_})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(t,s,n){var l=t("../utils"),i=t("../stream/GenericWorker");function d(u,g){i.call(this,"Nodejs stream input adapter for "+u),this._upstreamEnded=!1,this._bindStream(g)}l.inherits(d,i),d.prototype._bindStream=function(u){var g=this;(this._stream=u).pause(),u.on("data",function(y){g.push({data:y,meta:{percent:0}})}).on("error",function(y){g.isPaused?this.generatedError=y:g.error(y)}).on("end",function(){g.isPaused?g._upstreamEnded=!0:g.end()})},d.prototype.pause=function(){return!!i.prototype.pause.call(this)&&(this._stream.pause(),!0)},d.prototype.resume=function(){return!!i.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},s.exports=d},{"../stream/GenericWorker":28,"../utils":32}],13:[function(t,s,n){var l=t("readable-stream").Readable;function i(d,u,g){l.call(this,u),this._helper=d;var y=this;d.on("data",function(m,x){y.push(m)||y._helper.pause(),g&&g(x)}).on("error",function(m){y.emit("error",m)}).on("end",function(){y.push(null)})}t("../utils").inherits(i,l),i.prototype._read=function(){this._helper.resume()},s.exports=i},{"../utils":32,"readable-stream":16}],14:[function(t,s,n){s.exports={isNode:typeof Buffer<"u",newBufferFrom:function(l,i){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(l,i);if(typeof l=="number")throw new Error('The "data" argument must not be a number');return new Buffer(l,i)},allocBuffer:function(l){if(Buffer.alloc)return Buffer.alloc(l);var i=new Buffer(l);return i.fill(0),i},isBuffer:function(l){return Buffer.isBuffer(l)},isStream:function(l){return l&&typeof l.on=="function"&&typeof l.pause=="function"&&typeof l.resume=="function"}}},{}],15:[function(t,s,n){function l(F,R,z){var H,Y=d.getTypeOf(R),se=d.extend(z||{},y);se.date=se.date||new Date,se.compression!==null&&(se.compression=se.compression.toUpperCase()),typeof se.unixPermissions=="string"&&(se.unixPermissions=parseInt(se.unixPermissions,8)),se.unixPermissions&&16384&se.unixPermissions&&(se.dir=!0),se.dosPermissions&&16&se.dosPermissions&&(se.dir=!0),se.dir&&(F=b(F)),se.createFolders&&(H=k(F))&&f.call(this,H,!0);var W=Y==="string"&&se.binary===!1&&se.base64===!1;z&&z.binary!==void 0||(se.binary=!W),(R instanceof m&&R.uncompressedSize===0||se.dir||!R||R.length===0)&&(se.base64=!1,se.binary=!0,R="",se.compression="STORE",Y="string");var E=null;E=R instanceof m||R instanceof u?R:_.isNode&&_.isStream(R)?new v(F,R):d.prepareContent(F,R,se.binary,se.optimizedBinaryString,se.base64);var B=new x(F,E,se);this.files[F]=B}var i=t("./utf8"),d=t("./utils"),u=t("./stream/GenericWorker"),g=t("./stream/StreamHelper"),y=t("./defaults"),m=t("./compressedObject"),x=t("./zipObject"),p=t("./generate"),_=t("./nodejsUtils"),v=t("./nodejs/NodejsStreamInputAdapter"),k=function(F){F.slice(-1)==="/"&&(F=F.substring(0,F.length-1));var R=F.lastIndexOf("/");return 0<R?F.substring(0,R):""},b=function(F){return F.slice(-1)!=="/"&&(F+="/"),F},f=function(F,R){return R=R!==void 0?R:y.createFolders,F=b(F),this.files[F]||l.call(this,F,null,{dir:!0,createFolders:R}),this.files[F]};function C(F){return Object.prototype.toString.call(F)==="[object RegExp]"}var M={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(F){var R,z,H;for(R in this.files)H=this.files[R],(z=R.slice(this.root.length,R.length))&&R.slice(0,this.root.length)===this.root&&F(z,H)},filter:function(F){var R=[];return this.forEach(function(z,H){F(z,H)&&R.push(H)}),R},file:function(F,R,z){if(arguments.length!==1)return F=this.root+F,l.call(this,F,R,z),this;if(C(F)){var H=F;return this.filter(function(se,W){return!W.dir&&H.test(se)})}var Y=this.files[this.root+F];return Y&&!Y.dir?Y:null},folder:function(F){if(!F)return this;if(C(F))return this.filter(function(Y,se){return se.dir&&F.test(Y)});var R=this.root+F,z=f.call(this,R),H=this.clone();return H.root=z.name,H},remove:function(F){F=this.root+F;var R=this.files[F];if(R||(F.slice(-1)!=="/"&&(F+="/"),R=this.files[F]),R&&!R.dir)delete this.files[F];else for(var z=this.filter(function(Y,se){return se.name.slice(0,F.length)===F}),H=0;H<z.length;H++)delete this.files[z[H].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(F){var R,z={};try{if((z=d.extend(F||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:i.utf8encode})).type=z.type.toLowerCase(),z.compression=z.compression.toUpperCase(),z.type==="binarystring"&&(z.type="string"),!z.type)throw new Error("No output type specified.");d.checkSupport(z.type),z.platform!=="darwin"&&z.platform!=="freebsd"&&z.platform!=="linux"&&z.platform!=="sunos"||(z.platform="UNIX"),z.platform==="win32"&&(z.platform="DOS");var H=z.comment||this.comment||"";R=p.generateWorker(this,z,H)}catch(Y){(R=new u("error")).error(Y)}return new g(R,z.type||"string",z.mimeType)},generateAsync:function(F,R){return this.generateInternalStream(F).accumulate(R)},generateNodeStream:function(F,R){return(F=F||{}).type||(F.type="nodebuffer"),this.generateInternalStream(F).toNodejsStream(R)}};s.exports=M},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(t,s,n){s.exports=t("stream")},{stream:void 0}],17:[function(t,s,n){var l=t("./DataReader");function i(d){l.call(this,d);for(var u=0;u<this.data.length;u++)d[u]=255&d[u]}t("../utils").inherits(i,l),i.prototype.byteAt=function(d){return this.data[this.zero+d]},i.prototype.lastIndexOfSignature=function(d){for(var u=d.charCodeAt(0),g=d.charCodeAt(1),y=d.charCodeAt(2),m=d.charCodeAt(3),x=this.length-4;0<=x;--x)if(this.data[x]===u&&this.data[x+1]===g&&this.data[x+2]===y&&this.data[x+3]===m)return x-this.zero;return-1},i.prototype.readAndCheckSignature=function(d){var u=d.charCodeAt(0),g=d.charCodeAt(1),y=d.charCodeAt(2),m=d.charCodeAt(3),x=this.readData(4);return u===x[0]&&g===x[1]&&y===x[2]&&m===x[3]},i.prototype.readData=function(d){if(this.checkOffset(d),d===0)return[];var u=this.data.slice(this.zero+this.index,this.zero+this.index+d);return this.index+=d,u},s.exports=i},{"../utils":32,"./DataReader":18}],18:[function(t,s,n){var l=t("../utils");function i(d){this.data=d,this.length=d.length,this.index=0,this.zero=0}i.prototype={checkOffset:function(d){this.checkIndex(this.index+d)},checkIndex:function(d){if(this.length<this.zero+d||d<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+d+"). Corrupted zip ?")},setIndex:function(d){this.checkIndex(d),this.index=d},skip:function(d){this.setIndex(this.index+d)},byteAt:function(){},readInt:function(d){var u,g=0;for(this.checkOffset(d),u=this.index+d-1;u>=this.index;u--)g=(g<<8)+this.byteAt(u);return this.index+=d,g},readString:function(d){return l.transformTo("string",this.readData(d))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var d=this.readInt(4);return new Date(Date.UTC(1980+(d>>25&127),(d>>21&15)-1,d>>16&31,d>>11&31,d>>5&63,(31&d)<<1))}},s.exports=i},{"../utils":32}],19:[function(t,s,n){var l=t("./Uint8ArrayReader");function i(d){l.call(this,d)}t("../utils").inherits(i,l),i.prototype.readData=function(d){this.checkOffset(d);var u=this.data.slice(this.zero+this.index,this.zero+this.index+d);return this.index+=d,u},s.exports=i},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(t,s,n){var l=t("./DataReader");function i(d){l.call(this,d)}t("../utils").inherits(i,l),i.prototype.byteAt=function(d){return this.data.charCodeAt(this.zero+d)},i.prototype.lastIndexOfSignature=function(d){return this.data.lastIndexOf(d)-this.zero},i.prototype.readAndCheckSignature=function(d){return d===this.readData(4)},i.prototype.readData=function(d){this.checkOffset(d);var u=this.data.slice(this.zero+this.index,this.zero+this.index+d);return this.index+=d,u},s.exports=i},{"../utils":32,"./DataReader":18}],21:[function(t,s,n){var l=t("./ArrayReader");function i(d){l.call(this,d)}t("../utils").inherits(i,l),i.prototype.readData=function(d){if(this.checkOffset(d),d===0)return new Uint8Array(0);var u=this.data.subarray(this.zero+this.index,this.zero+this.index+d);return this.index+=d,u},s.exports=i},{"../utils":32,"./ArrayReader":17}],22:[function(t,s,n){var l=t("../utils"),i=t("../support"),d=t("./ArrayReader"),u=t("./StringReader"),g=t("./NodeBufferReader"),y=t("./Uint8ArrayReader");s.exports=function(m){var x=l.getTypeOf(m);return l.checkSupport(x),x!=="string"||i.uint8array?x==="nodebuffer"?new g(m):i.uint8array?new y(l.transformTo("uint8array",m)):new d(l.transformTo("array",m)):new u(m)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(t,s,n){n.LOCAL_FILE_HEADER="PK",n.CENTRAL_FILE_HEADER="PK",n.CENTRAL_DIRECTORY_END="PK",n.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",n.ZIP64_CENTRAL_DIRECTORY_END="PK",n.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(t,s,n){var l=t("./GenericWorker"),i=t("../utils");function d(u){l.call(this,"ConvertWorker to "+u),this.destType=u}i.inherits(d,l),d.prototype.processChunk=function(u){this.push({data:i.transformTo(this.destType,u.data),meta:u.meta})},s.exports=d},{"../utils":32,"./GenericWorker":28}],25:[function(t,s,n){var l=t("./GenericWorker"),i=t("../crc32");function d(){l.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}t("../utils").inherits(d,l),d.prototype.processChunk=function(u){this.streamInfo.crc32=i(u.data,this.streamInfo.crc32||0),this.push(u)},s.exports=d},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(t,s,n){var l=t("../utils"),i=t("./GenericWorker");function d(u){i.call(this,"DataLengthProbe for "+u),this.propName=u,this.withStreamInfo(u,0)}l.inherits(d,i),d.prototype.processChunk=function(u){if(u){var g=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=g+u.data.length}i.prototype.processChunk.call(this,u)},s.exports=d},{"../utils":32,"./GenericWorker":28}],27:[function(t,s,n){var l=t("../utils"),i=t("./GenericWorker");function d(u){i.call(this,"DataWorker");var g=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,u.then(function(y){g.dataIsReady=!0,g.data=y,g.max=y&&y.length||0,g.type=l.getTypeOf(y),g.isPaused||g._tickAndRepeat()},function(y){g.error(y)})}l.inherits(d,i),d.prototype.cleanUp=function(){i.prototype.cleanUp.call(this),this.data=null},d.prototype.resume=function(){return!!i.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,l.delay(this._tickAndRepeat,[],this)),!0)},d.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(l.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},d.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var u=null,g=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":u=this.data.substring(this.index,g);break;case"uint8array":u=this.data.subarray(this.index,g);break;case"array":case"nodebuffer":u=this.data.slice(this.index,g)}return this.index=g,this.push({data:u,meta:{percent:this.max?this.index/this.max*100:0}})},s.exports=d},{"../utils":32,"./GenericWorker":28}],28:[function(t,s,n){function l(i){this.name=i||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}l.prototype={push:function(i){this.emit("data",i)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(i){this.emit("error",i)}return!0},error:function(i){return!this.isFinished&&(this.isPaused?this.generatedError=i:(this.isFinished=!0,this.emit("error",i),this.previous&&this.previous.error(i),this.cleanUp()),!0)},on:function(i,d){return this._listeners[i].push(d),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(i,d){if(this._listeners[i])for(var u=0;u<this._listeners[i].length;u++)this._listeners[i][u].call(this,d)},pipe:function(i){return i.registerPrevious(this)},registerPrevious:function(i){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=i.streamInfo,this.mergeStreamInfo(),this.previous=i;var d=this;return i.on("data",function(u){d.processChunk(u)}),i.on("end",function(){d.end()}),i.on("error",function(u){d.error(u)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var i=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),i=!0),this.previous&&this.previous.resume(),!i},flush:function(){},processChunk:function(i){this.push(i)},withStreamInfo:function(i,d){return this.extraStreamInfo[i]=d,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var i in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,i)&&(this.streamInfo[i]=this.extraStreamInfo[i])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var i="Worker "+this.name;return this.previous?this.previous+" -> "+i:i}},s.exports=l},{}],29:[function(t,s,n){var l=t("../utils"),i=t("./ConvertWorker"),d=t("./GenericWorker"),u=t("../base64"),g=t("../support"),y=t("../external"),m=null;if(g.nodestream)try{m=t("../nodejs/NodejsStreamOutputAdapter")}catch{}function x(_,v){return new y.Promise(function(k,b){var f=[],C=_._internalType,M=_._outputType,F=_._mimeType;_.on("data",function(R,z){f.push(R),v&&v(z)}).on("error",function(R){f=[],b(R)}).on("end",function(){try{var R=(function(z,H,Y){switch(z){case"blob":return l.newBlob(l.transformTo("arraybuffer",H),Y);case"base64":return u.encode(H);default:return l.transformTo(z,H)}})(M,(function(z,H){var Y,se=0,W=null,E=0;for(Y=0;Y<H.length;Y++)E+=H[Y].length;switch(z){case"string":return H.join("");case"array":return Array.prototype.concat.apply([],H);case"uint8array":for(W=new Uint8Array(E),Y=0;Y<H.length;Y++)W.set(H[Y],se),se+=H[Y].length;return W;case"nodebuffer":return Buffer.concat(H);default:throw new Error("concat : unsupported type '"+z+"'")}})(C,f),F);k(R)}catch(z){b(z)}f=[]}).resume()})}function p(_,v,k){var b=v;switch(v){case"blob":case"arraybuffer":b="uint8array";break;case"base64":b="string"}try{this._internalType=b,this._outputType=v,this._mimeType=k,l.checkSupport(b),this._worker=_.pipe(new i(b)),_.lock()}catch(f){this._worker=new d("error"),this._worker.error(f)}}p.prototype={accumulate:function(_){return x(this,_)},on:function(_,v){var k=this;return _==="data"?this._worker.on(_,function(b){v.call(k,b.data,b.meta)}):this._worker.on(_,function(){l.delay(v,arguments,k)}),this},resume:function(){return l.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(_){if(l.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new m(this,{objectMode:this._outputType!=="nodebuffer"},_)}},s.exports=p},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(t,s,n){if(n.base64=!0,n.array=!0,n.string=!0,n.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",n.nodebuffer=typeof Buffer<"u",n.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")n.blob=!1;else{var l=new ArrayBuffer(0);try{n.blob=new Blob([l],{type:"application/zip"}).size===0}catch{try{var i=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);i.append(l),n.blob=i.getBlob("application/zip").size===0}catch{n.blob=!1}}}try{n.nodestream=!!t("readable-stream").Readable}catch{n.nodestream=!1}},{"readable-stream":16}],31:[function(t,s,n){for(var l=t("./utils"),i=t("./support"),d=t("./nodejsUtils"),u=t("./stream/GenericWorker"),g=new Array(256),y=0;y<256;y++)g[y]=252<=y?6:248<=y?5:240<=y?4:224<=y?3:192<=y?2:1;g[254]=g[254]=1;function m(){u.call(this,"utf-8 decode"),this.leftOver=null}function x(){u.call(this,"utf-8 encode")}n.utf8encode=function(p){return i.nodebuffer?d.newBufferFrom(p,"utf-8"):(function(_){var v,k,b,f,C,M=_.length,F=0;for(f=0;f<M;f++)(64512&(k=_.charCodeAt(f)))==55296&&f+1<M&&(64512&(b=_.charCodeAt(f+1)))==56320&&(k=65536+(k-55296<<10)+(b-56320),f++),F+=k<128?1:k<2048?2:k<65536?3:4;for(v=i.uint8array?new Uint8Array(F):new Array(F),f=C=0;C<F;f++)(64512&(k=_.charCodeAt(f)))==55296&&f+1<M&&(64512&(b=_.charCodeAt(f+1)))==56320&&(k=65536+(k-55296<<10)+(b-56320),f++),k<128?v[C++]=k:(k<2048?v[C++]=192|k>>>6:(k<65536?v[C++]=224|k>>>12:(v[C++]=240|k>>>18,v[C++]=128|k>>>12&63),v[C++]=128|k>>>6&63),v[C++]=128|63&k);return v})(p)},n.utf8decode=function(p){return i.nodebuffer?l.transformTo("nodebuffer",p).toString("utf-8"):(function(_){var v,k,b,f,C=_.length,M=new Array(2*C);for(v=k=0;v<C;)if((b=_[v++])<128)M[k++]=b;else if(4<(f=g[b]))M[k++]=65533,v+=f-1;else{for(b&=f===2?31:f===3?15:7;1<f&&v<C;)b=b<<6|63&_[v++],f--;1<f?M[k++]=65533:b<65536?M[k++]=b:(b-=65536,M[k++]=55296|b>>10&1023,M[k++]=56320|1023&b)}return M.length!==k&&(M.subarray?M=M.subarray(0,k):M.length=k),l.applyFromCharCode(M)})(p=l.transformTo(i.uint8array?"uint8array":"array",p))},l.inherits(m,u),m.prototype.processChunk=function(p){var _=l.transformTo(i.uint8array?"uint8array":"array",p.data);if(this.leftOver&&this.leftOver.length){if(i.uint8array){var v=_;(_=new Uint8Array(v.length+this.leftOver.length)).set(this.leftOver,0),_.set(v,this.leftOver.length)}else _=this.leftOver.concat(_);this.leftOver=null}var k=(function(f,C){var M;for((C=C||f.length)>f.length&&(C=f.length),M=C-1;0<=M&&(192&f[M])==128;)M--;return M<0||M===0?C:M+g[f[M]]>C?M:C})(_),b=_;k!==_.length&&(i.uint8array?(b=_.subarray(0,k),this.leftOver=_.subarray(k,_.length)):(b=_.slice(0,k),this.leftOver=_.slice(k,_.length))),this.push({data:n.utf8decode(b),meta:p.meta})},m.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:n.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},n.Utf8DecodeWorker=m,l.inherits(x,u),x.prototype.processChunk=function(p){this.push({data:n.utf8encode(p.data),meta:p.meta})},n.Utf8EncodeWorker=x},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(t,s,n){var l=t("./support"),i=t("./base64"),d=t("./nodejsUtils"),u=t("./external");function g(v){return v}function y(v,k){for(var b=0;b<v.length;++b)k[b]=255&v.charCodeAt(b);return k}t("setimmediate"),n.newBlob=function(v,k){n.checkSupport("blob");try{return new Blob([v],{type:k})}catch{try{var b=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return b.append(v),b.getBlob(k)}catch{throw new Error("Bug : can't construct the Blob.")}}};var m={stringifyByChunk:function(v,k,b){var f=[],C=0,M=v.length;if(M<=b)return String.fromCharCode.apply(null,v);for(;C<M;)k==="array"||k==="nodebuffer"?f.push(String.fromCharCode.apply(null,v.slice(C,Math.min(C+b,M)))):f.push(String.fromCharCode.apply(null,v.subarray(C,Math.min(C+b,M)))),C+=b;return f.join("")},stringifyByChar:function(v){for(var k="",b=0;b<v.length;b++)k+=String.fromCharCode(v[b]);return k},applyCanBeUsed:{uint8array:(function(){try{return l.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}})(),nodebuffer:(function(){try{return l.nodebuffer&&String.fromCharCode.apply(null,d.allocBuffer(1)).length===1}catch{return!1}})()}};function x(v){var k=65536,b=n.getTypeOf(v),f=!0;if(b==="uint8array"?f=m.applyCanBeUsed.uint8array:b==="nodebuffer"&&(f=m.applyCanBeUsed.nodebuffer),f)for(;1<k;)try{return m.stringifyByChunk(v,b,k)}catch{k=Math.floor(k/2)}return m.stringifyByChar(v)}function p(v,k){for(var b=0;b<v.length;b++)k[b]=v[b];return k}n.applyFromCharCode=x;var _={};_.string={string:g,array:function(v){return y(v,new Array(v.length))},arraybuffer:function(v){return _.string.uint8array(v).buffer},uint8array:function(v){return y(v,new Uint8Array(v.length))},nodebuffer:function(v){return y(v,d.allocBuffer(v.length))}},_.array={string:x,array:g,arraybuffer:function(v){return new Uint8Array(v).buffer},uint8array:function(v){return new Uint8Array(v)},nodebuffer:function(v){return d.newBufferFrom(v)}},_.arraybuffer={string:function(v){return x(new Uint8Array(v))},array:function(v){return p(new Uint8Array(v),new Array(v.byteLength))},arraybuffer:g,uint8array:function(v){return new Uint8Array(v)},nodebuffer:function(v){return d.newBufferFrom(new Uint8Array(v))}},_.uint8array={string:x,array:function(v){return p(v,new Array(v.length))},arraybuffer:function(v){return v.buffer},uint8array:g,nodebuffer:function(v){return d.newBufferFrom(v)}},_.nodebuffer={string:x,array:function(v){return p(v,new Array(v.length))},arraybuffer:function(v){return _.nodebuffer.uint8array(v).buffer},uint8array:function(v){return p(v,new Uint8Array(v.length))},nodebuffer:g},n.transformTo=function(v,k){if(k=k||"",!v)return k;n.checkSupport(v);var b=n.getTypeOf(k);return _[b][v](k)},n.resolve=function(v){for(var k=v.split("/"),b=[],f=0;f<k.length;f++){var C=k[f];C==="."||C===""&&f!==0&&f!==k.length-1||(C===".."?b.pop():b.push(C))}return b.join("/")},n.getTypeOf=function(v){return typeof v=="string"?"string":Object.prototype.toString.call(v)==="[object Array]"?"array":l.nodebuffer&&d.isBuffer(v)?"nodebuffer":l.uint8array&&v instanceof Uint8Array?"uint8array":l.arraybuffer&&v instanceof ArrayBuffer?"arraybuffer":void 0},n.checkSupport=function(v){if(!l[v.toLowerCase()])throw new Error(v+" is not supported by this platform")},n.MAX_VALUE_16BITS=65535,n.MAX_VALUE_32BITS=-1,n.pretty=function(v){var k,b,f="";for(b=0;b<(v||"").length;b++)f+="\\x"+((k=v.charCodeAt(b))<16?"0":"")+k.toString(16).toUpperCase();return f},n.delay=function(v,k,b){setImmediate(function(){v.apply(b||null,k||[])})},n.inherits=function(v,k){function b(){}b.prototype=k.prototype,v.prototype=new b},n.extend=function(){var v,k,b={};for(v=0;v<arguments.length;v++)for(k in arguments[v])Object.prototype.hasOwnProperty.call(arguments[v],k)&&b[k]===void 0&&(b[k]=arguments[v][k]);return b},n.prepareContent=function(v,k,b,f,C){return u.Promise.resolve(k).then(function(M){return l.blob&&(M instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(M))!==-1)&&typeof FileReader<"u"?new u.Promise(function(F,R){var z=new FileReader;z.onload=function(H){F(H.target.result)},z.onerror=function(H){R(H.target.error)},z.readAsArrayBuffer(M)}):M}).then(function(M){var F=n.getTypeOf(M);return F?(F==="arraybuffer"?M=n.transformTo("uint8array",M):F==="string"&&(C?M=i.decode(M):b&&f!==!0&&(M=(function(R){return y(R,l.uint8array?new Uint8Array(R.length):new Array(R.length))})(M))),M):u.Promise.reject(new Error("Can't read the data of '"+v+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(t,s,n){var l=t("./reader/readerFor"),i=t("./utils"),d=t("./signature"),u=t("./zipEntry"),g=t("./support");function y(m){this.files=[],this.loadOptions=m}y.prototype={checkSignature:function(m){if(!this.reader.readAndCheckSignature(m)){this.reader.index-=4;var x=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+i.pretty(x)+", expected "+i.pretty(m)+")")}},isSignature:function(m,x){var p=this.reader.index;this.reader.setIndex(m);var _=this.reader.readString(4)===x;return this.reader.setIndex(p),_},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var m=this.reader.readData(this.zipCommentLength),x=g.uint8array?"uint8array":"array",p=i.transformTo(x,m);this.zipComment=this.loadOptions.decodeFileName(p)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var m,x,p,_=this.zip64EndOfCentralSize-44;0<_;)m=this.reader.readInt(2),x=this.reader.readInt(4),p=this.reader.readData(x),this.zip64ExtensibleData[m]={id:m,length:x,value:p}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var m,x;for(m=0;m<this.files.length;m++)x=this.files[m],this.reader.setIndex(x.localHeaderOffset),this.checkSignature(d.LOCAL_FILE_HEADER),x.readLocalPart(this.reader),x.handleUTF8(),x.processAttributes()},readCentralDir:function(){var m;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(d.CENTRAL_FILE_HEADER);)(m=new u({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(m);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var m=this.reader.lastIndexOfSignature(d.CENTRAL_DIRECTORY_END);if(m<0)throw this.isSignature(0,d.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(m);var x=m;if(this.checkSignature(d.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===i.MAX_VALUE_16BITS||this.diskWithCentralDirStart===i.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===i.MAX_VALUE_16BITS||this.centralDirRecords===i.MAX_VALUE_16BITS||this.centralDirSize===i.MAX_VALUE_32BITS||this.centralDirOffset===i.MAX_VALUE_32BITS){if(this.zip64=!0,(m=this.reader.lastIndexOfSignature(d.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(m),this.checkSignature(d.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,d.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(d.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(d.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var p=this.centralDirOffset+this.centralDirSize;this.zip64&&(p+=20,p+=12+this.zip64EndOfCentralSize);var _=x-p;if(0<_)this.isSignature(x,d.CENTRAL_FILE_HEADER)||(this.reader.zero=_);else if(_<0)throw new Error("Corrupted zip: missing "+Math.abs(_)+" bytes.")},prepareReader:function(m){this.reader=l(m)},load:function(m){this.prepareReader(m),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},s.exports=y},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(t,s,n){var l=t("./reader/readerFor"),i=t("./utils"),d=t("./compressedObject"),u=t("./crc32"),g=t("./utf8"),y=t("./compressions"),m=t("./support");function x(p,_){this.options=p,this.loadOptions=_}x.prototype={isEncrypted:function(){return(1&this.bitFlag)==1},useUTF8:function(){return(2048&this.bitFlag)==2048},readLocalPart:function(p){var _,v;if(p.skip(22),this.fileNameLength=p.readInt(2),v=p.readInt(2),this.fileName=p.readData(this.fileNameLength),p.skip(v),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if((_=(function(k){for(var b in y)if(Object.prototype.hasOwnProperty.call(y,b)&&y[b].magic===k)return y[b];return null})(this.compressionMethod))===null)throw new Error("Corrupted zip : compression "+i.pretty(this.compressionMethod)+" unknown (inner file : "+i.transformTo("string",this.fileName)+")");this.decompressed=new d(this.compressedSize,this.uncompressedSize,this.crc32,_,p.readData(this.compressedSize))},readCentralPart:function(p){this.versionMadeBy=p.readInt(2),p.skip(2),this.bitFlag=p.readInt(2),this.compressionMethod=p.readString(2),this.date=p.readDate(),this.crc32=p.readInt(4),this.compressedSize=p.readInt(4),this.uncompressedSize=p.readInt(4);var _=p.readInt(2);if(this.extraFieldsLength=p.readInt(2),this.fileCommentLength=p.readInt(2),this.diskNumberStart=p.readInt(2),this.internalFileAttributes=p.readInt(2),this.externalFileAttributes=p.readInt(4),this.localHeaderOffset=p.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");p.skip(_),this.readExtraFields(p),this.parseZIP64ExtraField(p),this.fileComment=p.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var p=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),p==0&&(this.dosPermissions=63&this.externalFileAttributes),p==3&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||this.fileNameStr.slice(-1)!=="/"||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var p=l(this.extraFields[1].value);this.uncompressedSize===i.MAX_VALUE_32BITS&&(this.uncompressedSize=p.readInt(8)),this.compressedSize===i.MAX_VALUE_32BITS&&(this.compressedSize=p.readInt(8)),this.localHeaderOffset===i.MAX_VALUE_32BITS&&(this.localHeaderOffset=p.readInt(8)),this.diskNumberStart===i.MAX_VALUE_32BITS&&(this.diskNumberStart=p.readInt(4))}},readExtraFields:function(p){var _,v,k,b=p.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});p.index+4<b;)_=p.readInt(2),v=p.readInt(2),k=p.readData(v),this.extraFields[_]={id:_,length:v,value:k};p.setIndex(b)},handleUTF8:function(){var p=m.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=g.utf8decode(this.fileName),this.fileCommentStr=g.utf8decode(this.fileComment);else{var _=this.findExtraFieldUnicodePath();if(_!==null)this.fileNameStr=_;else{var v=i.transformTo(p,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(v)}var k=this.findExtraFieldUnicodeComment();if(k!==null)this.fileCommentStr=k;else{var b=i.transformTo(p,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(b)}}},findExtraFieldUnicodePath:function(){var p=this.extraFields[28789];if(p){var _=l(p.value);return _.readInt(1)!==1||u(this.fileName)!==_.readInt(4)?null:g.utf8decode(_.readData(p.length-5))}return null},findExtraFieldUnicodeComment:function(){var p=this.extraFields[25461];if(p){var _=l(p.value);return _.readInt(1)!==1||u(this.fileComment)!==_.readInt(4)?null:g.utf8decode(_.readData(p.length-5))}return null}},s.exports=x},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(t,s,n){function l(_,v,k){this.name=_,this.dir=k.dir,this.date=k.date,this.comment=k.comment,this.unixPermissions=k.unixPermissions,this.dosPermissions=k.dosPermissions,this._data=v,this._dataBinary=k.binary,this.options={compression:k.compression,compressionOptions:k.compressionOptions}}var i=t("./stream/StreamHelper"),d=t("./stream/DataWorker"),u=t("./utf8"),g=t("./compressedObject"),y=t("./stream/GenericWorker");l.prototype={internalStream:function(_){var v=null,k="string";try{if(!_)throw new Error("No output type specified.");var b=(k=_.toLowerCase())==="string"||k==="text";k!=="binarystring"&&k!=="text"||(k="string"),v=this._decompressWorker();var f=!this._dataBinary;f&&!b&&(v=v.pipe(new u.Utf8EncodeWorker)),!f&&b&&(v=v.pipe(new u.Utf8DecodeWorker))}catch(C){(v=new y("error")).error(C)}return new i(v,k,"")},async:function(_,v){return this.internalStream(_).accumulate(v)},nodeStream:function(_,v){return this.internalStream(_||"nodebuffer").toNodejsStream(v)},_compressWorker:function(_,v){if(this._data instanceof g&&this._data.compression.magic===_.magic)return this._data.getCompressedWorker();var k=this._decompressWorker();return this._dataBinary||(k=k.pipe(new u.Utf8EncodeWorker)),g.createWorkerFrom(k,_,v)},_decompressWorker:function(){return this._data instanceof g?this._data.getContentWorker():this._data instanceof y?this._data:new d(this._data)}};for(var m=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],x=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},p=0;p<m.length;p++)l.prototype[m[p]]=x;s.exports=l},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(t,s,n){(function(l){var i,d,u=l.MutationObserver||l.WebKitMutationObserver;if(u){var g=0,y=new u(_),m=l.document.createTextNode("");y.observe(m,{characterData:!0}),i=function(){m.data=g=++g%2}}else if(l.setImmediate||l.MessageChannel===void 0)i="document"in l&&"onreadystatechange"in l.document.createElement("script")?function(){var v=l.document.createElement("script");v.onreadystatechange=function(){_(),v.onreadystatechange=null,v.parentNode.removeChild(v),v=null},l.document.documentElement.appendChild(v)}:function(){setTimeout(_,0)};else{var x=new l.MessageChannel;x.port1.onmessage=_,i=function(){x.port2.postMessage(0)}}var p=[];function _(){var v,k;d=!0;for(var b=p.length;b;){for(k=p,p=[],v=-1;++v<b;)k[v]();b=p.length}d=!1}s.exports=function(v){p.push(v)!==1||d||i()}}).call(this,typeof at<"u"?at:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(t,s,n){var l=t("immediate");function i(){}var d={},u=["REJECTED"],g=["FULFILLED"],y=["PENDING"];function m(b){if(typeof b!="function")throw new TypeError("resolver must be a function");this.state=y,this.queue=[],this.outcome=void 0,b!==i&&v(this,b)}function x(b,f,C){this.promise=b,typeof f=="function"&&(this.onFulfilled=f,this.callFulfilled=this.otherCallFulfilled),typeof C=="function"&&(this.onRejected=C,this.callRejected=this.otherCallRejected)}function p(b,f,C){l(function(){var M;try{M=f(C)}catch(F){return d.reject(b,F)}M===b?d.reject(b,new TypeError("Cannot resolve promise with itself")):d.resolve(b,M)})}function _(b){var f=b&&b.then;if(b&&(typeof b=="object"||typeof b=="function")&&typeof f=="function")return function(){f.apply(b,arguments)}}function v(b,f){var C=!1;function M(z){C||(C=!0,d.reject(b,z))}function F(z){C||(C=!0,d.resolve(b,z))}var R=k(function(){f(F,M)});R.status==="error"&&M(R.value)}function k(b,f){var C={};try{C.value=b(f),C.status="success"}catch(M){C.status="error",C.value=M}return C}(s.exports=m).prototype.finally=function(b){if(typeof b!="function")return this;var f=this.constructor;return this.then(function(C){return f.resolve(b()).then(function(){return C})},function(C){return f.resolve(b()).then(function(){throw C})})},m.prototype.catch=function(b){return this.then(null,b)},m.prototype.then=function(b,f){if(typeof b!="function"&&this.state===g||typeof f!="function"&&this.state===u)return this;var C=new this.constructor(i);return this.state!==y?p(C,this.state===g?b:f,this.outcome):this.queue.push(new x(C,b,f)),C},x.prototype.callFulfilled=function(b){d.resolve(this.promise,b)},x.prototype.otherCallFulfilled=function(b){p(this.promise,this.onFulfilled,b)},x.prototype.callRejected=function(b){d.reject(this.promise,b)},x.prototype.otherCallRejected=function(b){p(this.promise,this.onRejected,b)},d.resolve=function(b,f){var C=k(_,f);if(C.status==="error")return d.reject(b,C.value);var M=C.value;if(M)v(b,M);else{b.state=g,b.outcome=f;for(var F=-1,R=b.queue.length;++F<R;)b.queue[F].callFulfilled(f)}return b},d.reject=function(b,f){b.state=u,b.outcome=f;for(var C=-1,M=b.queue.length;++C<M;)b.queue[C].callRejected(f);return b},m.resolve=function(b){return b instanceof this?b:d.resolve(new this(i),b)},m.reject=function(b){var f=new this(i);return d.reject(f,b)},m.all=function(b){var f=this;if(Object.prototype.toString.call(b)!=="[object Array]")return this.reject(new TypeError("must be an array"));var C=b.length,M=!1;if(!C)return this.resolve([]);for(var F=new Array(C),R=0,z=-1,H=new this(i);++z<C;)Y(b[z],z);return H;function Y(se,W){f.resolve(se).then(function(E){F[W]=E,++R!==C||M||(M=!0,d.resolve(H,F))},function(E){M||(M=!0,d.reject(H,E))})}},m.race=function(b){var f=this;if(Object.prototype.toString.call(b)!=="[object Array]")return this.reject(new TypeError("must be an array"));var C=b.length,M=!1;if(!C)return this.resolve([]);for(var F=-1,R=new this(i);++F<C;)z=b[F],f.resolve(z).then(function(H){M||(M=!0,d.resolve(R,H))},function(H){M||(M=!0,d.reject(R,H))});var z;return R}},{immediate:36}],38:[function(t,s,n){var l={};(0,t("./lib/utils/common").assign)(l,t("./lib/deflate"),t("./lib/inflate"),t("./lib/zlib/constants")),s.exports=l},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(t,s,n){var l=t("./zlib/deflate"),i=t("./utils/common"),d=t("./utils/strings"),u=t("./zlib/messages"),g=t("./zlib/zstream"),y=Object.prototype.toString,m=0,x=-1,p=0,_=8;function v(b){if(!(this instanceof v))return new v(b);this.options=i.assign({level:x,method:_,chunkSize:16384,windowBits:15,memLevel:8,strategy:p,to:""},b||{});var f=this.options;f.raw&&0<f.windowBits?f.windowBits=-f.windowBits:f.gzip&&0<f.windowBits&&f.windowBits<16&&(f.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new g,this.strm.avail_out=0;var C=l.deflateInit2(this.strm,f.level,f.method,f.windowBits,f.memLevel,f.strategy);if(C!==m)throw new Error(u[C]);if(f.header&&l.deflateSetHeader(this.strm,f.header),f.dictionary){var M;if(M=typeof f.dictionary=="string"?d.string2buf(f.dictionary):y.call(f.dictionary)==="[object ArrayBuffer]"?new Uint8Array(f.dictionary):f.dictionary,(C=l.deflateSetDictionary(this.strm,M))!==m)throw new Error(u[C]);this._dict_set=!0}}function k(b,f){var C=new v(f);if(C.push(b,!0),C.err)throw C.msg||u[C.err];return C.result}v.prototype.push=function(b,f){var C,M,F=this.strm,R=this.options.chunkSize;if(this.ended)return!1;M=f===~~f?f:f===!0?4:0,typeof b=="string"?F.input=d.string2buf(b):y.call(b)==="[object ArrayBuffer]"?F.input=new Uint8Array(b):F.input=b,F.next_in=0,F.avail_in=F.input.length;do{if(F.avail_out===0&&(F.output=new i.Buf8(R),F.next_out=0,F.avail_out=R),(C=l.deflate(F,M))!==1&&C!==m)return this.onEnd(C),!(this.ended=!0);F.avail_out!==0&&(F.avail_in!==0||M!==4&&M!==2)||(this.options.to==="string"?this.onData(d.buf2binstring(i.shrinkBuf(F.output,F.next_out))):this.onData(i.shrinkBuf(F.output,F.next_out)))}while((0<F.avail_in||F.avail_out===0)&&C!==1);return M===4?(C=l.deflateEnd(this.strm),this.onEnd(C),this.ended=!0,C===m):M!==2||(this.onEnd(m),!(F.avail_out=0))},v.prototype.onData=function(b){this.chunks.push(b)},v.prototype.onEnd=function(b){b===m&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=i.flattenChunks(this.chunks)),this.chunks=[],this.err=b,this.msg=this.strm.msg},n.Deflate=v,n.deflate=k,n.deflateRaw=function(b,f){return(f=f||{}).raw=!0,k(b,f)},n.gzip=function(b,f){return(f=f||{}).gzip=!0,k(b,f)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(t,s,n){var l=t("./zlib/inflate"),i=t("./utils/common"),d=t("./utils/strings"),u=t("./zlib/constants"),g=t("./zlib/messages"),y=t("./zlib/zstream"),m=t("./zlib/gzheader"),x=Object.prototype.toString;function p(v){if(!(this instanceof p))return new p(v);this.options=i.assign({chunkSize:16384,windowBits:0,to:""},v||{});var k=this.options;k.raw&&0<=k.windowBits&&k.windowBits<16&&(k.windowBits=-k.windowBits,k.windowBits===0&&(k.windowBits=-15)),!(0<=k.windowBits&&k.windowBits<16)||v&&v.windowBits||(k.windowBits+=32),15<k.windowBits&&k.windowBits<48&&(15&k.windowBits)==0&&(k.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new y,this.strm.avail_out=0;var b=l.inflateInit2(this.strm,k.windowBits);if(b!==u.Z_OK)throw new Error(g[b]);this.header=new m,l.inflateGetHeader(this.strm,this.header)}function _(v,k){var b=new p(k);if(b.push(v,!0),b.err)throw b.msg||g[b.err];return b.result}p.prototype.push=function(v,k){var b,f,C,M,F,R,z=this.strm,H=this.options.chunkSize,Y=this.options.dictionary,se=!1;if(this.ended)return!1;f=k===~~k?k:k===!0?u.Z_FINISH:u.Z_NO_FLUSH,typeof v=="string"?z.input=d.binstring2buf(v):x.call(v)==="[object ArrayBuffer]"?z.input=new Uint8Array(v):z.input=v,z.next_in=0,z.avail_in=z.input.length;do{if(z.avail_out===0&&(z.output=new i.Buf8(H),z.next_out=0,z.avail_out=H),(b=l.inflate(z,u.Z_NO_FLUSH))===u.Z_NEED_DICT&&Y&&(R=typeof Y=="string"?d.string2buf(Y):x.call(Y)==="[object ArrayBuffer]"?new Uint8Array(Y):Y,b=l.inflateSetDictionary(this.strm,R)),b===u.Z_BUF_ERROR&&se===!0&&(b=u.Z_OK,se=!1),b!==u.Z_STREAM_END&&b!==u.Z_OK)return this.onEnd(b),!(this.ended=!0);z.next_out&&(z.avail_out!==0&&b!==u.Z_STREAM_END&&(z.avail_in!==0||f!==u.Z_FINISH&&f!==u.Z_SYNC_FLUSH)||(this.options.to==="string"?(C=d.utf8border(z.output,z.next_out),M=z.next_out-C,F=d.buf2string(z.output,C),z.next_out=M,z.avail_out=H-M,M&&i.arraySet(z.output,z.output,C,M,0),this.onData(F)):this.onData(i.shrinkBuf(z.output,z.next_out)))),z.avail_in===0&&z.avail_out===0&&(se=!0)}while((0<z.avail_in||z.avail_out===0)&&b!==u.Z_STREAM_END);return b===u.Z_STREAM_END&&(f=u.Z_FINISH),f===u.Z_FINISH?(b=l.inflateEnd(this.strm),this.onEnd(b),this.ended=!0,b===u.Z_OK):f!==u.Z_SYNC_FLUSH||(this.onEnd(u.Z_OK),!(z.avail_out=0))},p.prototype.onData=function(v){this.chunks.push(v)},p.prototype.onEnd=function(v){v===u.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=i.flattenChunks(this.chunks)),this.chunks=[],this.err=v,this.msg=this.strm.msg},n.Inflate=p,n.inflate=_,n.inflateRaw=function(v,k){return(k=k||{}).raw=!0,_(v,k)},n.ungzip=_},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(t,s,n){var l=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";n.assign=function(u){for(var g=Array.prototype.slice.call(arguments,1);g.length;){var y=g.shift();if(y){if(typeof y!="object")throw new TypeError(y+"must be non-object");for(var m in y)y.hasOwnProperty(m)&&(u[m]=y[m])}}return u},n.shrinkBuf=function(u,g){return u.length===g?u:u.subarray?u.subarray(0,g):(u.length=g,u)};var i={arraySet:function(u,g,y,m,x){if(g.subarray&&u.subarray)u.set(g.subarray(y,y+m),x);else for(var p=0;p<m;p++)u[x+p]=g[y+p]},flattenChunks:function(u){var g,y,m,x,p,_;for(g=m=0,y=u.length;g<y;g++)m+=u[g].length;for(_=new Uint8Array(m),g=x=0,y=u.length;g<y;g++)p=u[g],_.set(p,x),x+=p.length;return _}},d={arraySet:function(u,g,y,m,x){for(var p=0;p<m;p++)u[x+p]=g[y+p]},flattenChunks:function(u){return[].concat.apply([],u)}};n.setTyped=function(u){u?(n.Buf8=Uint8Array,n.Buf16=Uint16Array,n.Buf32=Int32Array,n.assign(n,i)):(n.Buf8=Array,n.Buf16=Array,n.Buf32=Array,n.assign(n,d))},n.setTyped(l)},{}],42:[function(t,s,n){var l=t("./common"),i=!0,d=!0;try{String.fromCharCode.apply(null,[0])}catch{i=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{d=!1}for(var u=new l.Buf8(256),g=0;g<256;g++)u[g]=252<=g?6:248<=g?5:240<=g?4:224<=g?3:192<=g?2:1;function y(m,x){if(x<65537&&(m.subarray&&d||!m.subarray&&i))return String.fromCharCode.apply(null,l.shrinkBuf(m,x));for(var p="",_=0;_<x;_++)p+=String.fromCharCode(m[_]);return p}u[254]=u[254]=1,n.string2buf=function(m){var x,p,_,v,k,b=m.length,f=0;for(v=0;v<b;v++)(64512&(p=m.charCodeAt(v)))==55296&&v+1<b&&(64512&(_=m.charCodeAt(v+1)))==56320&&(p=65536+(p-55296<<10)+(_-56320),v++),f+=p<128?1:p<2048?2:p<65536?3:4;for(x=new l.Buf8(f),v=k=0;k<f;v++)(64512&(p=m.charCodeAt(v)))==55296&&v+1<b&&(64512&(_=m.charCodeAt(v+1)))==56320&&(p=65536+(p-55296<<10)+(_-56320),v++),p<128?x[k++]=p:(p<2048?x[k++]=192|p>>>6:(p<65536?x[k++]=224|p>>>12:(x[k++]=240|p>>>18,x[k++]=128|p>>>12&63),x[k++]=128|p>>>6&63),x[k++]=128|63&p);return x},n.buf2binstring=function(m){return y(m,m.length)},n.binstring2buf=function(m){for(var x=new l.Buf8(m.length),p=0,_=x.length;p<_;p++)x[p]=m.charCodeAt(p);return x},n.buf2string=function(m,x){var p,_,v,k,b=x||m.length,f=new Array(2*b);for(p=_=0;p<b;)if((v=m[p++])<128)f[_++]=v;else if(4<(k=u[v]))f[_++]=65533,p+=k-1;else{for(v&=k===2?31:k===3?15:7;1<k&&p<b;)v=v<<6|63&m[p++],k--;1<k?f[_++]=65533:v<65536?f[_++]=v:(v-=65536,f[_++]=55296|v>>10&1023,f[_++]=56320|1023&v)}return y(f,_)},n.utf8border=function(m,x){var p;for((x=x||m.length)>m.length&&(x=m.length),p=x-1;0<=p&&(192&m[p])==128;)p--;return p<0||p===0?x:p+u[m[p]]>x?p:x}},{"./common":41}],43:[function(t,s,n){s.exports=function(l,i,d,u){for(var g=65535&l|0,y=l>>>16&65535|0,m=0;d!==0;){for(d-=m=2e3<d?2e3:d;y=y+(g=g+i[u++]|0)|0,--m;);g%=65521,y%=65521}return g|y<<16|0}},{}],44:[function(t,s,n){s.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(t,s,n){var l=(function(){for(var i,d=[],u=0;u<256;u++){i=u;for(var g=0;g<8;g++)i=1&i?3988292384^i>>>1:i>>>1;d[u]=i}return d})();s.exports=function(i,d,u,g){var y=l,m=g+u;i^=-1;for(var x=g;x<m;x++)i=i>>>8^y[255&(i^d[x])];return-1^i}},{}],46:[function(t,s,n){var l,i=t("../utils/common"),d=t("./trees"),u=t("./adler32"),g=t("./crc32"),y=t("./messages"),m=0,x=4,p=0,_=-2,v=-1,k=4,b=2,f=8,C=9,M=286,F=30,R=19,z=2*M+1,H=15,Y=3,se=258,W=se+Y+1,E=42,B=113,c=1,w=2,G=3,ee=4;function J(h,U){return h.msg=y[U],U}function $(h){return(h<<1)-(4<h?9:0)}function N(h){for(var U=h.length;0<=--U;)h[U]=0}function L(h){var U=h.state,Z=U.pending;Z>h.avail_out&&(Z=h.avail_out),Z!==0&&(i.arraySet(h.output,U.pending_buf,U.pending_out,Z,h.next_out),h.next_out+=Z,U.pending_out+=Z,h.total_out+=Z,h.avail_out-=Z,U.pending-=Z,U.pending===0&&(U.pending_out=0))}function O(h,U){d._tr_flush_block(h,0<=h.block_start?h.block_start:-1,h.strstart-h.block_start,U),h.block_start=h.strstart,L(h.strm)}function ne(h,U){h.pending_buf[h.pending++]=U}function T(h,U){h.pending_buf[h.pending++]=U>>>8&255,h.pending_buf[h.pending++]=255&U}function D(h,U){var Z,A,I=h.max_chain_length,X=h.strstart,K=h.prev_length,le=h.nice_match,V=h.strstart>h.w_size-W?h.strstart-(h.w_size-W):0,pe=h.window,we=h.w_mask,ge=h.prev,me=h.strstart+se,re=pe[X+K-1],j=pe[X+K];h.prev_length>=h.good_match&&(I>>=2),le>h.lookahead&&(le=h.lookahead);do if(pe[(Z=U)+K]===j&&pe[Z+K-1]===re&&pe[Z]===pe[X]&&pe[++Z]===pe[X+1]){X+=2,Z++;do;while(pe[++X]===pe[++Z]&&pe[++X]===pe[++Z]&&pe[++X]===pe[++Z]&&pe[++X]===pe[++Z]&&pe[++X]===pe[++Z]&&pe[++X]===pe[++Z]&&pe[++X]===pe[++Z]&&pe[++X]===pe[++Z]&&X<me);if(A=se-(me-X),X=me-se,K<A){if(h.match_start=U,le<=(K=A))break;re=pe[X+K-1],j=pe[X+K]}}while((U=ge[U&we])>V&&--I!=0);return K<=h.lookahead?K:h.lookahead}function oe(h){var U,Z,A,I,X,K,le,V,pe,we,ge=h.w_size;do{if(I=h.window_size-h.lookahead-h.strstart,h.strstart>=ge+(ge-W)){for(i.arraySet(h.window,h.window,ge,ge,0),h.match_start-=ge,h.strstart-=ge,h.block_start-=ge,U=Z=h.hash_size;A=h.head[--U],h.head[U]=ge<=A?A-ge:0,--Z;);for(U=Z=ge;A=h.prev[--U],h.prev[U]=ge<=A?A-ge:0,--Z;);I+=ge}if(h.strm.avail_in===0)break;if(K=h.strm,le=h.window,V=h.strstart+h.lookahead,pe=I,we=void 0,we=K.avail_in,pe<we&&(we=pe),Z=we===0?0:(K.avail_in-=we,i.arraySet(le,K.input,K.next_in,we,V),K.state.wrap===1?K.adler=u(K.adler,le,we,V):K.state.wrap===2&&(K.adler=g(K.adler,le,we,V)),K.next_in+=we,K.total_in+=we,we),h.lookahead+=Z,h.lookahead+h.insert>=Y)for(X=h.strstart-h.insert,h.ins_h=h.window[X],h.ins_h=(h.ins_h<<h.hash_shift^h.window[X+1])&h.hash_mask;h.insert&&(h.ins_h=(h.ins_h<<h.hash_shift^h.window[X+Y-1])&h.hash_mask,h.prev[X&h.w_mask]=h.head[h.ins_h],h.head[h.ins_h]=X,X++,h.insert--,!(h.lookahead+h.insert<Y)););}while(h.lookahead<W&&h.strm.avail_in!==0)}function de(h,U){for(var Z,A;;){if(h.lookahead<W){if(oe(h),h.lookahead<W&&U===m)return c;if(h.lookahead===0)break}if(Z=0,h.lookahead>=Y&&(h.ins_h=(h.ins_h<<h.hash_shift^h.window[h.strstart+Y-1])&h.hash_mask,Z=h.prev[h.strstart&h.w_mask]=h.head[h.ins_h],h.head[h.ins_h]=h.strstart),Z!==0&&h.strstart-Z<=h.w_size-W&&(h.match_length=D(h,Z)),h.match_length>=Y)if(A=d._tr_tally(h,h.strstart-h.match_start,h.match_length-Y),h.lookahead-=h.match_length,h.match_length<=h.max_lazy_match&&h.lookahead>=Y){for(h.match_length--;h.strstart++,h.ins_h=(h.ins_h<<h.hash_shift^h.window[h.strstart+Y-1])&h.hash_mask,Z=h.prev[h.strstart&h.w_mask]=h.head[h.ins_h],h.head[h.ins_h]=h.strstart,--h.match_length!=0;);h.strstart++}else h.strstart+=h.match_length,h.match_length=0,h.ins_h=h.window[h.strstart],h.ins_h=(h.ins_h<<h.hash_shift^h.window[h.strstart+1])&h.hash_mask;else A=d._tr_tally(h,0,h.window[h.strstart]),h.lookahead--,h.strstart++;if(A&&(O(h,!1),h.strm.avail_out===0))return c}return h.insert=h.strstart<Y-1?h.strstart:Y-1,U===x?(O(h,!0),h.strm.avail_out===0?G:ee):h.last_lit&&(O(h,!1),h.strm.avail_out===0)?c:w}function te(h,U){for(var Z,A,I;;){if(h.lookahead<W){if(oe(h),h.lookahead<W&&U===m)return c;if(h.lookahead===0)break}if(Z=0,h.lookahead>=Y&&(h.ins_h=(h.ins_h<<h.hash_shift^h.window[h.strstart+Y-1])&h.hash_mask,Z=h.prev[h.strstart&h.w_mask]=h.head[h.ins_h],h.head[h.ins_h]=h.strstart),h.prev_length=h.match_length,h.prev_match=h.match_start,h.match_length=Y-1,Z!==0&&h.prev_length<h.max_lazy_match&&h.strstart-Z<=h.w_size-W&&(h.match_length=D(h,Z),h.match_length<=5&&(h.strategy===1||h.match_length===Y&&4096<h.strstart-h.match_start)&&(h.match_length=Y-1)),h.prev_length>=Y&&h.match_length<=h.prev_length){for(I=h.strstart+h.lookahead-Y,A=d._tr_tally(h,h.strstart-1-h.prev_match,h.prev_length-Y),h.lookahead-=h.prev_length-1,h.prev_length-=2;++h.strstart<=I&&(h.ins_h=(h.ins_h<<h.hash_shift^h.window[h.strstart+Y-1])&h.hash_mask,Z=h.prev[h.strstart&h.w_mask]=h.head[h.ins_h],h.head[h.ins_h]=h.strstart),--h.prev_length!=0;);if(h.match_available=0,h.match_length=Y-1,h.strstart++,A&&(O(h,!1),h.strm.avail_out===0))return c}else if(h.match_available){if((A=d._tr_tally(h,0,h.window[h.strstart-1]))&&O(h,!1),h.strstart++,h.lookahead--,h.strm.avail_out===0)return c}else h.match_available=1,h.strstart++,h.lookahead--}return h.match_available&&(A=d._tr_tally(h,0,h.window[h.strstart-1]),h.match_available=0),h.insert=h.strstart<Y-1?h.strstart:Y-1,U===x?(O(h,!0),h.strm.avail_out===0?G:ee):h.last_lit&&(O(h,!1),h.strm.avail_out===0)?c:w}function ue(h,U,Z,A,I){this.good_length=h,this.max_lazy=U,this.nice_length=Z,this.max_chain=A,this.func=I}function ie(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=f,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new i.Buf16(2*z),this.dyn_dtree=new i.Buf16(2*(2*F+1)),this.bl_tree=new i.Buf16(2*(2*R+1)),N(this.dyn_ltree),N(this.dyn_dtree),N(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new i.Buf16(H+1),this.heap=new i.Buf16(2*M+1),N(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new i.Buf16(2*M+1),N(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function he(h){var U;return h&&h.state?(h.total_in=h.total_out=0,h.data_type=b,(U=h.state).pending=0,U.pending_out=0,U.wrap<0&&(U.wrap=-U.wrap),U.status=U.wrap?E:B,h.adler=U.wrap===2?0:1,U.last_flush=m,d._tr_init(U),p):J(h,_)}function Q(h){var U=he(h);return U===p&&(function(Z){Z.window_size=2*Z.w_size,N(Z.head),Z.max_lazy_match=l[Z.level].max_lazy,Z.good_match=l[Z.level].good_length,Z.nice_match=l[Z.level].nice_length,Z.max_chain_length=l[Z.level].max_chain,Z.strstart=0,Z.block_start=0,Z.lookahead=0,Z.insert=0,Z.match_length=Z.prev_length=Y-1,Z.match_available=0,Z.ins_h=0})(h.state),U}function ae(h,U,Z,A,I,X){if(!h)return _;var K=1;if(U===v&&(U=6),A<0?(K=0,A=-A):15<A&&(K=2,A-=16),I<1||C<I||Z!==f||A<8||15<A||U<0||9<U||X<0||k<X)return J(h,_);A===8&&(A=9);var le=new ie;return(h.state=le).strm=h,le.wrap=K,le.gzhead=null,le.w_bits=A,le.w_size=1<<le.w_bits,le.w_mask=le.w_size-1,le.hash_bits=I+7,le.hash_size=1<<le.hash_bits,le.hash_mask=le.hash_size-1,le.hash_shift=~~((le.hash_bits+Y-1)/Y),le.window=new i.Buf8(2*le.w_size),le.head=new i.Buf16(le.hash_size),le.prev=new i.Buf16(le.w_size),le.lit_bufsize=1<<I+6,le.pending_buf_size=4*le.lit_bufsize,le.pending_buf=new i.Buf8(le.pending_buf_size),le.d_buf=1*le.lit_bufsize,le.l_buf=3*le.lit_bufsize,le.level=U,le.strategy=X,le.method=Z,Q(h)}l=[new ue(0,0,0,0,function(h,U){var Z=65535;for(Z>h.pending_buf_size-5&&(Z=h.pending_buf_size-5);;){if(h.lookahead<=1){if(oe(h),h.lookahead===0&&U===m)return c;if(h.lookahead===0)break}h.strstart+=h.lookahead,h.lookahead=0;var A=h.block_start+Z;if((h.strstart===0||h.strstart>=A)&&(h.lookahead=h.strstart-A,h.strstart=A,O(h,!1),h.strm.avail_out===0)||h.strstart-h.block_start>=h.w_size-W&&(O(h,!1),h.strm.avail_out===0))return c}return h.insert=0,U===x?(O(h,!0),h.strm.avail_out===0?G:ee):(h.strstart>h.block_start&&(O(h,!1),h.strm.avail_out),c)}),new ue(4,4,8,4,de),new ue(4,5,16,8,de),new ue(4,6,32,32,de),new ue(4,4,16,16,te),new ue(8,16,32,32,te),new ue(8,16,128,128,te),new ue(8,32,128,256,te),new ue(32,128,258,1024,te),new ue(32,258,258,4096,te)],n.deflateInit=function(h,U){return ae(h,U,f,15,8,0)},n.deflateInit2=ae,n.deflateReset=Q,n.deflateResetKeep=he,n.deflateSetHeader=function(h,U){return h&&h.state?h.state.wrap!==2?_:(h.state.gzhead=U,p):_},n.deflate=function(h,U){var Z,A,I,X;if(!h||!h.state||5<U||U<0)return h?J(h,_):_;if(A=h.state,!h.output||!h.input&&h.avail_in!==0||A.status===666&&U!==x)return J(h,h.avail_out===0?-5:_);if(A.strm=h,Z=A.last_flush,A.last_flush=U,A.status===E)if(A.wrap===2)h.adler=0,ne(A,31),ne(A,139),ne(A,8),A.gzhead?(ne(A,(A.gzhead.text?1:0)+(A.gzhead.hcrc?2:0)+(A.gzhead.extra?4:0)+(A.gzhead.name?8:0)+(A.gzhead.comment?16:0)),ne(A,255&A.gzhead.time),ne(A,A.gzhead.time>>8&255),ne(A,A.gzhead.time>>16&255),ne(A,A.gzhead.time>>24&255),ne(A,A.level===9?2:2<=A.strategy||A.level<2?4:0),ne(A,255&A.gzhead.os),A.gzhead.extra&&A.gzhead.extra.length&&(ne(A,255&A.gzhead.extra.length),ne(A,A.gzhead.extra.length>>8&255)),A.gzhead.hcrc&&(h.adler=g(h.adler,A.pending_buf,A.pending,0)),A.gzindex=0,A.status=69):(ne(A,0),ne(A,0),ne(A,0),ne(A,0),ne(A,0),ne(A,A.level===9?2:2<=A.strategy||A.level<2?4:0),ne(A,3),A.status=B);else{var K=f+(A.w_bits-8<<4)<<8;K|=(2<=A.strategy||A.level<2?0:A.level<6?1:A.level===6?2:3)<<6,A.strstart!==0&&(K|=32),K+=31-K%31,A.status=B,T(A,K),A.strstart!==0&&(T(A,h.adler>>>16),T(A,65535&h.adler)),h.adler=1}if(A.status===69)if(A.gzhead.extra){for(I=A.pending;A.gzindex<(65535&A.gzhead.extra.length)&&(A.pending!==A.pending_buf_size||(A.gzhead.hcrc&&A.pending>I&&(h.adler=g(h.adler,A.pending_buf,A.pending-I,I)),L(h),I=A.pending,A.pending!==A.pending_buf_size));)ne(A,255&A.gzhead.extra[A.gzindex]),A.gzindex++;A.gzhead.hcrc&&A.pending>I&&(h.adler=g(h.adler,A.pending_buf,A.pending-I,I)),A.gzindex===A.gzhead.extra.length&&(A.gzindex=0,A.status=73)}else A.status=73;if(A.status===73)if(A.gzhead.name){I=A.pending;do{if(A.pending===A.pending_buf_size&&(A.gzhead.hcrc&&A.pending>I&&(h.adler=g(h.adler,A.pending_buf,A.pending-I,I)),L(h),I=A.pending,A.pending===A.pending_buf_size)){X=1;break}X=A.gzindex<A.gzhead.name.length?255&A.gzhead.name.charCodeAt(A.gzindex++):0,ne(A,X)}while(X!==0);A.gzhead.hcrc&&A.pending>I&&(h.adler=g(h.adler,A.pending_buf,A.pending-I,I)),X===0&&(A.gzindex=0,A.status=91)}else A.status=91;if(A.status===91)if(A.gzhead.comment){I=A.pending;do{if(A.pending===A.pending_buf_size&&(A.gzhead.hcrc&&A.pending>I&&(h.adler=g(h.adler,A.pending_buf,A.pending-I,I)),L(h),I=A.pending,A.pending===A.pending_buf_size)){X=1;break}X=A.gzindex<A.gzhead.comment.length?255&A.gzhead.comment.charCodeAt(A.gzindex++):0,ne(A,X)}while(X!==0);A.gzhead.hcrc&&A.pending>I&&(h.adler=g(h.adler,A.pending_buf,A.pending-I,I)),X===0&&(A.status=103)}else A.status=103;if(A.status===103&&(A.gzhead.hcrc?(A.pending+2>A.pending_buf_size&&L(h),A.pending+2<=A.pending_buf_size&&(ne(A,255&h.adler),ne(A,h.adler>>8&255),h.adler=0,A.status=B)):A.status=B),A.pending!==0){if(L(h),h.avail_out===0)return A.last_flush=-1,p}else if(h.avail_in===0&&$(U)<=$(Z)&&U!==x)return J(h,-5);if(A.status===666&&h.avail_in!==0)return J(h,-5);if(h.avail_in!==0||A.lookahead!==0||U!==m&&A.status!==666){var le=A.strategy===2?(function(V,pe){for(var we;;){if(V.lookahead===0&&(oe(V),V.lookahead===0)){if(pe===m)return c;break}if(V.match_length=0,we=d._tr_tally(V,0,V.window[V.strstart]),V.lookahead--,V.strstart++,we&&(O(V,!1),V.strm.avail_out===0))return c}return V.insert=0,pe===x?(O(V,!0),V.strm.avail_out===0?G:ee):V.last_lit&&(O(V,!1),V.strm.avail_out===0)?c:w})(A,U):A.strategy===3?(function(V,pe){for(var we,ge,me,re,j=V.window;;){if(V.lookahead<=se){if(oe(V),V.lookahead<=se&&pe===m)return c;if(V.lookahead===0)break}if(V.match_length=0,V.lookahead>=Y&&0<V.strstart&&(ge=j[me=V.strstart-1])===j[++me]&&ge===j[++me]&&ge===j[++me]){re=V.strstart+se;do;while(ge===j[++me]&&ge===j[++me]&&ge===j[++me]&&ge===j[++me]&&ge===j[++me]&&ge===j[++me]&&ge===j[++me]&&ge===j[++me]&&me<re);V.match_length=se-(re-me),V.match_length>V.lookahead&&(V.match_length=V.lookahead)}if(V.match_length>=Y?(we=d._tr_tally(V,1,V.match_length-Y),V.lookahead-=V.match_length,V.strstart+=V.match_length,V.match_length=0):(we=d._tr_tally(V,0,V.window[V.strstart]),V.lookahead--,V.strstart++),we&&(O(V,!1),V.strm.avail_out===0))return c}return V.insert=0,pe===x?(O(V,!0),V.strm.avail_out===0?G:ee):V.last_lit&&(O(V,!1),V.strm.avail_out===0)?c:w})(A,U):l[A.level].func(A,U);if(le!==G&&le!==ee||(A.status=666),le===c||le===G)return h.avail_out===0&&(A.last_flush=-1),p;if(le===w&&(U===1?d._tr_align(A):U!==5&&(d._tr_stored_block(A,0,0,!1),U===3&&(N(A.head),A.lookahead===0&&(A.strstart=0,A.block_start=0,A.insert=0))),L(h),h.avail_out===0))return A.last_flush=-1,p}return U!==x?p:A.wrap<=0?1:(A.wrap===2?(ne(A,255&h.adler),ne(A,h.adler>>8&255),ne(A,h.adler>>16&255),ne(A,h.adler>>24&255),ne(A,255&h.total_in),ne(A,h.total_in>>8&255),ne(A,h.total_in>>16&255),ne(A,h.total_in>>24&255)):(T(A,h.adler>>>16),T(A,65535&h.adler)),L(h),0<A.wrap&&(A.wrap=-A.wrap),A.pending!==0?p:1)},n.deflateEnd=function(h){var U;return h&&h.state?(U=h.state.status)!==E&&U!==69&&U!==73&&U!==91&&U!==103&&U!==B&&U!==666?J(h,_):(h.state=null,U===B?J(h,-3):p):_},n.deflateSetDictionary=function(h,U){var Z,A,I,X,K,le,V,pe,we=U.length;if(!h||!h.state||(X=(Z=h.state).wrap)===2||X===1&&Z.status!==E||Z.lookahead)return _;for(X===1&&(h.adler=u(h.adler,U,we,0)),Z.wrap=0,we>=Z.w_size&&(X===0&&(N(Z.head),Z.strstart=0,Z.block_start=0,Z.insert=0),pe=new i.Buf8(Z.w_size),i.arraySet(pe,U,we-Z.w_size,Z.w_size,0),U=pe,we=Z.w_size),K=h.avail_in,le=h.next_in,V=h.input,h.avail_in=we,h.next_in=0,h.input=U,oe(Z);Z.lookahead>=Y;){for(A=Z.strstart,I=Z.lookahead-(Y-1);Z.ins_h=(Z.ins_h<<Z.hash_shift^Z.window[A+Y-1])&Z.hash_mask,Z.prev[A&Z.w_mask]=Z.head[Z.ins_h],Z.head[Z.ins_h]=A,A++,--I;);Z.strstart=A,Z.lookahead=Y-1,oe(Z)}return Z.strstart+=Z.lookahead,Z.block_start=Z.strstart,Z.insert=Z.lookahead,Z.lookahead=0,Z.match_length=Z.prev_length=Y-1,Z.match_available=0,h.next_in=le,h.input=V,h.avail_in=K,Z.wrap=X,p},n.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(t,s,n){s.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(t,s,n){s.exports=function(l,i){var d,u,g,y,m,x,p,_,v,k,b,f,C,M,F,R,z,H,Y,se,W,E,B,c,w;d=l.state,u=l.next_in,c=l.input,g=u+(l.avail_in-5),y=l.next_out,w=l.output,m=y-(i-l.avail_out),x=y+(l.avail_out-257),p=d.dmax,_=d.wsize,v=d.whave,k=d.wnext,b=d.window,f=d.hold,C=d.bits,M=d.lencode,F=d.distcode,R=(1<<d.lenbits)-1,z=(1<<d.distbits)-1;e:do{C<15&&(f+=c[u++]<<C,C+=8,f+=c[u++]<<C,C+=8),H=M[f&R];t:for(;;){if(f>>>=Y=H>>>24,C-=Y,(Y=H>>>16&255)===0)w[y++]=65535&H;else{if(!(16&Y)){if((64&Y)==0){H=M[(65535&H)+(f&(1<<Y)-1)];continue t}if(32&Y){d.mode=12;break e}l.msg="invalid literal/length code",d.mode=30;break e}se=65535&H,(Y&=15)&&(C<Y&&(f+=c[u++]<<C,C+=8),se+=f&(1<<Y)-1,f>>>=Y,C-=Y),C<15&&(f+=c[u++]<<C,C+=8,f+=c[u++]<<C,C+=8),H=F[f&z];r:for(;;){if(f>>>=Y=H>>>24,C-=Y,!(16&(Y=H>>>16&255))){if((64&Y)==0){H=F[(65535&H)+(f&(1<<Y)-1)];continue r}l.msg="invalid distance code",d.mode=30;break e}if(W=65535&H,C<(Y&=15)&&(f+=c[u++]<<C,(C+=8)<Y&&(f+=c[u++]<<C,C+=8)),p<(W+=f&(1<<Y)-1)){l.msg="invalid distance too far back",d.mode=30;break e}if(f>>>=Y,C-=Y,(Y=y-m)<W){if(v<(Y=W-Y)&&d.sane){l.msg="invalid distance too far back",d.mode=30;break e}if(B=b,(E=0)===k){if(E+=_-Y,Y<se){for(se-=Y;w[y++]=b[E++],--Y;);E=y-W,B=w}}else if(k<Y){if(E+=_+k-Y,(Y-=k)<se){for(se-=Y;w[y++]=b[E++],--Y;);if(E=0,k<se){for(se-=Y=k;w[y++]=b[E++],--Y;);E=y-W,B=w}}}else if(E+=k-Y,Y<se){for(se-=Y;w[y++]=b[E++],--Y;);E=y-W,B=w}for(;2<se;)w[y++]=B[E++],w[y++]=B[E++],w[y++]=B[E++],se-=3;se&&(w[y++]=B[E++],1<se&&(w[y++]=B[E++]))}else{for(E=y-W;w[y++]=w[E++],w[y++]=w[E++],w[y++]=w[E++],2<(se-=3););se&&(w[y++]=w[E++],1<se&&(w[y++]=w[E++]))}break}}break}}while(u<g&&y<x);u-=se=C>>3,f&=(1<<(C-=se<<3))-1,l.next_in=u,l.next_out=y,l.avail_in=u<g?g-u+5:5-(u-g),l.avail_out=y<x?x-y+257:257-(y-x),d.hold=f,d.bits=C}},{}],49:[function(t,s,n){var l=t("../utils/common"),i=t("./adler32"),d=t("./crc32"),u=t("./inffast"),g=t("./inftrees"),y=1,m=2,x=0,p=-2,_=1,v=852,k=592;function b(E){return(E>>>24&255)+(E>>>8&65280)+((65280&E)<<8)+((255&E)<<24)}function f(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new l.Buf16(320),this.work=new l.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function C(E){var B;return E&&E.state?(B=E.state,E.total_in=E.total_out=B.total=0,E.msg="",B.wrap&&(E.adler=1&B.wrap),B.mode=_,B.last=0,B.havedict=0,B.dmax=32768,B.head=null,B.hold=0,B.bits=0,B.lencode=B.lendyn=new l.Buf32(v),B.distcode=B.distdyn=new l.Buf32(k),B.sane=1,B.back=-1,x):p}function M(E){var B;return E&&E.state?((B=E.state).wsize=0,B.whave=0,B.wnext=0,C(E)):p}function F(E,B){var c,w;return E&&E.state?(w=E.state,B<0?(c=0,B=-B):(c=1+(B>>4),B<48&&(B&=15)),B&&(B<8||15<B)?p:(w.window!==null&&w.wbits!==B&&(w.window=null),w.wrap=c,w.wbits=B,M(E))):p}function R(E,B){var c,w;return E?(w=new f,(E.state=w).window=null,(c=F(E,B))!==x&&(E.state=null),c):p}var z,H,Y=!0;function se(E){if(Y){var B;for(z=new l.Buf32(512),H=new l.Buf32(32),B=0;B<144;)E.lens[B++]=8;for(;B<256;)E.lens[B++]=9;for(;B<280;)E.lens[B++]=7;for(;B<288;)E.lens[B++]=8;for(g(y,E.lens,0,288,z,0,E.work,{bits:9}),B=0;B<32;)E.lens[B++]=5;g(m,E.lens,0,32,H,0,E.work,{bits:5}),Y=!1}E.lencode=z,E.lenbits=9,E.distcode=H,E.distbits=5}function W(E,B,c,w){var G,ee=E.state;return ee.window===null&&(ee.wsize=1<<ee.wbits,ee.wnext=0,ee.whave=0,ee.window=new l.Buf8(ee.wsize)),w>=ee.wsize?(l.arraySet(ee.window,B,c-ee.wsize,ee.wsize,0),ee.wnext=0,ee.whave=ee.wsize):(w<(G=ee.wsize-ee.wnext)&&(G=w),l.arraySet(ee.window,B,c-w,G,ee.wnext),(w-=G)?(l.arraySet(ee.window,B,c-w,w,0),ee.wnext=w,ee.whave=ee.wsize):(ee.wnext+=G,ee.wnext===ee.wsize&&(ee.wnext=0),ee.whave<ee.wsize&&(ee.whave+=G))),0}n.inflateReset=M,n.inflateReset2=F,n.inflateResetKeep=C,n.inflateInit=function(E){return R(E,15)},n.inflateInit2=R,n.inflate=function(E,B){var c,w,G,ee,J,$,N,L,O,ne,T,D,oe,de,te,ue,ie,he,Q,ae,h,U,Z,A,I=0,X=new l.Buf8(4),K=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!E||!E.state||!E.output||!E.input&&E.avail_in!==0)return p;(c=E.state).mode===12&&(c.mode=13),J=E.next_out,G=E.output,N=E.avail_out,ee=E.next_in,w=E.input,$=E.avail_in,L=c.hold,O=c.bits,ne=$,T=N,U=x;e:for(;;)switch(c.mode){case _:if(c.wrap===0){c.mode=13;break}for(;O<16;){if($===0)break e;$--,L+=w[ee++]<<O,O+=8}if(2&c.wrap&&L===35615){X[c.check=0]=255&L,X[1]=L>>>8&255,c.check=d(c.check,X,2,0),O=L=0,c.mode=2;break}if(c.flags=0,c.head&&(c.head.done=!1),!(1&c.wrap)||(((255&L)<<8)+(L>>8))%31){E.msg="incorrect header check",c.mode=30;break}if((15&L)!=8){E.msg="unknown compression method",c.mode=30;break}if(O-=4,h=8+(15&(L>>>=4)),c.wbits===0)c.wbits=h;else if(h>c.wbits){E.msg="invalid window size",c.mode=30;break}c.dmax=1<<h,E.adler=c.check=1,c.mode=512&L?10:12,O=L=0;break;case 2:for(;O<16;){if($===0)break e;$--,L+=w[ee++]<<O,O+=8}if(c.flags=L,(255&c.flags)!=8){E.msg="unknown compression method",c.mode=30;break}if(57344&c.flags){E.msg="unknown header flags set",c.mode=30;break}c.head&&(c.head.text=L>>8&1),512&c.flags&&(X[0]=255&L,X[1]=L>>>8&255,c.check=d(c.check,X,2,0)),O=L=0,c.mode=3;case 3:for(;O<32;){if($===0)break e;$--,L+=w[ee++]<<O,O+=8}c.head&&(c.head.time=L),512&c.flags&&(X[0]=255&L,X[1]=L>>>8&255,X[2]=L>>>16&255,X[3]=L>>>24&255,c.check=d(c.check,X,4,0)),O=L=0,c.mode=4;case 4:for(;O<16;){if($===0)break e;$--,L+=w[ee++]<<O,O+=8}c.head&&(c.head.xflags=255&L,c.head.os=L>>8),512&c.flags&&(X[0]=255&L,X[1]=L>>>8&255,c.check=d(c.check,X,2,0)),O=L=0,c.mode=5;case 5:if(1024&c.flags){for(;O<16;){if($===0)break e;$--,L+=w[ee++]<<O,O+=8}c.length=L,c.head&&(c.head.extra_len=L),512&c.flags&&(X[0]=255&L,X[1]=L>>>8&255,c.check=d(c.check,X,2,0)),O=L=0}else c.head&&(c.head.extra=null);c.mode=6;case 6:if(1024&c.flags&&($<(D=c.length)&&(D=$),D&&(c.head&&(h=c.head.extra_len-c.length,c.head.extra||(c.head.extra=new Array(c.head.extra_len)),l.arraySet(c.head.extra,w,ee,D,h)),512&c.flags&&(c.check=d(c.check,w,D,ee)),$-=D,ee+=D,c.length-=D),c.length))break e;c.length=0,c.mode=7;case 7:if(2048&c.flags){if($===0)break e;for(D=0;h=w[ee+D++],c.head&&h&&c.length<65536&&(c.head.name+=String.fromCharCode(h)),h&&D<$;);if(512&c.flags&&(c.check=d(c.check,w,D,ee)),$-=D,ee+=D,h)break e}else c.head&&(c.head.name=null);c.length=0,c.mode=8;case 8:if(4096&c.flags){if($===0)break e;for(D=0;h=w[ee+D++],c.head&&h&&c.length<65536&&(c.head.comment+=String.fromCharCode(h)),h&&D<$;);if(512&c.flags&&(c.check=d(c.check,w,D,ee)),$-=D,ee+=D,h)break e}else c.head&&(c.head.comment=null);c.mode=9;case 9:if(512&c.flags){for(;O<16;){if($===0)break e;$--,L+=w[ee++]<<O,O+=8}if(L!==(65535&c.check)){E.msg="header crc mismatch",c.mode=30;break}O=L=0}c.head&&(c.head.hcrc=c.flags>>9&1,c.head.done=!0),E.adler=c.check=0,c.mode=12;break;case 10:for(;O<32;){if($===0)break e;$--,L+=w[ee++]<<O,O+=8}E.adler=c.check=b(L),O=L=0,c.mode=11;case 11:if(c.havedict===0)return E.next_out=J,E.avail_out=N,E.next_in=ee,E.avail_in=$,c.hold=L,c.bits=O,2;E.adler=c.check=1,c.mode=12;case 12:if(B===5||B===6)break e;case 13:if(c.last){L>>>=7&O,O-=7&O,c.mode=27;break}for(;O<3;){if($===0)break e;$--,L+=w[ee++]<<O,O+=8}switch(c.last=1&L,O-=1,3&(L>>>=1)){case 0:c.mode=14;break;case 1:if(se(c),c.mode=20,B!==6)break;L>>>=2,O-=2;break e;case 2:c.mode=17;break;case 3:E.msg="invalid block type",c.mode=30}L>>>=2,O-=2;break;case 14:for(L>>>=7&O,O-=7&O;O<32;){if($===0)break e;$--,L+=w[ee++]<<O,O+=8}if((65535&L)!=(L>>>16^65535)){E.msg="invalid stored block lengths",c.mode=30;break}if(c.length=65535&L,O=L=0,c.mode=15,B===6)break e;case 15:c.mode=16;case 16:if(D=c.length){if($<D&&(D=$),N<D&&(D=N),D===0)break e;l.arraySet(G,w,ee,D,J),$-=D,ee+=D,N-=D,J+=D,c.length-=D;break}c.mode=12;break;case 17:for(;O<14;){if($===0)break e;$--,L+=w[ee++]<<O,O+=8}if(c.nlen=257+(31&L),L>>>=5,O-=5,c.ndist=1+(31&L),L>>>=5,O-=5,c.ncode=4+(15&L),L>>>=4,O-=4,286<c.nlen||30<c.ndist){E.msg="too many length or distance symbols",c.mode=30;break}c.have=0,c.mode=18;case 18:for(;c.have<c.ncode;){for(;O<3;){if($===0)break e;$--,L+=w[ee++]<<O,O+=8}c.lens[K[c.have++]]=7&L,L>>>=3,O-=3}for(;c.have<19;)c.lens[K[c.have++]]=0;if(c.lencode=c.lendyn,c.lenbits=7,Z={bits:c.lenbits},U=g(0,c.lens,0,19,c.lencode,0,c.work,Z),c.lenbits=Z.bits,U){E.msg="invalid code lengths set",c.mode=30;break}c.have=0,c.mode=19;case 19:for(;c.have<c.nlen+c.ndist;){for(;ue=(I=c.lencode[L&(1<<c.lenbits)-1])>>>16&255,ie=65535&I,!((te=I>>>24)<=O);){if($===0)break e;$--,L+=w[ee++]<<O,O+=8}if(ie<16)L>>>=te,O-=te,c.lens[c.have++]=ie;else{if(ie===16){for(A=te+2;O<A;){if($===0)break e;$--,L+=w[ee++]<<O,O+=8}if(L>>>=te,O-=te,c.have===0){E.msg="invalid bit length repeat",c.mode=30;break}h=c.lens[c.have-1],D=3+(3&L),L>>>=2,O-=2}else if(ie===17){for(A=te+3;O<A;){if($===0)break e;$--,L+=w[ee++]<<O,O+=8}O-=te,h=0,D=3+(7&(L>>>=te)),L>>>=3,O-=3}else{for(A=te+7;O<A;){if($===0)break e;$--,L+=w[ee++]<<O,O+=8}O-=te,h=0,D=11+(127&(L>>>=te)),L>>>=7,O-=7}if(c.have+D>c.nlen+c.ndist){E.msg="invalid bit length repeat",c.mode=30;break}for(;D--;)c.lens[c.have++]=h}}if(c.mode===30)break;if(c.lens[256]===0){E.msg="invalid code -- missing end-of-block",c.mode=30;break}if(c.lenbits=9,Z={bits:c.lenbits},U=g(y,c.lens,0,c.nlen,c.lencode,0,c.work,Z),c.lenbits=Z.bits,U){E.msg="invalid literal/lengths set",c.mode=30;break}if(c.distbits=6,c.distcode=c.distdyn,Z={bits:c.distbits},U=g(m,c.lens,c.nlen,c.ndist,c.distcode,0,c.work,Z),c.distbits=Z.bits,U){E.msg="invalid distances set",c.mode=30;break}if(c.mode=20,B===6)break e;case 20:c.mode=21;case 21:if(6<=$&&258<=N){E.next_out=J,E.avail_out=N,E.next_in=ee,E.avail_in=$,c.hold=L,c.bits=O,u(E,T),J=E.next_out,G=E.output,N=E.avail_out,ee=E.next_in,w=E.input,$=E.avail_in,L=c.hold,O=c.bits,c.mode===12&&(c.back=-1);break}for(c.back=0;ue=(I=c.lencode[L&(1<<c.lenbits)-1])>>>16&255,ie=65535&I,!((te=I>>>24)<=O);){if($===0)break e;$--,L+=w[ee++]<<O,O+=8}if(ue&&(240&ue)==0){for(he=te,Q=ue,ae=ie;ue=(I=c.lencode[ae+((L&(1<<he+Q)-1)>>he)])>>>16&255,ie=65535&I,!(he+(te=I>>>24)<=O);){if($===0)break e;$--,L+=w[ee++]<<O,O+=8}L>>>=he,O-=he,c.back+=he}if(L>>>=te,O-=te,c.back+=te,c.length=ie,ue===0){c.mode=26;break}if(32&ue){c.back=-1,c.mode=12;break}if(64&ue){E.msg="invalid literal/length code",c.mode=30;break}c.extra=15&ue,c.mode=22;case 22:if(c.extra){for(A=c.extra;O<A;){if($===0)break e;$--,L+=w[ee++]<<O,O+=8}c.length+=L&(1<<c.extra)-1,L>>>=c.extra,O-=c.extra,c.back+=c.extra}c.was=c.length,c.mode=23;case 23:for(;ue=(I=c.distcode[L&(1<<c.distbits)-1])>>>16&255,ie=65535&I,!((te=I>>>24)<=O);){if($===0)break e;$--,L+=w[ee++]<<O,O+=8}if((240&ue)==0){for(he=te,Q=ue,ae=ie;ue=(I=c.distcode[ae+((L&(1<<he+Q)-1)>>he)])>>>16&255,ie=65535&I,!(he+(te=I>>>24)<=O);){if($===0)break e;$--,L+=w[ee++]<<O,O+=8}L>>>=he,O-=he,c.back+=he}if(L>>>=te,O-=te,c.back+=te,64&ue){E.msg="invalid distance code",c.mode=30;break}c.offset=ie,c.extra=15&ue,c.mode=24;case 24:if(c.extra){for(A=c.extra;O<A;){if($===0)break e;$--,L+=w[ee++]<<O,O+=8}c.offset+=L&(1<<c.extra)-1,L>>>=c.extra,O-=c.extra,c.back+=c.extra}if(c.offset>c.dmax){E.msg="invalid distance too far back",c.mode=30;break}c.mode=25;case 25:if(N===0)break e;if(D=T-N,c.offset>D){if((D=c.offset-D)>c.whave&&c.sane){E.msg="invalid distance too far back",c.mode=30;break}oe=D>c.wnext?(D-=c.wnext,c.wsize-D):c.wnext-D,D>c.length&&(D=c.length),de=c.window}else de=G,oe=J-c.offset,D=c.length;for(N<D&&(D=N),N-=D,c.length-=D;G[J++]=de[oe++],--D;);c.length===0&&(c.mode=21);break;case 26:if(N===0)break e;G[J++]=c.length,N--,c.mode=21;break;case 27:if(c.wrap){for(;O<32;){if($===0)break e;$--,L|=w[ee++]<<O,O+=8}if(T-=N,E.total_out+=T,c.total+=T,T&&(E.adler=c.check=c.flags?d(c.check,G,T,J-T):i(c.check,G,T,J-T)),T=N,(c.flags?L:b(L))!==c.check){E.msg="incorrect data check",c.mode=30;break}O=L=0}c.mode=28;case 28:if(c.wrap&&c.flags){for(;O<32;){if($===0)break e;$--,L+=w[ee++]<<O,O+=8}if(L!==(4294967295&c.total)){E.msg="incorrect length check",c.mode=30;break}O=L=0}c.mode=29;case 29:U=1;break e;case 30:U=-3;break e;case 31:return-4;case 32:default:return p}return E.next_out=J,E.avail_out=N,E.next_in=ee,E.avail_in=$,c.hold=L,c.bits=O,(c.wsize||T!==E.avail_out&&c.mode<30&&(c.mode<27||B!==4))&&W(E,E.output,E.next_out,T-E.avail_out)?(c.mode=31,-4):(ne-=E.avail_in,T-=E.avail_out,E.total_in+=ne,E.total_out+=T,c.total+=T,c.wrap&&T&&(E.adler=c.check=c.flags?d(c.check,G,T,E.next_out-T):i(c.check,G,T,E.next_out-T)),E.data_type=c.bits+(c.last?64:0)+(c.mode===12?128:0)+(c.mode===20||c.mode===15?256:0),(ne==0&&T===0||B===4)&&U===x&&(U=-5),U)},n.inflateEnd=function(E){if(!E||!E.state)return p;var B=E.state;return B.window&&(B.window=null),E.state=null,x},n.inflateGetHeader=function(E,B){var c;return E&&E.state?(2&(c=E.state).wrap)==0?p:((c.head=B).done=!1,x):p},n.inflateSetDictionary=function(E,B){var c,w=B.length;return E&&E.state?(c=E.state).wrap!==0&&c.mode!==11?p:c.mode===11&&i(1,B,w,0)!==c.check?-3:W(E,B,w,w)?(c.mode=31,-4):(c.havedict=1,x):p},n.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(t,s,n){var l=t("../utils/common"),i=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],d=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],u=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],g=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];s.exports=function(y,m,x,p,_,v,k,b){var f,C,M,F,R,z,H,Y,se,W=b.bits,E=0,B=0,c=0,w=0,G=0,ee=0,J=0,$=0,N=0,L=0,O=null,ne=0,T=new l.Buf16(16),D=new l.Buf16(16),oe=null,de=0;for(E=0;E<=15;E++)T[E]=0;for(B=0;B<p;B++)T[m[x+B]]++;for(G=W,w=15;1<=w&&T[w]===0;w--);if(w<G&&(G=w),w===0)return _[v++]=20971520,_[v++]=20971520,b.bits=1,0;for(c=1;c<w&&T[c]===0;c++);for(G<c&&(G=c),E=$=1;E<=15;E++)if($<<=1,($-=T[E])<0)return-1;if(0<$&&(y===0||w!==1))return-1;for(D[1]=0,E=1;E<15;E++)D[E+1]=D[E]+T[E];for(B=0;B<p;B++)m[x+B]!==0&&(k[D[m[x+B]]++]=B);if(z=y===0?(O=oe=k,19):y===1?(O=i,ne-=257,oe=d,de-=257,256):(O=u,oe=g,-1),E=c,R=v,J=B=L=0,M=-1,F=(N=1<<(ee=G))-1,y===1&&852<N||y===2&&592<N)return 1;for(;;){for(H=E-J,se=k[B]<z?(Y=0,k[B]):k[B]>z?(Y=oe[de+k[B]],O[ne+k[B]]):(Y=96,0),f=1<<E-J,c=C=1<<ee;_[R+(L>>J)+(C-=f)]=H<<24|Y<<16|se|0,C!==0;);for(f=1<<E-1;L&f;)f>>=1;if(f!==0?(L&=f-1,L+=f):L=0,B++,--T[E]==0){if(E===w)break;E=m[x+k[B]]}if(G<E&&(L&F)!==M){for(J===0&&(J=G),R+=c,$=1<<(ee=E-J);ee+J<w&&!(($-=T[ee+J])<=0);)ee++,$<<=1;if(N+=1<<ee,y===1&&852<N||y===2&&592<N)return 1;_[M=L&F]=G<<24|ee<<16|R-v|0}}return L!==0&&(_[R+L]=E-J<<24|64<<16|0),b.bits=G,0}},{"../utils/common":41}],51:[function(t,s,n){s.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(t,s,n){var l=t("../utils/common"),i=0,d=1;function u(I){for(var X=I.length;0<=--X;)I[X]=0}var g=0,y=29,m=256,x=m+1+y,p=30,_=19,v=2*x+1,k=15,b=16,f=7,C=256,M=16,F=17,R=18,z=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],H=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],Y=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],se=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],W=new Array(2*(x+2));u(W);var E=new Array(2*p);u(E);var B=new Array(512);u(B);var c=new Array(256);u(c);var w=new Array(y);u(w);var G,ee,J,$=new Array(p);function N(I,X,K,le,V){this.static_tree=I,this.extra_bits=X,this.extra_base=K,this.elems=le,this.max_length=V,this.has_stree=I&&I.length}function L(I,X){this.dyn_tree=I,this.max_code=0,this.stat_desc=X}function O(I){return I<256?B[I]:B[256+(I>>>7)]}function ne(I,X){I.pending_buf[I.pending++]=255&X,I.pending_buf[I.pending++]=X>>>8&255}function T(I,X,K){I.bi_valid>b-K?(I.bi_buf|=X<<I.bi_valid&65535,ne(I,I.bi_buf),I.bi_buf=X>>b-I.bi_valid,I.bi_valid+=K-b):(I.bi_buf|=X<<I.bi_valid&65535,I.bi_valid+=K)}function D(I,X,K){T(I,K[2*X],K[2*X+1])}function oe(I,X){for(var K=0;K|=1&I,I>>>=1,K<<=1,0<--X;);return K>>>1}function de(I,X,K){var le,V,pe=new Array(k+1),we=0;for(le=1;le<=k;le++)pe[le]=we=we+K[le-1]<<1;for(V=0;V<=X;V++){var ge=I[2*V+1];ge!==0&&(I[2*V]=oe(pe[ge]++,ge))}}function te(I){var X;for(X=0;X<x;X++)I.dyn_ltree[2*X]=0;for(X=0;X<p;X++)I.dyn_dtree[2*X]=0;for(X=0;X<_;X++)I.bl_tree[2*X]=0;I.dyn_ltree[2*C]=1,I.opt_len=I.static_len=0,I.last_lit=I.matches=0}function ue(I){8<I.bi_valid?ne(I,I.bi_buf):0<I.bi_valid&&(I.pending_buf[I.pending++]=I.bi_buf),I.bi_buf=0,I.bi_valid=0}function ie(I,X,K,le){var V=2*X,pe=2*K;return I[V]<I[pe]||I[V]===I[pe]&&le[X]<=le[K]}function he(I,X,K){for(var le=I.heap[K],V=K<<1;V<=I.heap_len&&(V<I.heap_len&&ie(X,I.heap[V+1],I.heap[V],I.depth)&&V++,!ie(X,le,I.heap[V],I.depth));)I.heap[K]=I.heap[V],K=V,V<<=1;I.heap[K]=le}function Q(I,X,K){var le,V,pe,we,ge=0;if(I.last_lit!==0)for(;le=I.pending_buf[I.d_buf+2*ge]<<8|I.pending_buf[I.d_buf+2*ge+1],V=I.pending_buf[I.l_buf+ge],ge++,le===0?D(I,V,X):(D(I,(pe=c[V])+m+1,X),(we=z[pe])!==0&&T(I,V-=w[pe],we),D(I,pe=O(--le),K),(we=H[pe])!==0&&T(I,le-=$[pe],we)),ge<I.last_lit;);D(I,C,X)}function ae(I,X){var K,le,V,pe=X.dyn_tree,we=X.stat_desc.static_tree,ge=X.stat_desc.has_stree,me=X.stat_desc.elems,re=-1;for(I.heap_len=0,I.heap_max=v,K=0;K<me;K++)pe[2*K]!==0?(I.heap[++I.heap_len]=re=K,I.depth[K]=0):pe[2*K+1]=0;for(;I.heap_len<2;)pe[2*(V=I.heap[++I.heap_len]=re<2?++re:0)]=1,I.depth[V]=0,I.opt_len--,ge&&(I.static_len-=we[2*V+1]);for(X.max_code=re,K=I.heap_len>>1;1<=K;K--)he(I,pe,K);for(V=me;K=I.heap[1],I.heap[1]=I.heap[I.heap_len--],he(I,pe,1),le=I.heap[1],I.heap[--I.heap_max]=K,I.heap[--I.heap_max]=le,pe[2*V]=pe[2*K]+pe[2*le],I.depth[V]=(I.depth[K]>=I.depth[le]?I.depth[K]:I.depth[le])+1,pe[2*K+1]=pe[2*le+1]=V,I.heap[1]=V++,he(I,pe,1),2<=I.heap_len;);I.heap[--I.heap_max]=I.heap[1],(function(j,be){var ze,Oe,He,Ie,Fe,ot,Ue=be.dyn_tree,rt=be.max_code,dt=be.stat_desc.static_tree,Ge=be.stat_desc.has_stree,kt=be.stat_desc.extra_bits,Io=be.stat_desc.extra_base,St=be.stat_desc.max_length,Ot=0;for(Ie=0;Ie<=k;Ie++)j.bl_count[Ie]=0;for(Ue[2*j.heap[j.heap_max]+1]=0,ze=j.heap_max+1;ze<v;ze++)St<(Ie=Ue[2*Ue[2*(Oe=j.heap[ze])+1]+1]+1)&&(Ie=St,Ot++),Ue[2*Oe+1]=Ie,rt<Oe||(j.bl_count[Ie]++,Fe=0,Io<=Oe&&(Fe=kt[Oe-Io]),ot=Ue[2*Oe],j.opt_len+=ot*(Ie+Fe),Ge&&(j.static_len+=ot*(dt[2*Oe+1]+Fe)));if(Ot!==0){do{for(Ie=St-1;j.bl_count[Ie]===0;)Ie--;j.bl_count[Ie]--,j.bl_count[Ie+1]+=2,j.bl_count[St]--,Ot-=2}while(0<Ot);for(Ie=St;Ie!==0;Ie--)for(Oe=j.bl_count[Ie];Oe!==0;)rt<(He=j.heap[--ze])||(Ue[2*He+1]!==Ie&&(j.opt_len+=(Ie-Ue[2*He+1])*Ue[2*He],Ue[2*He+1]=Ie),Oe--)}})(I,X),de(pe,re,I.bl_count)}function h(I,X,K){var le,V,pe=-1,we=X[1],ge=0,me=7,re=4;for(we===0&&(me=138,re=3),X[2*(K+1)+1]=65535,le=0;le<=K;le++)V=we,we=X[2*(le+1)+1],++ge<me&&V===we||(ge<re?I.bl_tree[2*V]+=ge:V!==0?(V!==pe&&I.bl_tree[2*V]++,I.bl_tree[2*M]++):ge<=10?I.bl_tree[2*F]++:I.bl_tree[2*R]++,pe=V,re=(ge=0)===we?(me=138,3):V===we?(me=6,3):(me=7,4))}function U(I,X,K){var le,V,pe=-1,we=X[1],ge=0,me=7,re=4;for(we===0&&(me=138,re=3),le=0;le<=K;le++)if(V=we,we=X[2*(le+1)+1],!(++ge<me&&V===we)){if(ge<re)for(;D(I,V,I.bl_tree),--ge!=0;);else V!==0?(V!==pe&&(D(I,V,I.bl_tree),ge--),D(I,M,I.bl_tree),T(I,ge-3,2)):ge<=10?(D(I,F,I.bl_tree),T(I,ge-3,3)):(D(I,R,I.bl_tree),T(I,ge-11,7));pe=V,re=(ge=0)===we?(me=138,3):V===we?(me=6,3):(me=7,4)}}u($);var Z=!1;function A(I,X,K,le){T(I,(g<<1)+(le?1:0),3),(function(V,pe,we,ge){ue(V),ne(V,we),ne(V,~we),l.arraySet(V.pending_buf,V.window,pe,we,V.pending),V.pending+=we})(I,X,K)}n._tr_init=function(I){Z||((function(){var X,K,le,V,pe,we=new Array(k+1);for(V=le=0;V<y-1;V++)for(w[V]=le,X=0;X<1<<z[V];X++)c[le++]=V;for(c[le-1]=V,V=pe=0;V<16;V++)for($[V]=pe,X=0;X<1<<H[V];X++)B[pe++]=V;for(pe>>=7;V<p;V++)for($[V]=pe<<7,X=0;X<1<<H[V]-7;X++)B[256+pe++]=V;for(K=0;K<=k;K++)we[K]=0;for(X=0;X<=143;)W[2*X+1]=8,X++,we[8]++;for(;X<=255;)W[2*X+1]=9,X++,we[9]++;for(;X<=279;)W[2*X+1]=7,X++,we[7]++;for(;X<=287;)W[2*X+1]=8,X++,we[8]++;for(de(W,x+1,we),X=0;X<p;X++)E[2*X+1]=5,E[2*X]=oe(X,5);G=new N(W,z,m+1,x,k),ee=new N(E,H,0,p,k),J=new N(new Array(0),Y,0,_,f)})(),Z=!0),I.l_desc=new L(I.dyn_ltree,G),I.d_desc=new L(I.dyn_dtree,ee),I.bl_desc=new L(I.bl_tree,J),I.bi_buf=0,I.bi_valid=0,te(I)},n._tr_stored_block=A,n._tr_flush_block=function(I,X,K,le){var V,pe,we=0;0<I.level?(I.strm.data_type===2&&(I.strm.data_type=(function(ge){var me,re=4093624447;for(me=0;me<=31;me++,re>>>=1)if(1&re&&ge.dyn_ltree[2*me]!==0)return i;if(ge.dyn_ltree[18]!==0||ge.dyn_ltree[20]!==0||ge.dyn_ltree[26]!==0)return d;for(me=32;me<m;me++)if(ge.dyn_ltree[2*me]!==0)return d;return i})(I)),ae(I,I.l_desc),ae(I,I.d_desc),we=(function(ge){var me;for(h(ge,ge.dyn_ltree,ge.l_desc.max_code),h(ge,ge.dyn_dtree,ge.d_desc.max_code),ae(ge,ge.bl_desc),me=_-1;3<=me&&ge.bl_tree[2*se[me]+1]===0;me--);return ge.opt_len+=3*(me+1)+5+5+4,me})(I),V=I.opt_len+3+7>>>3,(pe=I.static_len+3+7>>>3)<=V&&(V=pe)):V=pe=K+5,K+4<=V&&X!==-1?A(I,X,K,le):I.strategy===4||pe===V?(T(I,2+(le?1:0),3),Q(I,W,E)):(T(I,4+(le?1:0),3),(function(ge,me,re,j){var be;for(T(ge,me-257,5),T(ge,re-1,5),T(ge,j-4,4),be=0;be<j;be++)T(ge,ge.bl_tree[2*se[be]+1],3);U(ge,ge.dyn_ltree,me-1),U(ge,ge.dyn_dtree,re-1)})(I,I.l_desc.max_code+1,I.d_desc.max_code+1,we+1),Q(I,I.dyn_ltree,I.dyn_dtree)),te(I),le&&ue(I)},n._tr_tally=function(I,X,K){return I.pending_buf[I.d_buf+2*I.last_lit]=X>>>8&255,I.pending_buf[I.d_buf+2*I.last_lit+1]=255&X,I.pending_buf[I.l_buf+I.last_lit]=255&K,I.last_lit++,X===0?I.dyn_ltree[2*K]++:(I.matches++,X--,I.dyn_ltree[2*(c[K]+m+1)]++,I.dyn_dtree[2*O(X)]++),I.last_lit===I.lit_bufsize-1},n._tr_align=function(I){T(I,2,3),D(I,C,W),(function(X){X.bi_valid===16?(ne(X,X.bi_buf),X.bi_buf=0,X.bi_valid=0):8<=X.bi_valid&&(X.pending_buf[X.pending++]=255&X.bi_buf,X.bi_buf>>=8,X.bi_valid-=8)})(I)}},{"../utils/common":41}],53:[function(t,s,n){s.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(t,s,n){(function(l){(function(i,d){if(!i.setImmediate){var u,g,y,m,x=1,p={},_=!1,v=i.document,k=Object.getPrototypeOf&&Object.getPrototypeOf(i);k=k&&k.setTimeout?k:i,u={}.toString.call(i.process)==="[object process]"?function(M){process.nextTick(function(){f(M)})}:(function(){if(i.postMessage&&!i.importScripts){var M=!0,F=i.onmessage;return i.onmessage=function(){M=!1},i.postMessage("","*"),i.onmessage=F,M}})()?(m="setImmediate$"+Math.random()+"$",i.addEventListener?i.addEventListener("message",C,!1):i.attachEvent("onmessage",C),function(M){i.postMessage(m+M,"*")}):i.MessageChannel?((y=new MessageChannel).port1.onmessage=function(M){f(M.data)},function(M){y.port2.postMessage(M)}):v&&"onreadystatechange"in v.createElement("script")?(g=v.documentElement,function(M){var F=v.createElement("script");F.onreadystatechange=function(){f(M),F.onreadystatechange=null,g.removeChild(F),F=null},g.appendChild(F)}):function(M){setTimeout(f,0,M)},k.setImmediate=function(M){typeof M!="function"&&(M=new Function(""+M));for(var F=new Array(arguments.length-1),R=0;R<F.length;R++)F[R]=arguments[R+1];var z={callback:M,args:F};return p[x]=z,u(x),x++},k.clearImmediate=b}function b(M){delete p[M]}function f(M){if(_)setTimeout(f,0,M);else{var F=p[M];if(F){_=!0;try{(function(R){var z=R.callback,H=R.args;switch(H.length){case 0:z();break;case 1:z(H[0]);break;case 2:z(H[0],H[1]);break;case 3:z(H[0],H[1],H[2]);break;default:z.apply(d,H)}})(F)}finally{b(M),_=!1}}}}function C(M){M.source===i&&typeof M.data=="string"&&M.data.indexOf(m)===0&&f(+M.data.slice(m.length))}})(typeof self>"u"?l===void 0?this:l:self)}).call(this,typeof at<"u"?at:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[10])(10)})})(no)),no.exports}var kc=_c();const Sc=bt(kc),qe={printMode:"print-designer-print-mode",preferredPrintMode:"print-designer-preferred-print-mode",silentPrint:"print-designer-silent-print",exportImageMerged:"print-designer-export-image-merged",localSettings:"print-designer-local-settings",remoteSettings:"print-designer-remote-settings",localPrintOptions:"print-designer-local-print-options",remotePrintOptions:"print-designer-remote-print-options",remoteAuthToken:"print-designer-remote-auth-token",remoteSelectedClientId:"print-designer-remote-selected-client-id"},Cc={wsAddress:"ws://localhost:1122/ws",secretKey:""},Ec={wsAddress:"ws://localhost:8080/ws/request",apiBaseUrl:"http://localhost:8080/api/login",username:"",password:""},Fa={printer:"",jobName:"",copies:1,intervalMs:0,pageRange:"",pageSet:"",scale:"fit",orientation:"portrait",colorMode:"color",sidesMode:"simplex",paperSize:"",trayBin:""},Ft=(r,e)=>{const t=localStorage.getItem(r);if(!t)return e;try{return{...e,...JSON.parse(t)}}catch{return e}},jt=(r,e)=>{localStorage.setItem(r,JSON.stringify(e))},Tc=r=>r.trim(),ja=r=>{const e=Tc(r);return e?/^wss?:\/\//i.test(e)?e:`ws://${e.replace(/^\/+/,"")}`:"ws://"},Na=(r,e,t)=>{if(!t)return r;try{const s=new URL(r);return s.searchParams.set(e,t),s.toString()}catch{const s=r.includes("?")?"&":"?";return`${r}${s}${encodeURIComponent(e)}=${encodeURIComponent(t)}`}};let oo=null;const $c=()=>{const r=localStorage.getItem(qe.preferredPrintMode),e=ce(r||localStorage.getItem(qe.printMode)||"browser"),t=ce(localStorage.getItem(qe.silentPrint)==="true"),s=ce(localStorage.getItem(qe.exportImageMerged)!=="false"),n=mt(Ft(qe.localSettings,Cc));if(!n.wsAddress){const K=n;if(K.host||K.port||K.path){const le=K.host||"localhost",V=K.port?`:${K.port}`:"",pe=K.path||"/ws",we=K.protocol||"ws";n.wsAddress=`${we}://${le}${V}${pe}`}}const l=mt(Ft(qe.remoteSettings,Ec));if(!l.wsAddress){const K=l;if(K.host||K.wsPort||K.wsPath){const le=K.host||"localhost",V=K.wsPort?`:${K.wsPort}`:"",pe=K.wsPath||"/ws/request";l.wsAddress=`${le}${V}${pe}`}}const i=ce("disconnected"),d=ce("disconnected"),u=ce(""),g=ce(""),y=mt(Ft(qe.localPrintOptions,Fa)),m=mt(Ft(qe.remotePrintOptions,Fa)),x=ce(localStorage.getItem(qe.remoteAuthToken)||""),p=ce(localStorage.getItem(qe.remoteSelectedClientId)||""),_=ce([]),v=ce([]),k=ce([]),b=mt({}),f=ce(null),C=ce(null),M=[],F=[];let R=null,z=null;const H=ce(0),Y=ce(0),se=ce(null),W=ce(null),E=ce(!1),B=ce(!1),c=3e3,w=10,G=ve(()=>{const K=ja(n.wsAddress);return Na(K,"key",n.secretKey.trim())}),ee=ve(()=>{const K=ja(l.wsAddress);return Na(K,"token",x.value.trim())});Ae(e,K=>{if(localStorage.setItem(qe.printMode,K),K!=="browser"){localStorage.setItem(qe.preferredPrintMode,K);return}localStorage.removeItem(qe.preferredPrintMode)}),Ae(t,K=>{localStorage.setItem(qe.silentPrint,String(K))}),Ae(s,K=>{localStorage.setItem(qe.exportImageMerged,String(K))}),Ae(n,K=>{jt(qe.localSettings,K),i.value="disconnected",u.value=""},{deep:!0}),Ae(l,K=>{jt(qe.remoteSettings,K),d.value="disconnected",g.value=""},{deep:!0}),Ae(y,K=>{jt(qe.localPrintOptions,K)},{deep:!0}),Ae(m,K=>{jt(qe.remotePrintOptions,K)},{deep:!0}),Ae(x,K=>{localStorage.setItem(qe.remoteAuthToken,K)}),Ae(p,K=>{localStorage.setItem(qe.remoteSelectedClientId,K)});const J=()=>{const K=localStorage.getItem(qe.preferredPrintMode);!K||K==="browser"||e.value==="browser"&&(K==="local"&&i.value==="connected"&&(e.value="local"),K==="remote"&&d.value==="connected"&&(e.value="remote"))},$=()=>{const K=i.value==="connected",le=d.value==="connected";if(e.value==="local"&&!K){e.value="browser";return}if(e.value==="remote"&&!le){e.value="browser";return}!K&&!le&&(e.value="browser")};Ae([i,d],()=>{$(),J()},{immediate:!0});const N=(K,le)=>{K.slice().forEach(V=>{V.match(le)&&(window.clearTimeout(V.timeoutId),K.splice(K.indexOf(V),1),V.resolve(le))})},L=(K,le)=>{K.slice().forEach(V=>{window.clearTimeout(V.timeoutId),K.splice(K.indexOf(V),1),V.reject(le)})},O=()=>{se.value&&(window.clearTimeout(se.value),se.value=null),H.value=0},ne=()=>{W.value&&(window.clearTimeout(W.value),W.value=null),Y.value=0},T=()=>{E.value=!0,O(),f.value&&f.value.close(),f.value=null,i.value="disconnected",u.value=""},D=()=>{B.value=!0,ne(),C.value&&C.value.close(),C.value=null,d.value="disconnected",g.value=""},oe=()=>{if(!E.value&&!se.value){if(H.value>=w){i.value="error",u.value="Local connection failed",H.value=0;return}H.value+=1,i.value="connecting",se.value=window.setTimeout(()=>{se.value=null,he()},c)}},de=()=>{if(!B.value&&!W.value){if(Y.value>=w){d.value="error",g.value="Remote connection failed",Y.value=0;return}Y.value+=1,d.value="connecting",W.value=window.setTimeout(()=>{W.value=null,ae()},c)}},te=(K,le,V,pe,we=5e3)=>new Promise((ge,me)=>{const re=K.value;if(!re||re.readyState!==WebSocket.OPEN){me(new Error("WebSocket not connected"));return}const j=window.setTimeout(()=>{const be=le.findIndex(ze=>ze.resolve===ge);be>=0&&le.splice(be,1),me(new Error("WebSocket timeout"))},we);le.push({match:pe,resolve:ge,reject:me,timeoutId:j}),re.send(JSON.stringify(V))}),ue=K=>{K.onmessage=le=>{try{const V=JSON.parse(le.data);(V==null?void 0:V.type)==="printer_list"&&(_.value=Array.isArray(V.data)?V.data:[]),(V==null?void 0:V.type)==="printer_caps"&&V.printer&&(b[V.printer]=(V==null?void 0:V.data)||{}),N(M,V)}catch(V){L(M,V)}},K.onclose=()=>{f.value=null,i.value!=="error"&&(i.value="disconnected"),L(M,new Error("WebSocket closed")),oe()},K.onerror=()=>{i.value="error",u.value="Local connection failed",L(M,new Error("WebSocket error")),oe()}},ie=K=>{K.onmessage=le=>{try{const V=JSON.parse(le.data);if((V==null?void 0:V.cmd)==="clients_list")if(k.value=Array.isArray(V.clients)?V.clients:[],k.value.length>0){if(!k.value.some(we=>we.client_id===p.value)){const we=k.value.find(ge=>ge.online)||k.value[0];p.value=(we==null?void 0:we.client_id)||""}}else p.value="";(V==null?void 0:V.cmd)==="printers_list"&&(v.value=Array.isArray(V.printers)?V.printers:[]),N(F,V)}catch(V){L(F,V)}},K.onclose=()=>{C.value=null,d.value!=="error"&&(d.value="disconnected"),L(F,new Error("WebSocket closed")),de()},K.onerror=()=>{d.value="error",g.value="Remote connection failed",L(F,new Error("WebSocket error")),de()}},he=async()=>{if(R)return R;if(f.value&&f.value.readyState===WebSocket.OPEN)return i.value="connected",Promise.resolve();E.value=!1,i.value="connecting",u.value="";const K=new WebSocket(G.value);return f.value=K,ue(K),R=new Promise((le,V)=>{K.addEventListener("open",()=>{i.value="connected",O(),R=null,K.send(JSON.stringify({type:"get_printers"})),le()}),K.addEventListener("error",()=>{i.value="error",u.value="Local connection failed",R=null,oe(),V(new Error("WebSocket error"))})}),R},Q=()=>{E.value=!0,O(),f.value&&f.value.close(),f.value=null,i.value="disconnected",u.value=""},ae=async()=>z||(C.value&&C.value.readyState===WebSocket.OPEN?(d.value="connected",Promise.resolve()):(B.value=!1,d.value="connecting",g.value="",z=(async()=>{try{if(!l.apiBaseUrl||!l.username||!l.password){d.value="error",g.value="Missing remote connection fields";return}const K=await fetch(l.apiBaseUrl,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:l.username,password:l.password})});if(!K.ok){const pe=await K.text();throw new Error(pe||`HTTP ${K.status}`)}const le=await K.json();if(!(le!=null&&le.token))throw new Error("Missing auth token");x.value=le.token;const V=new WebSocket(ee.value);C.value=V,ie(V),await new Promise((pe,we)=>{V.addEventListener("open",()=>{d.value="connected",ne(),V.send(JSON.stringify({cmd:"get_clients"})),pe()}),V.addEventListener("error",()=>{d.value="error",g.value="Remote connection failed",de(),we(new Error("WebSocket error"))})})}catch(K){d.value="error",g.value=K.message||"Remote connection failed",de()}finally{z=null}})(),z)),h=()=>{B.value=!0,ne(),C.value&&C.value.close(),C.value=null,d.value="disconnected",g.value=""},U=async()=>{await he();const K=await te(f,M,{type:"get_printers"},le=>(le==null?void 0:le.type)==="printer_list");return _.value=Array.isArray(K.data)?K.data:[],_.value},Z=async K=>{if(!K)return;if(b[K])return b[K];await he();const le=await te(f,M,{type:"get_printer_caps",printer:K},V=>(V==null?void 0:V.type)==="printer_caps");return b[K]=(le==null?void 0:le.data)||{},b[K]},A=async()=>{await ae();const K=await te(C,F,{cmd:"get_clients"},le=>(le==null?void 0:le.cmd)==="clients_list");if(k.value=Array.isArray(K.clients)?K.clients:[],k.value.length>0){if(!k.value.some(V=>V.client_id===p.value)){const V=k.value.find(pe=>pe.online)||k.value[0];p.value=(V==null?void 0:V.client_id)||""}}else p.value="";return k.value},I=async K=>{const le=K||p.value;if(!le)return v.value=[],v.value;await ae();const V=await te(C,F,{cmd:"get_printers",client_id:le},pe=>(pe==null?void 0:pe.cmd)==="printers_list");return v.value=Array.isArray(V.printers)?V.printers:[],v.value};return(()=>{const K=!!n.wsAddress,le=!!(l.apiBaseUrl&&l.username&&l.password);K&&he(),le&&ae()})(),{printMode:e,silentPrint:t,exportImageMerged:s,localSettings:n,remoteSettings:l,localStatus:i,remoteStatus:d,localStatusMessage:u,remoteStatusMessage:g,localRetryCount:H,remoteRetryCount:Y,localPrintOptions:y,remotePrintOptions:m,localWsUrl:G,remoteWsUrl:ee,remoteAuthToken:x,localPrinters:_,remotePrinters:v,remoteClients:k,remoteSelectedClientId:p,localPrinterCaps:b,fetchLocalPrinters:U,fetchRemoteClients:A,fetchRemotePrinters:I,fetchLocalPrinterCaps:Z,cancelLocalRetry:T,cancelRemoteRetry:D,connectLocal:he,disconnectLocal:Q,connectRemote:ae,disconnectRemote:h}},Zt=()=>(oo||(oo=$c()),oo),Ol=()=>{const r=De(),{printMode:e,localSettings:t,remoteSettings:s,localStatus:n,remoteStatus:l,localPrintOptions:i,remotePrintOptions:d,localWsUrl:u,remoteWsUrl:g,remoteSelectedClientId:y,exportImageMerged:m}=Zt(),x=T=>{const D=Ee(T),oe=r.headerHeight>0&&r.showHeaderLine,de=r.footerHeight>0&&r.showFooterLine;if(!oe&&!de)return D;const te=D[0],ue=r.canvasSize.height,ie=oe?te.elements.filter(ae=>ae.y+ae.height<=r.headerHeight):[],he=de?te.elements.filter(ae=>ae.y>=ue-r.footerHeight):[],Q=Ee(D);for(let ae=0;ae<Q.length;ae++){if(ae===0)continue;const h=Q[ae];for(const U of ie)h.elements.push({...Ee(U),id:Ne()});for(const U of he)h.elements.push({...Ee(U),id:Ne()})}return Q},p=async(T={})=>{const D=T.mutateStore!==!1,oe=T.setExporting!==!1,de=D?r.selectedElementId:null,te=D?r.showGrid:!1,ue=D?r.zoom:1,ie=D?Ee(r.pages):null,he=D?r.showHeaderLine:!1,Q=D?r.showFooterLine:!1,ae=D?r.showCornerMarkers:!1,h=oe?!!r.isExporting:!1,U=document.documentElement.style.overflowX,Z=document.body.style.overflowX;return D&&(r.selectElement(null),r.setShowGrid(!1),r.setZoom(1),r.pages=x(r.pages),r.setShowHeaderLine(!1),r.setShowFooterLine(!1),r.showCornerMarkers=!1,oe&&(r.setIsExporting(!0),document.body.classList.add("exporting"))),document.documentElement.style.overflowX="hidden",document.body.style.overflowX="hidden",!D&&oe&&(r.setIsExporting(!0),document.body.classList.add("exporting")),await Xe(),await new Promise(A=>setTimeout(A,500)),()=>{oe&&(document.body.classList.remove("exporting"),r.setIsExporting(h)),document.documentElement.style.overflowX=U,document.body.style.overflowX=Z,D&&(r.setShowGrid(te),r.selectElement(de),r.setZoom(ue),ie&&(r.pages=ie),r.setShowHeaderLine(he),r.setShowFooterLine(Q),r.showCornerMarkers=ae)}},_=T=>{T.classList.remove("group","cursor-move","select-none","ring-2","ring-blue-500","ring-red-500","hover:outline","hover:outline-1","hover:outline-blue-300");const D=[];T.classList.forEach(de=>{(de.startsWith("hover:")||de.startsWith("focus:")||de.startsWith("active:"))&&D.push(de)}),D.forEach(de=>T.classList.remove(de)),(T.style.borderColor==="transparent"||T.style.border.includes("transparent")||T.style.borderStyle==="dashed"&&(T.style.borderColor==="transparent"||!T.style.borderColor&&T.style.border.includes("transparent")))&&(T.style.border="none",T.style.outline="none",T.style.boxShadow="none"),Array.from(T.children).forEach(de=>_(de))},v={enabled:!1,text:"",angle:-30,color:"#000000",opacity:.1,size:24,density:160},k=()=>({pages:x(r.pages),canvasSize:{...r.canvasSize},canvasBackground:r.canvasBackground,headerHeight:r.headerHeight,footerHeight:r.footerHeight,showHeaderLine:r.showHeaderLine,showFooterLine:r.showFooterLine,watermark:Ee(r.watermark||v),unit:r.unit||"mm",testData:Ee(r.testData||{})}),b=(T,D,oe=1e4)=>new Promise((de,te)=>{const ue=window.location.origin,ie=window.setTimeout(()=>{window.removeEventListener("message",he),te(new Error(`Print renderer timeout: ${D}`))},oe),he=Q=>{if(Q.origin!==ue)return;const ae=Q.data;!ae||ae.type!==D||ae.token!==T||(window.clearTimeout(ie),window.removeEventListener("message",he),de(ae))};window.addEventListener("message",he)}),f=async()=>{var de;const T=Ne(),D=document.createElement("iframe");D.setAttribute("data-print-renderer","true"),D.style.cssText="position:fixed;left:0;top:0;width:0;height:0;border:0;visibility:hidden;",D.src=`${window.location.origin}${window.location.pathname}?print=1&printToken=${encodeURIComponent(T)}`,document.body.appendChild(D);const oe=()=>{D.parentNode&&D.parentNode.removeChild(D)};try{await b(T,"print-renderer-ready");const te=k();(de=D.contentWindow)==null||de.postMessage({type:"print-renderer-payload",token:T,payload:te},window.location.origin),await b(T,"print-renderer-rendered");const ue=D.contentDocument,ie=D.contentWindow;if(!ue||!ie)throw new Error("Print renderer not available");return{pages:Array.from(ue.querySelectorAll(".print-page")),cleanup:oe,getComputedStyleFn:ie.getComputedStyle.bind(ie)}}catch(te){throw oe(),te}},C=async T=>{if(typeof T=="string")return{content:T,cleanup:null,getComputedStyleFn:window.getComputedStyle};const D=await f();return{content:D.pages,cleanup:D.cleanup,getComputedStyleFn:D.getComputedStyleFn}},M=async()=>{const T=await p({mutateStore:!1,setExporting:!1}),D=r.canvasSize.width,oe=r.canvasSize.height;let de=null,te=null,ue=null;try{const ie=await C(Array.from(document.querySelectorAll(".print-page")));ue=ie.cleanup;const he=await W(ie.content,D,oe,!0,ie.getComputedStyleFn);de=he.container,te=he.tempWrapper;const Q=document.createElement("div");return Q.style.width="100%",Q.style.display="flex",Q.style.flexDirection="column",Q.style.alignItems="center",Array.from(de.children).filter(h=>!["STYLE","LINK","SCRIPT"].includes(h.tagName)).forEach((h,U)=>{const Z=h.cloneNode(!0);Z.style.position="relative",Z.style.left="auto",Z.style.top="auto",Z.style.width=`${D}px`,Z.style.height=`${oe}px`,Z.style.margin="0 0 20px 0",Z.style.backgroundColor=r.canvasBackground,Z.style.transform="none",Q.appendChild(Z)}),Q.outerHTML}finally{te&&te.parentNode&&te.parentNode.removeChild(te),ue&&ue(),T()}},F=T=>{T.querySelectorAll("svg").forEach(oe=>{const de=oe.parentElement;if(!de)return;const te=getComputedStyle(de),ue=parseFloat(te.width),ie=parseFloat(te.height),he=document.createElement("canvas");he.width=Number.isFinite(ue)?Math.max(1,Math.round(ue)):10,he.height=Number.isFinite(ie)?Math.max(1,Math.round(ie)):10;const Q=he.getContext("2d");if(!Q)return;const ae=new XMLSerializer;oe.setAttribute("width",`${ue}px`),oe.setAttribute("height",`${ie}px`);const h=ae.serializeToString(oe);Kl.fromString(Q,h).render();const Z=document.createElement("img");Z.src=he.toDataURL("image/png"),Z.style.width=`${ue}px`,Z.style.height=`${ie}px`,Z.style.display="block",oe.before(Z),de.removeChild(oe)})},R=(T,D)=>{Array.from(T.children).filter(de=>!["STYLE","LINK","SCRIPT"].includes(de.tagName)).forEach((de,te)=>{de.querySelectorAll('[data-print-type="page-number"]').forEach(ie=>{const he=ie.querySelector(".page-number-text");he&&(he.textContent=`${te+1}/${D}`)})})},z=(T,D,oe,de,te,ue,ie)=>{T.querySelectorAll("[data-print-wrapper]").forEach(Q=>{const ae=Q,h=parseFloat(ae.style.top)||0;parseFloat(ae.style.height)||ae.offsetHeight;const U=ue&&h<oe,Z=ie&&h>=te-de;if(U||Z){const A=ae.cloneNode(!0);D.appendChild(A)}})},H=T=>{const D=T.querySelector("tfoot");if(!D)return;const oe=T.getAttribute("data-custom-script");if(oe)try{const de=T.querySelector("tbody"),te=[];de&&Array.from(de.querySelectorAll("tr")).forEach(ae=>{const h={};Array.from(ae.querySelectorAll("td")).forEach(Z=>{const A=Z.getAttribute("data-field");A&&(h[A]=Z.textContent||"")}),Object.keys(h).length>0&&te.push(h)});const ue=[];Array.from(D.querySelectorAll("tr")).forEach(Q=>{const ae={};Array.from(Q.querySelectorAll("td")).forEach(U=>{const Z=U.getAttribute("data-field");Z&&(ae[Z]={value:U.getAttribute("data-value")||U.textContent||""})}),ue.push(ae)}),new Function("data","footerData","columns","type",oe)(te,ue,[],"page"),ue.length>0&&Array.from(D.querySelectorAll("tr")).forEach((ae,h)=>{ue[h]&&Array.from(ae.querySelectorAll("td")).forEach(Z=>{const A=Z.getAttribute("data-field");if(A&&ue[h][A]!==void 0){let I=ue[h][A];I&&typeof I=="object"&&(I.result!==void 0?I=I.result:I.value!==void 0&&(I=I.value)),Z.textContent=String(I)}})});return}catch(de){console.error("Page sum script error:",de)}},Y=(T,D,oe,de,te,ue)=>{let ie=Array.from(T.children).filter(he=>!["STYLE","LINK","SCRIPT"].includes(he.tagName));for(let he=0;he<ie.length;he++){const Q=ie[he];Q.querySelectorAll("table").forEach(h=>{const U=h.closest("[data-print-wrapper]");if(!U||!(h.getAttribute("data-auto-paginate")==="true"))return;U.style.height="auto",h.style.height="auto";const A=h.querySelector("tbody");A&&(A.style.height="auto");const I=h.parentElement;I&&(I.classList.remove("h-full","overflow-hidden"),I.style.height="auto",I.style.overflow="visible");const K=Q.getBoundingClientRect().top+D-de,V=U.getBoundingClientRect().top;if(h.getBoundingClientRect().bottom<=K){H(h);return}let we=-1;const ge=h.querySelector("tbody");if(!ge)return;const me=Array.from(ge.querySelectorAll("tr")),re=h.querySelector("tfoot"),j=h.getAttribute("data-tfoot-repeat")==="true";let be=0;re&&j&&(be=re.getBoundingClientRect().height);for(let ze=0;ze<me.length;ze++)if(me[ze].getBoundingClientRect().bottom+be>K+1){if(we=ze,we===0){const Ie=te&&oe>0?oe+10:r.pageSpacingY||0;V<=Ie+5&&(we=1)}break}if(we!==-1){const ze=document.createElement("div");ze.className=Q.className,ze.style.cssText=Q.style.cssText,ze.innerHTML="",z(Q,ze,oe,de,D,te,ue),he===ie.length-1?T.appendChild(ze):T.insertBefore(ze,ie[he+1]),ie=Array.from(T.children).filter(Ge=>!["STYLE","LINK","SCRIPT"].includes(Ge.tagName));const Oe=U.cloneNode(!0),He=te&&oe>0?oe+10:r.pageSpacingY||0;Oe.style.removeProperty("top"),Oe.style.setProperty("top",`${He}px`,"important");const Ie=me;for(let Ge=we;Ge<Ie.length;Ge++)Ie[Ge].remove();we===0&&U.remove();const Fe=h.querySelector("tfoot"),ot=h.getAttribute("data-tfoot-repeat")==="true";Fe&&(ot?H(h):Fe.remove());const Ue=Oe.querySelector("table");Ue.style.height="auto";const rt=Ue.querySelector("tbody");rt&&(rt.style.height="auto");const dt=Array.from(rt.querySelectorAll("tr"));for(let Ge=0;Ge<we;Ge++)dt[Ge].remove();ze.appendChild(Oe)}else H(h)})}return ie=Array.from(T.children).filter(he=>!["STYLE","LINK","SCRIPT"].includes(he.tagName)),ie.forEach((he,Q)=>{he.style.top=`${Q*D}px`}),ie.length},se=(T,D=window.getComputedStyle)=>{const oe=T.cloneNode(!0),de=[[T,oe]];for(;de.length>0;){const[te,ue]=de.shift();if(te.nodeType===1){const ie=D(te),he=ue.style;for(let Q=0;Q<ie.length;Q++){const ae=ie[Q];he.setProperty(ae,ie.getPropertyValue(ae),ie.getPropertyPriority(ae))}}for(let ie=0;ie<te.children.length;ie++)ue.children[ie]&&de.push([te.children[ie],ue.children[ie]])}return oe},W=async(T,D,oe,de=!0,te=window.getComputedStyle)=>{const ue=document.createElement("div");ue.style.position="fixed",ue.style.left="0",ue.style.top="0",ue.style.width=`${D}px`,ue.style.height=`${oe}px`,ue.style.zIndex="-9999",ue.className="print_temp_container",document.body.appendChild(ue),document.head.querySelectorAll('style, link[rel="stylesheet"]').forEach(ae=>{ue.appendChild(ae.cloneNode(!0))});let he=[];typeof T=="string"?(ue.innerHTML=T,he=Array.from(ue.children).filter(ae=>!["STYLE","LINK","SCRIPT"].includes(ae.tagName))):Array.isArray(T)?he=T:T.classList.contains("design-workspace")?he=Array.from(T.children):he=[T],he.forEach((ae,h)=>{const U=se(ae,te);U.style.position="absolute",U.style.left="0",U.style.top=`${h*oe}px`,U.style.width=`${D}px`,U.style.height=`${oe}px`,U.style.transform="none",U.style.backgroundColor=r.canvasBackground,U.querySelectorAll('[data-print-exclude="true"]').forEach(I=>I.remove()),U.querySelectorAll(".element-wrapper").forEach(I=>I.setAttribute("data-print-wrapper","true")),_(U),U.querySelectorAll("svg").forEach(I=>{const X=I.getBoundingClientRect();if(X.width===0||X.height===0){const K=I.getAttribute("width"),le=I.getAttribute("height");K&&(I.style.width=K.includes("px")?K:`${K}px`),le&&(I.style.height=le.includes("px")?le:`${le}px`)}}),ue.appendChild(U)}),await new Promise(ae=>setTimeout(ae,100)),de&&F(ue);const Q=Y(ue,oe,r.headerHeight,r.footerHeight,r.showHeaderLine,r.showFooterLine);return R(ue,Q),ue.style.height=`${oe*Q}px`,{container:ue,tempWrapper:ue,pagesCount:Q}},E=async(T,D,oe)=>{const de=Array.from(T.children).filter(he=>!["STYLE","LINK","SCRIPT"].includes(he.tagName));de.forEach(he=>{he.style.top="0px"});const te=async he=>{const Q=await xc.toCanvas(he,{scale:1.5,width:D,height:oe,useCORS:!0,bgcolor:r.canvasBackground}),ae=Q.getContext("2d");return ae&&(ae.mozImageSmoothingEnabled=!1,ae.webkitImageSmoothingEnabled=!1,ae.msImageSmoothingEnabled=!1,ae.imageSmoothingEnabled=!1),Q.toDataURL("image/jpeg",.5)},ue=3,ie=[];for(let he=0;he<de.length;he+=ue){const Q=de.slice(he,he+ue),ae=await Promise.all(Q.map(h=>te(h)));ie.push(...ae)}return ie},B=async T=>{const D=await p({mutateStore:!1,setExporting:!1}),oe=r.canvasSize.width,de=r.canvasSize.height,te=ao(oe),ue=ao(de);let ie=null,he=null;try{const Q=await C(T);he=Q.cleanup;const{container:ae,tempWrapper:h}=await W(Q.content,oe,de,!0,Q.getComputedStyleFn);ie=h;const U=new Zl({orientation:oe>de?"l":"p",unit:"mm",format:[te,ue],hotfixes:["px_scaling"]});return(await E(ae,oe,de)).forEach((A,I)=>{I>0&&U.addPage([te,ue]),U.addImage(A,"JPEG",0,0,te,ue)}),U}finally{ie&&ie.parentNode&&ie.parentNode.removeChild(ie),he&&he(),D()}},c=async(T,D="print-design.pdf")=>{try{const oe=T||Array.from(document.querySelectorAll(".print-page"));(await B(oe)).save(D)}catch(oe){console.error("Export PDF failed",oe),alert("Export PDF failed")}},w=async T=>{try{const oe=(await B(T)).output("blob"),de=URL.createObjectURL(oe);if(/Edg\//.test(navigator.userAgent)){const ie=window.open(de,"_blank","noopener,noreferrer");if(!ie){URL.revokeObjectURL(de);return}ie.addEventListener("beforeunload",()=>{URL.revokeObjectURL(de)}),ie.onload=()=>{try{ie.focus(),ie.print()}finally{setTimeout(()=>{URL.revokeObjectURL(de)},1e3)}};return}const ue=document.createElement("iframe");ue.style.position="fixed",ue.style.left="0",ue.style.top="0",ue.style.width="0px",ue.style.height="0px",ue.style.border="0",ue.style.visibility="hidden",ue.src=de,document.body.appendChild(ue),ue.onload=()=>{const ie=ue.contentWindow;ie&&(ie.focus(),setTimeout(()=>{ie.print()},100)),setTimeout(()=>{document.body.removeChild(ue),URL.revokeObjectURL(de)},1e3)}}catch(D){console.error("Print failed",D),alert("Print failed")}},G=T=>new Promise((D,oe)=>{const de=new FileReader;de.onloadend=()=>D(de.result),de.onerror=()=>oe(new Error("Failed to read PDF blob")),de.readAsDataURL(T)}),ee=(T,D,oe)=>{const de={printer:T.printer,content:D};return oe&&(de.key=oe),(T.jobName||T.copies||T.intervalMs)&&(de.job={...T.jobName?{name:T.jobName}:{},...T.copies?{copies:T.copies}:{},...T.intervalMs?{intervalMs:T.intervalMs}:{}}),(T.pageRange||T.pageSet)&&(de.pages={...T.pageRange?{range:T.pageRange}:{},...T.pageSet?{set:T.pageSet}:{}}),(T.scale||T.orientation)&&(de.layout={...T.scale?{scale:T.scale}:{},...T.orientation?{orientation:T.orientation}:{}}),T.colorMode&&(de.color={mode:T.colorMode}),T.sidesMode&&(de.sides={mode:T.sidesMode}),T.paperSize&&(de.paper={size:T.paperSize}),T.trayBin&&(de.tray={bin:T.trayBin}),de},J=(T,D,oe)=>new Promise((de,te)=>{let ue=!1;const ie=new WebSocket(T),he=window.setTimeout(()=>{ue||(ue=!0,ie.close(),te(new Error("Print request timeout")))},3e4);ie.onopen=()=>{ie.send(JSON.stringify(D))},ie.onmessage=Q=>{if(!ue)try{const ae=JSON.parse(Q.data);if(oe==="status"&&(ae.status==="success"||ae.status==="error")){ue=!0,window.clearTimeout(he),ie.close(),ae.status==="success"?de():te(new Error(ae.message||"Print failed"));return}if(oe==="task_result"&&ae.cmd==="task_result"){ue=!0,window.clearTimeout(he),ie.close(),de();return}}catch(ae){ue=!0,window.clearTimeout(he),ie.close(),te(ae instanceof Error?ae:new Error("Print failed"))}},ie.onerror=()=>{ue||(ue=!0,window.clearTimeout(he),ie.close(),te(new Error("Print connection failed")))}}),$=async(T,D)=>{const oe=(D==null?void 0:D.mode)||e.value;if(oe==="browser"){await w(T);return}if(!(oe==="local"?n.value==="connected":l.value==="connected")){await w(T);return}const te=(D==null?void 0:D.options)||(oe==="local"?i:d);if(!te.printer){alert("Printer is required");return}try{const ue=await ne(T),ie=await G(ue);if(oe==="local"){const Q=ee(te,ie,t.secretKey.trim());await J(u.value,Q,"status");return}if(!y.value){alert("Client is required");return}const he=ee(te,ie);he.cmd="submit_task",he.client_id=y.value,await J(g.value,he,"task_result")}catch(ue){console.error("Print failed",ue),alert("Print failed")}},N=async T=>{if(T.length===0)return"";const D=await new Promise((he,Q)=>{const ae=new Image;ae.onload=()=>he(ae),ae.onerror=Q,ae.src=T[0]}),oe=D.width,de=D.height,te=de*T.length,ue=document.createElement("canvas");ue.width=oe,ue.height=te;const ie=ue.getContext("2d");if(!ie)throw new Error("Could not get canvas context");ie.drawImage(D,0,0);for(let he=1;he<T.length;he++)await new Promise((Q,ae)=>{const h=new Image;h.onload=()=>{ie.drawImage(h,0,he*de),Q()},h.onerror=ae,h.src=T[he]});return ue.toDataURL("image/jpeg",.8)},L=async(T,D="print-design")=>{try{const oe=T||Array.from(document.querySelectorAll(".print-page")),de=await p({mutateStore:!1,setExporting:!1}),te=r.canvasSize.width,ue=r.canvasSize.height;let ie=null;const he=await C(oe);ie=he.cleanup;const{container:Q,tempWrapper:ae}=await W(he.content,te,ue,!0,he.getComputedStyleFn);try{const h=await E(Q,te,ue);if(h.length===0)return;if(m.value){const U=await N(h),Z=document.createElement("a");Z.href=U,Z.download=`${D}.jpg`,document.body.appendChild(Z),Z.click(),document.body.removeChild(Z)}else{const U=new Sc;await Promise.all(h.map(async(X,K)=>{const V=await(await fetch(X)).blob();U.file(`${D}-${K+1}.jpg`,V)}));const Z=await U.generateAsync({type:"blob"}),A=URL.createObjectURL(Z),I=document.createElement("a");I.href=A,I.download=`${D}.zip`,document.body.appendChild(I),I.click(),document.body.removeChild(I),URL.revokeObjectURL(A)}}finally{ae&&ae.parentNode&&ae.parentNode.removeChild(ae),ie&&ie(),de()}}catch(oe){console.error("Export Images failed",oe),alert("Export Images failed")}},O=async T=>{try{const D=T||Array.from(document.querySelectorAll(".print-page")),oe=await p({mutateStore:!1,setExporting:!1}),de=r.canvasSize.width,te=r.canvasSize.height;let ue=null;const ie=await C(D);ue=ie.cleanup;const{container:he,tempWrapper:Q}=await W(ie.content,de,te,!0,ie.getComputedStyleFn);try{const ae=await E(he,de,te);if(ae.length===0)throw new Error("No images generated");const h=await N(ae);return await(await fetch(h)).blob()}finally{Q&&Q.parentNode&&Q.parentNode.removeChild(Q),ue&&ue(),oe()}}catch(D){throw console.error("Get Image Blob failed",D),D}},ne=async T=>{try{return(await B(T)).output("blob")}catch(D){throw console.error("Get PDF Blob failed",D),D}};return{getPrintHtml:M,print:$,exportPdf:c,exportImages:L,getPdfBlob:ne,getImageBlob:O}},Ic={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function Ac(r,e){return P(),q("svg",Ic,[...e[0]||(e[0]=[o("path",{fill:"currentColor",d:"M6.4 19L5 17.6l5.6-5.6L5 6.4L6.4 5l5.6 5.6L17.6 5L19 6.4L13.4 12l5.6 5.6l-1.4 1.4l-5.6-5.6z"},null,-1)])])}const pt=Se({name:"material-symbols-close",render:Ac}),zc={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function Pc(r,e){return P(),q("svg",zc,[...e[0]||(e[0]=[o("path",{fill:"currentColor",d:"M14 20v-2h3q.425 0 .713-.288T18 17v-2q0-.95.55-1.725t1.45-1.1v-.35q-.9-.325-1.45-1.1T18 9V7q0-.425-.288-.712T17 6h-3V4h3q1.25 0 2.125.875T20 7v2q0 .425.288.713T21 10h1v4h-1q-.425 0-.712.288T20 15v2q0 1.25-.875 2.125T17 20zm-7 0q-1.25 0-2.125-.875T4 17v-2q0-.425-.288-.712T3 14H2v-4h1q.425 0 .713-.288T4 9V7q0-1.25.875-2.125T7 4h3v2H7q-.425 0-.712.288T6 7v2q0 .95-.55 1.725T4 11.825v.35q.9.325 1.45 1.1T6 15v2q0 .425.288.713T7 18h3v2z"},null,-1)])])}const lt=Se({name:"material-symbols-data-object",render:Pc}),Lc={class:"bg-white rounded-lg shadow-xl w-[60vw] h-[80vh] flex flex-col overflow-hidden animate-fade-in"},Mc={class:"h-[60px] flex items-center justify-between px-4 border-b border-gray-200 shrink-0"},Rc={class:"flex items-center gap-2"},Dc={class:"text-lg font-semibold text-gray-800"},Bc={class:"px-2 py-0.5 rounded bg-gray-200 text-gray-600 text-xs font-mono"},Oc={class:"flex-1 overflow-hidden relative"},qc={class:"p-4 border-t border-gray-200 bg-gray-50 flex justify-end rounded-b-lg"},Fc=Le({__name:"CodeEditorModal",props:{visible:{type:Boolean},title:{},value:{},language:{},readOnly:{type:Boolean}},emits:["update:visible","update:value","close"],setup(r,{emit:e}){const{t}=je(),{isDark:s}=xo(),n=r,l=e,i=De(),d=ve(()=>({minimap:{enabled:!0},lineNumbers:"on",glyphMargin:!1,folding:!0,wordWrap:"on",automaticLayout:!0,scrollBeyondLastLine:!1,theme:s.value?"vs-dark":"vs",fontSize:14,fontFamily:'Consolas, "Courier New", monospace',renderLineHighlight:"none",overviewRulerLanes:0,hideCursorInOverviewRuler:!0,contextmenu:!0})),u=m=>{l("update:value",m||"")},g=()=>{l("update:visible",!1),l("close")},y=m=>{n.visible&&m.key==="Escape"&&g()};return Ae(()=>n.visible,m=>{i.setDisableGlobalShortcuts(m)}),Ve(()=>{window.addEventListener("keydown",y)}),We(()=>{window.removeEventListener("keydown",y),n.visible&&i.setDisableGlobalShortcuts(!1)}),(m,x)=>(P(),Pe(et,{to:"body"},[r.visible?(P(),q("div",{key:0,class:"fixed inset-0 z-[99999] flex items-center justify-center bg-black/50",onClick:Ke(g,["self"])},[o("div",Lc,[o("div",Mc,[o("div",Rc,[o("h3",Dc,S(r.title),1),o("span",Bc,S(r.language),1)]),o("button",{onClick:g,class:"p-1 hover:bg-gray-100 rounded-full transition-colors text-gray-500"},[fe(a(pt),{class:"w-4 h-4"})])]),o("div",Oc,[fe(a(dl),{value:r.value,language:r.language,options:{...d.value,readOnly:r.readOnly},"onUpdate:value":u,class:"w-full h-full"},null,8,["value","language","options"])]),o("div",qc,[o("button",{onClick:g,class:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 transition-colors text-sm"},S(a(t)("common.close")),1)])])])):xe("",!0)]))}}),_t=(r,e)=>{const t=r.__vccOpts||r;for(const[s,n]of e)t[s]=n;return t},Rt=_t(Fc,[["__scopeId","data-v-511b518d"]]),jc={class:"bg-white rounded-lg shadow-xl w-[90vw] h-[90vh] flex flex-col overflow-hidden"},Nc={class:"relative flex items-center justify-between p-4 border-b border-gray-200"},Hc={class:"text-lg font-semibold text-gray-800"},Uc={class:"absolute left-1/2 -translate-x-1/2 flex items-center gap-2"},Vc=["title"],Wc=["title"],Gc={class:"text-xs text-gray-600 w-9 text-right select-none"},Kc=["innerHTML"],Yc={class:"p-4 border-t border-gray-200 bg-gray-50 flex justify-end gap-3 rounded-b-lg"},Xc=Le({__name:"PreviewModal",props:{visible:{type:Boolean},htmlContent:{},width:{}},emits:["update:visible"],setup(r,{emit:e}){const t=r,s=e,{t:n}=je(),l=De(),{exportPdf:i,getPdfBlob:d,exportImages:u,getImageBlob:g}=Ol(),y=Yt(),m=ce(null),x=ce(null),p=ce(100),_=ce(!1),v=ce(""),k=ce(""),b=ce("json");Ae(()=>t.visible,G=>{G||(p.value=100),l.setDisableGlobalShortcuts(G)});const f=()=>{s("update:visible",!1)},C=()=>{const G={pages:Ee(l.pages),canvasSize:Ee(l.canvasSize),guides:Ee(l.guides),zoom:l.zoom,showGrid:l.showGrid,headerHeight:l.headerHeight,footerHeight:l.footerHeight,showHeaderLine:l.showHeaderLine,showFooterLine:l.showFooterLine,showMinimap:l.showMinimap,canvasBackground:l.canvasBackground};v.value=JSON.stringify(G,null,2),k.value=n("preview.templateJson"),b.value="json",_.value=!0},M=async()=>{try{if(!m.value)return;const G=Array.from(m.value.querySelectorAll(".print-page")),ee=await g(G),J=new FileReader;J.readAsDataURL(ee),J.onloadend=()=>{v.value=J.result,k.value=n("editor.viewImageBlob"),b.value="text",_.value=!0}}catch(G){console.error(G),alert("Failed to generate blob")}},F=async()=>{try{if(!m.value)return;const G=Array.from(m.value.querySelectorAll(".print-page")),ee=await d(G),J=new FileReader;J.readAsDataURL(ee),J.onloadend=()=>{v.value=J.result,k.value=n("editor.viewPdfBlob"),b.value="text",_.value=!0}}catch(G){console.error(G),alert("Failed to generate PDF blob")}},R=()=>{window.dispatchEvent(new CustomEvent("designer:print"))},z=()=>{if(m.value){const G=Array.from(m.value.querySelectorAll(".print-page"));i(G,`${Y()}.pdf`)}},H=async()=>{if(m.value){const G=Array.from(m.value.querySelectorAll(".print-page"));await u(G,Y())}},Y=()=>{const G=y.templates.find(ne=>ne.id===y.currentTemplateId),J=((G==null?void 0:G.name)||"print-design").trim().replace(/[\\/:*?"<>|]/g,"-").replace(/\s+/g," ").trim()||"print-design",$=new Date,N=$.getFullYear(),L=String($.getMonth()+1).padStart(2,"0"),O=String($.getDate()).padStart(2,"0");return`${J}-${N}${L}${O}`},se=()=>{p.value=Math.min(500,p.value+10)},W=()=>{p.value=Math.max(20,p.value-10)},E=G=>{G.ctrlKey&&(G.preventDefault(),G.deltaY<0?se():W())},B=G=>{var ee,J;(G.key==="Control"||G.key==="Meta")&&(G.type==="keydown"&&!G.repeat?(ee=x.value)==null||ee.addEventListener("wheel",E,{passive:!1}):G.type==="keyup"&&((J=x.value)==null||J.removeEventListener("wheel",E)))},c=()=>{var G;(G=x.value)==null||G.removeEventListener("wheel",E)},w=G=>{t.visible&&G.key==="Escape"&&f(),B(G)};return Ve(()=>{window.addEventListener("keydown",w),window.addEventListener("keyup",B),window.addEventListener("blur",c)}),We(()=>{var G;window.removeEventListener("keydown",w),window.removeEventListener("keyup",B),window.removeEventListener("blur",c),(G=x.value)==null||G.removeEventListener("wheel",E),t.visible&&l.setDisableGlobalShortcuts(!1)}),(G,ee)=>(P(),q(Te,null,[(P(),Pe(et,{to:"body"},[r.visible?(P(),q("div",{key:0,class:"fixed inset-0 z-[99999] flex items-center justify-center bg-black/50",onClick:Ke(f,["self"])},[o("div",jc,[o("div",Nc,[o("h3",Hc,S(a(n)("preview.title")),1),o("div",Uc,[o("button",{onClick:W,class:"p-1 hover:bg-gray-100 rounded text-gray-600 transition-colors",title:a(n)("preview.zoomOut")},[fe(a(Ll),{class:"w-4 h-4"})],8,Vc),$e(o("input",{type:"range",min:"20",max:"500",step:"10","onUpdate:modelValue":ee[0]||(ee[0]=J=>p.value=J),class:"w-32 h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer [&::-webkit-slider-thumb]:appearance-none [&::-webkit-slider-thumb]:w-4 [&::-webkit-slider-thumb]:h-4 [&::-webkit-slider-thumb]:bg-blue-600 [&::-webkit-slider-thumb]:rounded-full [&::-webkit-slider-thumb]:cursor-pointer [&::-webkit-slider-thumb]:transition-all [&::-webkit-slider-thumb]:hover:scale-110 [&::-moz-range-thumb]:w-4 [&::-moz-range-thumb]:h-4 [&::-moz-range-thumb]:bg-blue-600 [&::-moz-range-thumb]:border-none [&::-moz-range-thumb]:rounded-full [&::-moz-range-thumb]:cursor-pointer [&::-moz-range-thumb]:transition-all [&::-moz-range-thumb]:hover:scale-110"},null,512),[[Be,p.value,void 0,{number:!0}]]),o("button",{onClick:se,class:"p-1 hover:bg-gray-100 rounded text-gray-600 transition-colors",title:a(n)("preview.zoomIn")},[fe(a(Pl),{class:"w-4 h-4"})],8,Wc),o("span",Gc,S(p.value)+"%",1)]),o("button",{onClick:f,class:"p-1 hover:bg-gray-100 rounded-full transition-colors text-gray-500"},[fe(a(pt),{class:"w-4 h-4"})])]),o("div",{class:"flex-1 overflow-auto bg-gray-100 p-8 flex justify-center",ref_key:"wrapperRef",ref:x},[o("div",{ref_key:"previewContainer",ref:m,class:"preview-content",style:_e(`width: ${r.width}px; zoom: ${p.value/100}`),innerHTML:r.htmlContent},null,12,Kc)],512),o("div",Yc,[o("button",{onClick:R,class:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 flex items-center gap-2 text-sm transition-colors"},[fe(a(_o),{class:"text-lg"}),Ce(" "+S(a(n)("editor.print")),1)]),o("button",{onClick:z,class:"px-4 py-2 bg-indigo-600 text-white rounded hover:bg-indigo-700 flex items-center gap-2 text-sm transition-colors"},[fe(a(Ht),{class:"text-lg"}),Ce(" "+S(a(n)("editor.exportPdf")),1)]),o("button",{onClick:H,class:"px-4 py-2 bg-purple-600 text-white rounded hover:bg-purple-700 flex items-center gap-2 text-sm transition-colors"},[fe(a(Ht),{class:"text-lg"}),Ce(" "+S(a(n)("editor.exportImage")),1)]),o("button",{onClick:M,class:"px-4 py-2 border border-gray-300 rounded hover:bg-gray-100 text-sm text-gray-700 flex items-center gap-2 transition-colors"},[fe(a(lt),{class:"text-lg"}),Ce(" "+S(a(n)("editor.viewImageBlob")),1)]),o("button",{onClick:F,class:"px-4 py-2 border border-gray-300 rounded hover:bg-gray-100 text-sm text-gray-700 flex items-center gap-2 transition-colors"},[fe(a(lt),{class:"text-lg"}),Ce(" "+S(a(n)("editor.viewPdfBlob")),1)]),o("button",{onClick:C,class:"px-4 py-2 border border-gray-300 rounded hover:bg-gray-100 text-sm text-gray-700 flex items-center gap-2 transition-colors"},[fe(a(lt),{class:"text-lg"}),Ce(" "+S(a(n)("editor.viewJson")),1)]),o("button",{onClick:f,class:"px-4 py-2 border border-gray-300 rounded hover:bg-gray-100 text-sm text-gray-700 flex items-center gap-2 transition-colors"},S(a(n)("common.close")),1)])])])):xe("",!0)])),fe(Rt,{visible:_.value,"onUpdate:visible":ee[1]||(ee[1]=J=>_.value=J),title:k.value,value:v.value,language:b.value,"read-only":""},null,8,["visible","title","value","language"])],64))}}),Zc=_t(Xc,[["__scopeId","data-v-de785629"]]),Jc={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function Qc(r,e){return P(),q("svg",Jc,[...e[0]||(e[0]=[o("path",{fill:"currentColor",d:"m9.55 18l-5.7-5.7l1.425-1.425L9.55 15.15l9.175-9.175L20.15 7.4z"},null,-1)])])}const eh=Se({name:"material-symbols-check",render:Qc}),th={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function rh(r,e){return P(),q("svg",th,[...e[0]||(e[0]=[o("path",{fill:"currentColor",d:"M19.25 16.4L8.4 5.55L12 2l5.65 5.55q1.1 1.05 1.725 2.488T20 13.1q0 .9-.2 1.725t-.55 1.575m.55 6.2l-3.1-3.1q-1.025.725-2.2 1.113T12 21q-3.325 0-5.663-2.312T4 13.1q0-1.275.4-2.45T5.6 8.4L1.4 4.2l1.4-1.4l18.4 18.4z"},null,-1)])])}Se({name:"material-symbols-format-color-reset",render:rh});const nh={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function oh(r,e){return P(),q("svg",nh,[...e[0]||(e[0]=[o("path",{fill:"currentColor",d:"m20.475 23.3l-2.3-2.3h-1.85v-1.85l-2-2V21h-4.65v-4.675H13.5l-2-2H9.675v-1.85l-2-2v3.85H3v-4.65h3.875l-2-2H3V5.8L.7 3.5l1.4-1.4l19.8 19.8zM5 21q-.825 0-1.412-.587T3 19v-2.675h4.675V21zm16-2.9l-1.775-1.775H21zm-3.775-3.775l-.9-.9v-3.75H21v4.65zm-2.9-2.9l-1.75-1.75h1.75zm-3.75-3.75l-.9-.9V3h4.65v4.675zm5.75 0V3H19q.825 0 1.413.588T21 5v2.675zm-8.65-2.9L5.9 3h1.775z"},null,-1)])])}Se({name:"material-symbols-grid-off",render:oh});const sh={key:0,class:"w-full h-[1px] bg-red-500 rotate-45 absolute"},ah={key:1,class:"w-full h-full bg-[url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAIAAADZF8uwAAAAGUlEQVQYV2M4gwZ+5wNisxL//8n04mEeRAAAhNwX869V4DYAAAAASUVORK5CYII=')] opacity-50"},lh={class:"flex gap-2 mb-3"},ih={class:"flex-1 flex flex-col gap-2"},dh={class:"relative h-3 rounded bg-[url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAIAAADZF8uwAAAAGUlEQVQYV2M4gwZ+5wNisxL//8n04mEeRAAAhNwX869V4DYAAAAASUVORK5CYII=')] border border-gray-200"},uh={class:"w-8 h-8 rounded border border-gray-200 overflow-hidden relative"},ch={key:0,class:"absolute inset-0 flex items-center justify-center pointer-events-none"},hh={class:"flex gap-2 mb-3"},ph={class:"flex-1"},fh={class:"w-16 text-right text-xs text-gray-500 flex items-center justify-end"},mh={class:"grid grid-cols-9 gap-1.5 mb-3"},gh=["onClick","title"],vh={class:"flex justify-between border-t pt-2"},bh={key:0},yh={class:"flex gap-2 mb-3"},wh={class:"flex-1 flex flex-col gap-2"},xh={class:"relative h-3 rounded bg-[url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAIAAADZF8uwAAAAGUlEQVQYV2M4gwZ+5wNisxL//8n04mEeRAAAhNwX869V4DYAAAAASUVORK5CYII=')] border border-gray-200"},_h={class:"w-8 h-8 rounded border border-gray-200 overflow-hidden relative"},kh={key:0,class:"absolute inset-0 flex items-center justify-center pointer-events-none"},Sh={class:"flex gap-2 mb-3"},Ch={class:"flex-1"},Eh={class:"w-16 text-right text-xs text-gray-500 flex items-center justify-end"},Th={class:"grid grid-cols-9 gap-1.5 mb-3"},$h=["onClick","title"],Ih={class:"flex justify-between border-t pt-2"},Ah={key:0},vt=Le({__name:"ColorPicker",props:{modelValue:{},disabled:{type:Boolean},defaultColor:{},allowTransparent:{type:Boolean},teleportToBody:{type:Boolean}},emits:["update:modelValue"],setup(r,{emit:e}){const t=r,s=e,{t:n}=je(),l=ce(!1),i=ce(null),d=ce(null),u=ce({h:0,s:0,v:0,a:1}),g=ce(null),y=ce(null),m=ce(null),x=ve(()=>t.modelValue?t.modelValue==="transparent"?"transparent":t.modelValue:t.defaultColor||"#000000"),p=ve(()=>t.modelValue==="transparent"),_=ve({get:()=>Ba(u.value.h,u.value.s,u.value.v,u.value.a),set:c=>{const w=zt(c);w&&(u.value=w,R())}}),v=ve(()=>{const{r:c,g:w,b:G}=Lt(u.value.h,u.value.s,u.value.v);return`rgba(${c}, ${w}, ${G}, ${parseFloat(u.value.a.toFixed(2))})`}),k=ve(()=>({backgroundColor:`hsl(${u.value.h}, 100%, 50%)`})),b=ve(()=>({top:`${(1-u.value.v)*100}%`,left:`${u.value.s*100}%`})),f=ve(()=>({left:`${u.value.h/360*100}%`})),C=ve(()=>({left:`${u.value.a*100}%`})),M=ve(()=>{const{r:c,g:w,b:G}=Lt(u.value.h,u.value.s,u.value.v);return{background:`linear-gradient(to right, rgba(${c},${w},${G},0) 0%, rgba(${c},${w},${G},1) 100%)`}});Ae(()=>t.modelValue,c=>{if(c){const w=zt(c);w&&(u.value=w)}},{immediate:!0});const F=(c,w)=>{c.preventDefault();const G=w==="sv"?g.value:w==="hue"?y.value:m.value;if(!G)return;const ee=(N,L)=>{const O=G.getBoundingClientRect();let ne=(N-O.left)/O.width,T=(L-O.top)/O.height;ne=Math.max(0,Math.min(1,ne)),T=Math.max(0,Math.min(1,T)),w==="sv"?(u.value.s=ne,u.value.v=1-T,u.value.a===0&&(u.value.a=1)):w==="hue"?(u.value.h=ne*360,u.value.a===0&&(u.value.a=1)):w==="alpha"&&(u.value.a=ne),R()};ee(c.clientX,c.clientY);const J=N=>ee(N.clientX,N.clientY),$=()=>{window.removeEventListener("mousemove",J),window.removeEventListener("mouseup",$)};window.addEventListener("mousemove",J),window.addEventListener("mouseup",$)},R=()=>{u.value.a===0&&t.allowTransparent?s("update:modelValue","transparent"):s("update:modelValue",Ba(u.value.h,u.value.s,u.value.v,u.value.a))},z=ce({top:"100%",left:"0",marginTop:"8px"}),H=()=>{if(!i.value)return;const c=i.value.getBoundingClientRect(),w=window.innerWidth,G=window.innerHeight,ee=240,J=350,$={};if(t.teleportToBody){const N=c.left+ee<=w-20,L=c.bottom+J<=G-10;$.position="fixed",$.left=`${N?c.left:Math.max(8,c.right-ee)}px`,$.top=`${L?c.bottom+8:Math.max(8,c.top-J-8)}px`,z.value=$;return}c.left+ee>w-20?($.left="auto",$.right="0"):($.left="0",$.right="auto"),c.bottom+J>G-10?($.top="auto",$.bottom="100%",$.marginTop="0",$.marginBottom="8px"):($.top="100%",$.bottom="auto",$.marginTop="8px",$.marginBottom="0"),z.value=$},Y=async()=>{t.disabled||(l.value=!l.value,l.value&&(await Xe(),H()))},se=()=>{l.value=!1},W=c=>{const w=c.target;i.value&&i.value.contains(w)||d.value&&d.value.contains(w)||i.value&&se()};Ae(l,c=>{t.teleportToBody&&(c?(H(),window.addEventListener("scroll",H,!0),window.addEventListener("resize",H)):(window.removeEventListener("scroll",H,!0),window.removeEventListener("resize",H)))});const E=["#000000","#ffffff","#ff0000","#00ff00","#0000ff","#ffff00","#00ffff","#ff00ff","#f44336","#e91e63","#9c27b0","#673ab7","#3f51b5","#2196f3","#03a9f4","#00bcd4","#009688","#4caf50","#8bc34a","#cddc39","#ffeb3b","#ffc107","#ff9800","#ff5722","#795548","#9e9e9e","#607d8b"],B=c=>{const w=zt(c);w&&(u.value=w,R())};return Ve(()=>{window.addEventListener("mousedown",W)}),We(()=>{window.removeEventListener("mousedown",W)}),(c,w)=>(P(),q("div",{class:"relative flex",ref_key:"containerRef",ref:i,onClick:Y},[il(c.$slots,"trigger",{open:l.value,color:x.value,disabled:r.disabled},()=>[o("div",{class:ke(["w-6 h-6 rounded border border-gray-300 cursor-pointer flex items-center justify-center overflow-hidden transition-all hover:border-blue-500",{"opacity-50 cursor-not-allowed":r.disabled,"ring-2 ring-blue-500 ring-offset-1":l.value}]),style:_e({backgroundColor:p.value?"transparent":x.value})},[r.modelValue?xe("",!0):(P(),q("div",sh)),p.value?(P(),q("div",ah)):xe("",!0)],6)]),l.value&&r.teleportToBody?(P(),Pe(et,{key:0,to:"body"},[o("div",{ref_key:"dropdownRef",ref:d,class:"fixed z-[99999] bg-white rounded-lg shadow-xl border border-gray-200 p-3 w-[240px]",style:_e(z.value),onClick:w[6]||(w[6]=Ke(()=>{},["stop"]))},[o("div",{ref_key:"svPanelRef",ref:g,class:"w-full h-32 rounded relative cursor-crosshair mb-3",style:_e(k.value),onMousedown:w[0]||(w[0]=G=>F(G,"sv"))},[w[14]||(w[14]=o("div",{class:"absolute inset-0 bg-gradient-to-r from-white to-transparent rounded"},null,-1)),w[15]||(w[15]=o("div",{class:"absolute inset-0 bg-gradient-to-t from-black to-transparent rounded"},null,-1)),o("div",{class:"absolute w-3 h-3 border-2 border-white rounded-full shadow-sm -ml-1.5 -mt-1.5 pointer-events-none",style:_e(b.value)},null,4)],36),o("div",lh,[o("div",ih,[o("div",{ref_key:"hueSliderRef",ref:y,class:"h-3 rounded relative cursor-pointer border border-gray-200",style:{background:"linear-gradient(to right, #f00 0%, #ff0 17%, #0f0 33%, #0ff 50%, #00f 67%, #f0f 83%, #f00 100%)"},onMousedown:w[1]||(w[1]=G=>F(G,"hue"))},[o("div",{class:"absolute top-1/2 -translate-y-1/2 w-3 h-3 bg-white border border-gray-300 rounded-full shadow-sm -ml-1.5 pointer-events-none",style:_e(f.value)},null,4)],544),o("div",dh,[o("div",{ref_key:"alphaSliderRef",ref:m,class:"absolute inset-0 cursor-pointer rounded",style:_e(M.value),onMousedown:w[2]||(w[2]=G=>F(G,"alpha"))},[o("div",{class:"absolute top-1/2 -translate-y-1/2 w-3 h-3 bg-white border border-gray-300 rounded-full shadow-sm -ml-1.5 pointer-events-none",style:_e(C.value)},null,4)],36)])]),o("div",uh,[w[17]||(w[17]=o("div",{class:"absolute inset-0 bg-[url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAIAAADZF8uwAAAAGUlEQVQYV2M4gwZ+5wNisxL//8n04mEeRAAAhNwX869V4DYAAAAASUVORK5CYII=')] opacity-50"},null,-1)),o("div",{class:"absolute inset-0",style:_e({backgroundColor:v.value})},null,4),u.value.a===0?(P(),q("div",ch,[...w[16]||(w[16]=[o("div",{class:"w-full h-[1px] bg-red-500 rotate-45"},null,-1)])])):xe("",!0)])]),o("div",hh,[o("div",ph,[$e(o("input",{type:"text","onUpdate:modelValue":w[3]||(w[3]=G=>_.value=G),class:"w-full text-xs px-2 py-1 border border-gray-300 rounded focus:border-blue-500 outline-none font-mono uppercase",placeholder:"#000000"},null,512),[[Be,_.value]])]),o("div",fh,S(Math.round(u.value.a*100))+"% ",1)]),o("div",mh,[(P(),q(Te,null,Me(E,G=>o("div",{key:G,class:ke(["w-4 h-4 rounded-sm cursor-pointer border border-transparent hover:scale-110 hover:border-gray-400 hover:z-10 transition-all relative",{"ring-2 ring-blue-500 ring-offset-1 z-10":_.value===G}]),style:_e({backgroundColor:G}),onClick:ee=>B(G),title:G},null,14,gh)),64))]),o("div",vh,[o("button",{onClick:w[4]||(w[4]=G=>{c.$emit("update:modelValue",void 0),se()}),class:"text-xs text-red-600 hover:text-red-800 hover:bg-red-50 px-2 py-1 rounded transition-colors"},S(a(n)("colorPicker.clear")),1),r.allowTransparent?(P(),q("div",bh,[o("button",{onClick:w[5]||(w[5]=G=>{c.$emit("update:modelValue","transparent"),se()}),class:"text-xs text-gray-600 hover:text-gray-800 hover:bg-gray-100 px-2 py-1 rounded transition-colors"},S(a(n)("colorPicker.transparent")),1)])):xe("",!0)])],4)])):l.value?(P(),q("div",{key:1,ref_key:"dropdownRef",ref:d,class:"absolute z-50 bg-white rounded-lg shadow-xl border border-gray-200 p-3 w-[240px]",style:_e(z.value),onClick:w[13]||(w[13]=Ke(()=>{},["stop"]))},[o("div",{ref_key:"svPanelRef",ref:g,class:"w-full h-32 rounded relative cursor-crosshair mb-3",style:_e(k.value),onMousedown:w[7]||(w[7]=G=>F(G,"sv"))},[w[18]||(w[18]=o("div",{class:"absolute inset-0 bg-gradient-to-r from-white to-transparent rounded"},null,-1)),w[19]||(w[19]=o("div",{class:"absolute inset-0 bg-gradient-to-t from-black to-transparent rounded"},null,-1)),o("div",{class:"absolute w-3 h-3 border-2 border-white rounded-full shadow-sm -ml-1.5 -mt-1.5 pointer-events-none",style:_e(b.value)},null,4)],36),o("div",yh,[o("div",wh,[o("div",{ref_key:"hueSliderRef",ref:y,class:"h-3 rounded relative cursor-pointer border border-gray-200",style:{background:"linear-gradient(to right, #f00 0%, #ff0 17%, #0f0 33%, #0ff 50%, #00f 67%, #f0f 83%, #f00 100%)"},onMousedown:w[8]||(w[8]=G=>F(G,"hue"))},[o("div",{class:"absolute top-1/2 -translate-y-1/2 w-3 h-3 bg-white border border-gray-300 rounded-full shadow-sm -ml-1.5 pointer-events-none",style:_e(f.value)},null,4)],544),o("div",xh,[o("div",{ref_key:"alphaSliderRef",ref:m,class:"absolute inset-0 cursor-pointer rounded",style:_e(M.value),onMousedown:w[9]||(w[9]=G=>F(G,"alpha"))},[o("div",{class:"absolute top-1/2 -translate-y-1/2 w-3 h-3 bg-white border border-gray-300 rounded-full shadow-sm -ml-1.5 pointer-events-none",style:_e(C.value)},null,4)],36)])]),o("div",_h,[w[21]||(w[21]=o("div",{class:"absolute inset-0 bg-[url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAIAAADZF8uwAAAAGUlEQVQYV2M4gwZ+5wNisxL//8n04mEeRAAAhNwX869V4DYAAAAASUVORK5CYII=')] opacity-50"},null,-1)),o("div",{class:"absolute inset-0",style:_e({backgroundColor:v.value})},null,4),u.value.a===0?(P(),q("div",kh,[...w[20]||(w[20]=[o("div",{class:"w-full h-[1px] bg-red-500 rotate-45"},null,-1)])])):xe("",!0)])]),o("div",Sh,[o("div",Ch,[$e(o("input",{type:"text","onUpdate:modelValue":w[10]||(w[10]=G=>_.value=G),class:"w-full text-xs px-2 py-1 border border-gray-300 rounded focus:border-blue-500 outline-none font-mono uppercase",placeholder:"#000000"},null,512),[[Be,_.value]])]),o("div",Eh,S(Math.round(u.value.a*100))+"% ",1)]),o("div",Th,[(P(),q(Te,null,Me(E,G=>o("div",{key:G,class:ke(["w-4 h-4 rounded-sm cursor-pointer border border-transparent hover:scale-110 hover:border-gray-400 hover:z-10 transition-all relative",{"ring-2 ring-blue-500 ring-offset-1 z-10":_.value===G}]),style:_e({backgroundColor:G}),onClick:ee=>B(G),title:G},null,14,$h)),64))]),o("div",Ih,[o("button",{onClick:w[11]||(w[11]=G=>{c.$emit("update:modelValue",void 0),se()}),class:"text-xs text-red-600 hover:text-red-800 hover:bg-red-50 px-2 py-1 rounded transition-colors"},S(a(n)("colorPicker.clear")),1),r.allowTransparent?(P(),q("div",Ah,[o("button",{onClick:w[12]||(w[12]=G=>{c.$emit("update:modelValue","transparent"),se()}),class:"text-xs text-gray-600 hover:text-gray-800 hover:bg-gray-100 px-2 py-1 rounded transition-colors"},S(a(n)("colorPicker.transparent")),1)])):xe("",!0)])],4)):xe("",!0)],512))}}),zh={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function Ph(r,e){return P(),q("svg",zh,[...e[0]||(e[0]=[o("path",{fill:"currentColor",d:"M12 20q-.825 0-1.412-.587T10 18t.588-1.412T12 16t1.413.588T14 18t-.587 1.413T12 20m0-6q-.825 0-1.412-.587T10 12t.588-1.412T12 10t1.413.588T14 12t-.587 1.413T12 14m0-6q-.825 0-1.412-.587T10 6t.588-1.412T12 4t1.413.588T14 6t-.587 1.413T12 8"},null,-1)])])}const ql=Se({name:"material-symbols-more-vert",render:Ph}),Lh={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function Mh(r,e){return P(),q("svg",Lh,[...e[0]||(e[0]=[o("path",{fill:"currentColor",d:"M3 21v-4.25L16.2 3.575q.3-.275.663-.425t.762-.15t.775.15t.65.45L20.425 5q.3.275.438.65T21 6.4q0 .4-.137.763t-.438.662L7.25 21zM17.6 7.8L19 6.4L17.6 5l-1.4 1.4z"},null,-1)])])}const lo=Se({name:"material-symbols-edit",render:Mh}),Rh={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function Dh(r,e){return P(),q("svg",Rh,[...e[0]||(e[0]=[o("path",{fill:"currentColor",d:"M11 13H5v-2h6V5h2v6h6v2h-6v6h-2z"},null,-1)])])}const To=Se({name:"material-symbols-add",render:Dh}),Bh={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function Oh(r,e){return P(),q("svg",Bh,[...e[0]||(e[0]=[o("path",{fill:"currentColor",d:"M8 18h8v-2H8zm0-4h8v-2H8zm-2 8q-.825 0-1.412-.587T4 20V4q0-.825.588-1.412T6 2h8l6 6v12q0 .825-.587 1.413T18 22zm7-13h5l-5-5z"},null,-1)])])}const qh=Se({name:"material-symbols-description",render:Oh}),Fh={key:0,class:"fixed inset-0 z-[2000] flex items-center justify-center bg-black/50"},jh={class:"bg-white rounded-lg shadow-xl w-96 animate-in fade-in zoom-in duration-200 flex flex-col overflow-hidden"},Nh={class:"h-[60px] flex items-center justify-between px-4 border-b border-gray-200 shrink-0"},Hh={class:"text-lg font-semibold text-gray-800"},Uh={class:"p-4"},Vh={class:"mb-4"},Wh=["placeholder"],Gh={class:"flex justify-end gap-2"},Kh=["disabled"],Dt=Le({__name:"InputModal",props:{show:{type:Boolean},initialValue:{},title:{},placeholder:{}},emits:["close","save"],setup(r,{emit:e}){const t=r,s=e,{t:n}=je(),l=De(),i=ce(""),d=ce(null);Ae(()=>t.show,g=>{if(g){i.value=t.initialValue||"",setTimeout(()=>{var y;(y=d.value)==null||y.focus()},100),l.setDisableGlobalShortcuts(!0);return}l.setDisableGlobalShortcuts(!1)});const u=()=>{i.value.trim()&&(s("save",i.value.trim()),s("close"))};return We(()=>{t.show&&l.setDisableGlobalShortcuts(!1)}),(g,y)=>(P(),Pe(et,{to:"body"},[r.show?(P(),q("div",Fh,[o("div",jh,[o("div",Nh,[o("h3",Hh,S(r.title||a(n)("input.title")),1),o("button",{onClick:y[0]||(y[0]=m=>s("close")),class:"p-1 hover:bg-gray-100 rounded-full transition-colors text-gray-500"},[fe(a(pt),{class:"w-4 h-4"})])]),o("div",Uh,[o("div",Vh,[$e(o("input",{ref_key:"inputRef",ref:d,"onUpdate:modelValue":y[1]||(y[1]=m=>i.value=m),type:"text",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:r.placeholder||a(n)("input.placeholder"),onKeydown:[gt(u,["enter"]),y[2]||(y[2]=gt(m=>s("close"),["esc"]))]},null,40,Wh),[[Be,i.value]])]),o("div",Gh,[o("button",{onClick:y[3]||(y[3]=m=>s("close")),class:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-md transition-colors"},S(a(n)("common.cancel")),1),o("button",{onClick:u,disabled:!i.value.trim(),class:"px-4 py-2 text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 rounded-md transition-colors disabled:opacity-50 disabled:cursor-not-allowed"},S(a(n)("common.confirm")),9,Kh)])])])])):xe("",!0)]))}}),Bt=r=>{const e=r.trim();return e?e.startsWith("@")?e.slice(1).trim():e.startsWith("{#")&&e.endsWith("}")?e.slice(2,-1).trim():e:""},Fl=r=>[ye.TEXT,ye.BARCODE,ye.QRCODE,ye.TABLE].includes(r.type),Yh=r=>{if(Array.isArray(r.data)&&r.data.length>0)return Ee(r.data);const e=r.columns||[];if(e.length===0)return[];const t={};return e.forEach(s=>{t[s.field]=""}),[t]},io=(r,e={})=>{const t={...e};if(!Fl(r))return t;const s=r.variable||"",n=Bt(s);return!n||Object.prototype.hasOwnProperty.call(t,n)?t:r.type===ye.TABLE?(t[n]=Yh(r),t):(t[n]=r.content??"",t)},Xh=(r=[],e={})=>{let t={...e};return r.forEach(s=>{s.elements.forEach(n=>{t=io(n,t)})}),t},Zh={class:"flex-1 truncate text-left"},Jh={key:0,class:"absolute top-full left-0 mt-2 w-[220px] bg-white rounded-lg shadow-xl border border-gray-200 z-[100] flex flex-col max-h-[500px]"},Qh={class:"flex-1 overflow-y-auto py-1"},ep={key:0,class:"px-4 py-3 text-sm text-gray-500 text-center"},tp=["onClick"],rp={class:"flex items-center gap-2 overflow-hidden flex-1"},np={class:"w-2 h-2 flex items-center justify-center flex-shrink-0"},op={key:0,class:"w-1.5 h-1.5 rounded-full bg-blue-500"},sp=["onClick"],ap={class:"border-t border-gray-100 p-1"},lp=Le({__name:"TemplateDropdown",setup(r){const{t:e}=je(),t=Yt(),s=De(),n=ce(!1),l=ce(null),i=ce(null),d=ce({}),u=ce(!1),g=ce("create"),y=ce(""),m=ce(null),x=ce(!1),p=ce(""),_=ce(null),v=ce([]);Ve(()=>{t.loadTemplates(),!t.currentTemplateId&&t.templates.length>0&&t.loadTemplate(t.templates[0].id),document.addEventListener("click",k),window.addEventListener("designer:new-template",R)}),We(()=>{document.removeEventListener("click",k),window.removeEventListener("designer:new-template",R)});const k=c=>{l.value&&!l.value.contains(c.target)&&(n.value=!1,i.value=null);const w=c.target;i.value&&!w.closest(".row-menu-trigger")&&!w.closest(".row-menu-content")&&(i.value=null)},b=ve(()=>{const c=t.templates.find(w=>w.id===t.currentTemplateId);return c?c.name:e("template.select")}),f=()=>{n.value=!n.value,n.value||(i.value=null)},C=c=>{if(t.currentTemplateId){const w=t.templates.find(G=>G.id===t.currentTemplateId);w&&t.saveCurrentTemplate(w.name)}t.loadTemplate(c.id),n.value=!1},M=(c,w)=>{if(c.stopPropagation(),i.value===w)i.value=null;else{const ee=c.currentTarget.getBoundingClientRect();let $=ee.right-128;$<5&&($=ee.left),window.innerHeight-ee.bottom<150?d.value={bottom:`${window.innerHeight-ee.top+5}px`,left:`${$}px`}:d.value={top:`${ee.bottom+5}px`,left:`${$}px`},i.value=w}},F=()=>t.templates.find(c=>c.id===i.value),R=()=>{i.value=null,g.value="create",y.value="",u.value=!0,n.value=!1},z=c=>{i.value=null,g.value="rename",m.value=c.id,y.value=c.name,u.value=!0,n.value=!1},H=c=>{t.copyTemplate(c.id),i.value=null},Y=c=>{confirm(e("template.confirmDelete",{name:c.name}))&&(t.deleteTemplate(c.id),!t.currentTemplateId&&t.templates.length>0&&t.loadTemplate(t.templates[0].id)),i.value=null},se=c=>{var J,$;const w=t.currentTemplateId===c.id,G=w?s.testData||{}:((J=c.data)==null?void 0:J.testData)||{},ee=w?s.pages:(($=c.data)==null?void 0:$.pages)||[];return Xh(ee,G)},W=c=>{i.value=null,_.value=c;const w=se(c);v.value=Object.keys(w),p.value=JSON.stringify(w,null,2),x.value=!0,n.value=!1},E=()=>{var ee;const c=_.value,w=new Set(v.value||[]);if(_.value=null,v.value=[],!c)return;let G=null;try{const J=((ee=p.value)==null?void 0:ee.trim())||"{}",$=JSON.parse(J);$&&typeof $=="object"&&!Array.isArray($)&&(G=$)}catch{G=null}if(!G){alert(e("common.invalidJson"));return}if(w.size>0){const J=Object.keys(G);if(J.length!==w.size||J.some(N=>!w.has(N))){alert(e("common.testDataKeyChanged"));return}}c.data={...c.data||{},testData:G},c.updatedAt=Date.now(),t.saveToLocalStorage(),t.currentTemplateId===c.id&&(s.testData=G)},B=c=>{if(g.value==="create"){if(t.currentTemplateId){const G=t.templates.find(ee=>ee.id===t.currentTemplateId);G&&t.saveCurrentTemplate(G.name)}De().resetCanvas(),t.createTemplate(c)}else g.value==="rename"&&m.value&&t.renameTemplate(m.value,c)};return(c,w)=>(P(),q("div",{class:"relative",ref_key:"containerRef",ref:l},[o("button",{onClick:f,class:"flex items-center gap-2 px-3 py-1.5 bg-gray-100 hover:bg-gray-200 rounded-lg text-sm font-medium text-gray-700 transition-colors w-40",title:"Templates"},[fe(a(qh),{class:"w-4 h-4 flex-shrink-0"}),o("span",Zh,S(b.value),1),fe(a(Eo),{class:"w-4 h-4 flex-shrink-0"})]),n.value?(P(),q("div",Jh,[o("div",Qh,[a(t).templates.length===0?(P(),q("div",ep,S(a(e)("template.noTemplates")),1)):xe("",!0),(P(!0),q(Te,null,Me(a(t).templates,G=>(P(),q("div",{key:G.id,class:"relative group border-b border-gray-100 last:border-b-0 flex items-center justify-between px-3 py-2 hover:bg-gray-50 cursor-pointer",onClick:ee=>C(G)},[o("div",rp,[o("div",np,[a(t).currentTemplateId===G.id?(P(),q("div",op)):xe("",!0)]),o("span",{class:ke(["text-sm text-gray-700 truncate",{"font-medium text-blue-600":a(t).currentTemplateId===G.id}])},S(G.name),3)]),o("button",{onClick:ee=>M(ee,G.id),class:ke(["row-menu-trigger p-1 hover:bg-gray-200 rounded-full text-gray-400 hover:text-gray-600 opacity-0 group-hover:opacity-100 transition-opacity",{"opacity-100 bg-gray-200":i.value===G.id}])},[fe(a(ql),{class:"w-4 h-4"})],10,sp)],8,tp))),128))]),o("div",ap,[o("button",{onClick:R,class:"w-full flex items-center justify-center gap-2 px-3 py-2 text-sm text-blue-600 hover:bg-blue-50 rounded transition-colors"},[fe(a(To),{class:"w-4 h-4"}),Ce(" "+S(a(e)("template.new")),1)])])])):xe("",!0),(P(),Pe(et,{to:"body"},[i.value?(P(),q("div",{key:0,class:"row-menu-content fixed w-32 bg-white rounded shadow-lg border border-gray-100 z-[2001] py-1",style:_e(d.value),onClick:w[4]||(w[4]=Ke(()=>{},["stop"]))},[F()?(P(),q(Te,{key:0},[o("button",{onClick:w[0]||(w[0]=G=>W(F())),class:"w-full text-left px-3 py-1.5 text-xs text-gray-700 hover:bg-gray-50 flex items-center gap-2"},[fe(a(lt),{class:"w-3.5 h-3.5"}),Ce(" "+S(a(e)("common.testData")),1)]),o("button",{onClick:w[1]||(w[1]=G=>z(F())),class:"w-full text-left px-3 py-1.5 text-xs text-gray-700 hover:bg-gray-50 flex items-center gap-2"},[fe(a(lo),{class:"w-3.5 h-3.5"}),Ce(" "+S(a(e)("common.rename")),1)]),o("button",{onClick:w[2]||(w[2]=G=>H(F())),class:"w-full text-left px-3 py-1.5 text-xs text-gray-700 hover:bg-gray-50 flex items-center gap-2"},[fe(a(xt),{class:"w-3.5 h-3.5"}),Ce(" "+S(a(e)("common.copy")),1)]),o("button",{onClick:w[3]||(w[3]=G=>Y(F())),class:"w-full text-left px-3 py-1.5 text-xs text-red-600 hover:bg-red-50 flex items-center gap-2"},[fe(a(wt),{class:"w-3.5 h-3.5"}),Ce(" "+S(a(e)("common.delete")),1)])],64)):xe("",!0)],4)):xe("",!0)])),fe(Dt,{show:u.value,"initial-value":y.value,title:g.value==="create"?a(e)("template.new"):a(e)("template.rename"),onClose:w[5]||(w[5]=G=>u.value=!1),onSave:B},null,8,["show","initial-value","title"]),fe(Rt,{visible:x.value,"onUpdate:visible":w[6]||(w[6]=G=>x.value=G),title:a(e)("common.testData"),value:p.value,language:"json","onUpdate:value":w[7]||(w[7]=G=>p.value=G),onClose:E},null,8,["visible","title","value"])],512))}}),ft={A3:{width:1123,height:1587},A4:{width:794,height:1123},A5:{width:559,height:794},LETTER:{width:816,height:1056},LEGAL:{width:816,height:1344},"Receipt 58mm":{width:219,height:794},"Receipt 80mm":{width:302,height:794},"241-1 (Full)":{width:911,height:1058},"241-2 (Half)":{width:911,height:529},"241-3 (Third)":{width:911,height:352}},ip={class:"relative"},dp={class:"flex items-center bg-gray-100 rounded-lg p-1"},up=["title"],cp=["title"],hp={class:"truncate"},pp=["title"],fp={key:0,class:"absolute top-full left-0 mt-2 w-64 bg-white border border-gray-200 shadow-xl rounded-lg p-4 z-[1000]"},mp={class:"text-sm font-semibold text-gray-700 mb-3"},gp={class:"space-y-3"},vp={class:"block text-xs text-gray-500 mb-1"},bp=["value"],yp={value:"CUSTOM"},wp={class:"block text-xs text-gray-500 mb-1"},xp=["value"],_p={value:"mm"},kp={value:"pt"},Sp={value:"px"},Cp={class:"grid grid-cols-2 gap-2"},Ep={class:"block text-xs text-gray-500 mb-1"},Tp=["value"],$p={class:"block text-xs text-gray-500 mb-1"},Ip=["value"],Ap={class:"grid grid-cols-2 gap-2"},zp={class:"block text-xs text-gray-500 mb-1"},Pp=["value"],Lp={class:"block text-xs text-gray-500 mb-1"},Mp=["value"],Rp={class:"mt-4 flex items-center justify-between"},Dp={class:"text-sm text-gray-700 font-medium"},Bp={class:"mt-3 flex items-center justify-between"},Op={class:"text-sm text-gray-700 font-medium"},qp={class:"mt-3 flex items-center justify-between"},Fp={class:"text-sm text-gray-700 font-medium"},jp={class:"mt-3 flex items-center justify-between"},Np={class:"text-sm text-gray-700 font-medium"},Hp={key:0,class:"absolute inset-0 flex items-center justify-center"},Up={class:"border-t border-gray-200 my-4 pt-3"},Vp={class:"text-sm font-semibold text-gray-700 mb-3"},Wp={class:"space-y-3"},Gp={class:"flex items-center justify-between"},Kp={class:"flex items-center gap-2"},Yp={class:"text-xs text-gray-600"},Xp={class:"flex items-center gap-1"},Zp=["value"],Jp={class:"text-xs text-gray-500"},Qp={class:"flex items-center justify-between"},ef={class:"flex items-center gap-2"},tf={class:"text-xs text-gray-600"},rf={class:"flex items-center gap-1"},nf=["value"],of={class:"text-xs text-gray-500"},sf={class:"border-t border-gray-200 pt-3 mt-3"},af={class:"bg-white rounded-lg shadow-xl w-[640px] max-w-full max-h-[90vh] flex flex-col overflow-hidden"},lf={class:"h-[60px] flex items-center justify-between px-4 border-b border-gray-200 shrink-0"},df={class:"text-lg font-semibold text-gray-800"},uf={class:"p-4 overflow-y-auto space-y-4"},cf={class:"text-sm font-semibold text-gray-700 mb-3"},hf={class:"space-y-3"},pf={class:"flex items-center justify-between"},ff={class:"text-sm text-gray-700 font-medium"},mf={class:"block text-xs text-gray-500 mb-1"},gf=["placeholder"],vf={class:"grid grid-cols-2 gap-2"},bf={class:"block text-xs text-gray-500 mb-1"},yf={class:"block text-xs text-gray-500 mb-1"},wf={class:"grid grid-cols-2 gap-2"},xf={class:"block text-xs text-gray-500 mb-1"},_f={class:"block text-xs text-gray-500 mb-1"},kf={class:"block text-xs text-gray-500 mb-1"},Sf={class:"p-4 border-t border-gray-200 bg-gray-50 flex justify-end"},Cf=Le({__name:"PaperSettings",setup(r){const{t:e}=je(),t=De(),s=ce("A4"),n=ce(ft.A4.width),l=ce(ft.A4.height),i=ce(!1),d=ce(!1),u=ve({get:()=>t.canvasBackground,set:R=>t.setCanvasBackground(R)}),g=ve({get:()=>{var R;return((R=t.watermark)==null?void 0:R.text)||""},set:R=>t.setWatermark({text:R})}),y=ve({get:()=>{var R;return((R=t.watermark)==null?void 0:R.enabled)??!1},set:R=>t.setWatermark({enabled:!!R})}),m=ve({get:()=>{var R;return((R=t.watermark)==null?void 0:R.angle)??-30},set:R=>t.setWatermark({angle:Number(R)})}),x=ve({get:()=>{var R;return((R=t.watermark)==null?void 0:R.color)||"#000000"},set:R=>t.setWatermark({color:R})}),p=ve({get:()=>{var R;return Math.round((((R=t.watermark)==null?void 0:R.opacity)??.1)*100)},set:R=>{const z=Math.max(0,Math.min(100,Number(R)));t.setWatermark({opacity:z/100})}}),_=ve({get:()=>{var R;return C(((R=t.watermark)==null?void 0:R.size)??24)},set:R=>t.setWatermark({size:Ye(Number(R),t.unit)})}),v=ve({get:()=>{var R;return C(((R=t.watermark)==null?void 0:R.density)??160)},set:R=>t.setWatermark({density:Ye(Number(R),t.unit)})}),k=ve({get:()=>C(t.pageSpacingX||0),set:R=>t.setPageSpacingX(Ye(Number(R),t.unit))}),b=ve({get:()=>C(t.pageSpacingY||0),set:R=>t.setPageSpacingY(Ye(Number(R),t.unit))}),f=ve(()=>t.unit==="px"?e("common.px"):t.unit==="pt"?e("common.pt"):e("common.mm")),C=R=>{const z=nt(R,t.unit);return t.unit==="px"?Math.round(z):Number(z.toFixed(1))},M=()=>{if(s.value!=="CUSTOM"){const R=ft[s.value];n.value=R.width,l.value=R.height,t.setCanvasSize(R.width,R.height)}},F=()=>{t.setCanvasSize(n.value,l.value),Object.values(ft).some(R=>R.width===n.value&&R.height===l.value)||(s.value="CUSTOM")};return Ae(()=>t.canvasSize,R=>{n.value=R.width,l.value=R.height;const z=Object.entries(ft).find(([H,Y])=>Y.width===R.width&&Y.height===R.height);z?s.value=z[0]:s.value="CUSTOM"},{immediate:!0}),(R,z)=>(P(),q("div",ip,[o("div",dp,[o("button",{onClick:z[0]||(z[0]=H=>i.value=!i.value),class:"p-1 hover:bg-gray-200 rounded transition-colors",title:a(e)("editor.paperSettings")},[fe(a(ko),{class:"w-4 h-4"})],8,up),o("button",{onClick:z[1]||(z[1]=H=>i.value=!i.value),class:"flex items-center justify-center text-xs text-gray-700 hover:bg-gray-200 rounded px-1 py-0.5 transition-colors w-16 text-center",title:a(e)("editor.paperSettings")},[o("span",hp,S(s.value==="CUSTOM"?a(e)("editor.custom"):s.value),1)],8,cp),o("button",{onClick:z[2]||(z[2]=H=>i.value=!i.value),class:"p-1 hover:bg-gray-200 rounded transition-colors",title:a(e)("editor.paperSettings")},[fe(a(Eo),{class:"w-4 h-4"})],8,pp)]),i.value?(P(),q("div",fp,[o("h3",mp,S(a(e)("editor.paperSettings")),1),o("div",gp,[o("div",null,[o("label",vp,S(a(e)("editor.sizePreset")),1),$e(o("select",{"onUpdate:modelValue":z[3]||(z[3]=H=>s.value=H),onChange:M,class:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded focus:border-blue-500 outline-none"},[(P(!0),q(Te,null,Me(a(ft),(H,Y)=>(P(),q("option",{key:Y,value:Y},S(Y)+" ("+S(C(H.width))+S(f.value)+" x "+S(C(H.height))+S(f.value)+") ",9,bp))),128)),o("option",yp,S(a(e)("editor.custom")),1)],544),[[Ze,s.value]])]),o("div",null,[o("label",wp,S(a(e)("editor.unit")),1),o("select",{value:a(t).unit,onChange:z[4]||(z[4]=H=>a(t).setUnit(H.target.value)),class:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded focus:border-blue-500 outline-none"},[o("option",_p,S(a(e)("common.mm")),1),o("option",kp,S(a(e)("common.pt")),1),o("option",Sp,S(a(e)("common.px")),1)],40,xp)]),o("div",Cp,[o("div",null,[o("label",Ep,S(a(e)("common.width"))+" ("+S(f.value)+")",1),o("input",{type:"number",value:C(n.value),onChange:z[5]||(z[5]=H=>{n.value=a(Ye)(Number(H.target.value),a(t).unit),F()}),class:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:border-blue-500 outline-none"},null,40,Tp)]),o("div",null,[o("label",$p,S(a(e)("common.height"))+" ("+S(f.value)+")",1),o("input",{type:"number",value:C(l.value),onChange:z[6]||(z[6]=H=>{l.value=a(Ye)(Number(H.target.value),a(t).unit),F()}),class:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:border-blue-500 outline-none"},null,40,Ip)])]),o("div",Ap,[o("div",null,[o("label",zp,S(a(e)("editor.spacingX"))+" ("+S(f.value)+")",1),o("input",{type:"number",value:k.value,onChange:z[7]||(z[7]=H=>{k.value=Number(H.target.value)}),class:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:border-blue-500 outline-none"},null,40,Pp)]),o("div",null,[o("label",Lp,S(a(e)("editor.spacingY"))+" ("+S(f.value)+")",1),o("input",{type:"number",value:b.value,onChange:z[8]||(z[8]=H=>{b.value=Number(H.target.value)}),class:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:border-blue-500 outline-none"},null,40,Mp)])]),o("div",null,[o("button",{onClick:z[9]||(z[9]=H=>d.value=!0),class:"w-full flex items-center justify-center gap-2 px-3 py-2 bg-gray-100 text-gray-700 hover:bg-gray-200 rounded-md transition-colors text-sm font-medium"},S(a(e)("editor.advancedSettings")),1)])]),o("div",Rp,[o("span",Dp,S(a(e)("editor.showCornerMarkers")),1),o("button",{onClick:z[10]||(z[10]=H=>a(t).setShowCornerMarkers(!a(t).showCornerMarkers)),class:ke(["relative inline-flex h-6 w-11 flex-shrink-0 cursor-pointer rounded-full border-2 border-transparent transition-colors duration-200 ease-in-out focus:outline-none focus:ring-2 focus:ring-blue-600 focus:ring-offset-2",a(t).showCornerMarkers?"bg-blue-600":"bg-gray-200"])},[z[30]||(z[30]=o("span",{class:"sr-only"},"Toggle corner markers",-1)),o("span",{"aria-hidden":"true",class:ke(["pointer-events-none inline-block h-5 w-5 transform rounded-full bg-white shadow ring-0 transition duration-200 ease-in-out",a(t).showCornerMarkers?"translate-x-5":"translate-x-0"])},null,2)],2)]),o("div",Bp,[o("span",Op,S(a(e)("editor.showGrid")),1),o("button",{onClick:z[11]||(z[11]=H=>a(t).setShowGrid(!a(t).showGrid)),class:ke(["relative inline-flex h-6 w-11 flex-shrink-0 cursor-pointer rounded-full border-2 border-transparent transition-colors duration-200 ease-in-out focus:outline-none focus:ring-2 focus:ring-blue-600 focus:ring-offset-2",a(t).showGrid?"bg-blue-600":"bg-gray-200"])},[z[31]||(z[31]=o("span",{class:"sr-only"},"Toggle grid",-1)),o("span",{"aria-hidden":"true",class:ke(["pointer-events-none inline-block h-5 w-5 transform rounded-full bg-white shadow ring-0 transition duration-200 ease-in-out",a(t).showGrid?"translate-x-5":"translate-x-0"])},null,2)],2)]),o("div",qp,[o("span",Fp,S(a(e)("editor.showMinimap")),1),o("button",{onClick:z[12]||(z[12]=H=>a(t).setShowMinimap(!a(t).showMinimap)),class:ke(["relative inline-flex h-6 w-11 flex-shrink-0 cursor-pointer rounded-full border-2 border-transparent transition-colors duration-200 ease-in-out focus:outline-none focus:ring-2 focus:ring-blue-600 focus:ring-offset-2",a(t).showMinimap?"bg-blue-600":"bg-gray-200"])},[z[32]||(z[32]=o("span",{class:"sr-only"},"Toggle minimap",-1)),o("span",{"aria-hidden":"true",class:ke(["pointer-events-none inline-block h-5 w-5 transform rounded-full bg-white shadow ring-0 transition duration-200 ease-in-out",a(t).showMinimap?"translate-x-5":"translate-x-0"])},null,2)],2)]),o("div",jp,[o("span",Np,S(a(e)("editor.backgroundColor")),1),fe(vt,{modelValue:u.value,"onUpdate:modelValue":z[13]||(z[13]=H=>u.value=H),"allow-transparent":!0,"default-color":"#ffffff",placement:"bottom-end"},{trigger:it(({color:H,open:Y})=>[o("div",{class:ke(["w-8 h-6 rounded border border-gray-300 cursor-pointer relative overflow-hidden hover:border-blue-500 transition-colors",{"ring-2 ring-blue-500 ring-offset-1":Y}])},[z[34]||(z[34]=o("div",{class:"absolute inset-0 bg-[url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAIAAADZF8uwAAAAGUlEQVQYV2M4gwZ+5wNisxL//8n04mEeRAAAhNwX869V4DYAAAAASUVORK5CYII=')] opacity-50"},null,-1)),o("div",{class:"absolute inset-0",style:_e({backgroundColor:H==="transparent"?"transparent":H})},null,4),H==="transparent"?(P(),q("div",Hp,[...z[33]||(z[33]=[o("div",{class:"w-full h-[1px] bg-red-500 rotate-45"},null,-1)])])):xe("",!0)],2)]),_:1},8,["modelValue"])]),o("div",Up,[o("h3",Vp,S(a(e)("editor.headerFooter")),1),o("div",Wp,[o("div",Gp,[o("div",Kp,[o("button",{onClick:z[14]||(z[14]=H=>a(t).setShowHeaderLine(!a(t).showHeaderLine)),class:ke(["relative inline-flex h-5 w-9 flex-shrink-0 cursor-pointer rounded-full border-2 border-transparent transition-colors duration-200 ease-in-out focus:outline-none focus:ring-2 focus:ring-blue-600 focus:ring-offset-2",a(t).showHeaderLine?"bg-blue-600":"bg-gray-200"])},[z[35]||(z[35]=o("span",{class:"sr-only"},"Toggle header line",-1)),o("span",{"aria-hidden":"true",class:ke(["pointer-events-none inline-block h-4 w-4 transform rounded-full bg-white shadow ring-0 transition duration-200 ease-in-out",a(t).showHeaderLine?"translate-x-4":"translate-x-0"])},null,2)],2),o("label",Yp,S(a(e)("editor.headerLine")),1)]),o("div",Xp,[o("input",{type:"number",value:C(a(t).headerHeight),onChange:z[15]||(z[15]=H=>a(t).setHeaderHeight(a(Ye)(Number(H.target.value),a(t).unit))),class:"w-16 px-2 py-1 text-sm border border-gray-300 rounded focus:border-blue-500 outline-none text-right",min:"0"},null,40,Zp),o("span",Jp,S(f.value),1)])]),o("div",Qp,[o("div",ef,[o("button",{onClick:z[16]||(z[16]=H=>a(t).setShowFooterLine(!a(t).showFooterLine)),class:ke(["relative inline-flex h-5 w-9 flex-shrink-0 cursor-pointer rounded-full border-2 border-transparent transition-colors duration-200 ease-in-out focus:outline-none focus:ring-2 focus:ring-blue-600 focus:ring-offset-2",a(t).showFooterLine?"bg-blue-600":"bg-gray-200"])},[z[36]||(z[36]=o("span",{class:"sr-only"},"Toggle footer line",-1)),o("span",{"aria-hidden":"true",class:ke(["pointer-events-none inline-block h-4 w-4 transform rounded-full bg-white shadow ring-0 transition duration-200 ease-in-out",a(t).showFooterLine?"translate-x-4":"translate-x-0"])},null,2)],2),o("label",tf,S(a(e)("editor.footerLine")),1)]),o("div",rf,[o("input",{type:"number",value:C(a(t).footerHeight),onChange:z[17]||(z[17]=H=>a(t).setFooterHeight(a(Ye)(Number(H.target.value),a(t).unit))),class:"w-16 px-2 py-1 text-sm border border-gray-300 rounded focus:border-blue-500 outline-none text-right",min:"0"},null,40,nf),o("span",of,S(f.value),1)])])])]),o("div",sf,[o("button",{onClick:z[18]||(z[18]=H=>{a(t).addPage(),i.value=!1}),class:"w-full flex items-center justify-center gap-2 px-3 py-2 bg-blue-50 text-blue-700 hover:bg-blue-100 rounded-md transition-colors text-sm font-medium"},[fe(a(To),{class:"w-4 h-4"}),o("span",null,S(a(e)("editor.addNewPage")),1)])]),o("div",{class:"fixed inset-0 z-[-1]",onClick:z[19]||(z[19]=H=>i.value=!1)})])):xe("",!0),(P(),Pe(et,{to:"body"},[d.value?(P(),q("div",{key:0,class:"fixed inset-0 z-[2000] flex items-center justify-center bg-black/50",onClick:z[29]||(z[29]=Ke(H=>d.value=!1,["self"]))},[o("div",af,[o("div",lf,[o("h3",df,S(a(e)("editor.advancedSettings")),1),o("button",{onClick:z[20]||(z[20]=H=>d.value=!1),class:"p-1 hover:bg-gray-100 rounded-full transition-colors text-gray-500"},[fe(a(pt),{class:"w-4 h-4"})])]),o("div",uf,[o("div",null,[o("h3",cf,S(a(e)("editor.watermark")),1),o("div",hf,[o("div",pf,[o("span",ff,S(a(e)("editor.watermarkEnable")),1),o("button",{onClick:z[21]||(z[21]=H=>y.value=!y.value),class:ke(["relative inline-flex h-6 w-11 flex-shrink-0 cursor-pointer rounded-full border-2 border-transparent transition-colors duration-200 ease-in-out focus:outline-none focus:ring-2 focus:ring-blue-600 focus:ring-offset-2",y.value?"bg-blue-600":"bg-gray-200"])},[z[37]||(z[37]=o("span",{class:"sr-only"},"Toggle watermark",-1)),o("span",{"aria-hidden":"true",class:ke(["pointer-events-none inline-block h-5 w-5 transform rounded-full bg-white shadow ring-0 transition duration-200 ease-in-out",y.value?"translate-x-5":"translate-x-0"])},null,2)],2)]),o("div",null,[o("label",mf,S(a(e)("editor.watermarkText")),1),$e(o("input",{"onUpdate:modelValue":z[22]||(z[22]=H=>g.value=H),type:"text",class:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded focus:border-blue-500 outline-none",placeholder:a(e)("editor.watermarkTextPlaceholder")},null,8,gf),[[Be,g.value]])]),o("div",vf,[o("div",null,[o("label",bf,S(a(e)("editor.watermarkAngle")),1),$e(o("input",{"onUpdate:modelValue":z[23]||(z[23]=H=>m.value=H),type:"number",class:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:border-blue-500 outline-none"},null,512),[[Be,m.value,void 0,{number:!0}]])]),o("div",null,[o("label",yf,S(a(e)("editor.watermarkOpacity")),1),$e(o("input",{"onUpdate:modelValue":z[24]||(z[24]=H=>p.value=H),type:"number",min:"0",max:"100",class:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:border-blue-500 outline-none"},null,512),[[Be,p.value,void 0,{number:!0}]])])]),o("div",wf,[o("div",null,[o("label",xf,S(a(e)("editor.watermarkSize"))+" ("+S(f.value)+")",1),$e(o("input",{"onUpdate:modelValue":z[25]||(z[25]=H=>_.value=H),type:"number",min:"1",class:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:border-blue-500 outline-none"},null,512),[[Be,_.value,void 0,{number:!0}]])]),o("div",null,[o("label",_f,S(a(e)("editor.watermarkDensity"))+" ("+S(f.value)+")",1),$e(o("input",{"onUpdate:modelValue":z[26]||(z[26]=H=>v.value=H),type:"number",min:"20",class:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:border-blue-500 outline-none"},null,512),[[Be,v.value,void 0,{number:!0}]])])]),o("div",null,[o("label",kf,S(a(e)("editor.watermarkColor")),1),fe(vt,{modelValue:x.value,"onUpdate:modelValue":z[27]||(z[27]=H=>x.value=H),"default-color":"#000000",placement:"bottom-end"},{trigger:it(({color:H,open:Y})=>[o("div",{class:ke(["w-8 h-6 rounded border border-gray-300 cursor-pointer relative overflow-hidden hover:border-blue-500 transition-colors",{"ring-2 ring-blue-500 ring-offset-1":Y}])},[o("div",{class:"absolute inset-0",style:_e({backgroundColor:H})},null,4)],2)]),_:1},8,["modelValue"])])])])]),o("div",Sf,[o("button",{onClick:z[28]||(z[28]=H=>d.value=!1),class:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 transition-colors text-sm"},S(a(e)("common.close")),1)])])])):xe("",!0)]))]))}}),Ef=()=>typeof navigator>"u"?!1:/Mac|iPod|iPhone|iPad/.test(navigator.platform),Re=r=>{const e=Ef();return r.map(t=>{switch(t.toLowerCase()){case"ctrl":case"control":return e?"⌘":"Ctrl";case"alt":return e?"⌥":"Alt";case"shift":return e?"⇧":"Shift";case"enter":return e?"⏎":"Enter";case"backspace":return e?"⌫":"Backspace";case"delete":return e?"⌦":"Del";case"esc":case"escape":return"Esc";default:return t.toUpperCase()}}).join(" + ")},Tf={class:"bg-white rounded-lg shadow-xl w-[700px] max-w-full max-h-[90vh] flex flex-col overflow-hidden"},$f={class:"h-[56px] flex items-center justify-between px-4 border-b border-gray-200"},If={class:"text-lg font-semibold text-gray-800"},Af={class:"flex-1 overflow-y-auto p-6 space-y-5 text-sm text-gray-700"},zf={class:"space-y-3"},Pf={class:"font-medium text-gray-900"},Lf={key:0,class:"grid grid-cols-2 gap-4"},Mf={class:"flex flex-col gap-1 col-span-2"},Rf={class:"text-xs text-gray-500"},Df=["disabled"],Bf={value:""},Of=["value","disabled"],qf={class:"grid grid-cols-2 gap-4"},Ff={class:"flex flex-col gap-1"},jf={class:"text-xs text-gray-500"},Nf=["disabled"],Hf={value:""},Uf=["value"],Vf={class:"flex flex-col gap-1"},Wf={class:"text-xs text-gray-500"},Gf=["placeholder"],Kf={key:1,class:"text-xs text-red-600"},Yf={key:2,class:"text-xs text-gray-500"},Xf={key:3,class:"text-xs text-gray-500"},Zf={key:4,class:"text-xs text-gray-500"},Jf={class:"grid grid-cols-3 gap-4"},Qf={class:"flex flex-col gap-1"},em={class:"text-xs text-gray-500"},tm={class:"flex flex-col gap-1"},rm={class:"text-xs text-gray-500"},nm={class:"flex flex-col gap-1"},om={class:"text-xs text-gray-500"},sm=["placeholder"],am={class:"grid grid-cols-3 gap-4"},lm={class:"flex flex-col gap-1"},im={class:"text-xs text-gray-500"},dm={value:""},um={value:"odd"},cm={value:"even"},hm={class:"flex flex-col gap-1"},pm={class:"text-xs text-gray-500"},fm={value:"noscale"},mm={value:"shrink"},gm={value:"fit"},vm={class:"flex flex-col gap-1"},bm={class:"text-xs text-gray-500"},ym={value:"portrait"},wm={value:"landscape"},xm={class:"space-y-3"},_m={class:"font-medium text-gray-900"},km={class:"grid grid-cols-2 gap-4"},Sm={class:"flex flex-col gap-1"},Cm={class:"text-xs text-gray-500"},Em=["disabled"],Tm={value:"color"},$m={value:"monochrome"},Im={class:"flex flex-col gap-1"},Am={class:"text-xs text-gray-500"},zm=["disabled"],Pm={value:"simplex"},Lm={value:"duplex"},Mm={value:"duplexshort"},Rm={value:"duplexlong"},Dm={class:"grid grid-cols-2 gap-4"},Bm={class:"flex flex-col gap-1"},Om={class:"text-xs text-gray-500"},qm=["value"],Fm=["placeholder"],jm={class:"flex flex-col gap-1"},Nm={class:"text-xs text-gray-500"},Hm=["placeholder"],Um={class:"p-4 border-t border-gray-200 bg-gray-50 flex justify-end gap-3 rounded-b-lg"},Vm=Le({__name:"PrintDialog",props:{show:{type:Boolean},mode:{},options:{}},emits:["update:show","confirm"],setup(r,{emit:e}){const t=r,s=e,{t:n}=je(),l=De(),{localPrinters:i,remotePrinters:d,remoteClients:u,remoteSelectedClientId:g,localPrinterCaps:y,fetchLocalPrinters:m,fetchRemoteClients:x,fetchRemotePrinters:p,fetchLocalPrinterCaps:_}=Zt(),v=ce(!1),k=ce(!1),b=ce(""),f=ce(""),C=mt({printer:"",jobName:"",copies:1,intervalMs:0,pageRange:"",pageSet:"",scale:"fit",orientation:"portrait",colorMode:"color",sidesMode:"simplex",paperSize:"",trayBin:""});Ae(()=>t.show,J=>{J&&(Object.assign(C,JSON.parse(JSON.stringify(t.options))),f.value=g.value||"",E(),l.setDisableGlobalShortcuts(!0))}),Ae(()=>t.show,J=>{J||l.setDisableGlobalShortcuts(!1)}),Ae(()=>t.mode,()=>{t.show&&E()});const M=ve(()=>(t.mode==="remote"?d.value:i.value)||[]),F=ve(()=>u.value||[]),R=ve(()=>{if(!(t.mode!=="local"||!C.printer))return y[C.printer]}),z=ve(()=>{var N;if(t.mode!=="local")return[];const J=R.value,$=(N=J==null?void 0:J.printerPaperNames)!=null&&N.length?J.printerPaperNames:(J==null?void 0:J.paperSizes)||[];return Array.from(new Set($)).filter(Boolean)}),H=ve(()=>M.value.map(J=>{if(t.mode==="local"){const N=J;return{key:N.name,label:N.name}}const $=J;return{key:$.printer_name,label:$.printer_name}})),Y=ve(()=>{var J;return t.mode!=="local"?!0:((J=R.value)==null?void 0:J.colorSupported)!==!1}),se=ve(()=>{var J;return t.mode!=="local"?!0:((J=R.value)==null?void 0:J.duplexSupported)!==!1}),W=ve(()=>{if(t.mode==="remote")return(d.value||[]).find(J=>J.printer_name===C.printer)}),E=async()=>{v.value=!0,b.value="";try{if(t.mode==="remote"?(await x(),(!f.value||!F.value.some(J=>J.client_id===f.value))&&(f.value=g.value||""),f.value?await p(f.value):d.value=[]):t.mode==="local"&&await m(),!C.printer&&M.value.length>0){const J=t.mode==="local"&&M.value.find($=>$.isDefault)||M.value[0];C.printer=t.mode==="local"?J.name:J.printer_name}t.mode==="local"&&C.printer&&await B(C.printer)}catch(J){b.value=J.message||n("printDialog.printerLoadFailed")}finally{v.value=!1}},B=async J=>{if(!(!J||t.mode!=="local")){k.value=!0;try{await _(J)}finally{k.value=!1}}};Ae(f,async(J,$)=>{if(!(!t.show||t.mode!=="remote"||J===$)){g.value=J,C.printer="",v.value=!0,b.value="";try{J?await p(J):d.value=[]}catch(N){b.value=N.message||n("printDialog.printerLoadFailed")}finally{v.value=!1}}}),Ae(()=>C.printer,async(J,$)=>{if(!(!t.show||J===$)){if(t.mode==="local")await B(J),z.value.length&&!C.paperSize&&(C.paperSize=z.value[0]);else if(t.mode==="remote"){const N=(d.value||[]).find(L=>L.printer_name===J);N!=null&&N.paper_spec&&!C.paperSize&&(C.paperSize=N.paper_spec)}}}),Ae(R,J=>{J&&(J.colorSupported===!1&&C.colorMode==="color"&&(C.colorMode="monochrome"),J.duplexSupported===!1&&C.sidesMode.startsWith("duplex")&&(C.sidesMode="simplex"))});const c=()=>{s("update:show",!1)},w=J=>{t.show&&J.key==="Escape"&&(J.preventDefault(),c())},G=()=>{s("confirm",JSON.parse(JSON.stringify(C)))},ee=ve(()=>t.mode==="local"?n("printDialog.titleLocal"):t.mode==="remote"?n("printDialog.titleRemote"):n("printDialog.title"));return Ve(()=>{window.addEventListener("keydown",w)}),We(()=>{window.removeEventListener("keydown",w),t.show&&l.setDisableGlobalShortcuts(!1)}),(J,$)=>(P(),Pe(et,{to:"body"},[r.show?(P(),q("div",{key:0,class:"fixed inset-0 z-[99999] flex items-center justify-center bg-black/50",onClick:Ke(c,["self"])},[o("div",Tf,[o("div",$f,[o("h3",If,S(ee.value),1),o("button",{onClick:c,class:"p-1 hover:bg-gray-100 rounded-full transition-colors text-gray-500"},[fe(a(pt),{class:"w-4 h-4"})])]),o("div",Af,[o("div",zf,[o("div",Pf,S(a(n)("printDialog.sectionBasic")),1),t.mode==="remote"?(P(),q("div",Lf,[o("label",Mf,[o("span",Rf,S(a(n)("printDialog.remoteClient")),1),$e(o("select",{"onUpdate:modelValue":$[0]||($[0]=N=>f.value=N),class:"w-full px-3 py-2 border rounded bg-white focus:ring-2 focus:ring-blue-600 focus:border-blue-600",disabled:v.value},[o("option",Bf,S(a(n)("printDialog.remoteClientPlaceholder")),1),(P(!0),q(Te,null,Me(F.value,N=>(P(),q("option",{key:N.client_id,value:N.client_id,disabled:N.online===!1},S(N.client_name||N.client_id)+S(N.online===!1?" (offline)":""),9,Of))),128))],8,Df),[[Ze,f.value]])])])):xe("",!0),o("div",qf,[o("label",Ff,[o("span",jf,S(a(n)("printDialog.printer")),1),$e(o("select",{"onUpdate:modelValue":$[1]||($[1]=N=>C.printer=N),class:"w-full px-3 py-2 border rounded bg-white focus:ring-2 focus:ring-blue-600 focus:border-blue-600",disabled:v.value||k.value||t.mode==="remote"&&!f.value},[o("option",Hf,S(a(n)("printDialog.printerSelect")),1),(P(!0),q(Te,null,Me(H.value,N=>(P(),q("option",{key:N.key,value:N.key},S(N.label),9,Uf))),128))],8,Nf),[[Ze,C.printer]])]),o("label",Vf,[o("span",Wf,S(a(n)("printDialog.jobName")),1),$e(o("input",{"onUpdate:modelValue":$[2]||($[2]=N=>C.jobName=N),type:"text",class:"w-full px-3 py-2 border rounded focus:ring-2 focus:ring-blue-600 focus:border-blue-600",placeholder:a(n)("printDialog.jobNamePlaceholder")},null,8,Gf),[[Be,C.jobName]])])]),b.value?(P(),q("div",Kf,S(b.value),1)):t.mode==="remote"&&F.value.length===0?(P(),q("div",Yf,S(a(n)("printDialog.remoteClientEmpty")),1)):M.value.length===0?(P(),q("div",Xf,S(a(n)("printDialog.printerEmpty")),1)):xe("",!0),t.mode==="remote"&&W.value?(P(),q("div",Zf,S(a(n)("printDialog.remotePrinterInfo",{type:W.value.printer_type||"-",paper:W.value.paper_spec||"-",format:W.value.supported_format||"-"})),1)):xe("",!0),o("div",Jf,[o("label",Qf,[o("span",em,S(a(n)("printDialog.copies")),1),$e(o("input",{"onUpdate:modelValue":$[3]||($[3]=N=>C.copies=N),type:"number",min:"1",class:"w-full px-3 py-2 border rounded focus:ring-2 focus:ring-blue-600 focus:border-blue-600"},null,512),[[Be,C.copies,void 0,{number:!0}]])]),o("label",tm,[o("span",rm,S(a(n)("printDialog.intervalMs")),1),$e(o("input",{"onUpdate:modelValue":$[4]||($[4]=N=>C.intervalMs=N),type:"number",min:"0",class:"w-full px-3 py-2 border rounded focus:ring-2 focus:ring-blue-600 focus:border-blue-600"},null,512),[[Be,C.intervalMs,void 0,{number:!0}]])]),o("label",nm,[o("span",om,S(a(n)("printDialog.pageRange")),1),$e(o("input",{"onUpdate:modelValue":$[5]||($[5]=N=>C.pageRange=N),type:"text",class:"w-full px-3 py-2 border rounded focus:ring-2 focus:ring-blue-600 focus:border-blue-600",placeholder:a(n)("printDialog.pageRangePlaceholder")},null,8,sm),[[Be,C.pageRange]])])]),o("div",am,[o("label",lm,[o("span",im,S(a(n)("printDialog.pageSet")),1),$e(o("select",{"onUpdate:modelValue":$[6]||($[6]=N=>C.pageSet=N),class:"w-full px-3 py-2 border rounded bg-white focus:ring-2 focus:ring-blue-600 focus:border-blue-600"},[o("option",dm,S(a(n)("printDialog.pageSetAll")),1),o("option",um,S(a(n)("printDialog.pageSetOdd")),1),o("option",cm,S(a(n)("printDialog.pageSetEven")),1)],512),[[Ze,C.pageSet]])]),o("label",hm,[o("span",pm,S(a(n)("printDialog.scale")),1),$e(o("select",{"onUpdate:modelValue":$[7]||($[7]=N=>C.scale=N),class:"w-full px-3 py-2 border rounded bg-white focus:ring-2 focus:ring-blue-600 focus:border-blue-600"},[o("option",fm,S(a(n)("printDialog.scaleNo")),1),o("option",mm,S(a(n)("printDialog.scaleShrink")),1),o("option",gm,S(a(n)("printDialog.scaleFit")),1)],512),[[Ze,C.scale]])]),o("label",vm,[o("span",bm,S(a(n)("printDialog.orientation")),1),$e(o("select",{"onUpdate:modelValue":$[8]||($[8]=N=>C.orientation=N),class:"w-full px-3 py-2 border rounded bg-white focus:ring-2 focus:ring-blue-600 focus:border-blue-600"},[o("option",ym,S(a(n)("printDialog.portrait")),1),o("option",wm,S(a(n)("printDialog.landscape")),1)],512),[[Ze,C.orientation]])])])]),o("div",xm,[o("div",_m,S(a(n)("printDialog.sectionAdvanced")),1),o("div",km,[o("label",Sm,[o("span",Cm,S(a(n)("printDialog.colorMode")),1),$e(o("select",{"onUpdate:modelValue":$[9]||($[9]=N=>C.colorMode=N),class:"w-full px-3 py-2 border rounded bg-white focus:ring-2 focus:ring-blue-600 focus:border-blue-600",disabled:!Y.value},[o("option",Tm,S(a(n)("printDialog.color")),1),o("option",$m,S(a(n)("printDialog.monochrome")),1)],8,Em),[[Ze,C.colorMode]])]),o("label",Im,[o("span",Am,S(a(n)("printDialog.sidesMode")),1),$e(o("select",{"onUpdate:modelValue":$[10]||($[10]=N=>C.sidesMode=N),class:"w-full px-3 py-2 border rounded bg-white focus:ring-2 focus:ring-blue-600 focus:border-blue-600",disabled:!se.value},[o("option",Pm,S(a(n)("printDialog.simplex")),1),o("option",Lm,S(a(n)("printDialog.duplex")),1),o("option",Mm,S(a(n)("printDialog.duplexShort")),1),o("option",Rm,S(a(n)("printDialog.duplexLong")),1)],8,zm),[[Ze,C.sidesMode]])])]),o("div",Dm,[o("label",Bm,[o("span",Om,S(a(n)("printDialog.paperSize")),1),z.value.length?$e((P(),q("select",{key:0,"onUpdate:modelValue":$[11]||($[11]=N=>C.paperSize=N),class:"w-full px-3 py-2 border rounded bg-white focus:ring-2 focus:ring-blue-600 focus:border-blue-600"},[(P(!0),q(Te,null,Me(z.value,N=>(P(),q("option",{key:N,value:N},S(N),9,qm))),128))],512)),[[Ze,C.paperSize]]):$e((P(),q("input",{key:1,"onUpdate:modelValue":$[12]||($[12]=N=>C.paperSize=N),type:"text",class:"w-full px-3 py-2 border rounded focus:ring-2 focus:ring-blue-600 focus:border-blue-600",placeholder:a(n)("printDialog.paperSizePlaceholder")},null,8,Fm)),[[Be,C.paperSize]])]),o("label",jm,[o("span",Nm,S(a(n)("printDialog.trayBin")),1),$e(o("input",{"onUpdate:modelValue":$[13]||($[13]=N=>C.trayBin=N),type:"text",class:"w-full px-3 py-2 border rounded focus:ring-2 focus:ring-blue-600 focus:border-blue-600",placeholder:a(n)("printDialog.trayBinPlaceholder")},null,8,Hm),[[Be,C.trayBin]])])])])]),o("div",Um,[o("button",{onClick:c,class:"px-4 py-2 border border-gray-300 rounded hover:bg-gray-100 text-sm text-gray-700"},S(a(n)("common.close")),1),o("button",{onClick:G,class:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 transition-colors text-sm"},S(a(n)("printDialog.confirm")),1)])])])):xe("",!0)]))}}),Wm={class:"flex items-center gap-4"},Gm={class:"flex items-center gap-2 bg-gray-100 rounded-lg p-1 px-2"},Km=["disabled","title"],Ym=["value"],Xm={class:"flex items-center gap-1"},Zm=["disabled"],Jm=["disabled"],Qm=["disabled"],eg=["disabled","title"],tg=["disabled","title"],rg=["disabled","title"],ng=["disabled","title"],og=["disabled","title"],sg=["disabled","title"],ag={class:"w-1 h-3.5 rounded-[1px] border border-gray-300 relative overflow-hidden bg-white"},lg={key:0,class:"absolute inset-0 bg-[url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAIAAADZF8uwAAAAGUlEQVQYV2M4gwZ+5wNisxL//8n04mEeRAAAhNwX869V4DYAAAAASUVORK5CYII=')] opacity-50 bg-repeat bg-[length:6px_6px]"},ig={key:1,class:"absolute inset-0 flex items-center justify-center"},dg=["disabled","title"],ug={class:"flex items-center gap-1 bg-gray-100 rounded-lg p-1"},cg=["disabled","title"],hg=["disabled","title"],pg=["disabled","title"],fg=["disabled","title"],mg=["disabled","title"],gg=["disabled","title"],vg=["disabled","title"],bg={class:"flex items-center gap-1 bg-gray-100 rounded-lg p-1"},yg=["disabled","title"],wg=["disabled","title"],xg=["disabled","title"],_g=["disabled","title"],kg=["disabled","title"],Sg=["disabled","title"],Cg={class:"relative"},Eg={class:"flex items-center bg-gray-100 rounded-lg p-1"},Tg=["title"],$g=["title"],Ig=["title"],Ag={key:0,class:"absolute top-full left-0 mt-2 w-64 bg-white border border-gray-200 shadow-xl rounded-lg p-4 z-[1000]"},zg={class:"text-sm font-semibold text-gray-700 mb-3"},Pg={class:"space-y-3"},Lg={class:"block text-xs text-gray-500 mb-1"},Mg={class:"text-right text-xs text-gray-600 mt-1"},Rg={class:"relative"},Dg={class:"flex items-center shadow-sm"},Bg=["disabled"],Og={key:0,class:"absolute top-full right-0 mt-2 w-max min-w-[160px] bg-white border border-gray-200 shadow-xl rounded-lg p-1 z-[1000] flex flex-col gap-1"},qg=Le({__name:"HeaderToolbar",emits:["toggleHelp","toggleSettings"],setup(r,{emit:e}){const t=e,{t:s}=je(),n=De(),l=Yt(),{printMode:i,silentPrint:d,localPrintOptions:u,remotePrintOptions:g}=Zt(),y=ve(()=>i.value||"browser"),m=ce(!1),x=ce(""),p=ce(""),_=ce("json"),v=()=>{const re={pages:Ee(n.pages),canvasSize:Ee(n.canvasSize),guides:Ee(n.guides),zoom:n.zoom,showGrid:n.showGrid,headerHeight:n.headerHeight,footerHeight:n.footerHeight,showHeaderLine:n.showHeaderLine,showFooterLine:n.showFooterLine,showMinimap:n.showMinimap,canvasBackground:n.canvasBackground};x.value=JSON.stringify(re,null,2),p.value=s("preview.templateJson"),_.value="json",m.value=!0},k=ce(!1),b=ce(""),f=ce("save"),{getPrintHtml:C,print:M,exportPdf:F,getPdfBlob:R,exportImages:z,getImageBlob:H}=Ol(),Y=async()=>{try{const re=Array.from(document.querySelectorAll(".print-page")),j=await H(re),be=new FileReader;be.readAsDataURL(j),be.onloadend=()=>{x.value=be.result,p.value=s("editor.viewImageBlob"),_.value="text",m.value=!0}}catch(re){console.error(re),alert("Failed to generate blob")}},se=async()=>{try{const re=Array.from(document.querySelectorAll(".print-page")),j=await R(re),be=new FileReader;be.readAsDataURL(j),be.onloadend=()=>{x.value=be.result,p.value=s("editor.viewPdfBlob"),_.value="text",m.value=!0}}catch(re){console.error(re),alert("Failed to generate PDF blob")}},W=ce(!1),E=ce(""),B=ce(!1),c=ce(!1),w=ce(null),G=ve(()=>i.value==="remote"?g:u),ee=ce(!1),J=ce(Math.round(n.zoom*100)),$=ve({get:()=>n.selectedElement&&n.selectedElement.style.fontFamily||"",set:re=>{n.updateSelectedElementsStyle({fontFamily:re})}}),N=ve({get:()=>n.selectedElement&&n.selectedElement.style.fontSize||12,set:re=>{n.updateSelectedElementsStyle({fontSize:re})}}),L=ve(()=>{var re,j;return((re=n.selectedElement)==null?void 0:re.style.fontWeight)==="700"||((j=n.selectedElement)==null?void 0:j.style.fontWeight)==="bold"}),O=ve(()=>{var re;return((re=n.selectedElement)==null?void 0:re.style.fontStyle)==="italic"}),ne=ve(()=>{var re;return((re=n.selectedElement)==null?void 0:re.style.textDecoration)==="underline"}),T=ve(()=>{var re;return((re=n.selectedElement)==null?void 0:re.style.writingMode)==="vertical-rl"}),D=ve({get:()=>{if(n.selectedElement)return n.selectedElement.style.color},set:re=>{n.updateSelectedElementsStyle({color:re})}}),oe=ve({get:()=>{if(n.selectedElement)return n.selectedElement.style.backgroundColor},set:re=>{n.updateSelectedElementsStyle({backgroundColor:re})}}),de=ve(()=>{var re;return n.selectedElementIds.length===0?!1:((re=n.selectedElement)==null?void 0:re.locked)||!1}),te=ve(()=>{var re;return!n.selectedElementId||de.value||((re=n.selectedElement)==null?void 0:re.type)===ye.IMAGE}),ue=()=>{n.updateSelectedElementsStyle({fontWeight:L.value?"400":"700"})},ie=()=>{n.updateSelectedElementsStyle({fontStyle:O.value?"normal":"italic"})},he=()=>{n.updateSelectedElementsStyle({textDecoration:ne.value?"none":"underline"})},Q=()=>{n.updateSelectedElementsStyle({writingMode:T.value?"horizontal-tb":"vertical-rl"})},ae=()=>{n.updateSelectedElementsStyle({rotate:0})},h=ve(()=>[{label:s("editor.fonts.default"),value:""},{label:s("editor.fonts.arial"),value:"Arial, sans-serif"},{label:s("editor.fonts.timesNewRoman"),value:'"Times New Roman", serif'},{label:s("editor.fonts.courierNew"),value:'"Courier New", monospace'},{label:s("editor.fonts.simSun"),value:"SimSun, serif"},{label:s("editor.fonts.simHei"),value:"SimHei, sans-serif"}]),U=()=>{const re=Math.round(n.zoom*100),j=Math.min(re+10,500);n.setZoom(j/100),J.value=j},Z=()=>{const re=Math.round(n.zoom*100),j=Math.max(re-10,20);n.setZoom(j/100),J.value=j};Ae(()=>n.zoom,re=>{J.value=Math.round(re*100)});const A=()=>{const re=Math.max(20,Math.min(500,J.value));J.value=re,n.setZoom(re/100)},I=async()=>{try{E.value=await C(),W.value=!0}catch(re){console.error(re),alert("Preview generation failed")}},X=async()=>{const re=Array.from(document.querySelectorAll(".print-page"));if(i.value!=="browser"&&!d.value){w.value=re,c.value=!0;return}await M(re,{mode:y.value})},K=async re=>{i.value==="local"&&Object.assign(u,re),i.value==="remote"&&Object.assign(g,re);const j=w.value||Array.from(document.querySelectorAll(".print-page"));w.value=null,c.value=!1,await M(j,{mode:y.value,options:re})},le=async()=>{const re=me();await F(void 0,`${re}.pdf`)},V=async()=>{const re=me();await z(void 0,re)},pe=()=>{if(l.currentTemplateId){const re=l.templates.find(j=>j.id===l.currentTemplateId);if(re){l.saveCurrentTemplate(re.name);return}}f.value="save",b.value="",k.value=!0},we=()=>{f.value="saveAs";const re=l.templates.find(j=>j.id===l.currentTemplateId);b.value=re?`${re.name} Copy`:"",k.value=!0},ge=re=>{f.value==="saveAs"?l.createTemplate(re):l.saveCurrentTemplate(re),k.value=!1},me=()=>{const re=l.templates.find(Fe=>Fe.id===l.currentTemplateId),be=((re==null?void 0:re.name)||"print-design").trim().replace(/[\\/:*?"<>|]/g,"-").replace(/\s+/g," ").trim()||"print-design",ze=new Date,Oe=ze.getFullYear(),He=String(ze.getMonth()+1).padStart(2,"0"),Ie=String(ze.getDate()).padStart(2,"0");return`${be}-${Oe}${He}${Ie}`};return Ve(()=>{window.addEventListener("designer:preview",I),window.addEventListener("designer:save",pe),window.addEventListener("designer:save-as",we),window.addEventListener("designer:print",X),window.addEventListener("designer:export-pdf",le),window.addEventListener("designer:view-json",v),window.addEventListener("designer:view-blob",Y)}),We(()=>{window.removeEventListener("designer:preview",I),window.removeEventListener("designer:save",pe),window.removeEventListener("designer:save-as",we),window.removeEventListener("designer:print",X),window.removeEventListener("designer:export-pdf",le),window.removeEventListener("designer:view-json",v),window.removeEventListener("designer:view-blob",Y)}),(re,j)=>(P(),q(Te,null,[o("div",Wm,[fe(lp),fe(Dt,{show:k.value,title:f.value==="saveAs"?a(s)("editor.saveAsTemplate"):a(s)("editor.saveTemplate"),"initial-value":b.value,onClose:j[0]||(j[0]=be=>k.value=!1),onSave:ge},null,8,["show","title","initial-value"]),o("div",Gm,[$e(o("select",{"onUpdate:modelValue":j[1]||(j[1]=be=>$.value=be),disabled:te.value,class:"w-32 text-sm bg-transparent border-none outline-none focus:ring-0 cursor-pointer disabled:cursor-not-allowed disabled:opacity-50",title:a(s)("editor.fontFamily")},[(P(!0),q(Te,null,Me(h.value,be=>(P(),q("option",{key:be.value,value:be.value},S(be.label),9,Ym))),128))],8,Km),[[Ze,$.value]]),j[39]||(j[39]=o("div",{class:"w-px h-4 bg-gray-300"},null,-1)),o("div",Xm,[o("button",{onClick:j[2]||(j[2]=be=>N.value--),disabled:te.value,class:"w-6 h-6 flex items-center justify-center hover:bg-gray-200 rounded text-sm font-medium disabled:opacity-50 disabled:cursor-not-allowed"},"-",8,Zm),$e(o("input",{type:"number","onUpdate:modelValue":j[3]||(j[3]=be=>N.value=be),disabled:te.value,class:"w-12 text-center text-sm bg-transparent border-none outline-none focus:ring-0 p-0 disabled:opacity-50 disabled:cursor-not-allowed [appearance:textfield] [-moz-appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none",min:"1",max:"200"},null,8,Jm),[[Be,N.value]]),o("button",{onClick:j[4]||(j[4]=be=>N.value++),disabled:te.value,class:"w-6 h-6 flex items-center justify-center hover:bg-gray-200 rounded text-sm font-medium disabled:opacity-50 disabled:cursor-not-allowed"},"+",8,Qm)]),j[40]||(j[40]=o("div",{class:"w-px h-4 bg-gray-300"},null,-1)),o("button",{onClick:ue,disabled:te.value,class:ke(["p-1 hover:bg-gray-200 rounded transition-colors disabled:opacity-50 disabled:cursor-not-allowed",{"bg-gray-300 text-blue-700":L.value}]),title:a(s)("editor.bold")},[fe(a(Nu),{class:"w-4 h-4"})],10,eg),o("button",{onClick:ie,disabled:te.value,class:ke(["p-1 hover:bg-gray-200 rounded transition-colors disabled:opacity-50 disabled:cursor-not-allowed",{"bg-gray-300 text-blue-700":O.value}]),title:a(s)("editor.italic")},[fe(a(Vu),{class:"w-4 h-4"})],10,tg),o("button",{onClick:he,disabled:te.value,class:ke(["p-1 hover:bg-gray-200 rounded transition-colors disabled:opacity-50 disabled:cursor-not-allowed",{"bg-gray-300 text-blue-700":ne.value}]),title:a(s)("editor.underline")},[fe(a(Ku),{class:"w-4 h-4"})],10,rg),o("button",{onClick:Q,disabled:te.value,class:ke(["p-1 hover:bg-gray-200 rounded transition-colors disabled:opacity-50 disabled:cursor-not-allowed",{"bg-gray-300 text-blue-700":T.value}]),title:a(s)("editor.verticalText")},[fe(a(Zu),{class:"w-4 h-4"})],10,ng),fe(vt,{modelValue:D.value,"onUpdate:modelValue":j[5]||(j[5]=be=>D.value=be),disabled:te.value,"default-color":"#000000"},{trigger:it(({color:be})=>[o("button",{type:"button",class:"flex items-center gap-1 p-1 hover:bg-gray-200 rounded transition-colors disabled:opacity-50 disabled:cursor-not-allowed",disabled:te.value,title:a(s)("editor.textColor")},[fe(a(sc),{class:"w-4 h-4"}),o("div",{class:"w-1 h-3.5 rounded-[1px] border border-gray-300",style:_e({backgroundColor:be})},null,4)],8,og)]),_:1},8,["modelValue","disabled"]),fe(vt,{modelValue:oe.value,"onUpdate:modelValue":j[6]||(j[6]=be=>oe.value=be),disabled:te.value,"allow-transparent":!0,"default-color":"transparent"},{trigger:it(({color:be})=>[o("button",{type:"button",class:"flex items-center gap-1 p-1 hover:bg-gray-200 rounded transition-colors disabled:opacity-50 disabled:cursor-not-allowed",disabled:te.value,title:a(s)("editor.backgroundColor")},[fe(a(ic),{class:"w-4 h-4"}),o("div",ag,[be==="transparent"?(P(),q("div",lg)):xe("",!0),o("div",{class:"absolute inset-0",style:_e({backgroundColor:be==="transparent"?"transparent":be})},null,4),be==="transparent"?(P(),q("div",ig,[...j[38]||(j[38]=[o("div",{class:"w-full h-[1px] bg-red-500 rotate-90 transform scale-150"},null,-1)])])):xe("",!0)])],8,sg)]),_:1},8,["modelValue","disabled"]),j[41]||(j[41]=o("div",{class:"w-px h-4 bg-gray-300"},null,-1)),o("button",{onClick:ae,disabled:de.value||!a(n).selectedElementId,class:"p-1 hover:bg-gray-200 rounded transition-colors disabled:opacity-50 disabled:cursor-not-allowed",title:a(s)("editor.resetRotation")},[fe(a(ec),{class:"w-4 h-4"})],8,dg)]),j[47]||(j[47]=o("div",{class:"h-6 w-px bg-gray-300"},null,-1)),o("div",ug,[o("button",{onClick:j[7]||(j[7]=be=>a(n).alignSelectedElements("left")),disabled:!a(n).selectedElementId||de.value,class:"p-1 hover:bg-gray-200 rounded disabled:opacity-30 disabled:cursor-not-allowed",title:a(s)("editor.alignLeft")},[fe(a(Su),{class:"w-4 h-4"})],8,cg),o("button",{onClick:j[8]||(j[8]=be=>a(n).alignSelectedElements("center")),disabled:!a(n).selectedElementId||de.value,class:"p-1 hover:bg-gray-200 rounded disabled:opacity-30 disabled:cursor-not-allowed",title:a(s)("editor.alignCenter")},[fe(a(Tu),{class:"w-4 h-4"})],8,hg),o("button",{onClick:j[9]||(j[9]=be=>a(n).alignSelectedElements("right")),disabled:!a(n).selectedElementId||de.value,class:"p-1 hover:bg-gray-200 rounded disabled:opacity-30 disabled:cursor-not-allowed",title:a(s)("editor.alignRight")},[fe(a(Au),{class:"w-4 h-4"})],8,pg),j[43]||(j[43]=o("div",{class:"w-px h-4 bg-gray-300 mx-1"},null,-1)),o("button",{onClick:j[10]||(j[10]=be=>a(n).alignSelectedElements("top")),disabled:!a(n).selectedElementId||de.value,class:"p-1 hover:bg-gray-200 rounded disabled:opacity-30 disabled:cursor-not-allowed",title:a(s)("editor.alignTop")},[fe(a(Lu),{class:"w-4 h-4"})],8,fg),o("button",{onClick:j[11]||(j[11]=be=>a(n).alignSelectedElements("middle")),disabled:!a(n).selectedElementId||de.value,class:"p-1 hover:bg-gray-200 rounded disabled:opacity-30 disabled:cursor-not-allowed",title:a(s)("editor.alignMiddle")},[fe(a(Du),{class:"w-4 h-4"})],8,mg),o("button",{onClick:j[12]||(j[12]=be=>a(n).alignSelectedElements("bottom")),disabled:!a(n).selectedElementId||de.value,class:"p-1 hover:bg-gray-200 rounded disabled:opacity-30 disabled:cursor-not-allowed",title:a(s)("editor.alignBottom")},[fe(a(qu),{class:"w-4 h-4"})],8,gg),a(n).selectedElementIds.length>1?(P(),q(Te,{key:0},[j[42]||(j[42]=o("div",{class:"w-px h-4 bg-gray-300 mx-1"},null,-1)),o("button",{onClick:j[13]||(j[13]=be=>a(n).groupSelectedElements()),disabled:de.value,class:"p-1 hover:bg-gray-200 rounded disabled:opacity-30 disabled:cursor-not-allowed",title:a(s)("editor.group")},[fe(a(pc),{class:"w-4 h-4"})],8,vg)],64)):xe("",!0)]),j[48]||(j[48]=o("div",{class:"h-6 w-px bg-gray-300"},null,-1)),o("div",bg,[o("button",{onClick:j[14]||(j[14]=be=>a(n).undo()),disabled:a(n).historyPast.length===0,class:"p-1 hover:bg-gray-200 rounded disabled:opacity-30 disabled:cursor-not-allowed",title:a(s)("common.undo")+" ("+a(Re)(["Ctrl","Z"])+")"},[fe(a(Rl),{class:"w-4 h-4"})],8,yg),o("button",{onClick:j[15]||(j[15]=be=>a(n).redo()),disabled:a(n).historyFuture.length===0,class:"p-1 hover:bg-gray-200 rounded disabled:opacity-30 disabled:cursor-not-allowed",title:a(s)("common.redo")+" ("+a(Re)(["Ctrl","Y"])+")"},[fe(a(Dl),{class:"w-4 h-4"})],8,wg),j[44]||(j[44]=o("div",{class:"w-px h-4 bg-gray-300 mx-1"},null,-1)),o("button",{onClick:j[16]||(j[16]=be=>a(n).copy()),disabled:!a(n).selectedElementId||de.value,class:"p-1 hover:bg-gray-200 rounded disabled:opacity-30 disabled:cursor-not-allowed",title:a(s)("common.copy")+" ("+a(Re)(["Ctrl","C"])+")"},[fe(a(xt),{class:"w-4 h-4"})],8,xg),o("button",{onClick:j[17]||(j[17]=be=>a(n).paste()),disabled:a(n).clipboard.length===0,class:"p-1 hover:bg-gray-200 rounded disabled:opacity-30 disabled:cursor-not-allowed",title:a(s)("common.paste")+" ("+a(Re)(["Ctrl","V"])+")"},[fe(a(Co),{class:"w-4 h-4"})],8,_g),j[45]||(j[45]=o("div",{class:"w-px h-4 bg-gray-300 mx-1"},null,-1)),o("button",{onClick:j[18]||(j[18]=be=>a(n).toggleLock()),disabled:!a(n).selectedElementId,class:"p-1 hover:bg-gray-200 rounded disabled:opacity-30 disabled:cursor-not-allowed",title:(de.value?a(s)("editor.unlock"):a(s)("editor.lock"))+" ("+a(Re)(["Ctrl","L"])+")"},[de.value?(P(),Pe(a(Bl),{key:0,class:"w-4 h-4 text-red-500"})):(P(),Pe(a(Xt),{key:1,class:"w-4 h-4"}))],8,kg),o("button",{onClick:j[19]||(j[19]=be=>a(n).removeSelectedElements()),disabled:!a(n).selectedElementId||de.value,class:"p-1 hover:bg-gray-200 rounded disabled:opacity-30 disabled:cursor-not-allowed",title:a(s)("common.delete")+" ("+a(Re)(["Del"])+")"},[fe(a(wt),{class:"w-4 h-4"})],8,Sg)]),j[49]||(j[49]=o("div",{class:"h-6 w-px bg-gray-300"},null,-1)),fe(Cf),o("div",Cg,[o("div",Eg,[o("button",{onClick:Z,class:"p-1 hover:bg-gray-200 rounded",title:a(s)("editor.zoomOut")},[fe(a(Ll),{class:"w-4 h-4"})],8,Tg),o("button",{onClick:j[20]||(j[20]=be=>ee.value=!ee.value),class:"text-xs w-12 text-center hover:bg-gray-200 rounded px-1 py-0.5",title:a(s)("editor.zoomSettings")},S(Math.round(a(n).zoom*100))+"% ",9,$g),o("button",{onClick:U,class:"p-1 hover:bg-gray-200 rounded",title:a(s)("editor.zoomIn")},[fe(a(Pl),{class:"w-4 h-4"})],8,Ig)]),ee.value?(P(),q("div",Ag,[o("h3",zg,S(a(s)("editor.zoomLevel")),1),o("div",Pg,[o("div",null,[o("label",Lg,S(a(s)("editor.zoomLevel"))+" (20% - 500%)",1),$e(o("input",{type:"range",min:"20",max:"500",step:"10","onUpdate:modelValue":j[21]||(j[21]=be=>J.value=be),onInput:A,class:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer [&::-webkit-slider-thumb]:appearance-none [&::-webkit-slider-thumb]:w-4 [&::-webkit-slider-thumb]:h-4 [&::-webkit-slider-thumb]:bg-blue-600 [&::-webkit-slider-thumb]:rounded-full [&::-webkit-slider-thumb]:cursor-pointer [&::-webkit-slider-thumb]:transition-all [&::-webkit-slider-thumb]:hover:scale-110 [&::-moz-range-thumb]:w-4 [&::-moz-range-thumb]:h-4 [&::-moz-range-thumb]:bg-blue-600 [&::-moz-range-thumb]:border-none [&::-moz-range-thumb]:rounded-full [&::-moz-range-thumb]:cursor-pointer [&::-moz-range-thumb]:transition-all [&::-moz-range-thumb]:hover:scale-110"},null,544),[[Be,J.value,void 0,{number:!0}]]),o("div",Mg,S(J.value)+"%",1)])]),o("div",{class:"fixed inset-0 z-[-1]",onClick:j[22]||(j[22]=be=>ee.value=!1)})])):xe("",!0)]),j[50]||(j[50]=o("div",{class:"h-6 w-px bg-gray-300"},null,-1)),o("div",Rg,[o("div",Dg,[o("button",{onClick:pe,disabled:a(l).isSaving,class:"flex items-center gap-2 px-3 py-1.5 bg-blue-600 text-white rounded-l-md hover:bg-blue-700 transition-colors text-sm border-r border-blue-500 disabled:opacity-50 disabled:cursor-not-allowed"},[a(l).isSaving?(P(),Pe(a(hu),{key:0,class:"w-4 h-4 animate-spin"})):(P(),Pe(a(So),{key:1,class:"w-4 h-4"})),o("span",null,S(a(s)("common.save")),1)],8,Bg),o("button",{onClick:j[23]||(j[23]=be=>B.value=!B.value),class:"px-2 py-1.5 bg-blue-600 text-white rounded-r-md hover:bg-blue-700 transition-colors text-sm flex items-center"},[fe(a(Eo),{class:"w-5 h-5"})])]),B.value?(P(),q("div",Og,[o("button",{onClick:j[24]||(j[24]=be=>{we(),B.value=!1}),class:"w-full flex items-center gap-2 px-3 py-2 text-gray-700 hover:bg-gray-50 rounded text-sm text-left transition-colors whitespace-nowrap"},[fe(a(Ml),{class:"w-4 h-4 text-gray-500"}),o("span",null,S(a(s)("editor.saveAsTemplate")),1)]),o("button",{onClick:j[25]||(j[25]=be=>{I(),B.value=!1}),class:"w-full flex items-center gap-2 px-3 py-2 text-gray-700 hover:bg-gray-50 rounded text-sm text-left transition-colors whitespace-nowrap"},[fe(a(Gd),{class:"w-4 h-4 text-gray-500"}),o("span",null,S(a(s)("editor.preview")),1)]),o("button",{onClick:j[26]||(j[26]=be=>{X(),B.value=!1}),class:"w-full flex items-center gap-2 px-3 py-2 text-gray-700 hover:bg-gray-50 rounded text-sm text-left transition-colors whitespace-nowrap"},[fe(a(_o),{class:"w-4 h-4 text-gray-500"}),o("span",null,S(a(s)("editor.print")),1)]),o("button",{onClick:j[27]||(j[27]=be=>{le(),B.value=!1}),class:"w-full flex items-center gap-2 px-3 py-2 text-gray-700 hover:bg-gray-50 rounded text-sm text-left transition-colors whitespace-nowrap"},[fe(a(Ht),{class:"w-4 h-4 text-gray-500"}),o("span",null,S(a(s)("editor.exportPdf")),1)]),o("button",{onClick:j[28]||(j[28]=be=>{V(),B.value=!1}),class:"w-full flex items-center gap-2 px-3 py-2 text-gray-700 hover:bg-gray-50 rounded text-sm text-left transition-colors whitespace-nowrap"},[fe(a(Ht),{class:"w-4 h-4 text-gray-500"}),o("span",null,S(a(s)("editor.exportImage")),1)]),o("button",{onClick:j[29]||(j[29]=be=>{Y(),B.value=!1}),class:"w-full flex items-center gap-2 px-3 py-2 text-gray-700 hover:bg-gray-50 rounded text-sm text-left transition-colors whitespace-nowrap"},[fe(a(lt),{class:"w-4 h-4 text-gray-500"}),o("span",null,S(a(s)("editor.viewImageBlob")),1)]),o("button",{onClick:j[30]||(j[30]=be=>{se(),B.value=!1}),class:"w-full flex items-center gap-2 px-3 py-2 text-gray-700 hover:bg-gray-50 rounded text-sm text-left transition-colors whitespace-nowrap"},[fe(a(lt),{class:"w-4 h-4 text-gray-500"}),o("span",null,S(a(s)("editor.viewPdfBlob")),1)]),o("button",{onClick:j[31]||(j[31]=be=>{v(),B.value=!1}),class:"w-full flex items-center gap-2 px-3 py-2 text-gray-700 hover:bg-gray-50 rounded text-sm text-left transition-colors whitespace-nowrap"},[fe(a(lt),{class:"w-4 h-4 text-gray-500"}),o("span",null,S(a(s)("editor.viewJson")),1)]),j[46]||(j[46]=o("div",{class:"h-px bg-gray-200 my-0.5"},null,-1)),o("button",{onClick:j[32]||(j[32]=be=>{t("toggleHelp"),B.value=!1}),class:"w-full flex items-center gap-2 px-3 py-2 text-gray-700 hover:bg-gray-50 rounded text-sm text-left transition-colors whitespace-nowrap"},[fe(a(xu),{class:"w-4 h-4 text-gray-500"}),o("span",null,S(a(s)("editor.help")),1)]),o("button",{onClick:j[33]||(j[33]=be=>{t("toggleSettings"),B.value=!1}),class:"w-full flex items-center gap-2 px-3 py-2 text-gray-700 hover:bg-gray-50 rounded text-sm text-left transition-colors whitespace-nowrap"},[fe(a(ko),{class:"w-4 h-4 text-gray-500"}),o("span",null,S(a(s)("editor.settings")),1)])])):xe("",!0),B.value?(P(),q("div",{key:1,class:"fixed inset-0 z-[999]",onClick:j[34]||(j[34]=be=>B.value=!1)})):xe("",!0)])]),fe(Zc,{visible:W.value,"onUpdate:visible":j[35]||(j[35]=be=>W.value=be),"html-content":E.value,width:a(n).canvasSize.width},null,8,["visible","html-content","width"]),fe(Vm,{show:c.value,"onUpdate:show":j[36]||(j[36]=be=>c.value=be),mode:y.value,options:G.value,onConfirm:K},null,8,["show","mode","options"]),fe(Rt,{visible:m.value,"onUpdate:visible":j[37]||(j[37]=be=>m.value=be),title:p.value,value:x.value,language:_.value,"read-only":""},null,8,["visible","title","value","language"])],64))}}),jl="/Vue-Print-Designer/assets/logo-D22CyW4G.png";var Fg=Yl();const jg={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function Ng(r,e){return P(),q("svg",jg,[...e[0]||(e[0]=[o("path",{fill:"currentColor",d:"M4 19q-.825 0-1.412-.587T2 17V7q0-.825.588-1.412T4 5h16q.825 0 1.413.588T22 7v10q0 .825-.587 1.413T20 19zm4-3h8v-2H8zm-3-3h2v-2H5zm3 0h2v-2H8zm3 0h2v-2h-2zm3 0h2v-2h-2zm3 0h2v-2h-2zM5 10h2V8H5zm3 0h2V8H8zm3 0h2V8h-2zm3 0h2V8h-2zm3 0h2V8h-2z"},null,-1)])])}const Hg=Se({name:"material-symbols-keyboard",render:Ng}),Ug={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function Vg(r,e){return P(),q("svg",Ug,[...e[0]||(e[0]=[o("path",{fill:"currentColor",d:"M11 17h2v-6h-2zm1-8q.425 0 .713-.288T13 8t-.288-.712T12 7t-.712.288T11 8t.288.713T12 9m0 13q-2.075 0-3.9-.788t-3.175-2.137T2.788 15.9T2 12t.788-3.9t2.137-3.175T8.1 2.788T12 2t3.9.788t3.175 2.137T21.213 8.1T22 12t-.788 3.9t-2.137 3.175t-3.175 2.138T12 22"},null,-1)])])}const Wg=Se({name:"material-symbols-info",render:Vg}),Gg="vue-print-designer",Kg="0.9.2",Yg={"@guolao/vue-monaco-editor":"^1.6.0",canvg:"^4.0.3","dom-to-image-more":"^3.7.2",jszip:"^3.10.1",jsbarcode:"^3.12.3",jspdf:"^2.5.2",lodash:"^4.17.21",pinia:"^2.3.0",qrcode:"^1.5.4",uuid:"^11.0.3",vue:"^3.5.13","vue-i18n":"^11.2.8"},so={name:Gg,version:Kg,dependencies:Yg},Xg={class:"bg-white rounded-lg shadow-xl w-[700px] max-w-full h-[500px] flex overflow-hidden"},Zg={class:"w-48 bg-gray-50 border-r border-gray-200 flex flex-col"},Jg={class:"h-[60px] flex items-center px-4 border-b border-gray-200"},Qg={class:"text-lg font-semibold text-gray-800"},e0={class:"flex-1 py-2"},t0={class:"flex-1 flex flex-col min-w-0"},r0={class:"h-[60px] flex items-center justify-between px-4 border-b border-gray-200"},n0={class:"text-lg font-semibold text-gray-800"},o0={class:"flex-1 overflow-y-auto p-6"},s0={key:0,class:"space-y-6"},a0={class:"grid grid-cols-1 gap-6 text-sm"},l0={class:"font-medium text-gray-900 mb-3 border-b pb-1"},i0={class:"space-y-2 text-gray-600"},d0={class:"flex justify-between items-center"},u0={class:"bg-gray-100 px-2 py-0.5 rounded border text-xs"},c0={class:"flex justify-between items-center"},h0={class:"bg-gray-100 px-2 py-0.5 rounded border text-xs"},p0={class:"flex justify-between items-center"},f0={class:"bg-gray-100 px-2 py-0.5 rounded border text-xs"},m0={class:"flex justify-between items-center"},g0={class:"bg-gray-100 px-2 py-0.5 rounded border text-xs"},v0={class:"flex justify-between items-center"},b0={class:"bg-gray-100 px-2 py-0.5 rounded border text-xs"},y0={class:"flex justify-between items-center"},w0={class:"bg-gray-100 px-2 py-0.5 rounded border text-xs"},x0={class:"flex justify-between items-center"},_0={class:"bg-gray-100 px-2 py-0.5 rounded border text-xs"},k0={class:"flex justify-between items-center"},S0={class:"bg-gray-100 px-2 py-0.5 rounded border text-xs"},C0={class:"flex justify-between items-center"},E0={class:"bg-gray-100 px-2 py-0.5 rounded border text-xs"},T0={class:"flex justify-between items-center"},$0={class:"bg-gray-100 px-2 py-0.5 rounded border text-xs"},I0={class:"flex justify-between items-center"},A0={class:"bg-gray-100 px-2 py-0.5 rounded border text-xs"},z0={class:"flex justify-between items-center"},P0={class:"bg-gray-100 px-2 py-0.5 rounded border text-xs"},L0={class:"flex justify-between items-center"},M0={class:"bg-gray-100 px-2 py-0.5 rounded border text-xs"},R0={class:"font-medium text-gray-900 mb-3 border-b pb-1"},D0={class:"space-y-2 text-gray-600"},B0={class:"flex justify-between items-center"},O0={class:"bg-gray-100 px-2 py-0.5 rounded border text-xs"},q0={class:"flex justify-between items-center"},F0={class:"bg-gray-100 px-2 py-0.5 rounded border text-xs"},j0={class:"flex justify-between items-center"},N0={class:"bg-gray-100 px-2 py-0.5 rounded border text-xs"},H0={class:"flex justify-between items-center"},U0={class:"bg-gray-100 px-2 py-0.5 rounded border text-xs"},V0={class:"flex justify-between items-center"},W0={class:"bg-gray-100 px-2 py-0.5 rounded border text-xs"},G0={class:"flex justify-between items-center"},K0={class:"bg-gray-100 px-2 py-0.5 rounded border text-xs"},Y0={class:"flex justify-between items-center"},X0={class:"bg-gray-100 px-2 py-0.5 rounded border text-xs"},Z0={class:"flex justify-between items-center"},J0={class:"bg-gray-100 px-2 py-0.5 rounded border text-xs"},Q0={class:"flex justify-between items-center"},ev={class:"bg-gray-100 px-2 py-0.5 rounded border text-xs"},tv={class:"flex justify-between items-center"},rv={class:"bg-gray-100 px-2 py-0.5 rounded border text-xs"},nv={class:"font-medium text-gray-900 mb-3 border-b pb-1"},ov={class:"space-y-2 text-gray-600"},sv={class:"flex justify-between items-center"},av={class:"bg-gray-100 px-2 py-0.5 rounded border text-xs"},lv={class:"flex justify-between items-center"},iv={class:"bg-gray-100 px-2 py-0.5 rounded border text-xs"},dv={class:"flex justify-between items-center"},uv={class:"bg-gray-100 px-2 py-0.5 rounded border text-xs"},cv={class:"flex justify-between items-center"},hv={class:"bg-gray-100 px-2 py-0.5 rounded border text-xs"},pv={key:1,class:"space-y-6"},fv={class:"text-center mb-8"},mv={class:"text-xl font-bold text-gray-800"},gv={class:"mt-4 flex justify-center"},vv=["title"],bv={class:"text-gray-600"},yv={class:"font-medium text-gray-900 mb-3 border-b pb-1"},wv={class:"bg-gray-50 rounded-lg border border-gray-200 overflow-hidden"},xv={class:"w-full text-sm text-left"},_v={class:"bg-gray-100 text-gray-700 font-medium"},kv={class:"px-4 py-2 border-b"},Sv={class:"px-4 py-2 border-b"},Cv={class:"divide-y divide-gray-200"},Ev={class:"px-4 py-2 text-gray-700 font-mono"},Tv={class:"px-4 py-2 text-gray-500"},$v={class:"p-4 border-t border-gray-200 bg-gray-50 flex justify-end rounded-br-lg"},Iv=Le({__name:"HelpModal",props:{show:{type:Boolean}},emits:["update:show"],setup(r,{emit:e}){const t=r,s=e,{t:n}=je(),l=De(),i=ce("shortcuts"),d=()=>{s("update:show",!1)},u=x=>{t.show&&x.key==="Escape"&&(x.preventDefault(),d())};Ve(()=>{window.addEventListener("keydown",u)}),Ae(()=>t.show,x=>{l.setDisableGlobalShortcuts(x)}),We(()=>{window.removeEventListener("keydown",u),t.show&&l.setDisableGlobalShortcuts(!1)});const g=Object.entries(so.dependencies).map(([x,p])=>({name:x,version:p})),y=so.version,m=Fg.startCase(so.name);return(x,p)=>(P(),Pe(et,{to:"body"},[r.show?(P(),q("div",{key:0,class:"fixed inset-0 z-[99999] flex items-center justify-center bg-black/50",onClick:Ke(d,["self"])},[o("div",Xg,[o("div",Zg,[o("div",Jg,[o("h3",Qg,S(a(n)("help.title")),1)]),o("div",e0,[o("button",{onClick:p[0]||(p[0]=_=>i.value="shortcuts"),class:ke(["w-full text-left px-4 py-3 flex items-center gap-3 transition-colors text-sm",i.value==="shortcuts"?"bg-white text-blue-600 border-l-4 border-blue-600 font-medium":"text-gray-600 hover:bg-gray-100 border-l-4 border-transparent"])},[fe(a(Hg),{class:"w-5 h-5"}),Ce(" "+S(a(n)("shortcuts.title")),1)],2),o("button",{onClick:p[1]||(p[1]=_=>i.value="about"),class:ke(["w-full text-left px-4 py-3 flex items-center gap-3 transition-colors text-sm",i.value==="about"?"bg-white text-blue-600 border-l-4 border-blue-600 font-medium":"text-gray-600 hover:bg-gray-100 border-l-4 border-transparent"])},[fe(a(Wg),{class:"w-5 h-5"}),Ce(" "+S(a(n)("help.about")),1)],2)])]),o("div",t0,[o("div",r0,[o("h3",n0,S(i.value==="shortcuts"?a(n)("shortcuts.keyboardShortcuts"):a(n)("help.aboutProject",{name:a(m)})),1),o("button",{onClick:d,class:"p-1 hover:bg-gray-100 rounded-full transition-colors text-gray-500"},[fe(a(pt),{class:"w-4 h-4"})])]),o("div",o0,[i.value==="shortcuts"?(P(),q("div",s0,[o("div",a0,[o("div",null,[o("h4",l0,S(a(n)("shortcuts.general")),1),o("ul",i0,[o("li",d0,[o("span",null,S(a(n)("common.save")),1),p[2]||(p[2]=Ce()),o("kbd",u0,S(a(Re)(["Ctrl","S"])),1)]),o("li",c0,[o("span",null,S(a(n)("shortcuts.saveAsTemplate")),1),p[3]||(p[3]=Ce()),o("kbd",h0,S(a(Re)(["Ctrl","Shift","S"])),1)]),o("li",p0,[o("span",null,S(a(n)("editor.print")),1),p[4]||(p[4]=Ce()),o("kbd",f0,S(a(Re)(["Ctrl","P"])),1)]),o("li",m0,[o("span",null,S(a(n)("editor.exportPdf")),1),p[5]||(p[5]=Ce()),o("kbd",g0,S(a(Re)(["Ctrl","Shift","E"])),1)]),o("li",v0,[o("span",null,S(a(n)("editor.preview")),1),p[6]||(p[6]=Ce()),o("kbd",b0,S(a(Re)(["Ctrl","Shift","P"])),1)]),o("li",y0,[o("span",null,S(a(n)("editor.viewJson")),1),p[7]||(p[7]=Ce()),o("kbd",w0,S(a(Re)(["Ctrl","Shift","J"])),1)]),o("li",x0,[o("span",null,S(a(n)("shortcuts.newTemplate")),1),p[8]||(p[8]=Ce()),o("kbd",_0,S(a(Re)(["Ctrl","Alt","N"])),1)]),o("li",k0,[o("span",null,S(a(n)("shortcuts.openSettings")),1),p[9]||(p[9]=Ce()),o("kbd",S0,S(a(Re)(["Ctrl",","])),1)]),o("li",C0,[o("span",null,S(a(n)("common.undo")),1),p[10]||(p[10]=Ce()),o("kbd",E0,S(a(Re)(["Ctrl","Z"])),1)]),o("li",T0,[o("span",null,S(a(n)("common.redo")),1),p[11]||(p[11]=Ce()),o("kbd",$0,S(a(Re)(["Ctrl","Y"])),1)]),o("li",I0,[o("span",null,S(a(n)("shortcuts.openHelp")),1),p[12]||(p[12]=Ce()),o("kbd",A0,S(a(Re)(["Ctrl","H"])),1)]),o("li",z0,[o("span",null,S(a(n)("shortcuts.zoom")),1),p[13]||(p[13]=Ce()),o("kbd",P0,S(a(Re)(["Ctrl","Wheel"])),1)]),o("li",L0,[o("span",null,S(a(n)("shortcuts.closeModal")),1),p[14]||(p[14]=Ce()),o("kbd",M0,S(a(Re)(["Esc"])),1)])])]),o("div",null,[o("h4",R0,S(a(n)("shortcuts.editing")),1),o("ul",D0,[o("li",B0,[o("span",null,S(a(n)("common.copy")),1),p[15]||(p[15]=Ce()),o("kbd",O0,S(a(Re)(["Ctrl","C"])),1)]),o("li",q0,[o("span",null,S(a(n)("common.cut")),1),p[16]||(p[16]=Ce()),o("kbd",F0,S(a(Re)(["Ctrl","X"])),1)]),o("li",j0,[o("span",null,S(a(n)("common.paste")),1),p[17]||(p[17]=Ce()),o("kbd",N0,S(a(Re)(["Ctrl","V"])),1)]),o("li",H0,[o("span",null,S(a(n)("common.delete")),1),p[18]||(p[18]=Ce()),o("kbd",U0,S(a(Re)(["Delete"])),1)]),o("li",V0,[o("span",null,S(a(n)("shortcuts.selectAll")),1),p[19]||(p[19]=Ce()),o("kbd",W0,S(a(Re)(["Ctrl","A"])),1)]),o("li",G0,[o("span",null,S(a(n)("shortcuts.multiSelect")),1),p[20]||(p[20]=Ce()),o("kbd",K0,S(a(Re)(["Ctrl","Click"])),1)]),o("li",Y0,[o("span",null,S(a(n)("common.lock"))+"/"+S(a(n)("common.unlock")),1),p[21]||(p[21]=Ce()),o("kbd",X0,S(a(Re)(["Ctrl","L"])),1)]),o("li",Z0,[o("span",null,S(a(n)("shortcuts.customEditSave")),1),p[22]||(p[22]=Ce()),o("kbd",J0,S(a(Re)(["Ctrl","S"])),1)]),o("li",Q0,[o("span",null,S(a(n)("shortcuts.customEditSaveAs")),1),p[23]||(p[23]=Ce()),o("kbd",ev,S(a(Re)(["Ctrl","Shift","S"])),1)]),o("li",tv,[o("span",null,S(a(n)("shortcuts.customEditExit")),1),p[24]||(p[24]=Ce()),o("kbd",rv,S(a(Re)(["Ctrl","Q"])),1)])])]),o("div",null,[o("h4",nv,S(a(n)("shortcuts.manipulation")),1),o("ul",ov,[o("li",sv,[o("span",null,S(a(n)("shortcuts.move")),1),p[25]||(p[25]=Ce()),o("kbd",av,S(a(n)("shortcuts.arrow")),1)]),o("li",lv,[o("span",null,S(a(n)("shortcuts.fastMove")),1),p[26]||(p[26]=Ce()),o("kbd",iv,S(a(Re)(["Shift",a(n)("shortcuts.arrow")])),1)]),o("li",dv,[o("span",null,S(a(n)("shortcuts.snapRotate")),1),p[27]||(p[27]=Ce()),o("kbd",uv,S(a(Re)(["Shift",a(n)("shortcuts.drag")])),1)]),o("li",cv,[o("span",null,S(a(n)("shortcuts.resize")),1),p[28]||(p[28]=Ce()),o("kbd",hv,S(a(Re)(["Shift",a(n)("shortcuts.resize")])),1)])])])])])):xe("",!0),i.value==="about"?(P(),q("div",pv,[o("div",fv,[p[32]||(p[32]=o("img",{src:jl,alt:"Vue Print Designer",class:"w-12 h-12 mx-auto mb-2"},null,-1)),o("h2",mv,S(a(m)),1),o("div",gv,[o("a",{href:"https://github.com/0ldFive/Vue-Print-Designer",target:"_blank",rel:"noopener noreferrer",class:"group inline-flex items-center gap-2 rounded-full border border-gray-200 bg-gray-50 px-2.5 py-1 text-[11px] text-gray-700 shadow-sm transition-colors hover:border-blue-200 hover:bg-blue-50 hover:text-blue-700",title:a(n)("help.github")},[p[29]||(p[29]=o("span",{class:"inline-flex h-5 w-5 items-center justify-center rounded-full bg-white text-gray-700 shadow-sm transition-colors group-hover:text-blue-700"},[o("svg",{viewBox:"0 0 16 16","aria-hidden":"true",class:"w-3.5 h-3.5"},[o("path",{fill:"currentColor",d:"M8 0C3.58 0 0 3.73 0 8.35c0 3.7 2.29 6.83 5.47 7.94.4.08.55-.18.55-.4 0-.2-.01-.86-.01-1.56-2.01.38-2.53-.5-2.69-.96-.09-.24-.48-.96-.82-1.16-.28-.16-.68-.56-.01-.57.63-.01 1.08.6 1.23.85.72 1.25 1.87.9 2.33.69.07-.54.28-.9.51-1.11-1.78-.21-3.64-.92-3.64-4.08 0-.9.31-1.64.82-2.22-.08-.21-.36-1.06.08-2.2 0 0 .67-.22 2.2.85.64-.18 1.32-.27 2-.27s1.36.09 2 .27c1.53-1.07 2.2-.85 2.2-.85.44 1.14.16 1.99.08 2.2.51.58.82 1.32.82 2.22 0 3.17-1.87 3.87-3.65 4.08.29.26.54.77.54 1.56 0 1.12-.01 2.03-.01 2.32 0 .22.15.48.55.4C13.71 15.18 16 12.04 16 8.35 16 3.73 12.42 0 8 0z"})])],-1)),p[30]||(p[30]=o("span",{class:"text-gray-500 group-hover:text-blue-600"},"0ldFive/Vue-Print-Designer",-1)),p[31]||(p[31]=o("span",{class:"text-gray-400"},"|",-1)),o("span",bv,S(a(n)("help.version"))+" "+S(a(y)),1)],8,vv)])]),o("div",null,[o("h4",yv,S(a(n)("help.dependencies")),1),o("div",wv,[o("table",xv,[o("thead",_v,[o("tr",null,[o("th",kv,S(a(n)("help.package")),1),o("th",Sv,S(a(n)("help.version")),1)])]),o("tbody",Cv,[(P(!0),q(Te,null,Me(a(g),_=>(P(),q("tr",{key:_.name,class:"hover:bg-gray-50"},[o("td",Ev,S(_.name),1),o("td",Tv,S(_.version),1)]))),128))])])])])])):xe("",!0)]),o("div",$v,[o("button",{onClick:d,class:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 transition-colors text-sm"},S(a(n)("common.close")),1)])])])])):xe("",!0)]))}}),Av={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function zv(r,e){return P(),q("svg",Av,[...e[0]||(e[0]=[o("path",{fill:"currentColor",d:"m11.9 22l4.55-12h2.1l4.55 12H21l-1.075-3.05h-4.85L14 22zM4 19l-1.4-1.4l5.05-5.05q-.875-.875-1.588-2T4.75 8h2.1q.5.975 1 1.7t1.2 1.45q.825-.825 1.713-2.313T12.1 6H1V4h7V2h2v2h7v2h-2.9q-.525 1.8-1.575 3.7t-2.075 2.9l2.4 2.45l-.75 2.05l-3.05-3.125zm11.7-1.8h3.6l-1.8-5.1z"},null,-1)])])}const Pv=Se({name:"material-symbols-translate",render:zv}),Lv={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function Mv(r,e){return P(),q("svg",Lv,[...e[0]||(e[0]=[o("path",{fill:"currentColor",d:"M6.5 20q-2.275 0-3.887-1.575T1 14.575q0-1.95 1.175-3.475T5.25 9.15q.625-2.3 2.5-3.725T12 4q2.925 0 4.963 2.038T19 11q1.725.2 2.863 1.488T23 15.5q0 1.875-1.312 3.188T18.5 20z"},null,-1)])])}const Rv=Se({name:"material-symbols-cloud",render:Mv}),Dv={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function Bv(r,e){return P(),q("svg",Dv,[...e[0]||(e[0]=[o("path",{fill:"currentColor",d:"M11 17H7q-2.075 0-3.537-1.463T2 12t1.463-3.537T7 7h4v2H7q-1.25 0-2.125.875T4 12t.875 2.125T7 15h4zm-3-4v-2h8v2zm5 4v-2h4q1.25 0 2.125-.875T20 12t-.875-2.125T17 9h-4V7h4q2.075 0 3.538 1.463T22 12t-1.463 3.538T17 17z"},null,-1)])])}const Ha=Se({name:"material-symbols-link",render:Bv}),Ov={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function qv(r,e){return P(),q("svg",Ov,[...e[0]||(e[0]=[o("path",{fill:"currentColor",d:"m19.25 16.45l-1.5-1.55q1-.275 1.625-1.063T20 12q0-1.25-.875-2.125T17 9h-4V7h4q2.075 0 3.538 1.463T22 12q0 1.425-.737 2.625T19.25 16.45M15.85 13l-2-2H16v2zm3.95 9.6L1.4 4.2l1.4-1.4l18.4 18.4zM11 17H7q-2.075 0-3.537-1.463T2 12q0-1.725 1.05-3.075t2.7-1.775L7.6 9H7q-1.25 0-2.125.875T4 12t.875 2.125T7 15h4zm-3-4v-2h1.625l1.975 2z"},null,-1)])])}const Ua=Se({name:"material-symbols-link-off",render:qv}),Fv={class:"bg-white rounded-lg shadow-xl w-[700px] max-w-full h-[500px] flex overflow-hidden"},jv={class:"w-48 bg-gray-50 border-r border-gray-200 flex flex-col"},Nv={class:"h-[60px] flex items-center px-4 border-b border-gray-200"},Hv={class:"text-lg font-semibold text-gray-800"},Uv={class:"flex-1 py-2"},Vv={class:"flex-1 flex flex-col min-w-0 relative"},Wv={class:"h-[60px] flex items-center justify-between px-4 border-b border-gray-200"},Gv={class:"text-lg font-semibold text-gray-800"},Kv={class:"flex-1 overflow-y-auto p-6"},Yv={key:0,class:"space-y-4 text-sm text-gray-700"},Xv={class:"mb-2 font-medium text-gray-900"},Zv={class:"flex items-center gap-3"},Jv={class:"text-xs text-gray-500 mt-2"},Qv={class:"border-t border-gray-200 pt-4"},eb={class:"mb-2 font-medium text-gray-900"},tb={class:"flex flex-wrap gap-2"},rb=["onClick"],nb={class:"text-xs text-gray-500 mt-2"},ob={class:"border-t border-gray-200 pt-4"},sb={class:"flex items-center justify-between"},ab={class:"font-medium text-gray-900"},lb={class:"sr-only"},ib={class:"text-xs text-gray-500 mt-2"},db={class:"border-t border-gray-200 pt-4"},ub={class:"flex items-center justify-between"},cb={class:"font-medium text-gray-900"},hb={class:"sr-only"},pb={class:"text-xs text-gray-500 mt-2"},fb={class:"border-t border-gray-200 pt-4 space-y-3"},mb={class:"mb-2 font-medium text-gray-900"},gb={class:"flex items-center gap-3"},vb=["disabled"],bb=["disabled"],yb={class:"text-xs text-gray-500 mt-2"},wb={class:"flex items-center justify-between"},xb={class:"font-medium text-gray-900"},_b={class:"sr-only"},kb={class:"text-xs text-gray-500"},Sb={key:1,class:"space-y-4 text-sm text-gray-700"},Cb={class:"mb-2 font-medium text-gray-900"},Eb={class:"flex items-center gap-3"},Tb={class:"text-xs text-gray-500 mt-2"},$b={key:2,class:"space-y-4 text-sm text-gray-700"},Ib={class:"space-y-2"},Ab={class:"font-medium text-gray-900"},zb={class:"text-xs text-gray-500"},Pb={class:"grid grid-cols-2 gap-4"},Lb={class:"flex flex-col gap-1 col-span-2"},Mb={class:"text-xs text-gray-500"},Rb=["placeholder"],Db={class:"flex flex-col gap-1 col-span-2"},Bb={class:"text-xs text-gray-500"},Ob={class:"rounded bg-gray-100 px-3 py-2 text-xs text-gray-600 break-all"},qb={class:"font-medium text-gray-700"},Fb={class:"w-full pt-2"},jb=["disabled"],Nb={key:0,class:"mt-2 flex items-center justify-between text-xs text-gray-500"},Hb={key:3,class:"space-y-4 text-sm text-gray-700"},Ub={class:"space-y-2"},Vb={class:"font-medium text-gray-900"},Wb={class:"text-xs text-gray-500"},Gb={class:"grid grid-cols-2 gap-4"},Kb={class:"flex flex-col gap-1 col-span-2"},Yb={class:"text-xs text-gray-500"},Xb=["placeholder"],Zb={class:"flex flex-col gap-1"},Jb={class:"text-xs text-gray-500"},Qb={class:"flex flex-col gap-1"},e1={class:"text-xs text-gray-500"},t1={class:"space-y-2 pt-2 border-t border-gray-200"},r1={class:"font-medium text-gray-900"},n1={class:"text-xs text-gray-500"},o1={class:"grid grid-cols-2 gap-4"},s1={class:"flex flex-col gap-1 col-span-2"},a1={class:"text-xs text-gray-500"},l1=["placeholder"],i1={class:"flex flex-col gap-1 col-span-2"},d1={class:"text-xs text-gray-500"},u1=["disabled"],c1={value:""},h1=["value","disabled"],p1={class:"rounded bg-gray-100 px-3 py-2 text-xs text-gray-600 break-all"},f1={class:"font-medium text-gray-700"},m1={class:"text-xs text-gray-500"},g1={class:"w-full pt-2"},v1=["disabled"],b1={key:0,class:"mt-2 flex items-center justify-between text-xs text-gray-500"},y1={class:"p-4 border-t border-gray-200 bg-gray-50 flex justify-end rounded-br-lg"},w1=Le({__name:"SettingsModal",props:{show:{type:Boolean}},emits:["update:show"],setup(r,{emit:e}){const t=r,s=e,{t:n,locale:l}=je(),{theme:i,setTheme:d}=xo(),{autoSave:u}=Tl(),g=De(),{printMode:y,silentPrint:m,exportImageMerged:x,localSettings:p,remoteSettings:_,localStatus:v,remoteStatus:k,localRetryCount:b,remoteRetryCount:f,remoteClients:C,remoteSelectedClientId:M,localWsUrl:F,remoteWsUrl:R,cancelLocalRetry:z,cancelRemoteRetry:H,connectLocal:Y,disconnectLocal:se,connectRemote:W,disconnectRemote:E,fetchRemoteClients:B}=Zt(),c=ce("basic"),w=ce(l.value),G=ce(localStorage.getItem("print-designer-brand-key")||"default"),ee=ce(localStorage.getItem("print-designer-brand-custom-hex")||"#3b82f6"),J=ve(()=>v.value||"disconnected"),$=ve(()=>k.value||"disconnected"),N=ve(()=>b.value||0),L=ve(()=>f.value||0),O=ve(()=>C.value||[]),ne=ve(()=>J.value==="connected"),T=ve(()=>$.value==="connected"),D=ve(()=>J.value==="connecting"),oe=ve(()=>$.value==="connecting"),de=ve(()=>!!p.wsAddress),te=ve(()=>!!(_.apiBaseUrl&&_.username&&_.password)),ue=ve(()=>ne.value?n("settings.status.connected"):n("settings.status.disconnected")),ie=ve(()=>T.value?n("settings.status.connected"):n("settings.status.disconnected")),he=me=>me==="connected"?"bg-blue-600 hover:bg-blue-700 text-white border border-blue-600":"bg-transparent text-blue-600 border border-blue-600 hover:bg-blue-50",Q=(me,re=0,j=255)=>Math.min(Math.max(me,re),j),ae=(me,re,j)=>{const be=ze=>Q(Math.round(ze)).toString(16).padStart(2,"0");return`#${be(me)}${be(re)}${be(j)}`},h=(me,re,j)=>({r:me.r+(re.r-me.r)*j,g:me.g+(re.g-me.g)*j,b:me.b+(re.b-me.b)*j}),U=me=>{const re=zt(me);if(!re)return null;const j=Lt(re.h,re.s,re.v),be={r:255,g:255,b:255},ze={r:0,g:0,b:0},Oe=h(j,be,.92),He=h(j,be,.84),Ie=h(j,be,.68),Fe=h(j,be,.5),ot=h(j,be,.32),Ue=h(j,be,.16),rt=h(j,ze,.12),dt=h(j,ze,.24),Ge=h(j,ze,.36),kt=h(j,ze,.5);return{"--brand-50":ae(Oe.r,Oe.g,Oe.b),"--brand-100":ae(He.r,He.g,He.b),"--brand-200":ae(Ie.r,Ie.g,Ie.b),"--brand-300":ae(Fe.r,Fe.g,Fe.b),"--brand-400":ae(ot.r,ot.g,ot.b),"--brand-500":ae(Ue.r,Ue.g,Ue.b),"--brand-600":ae(j.r,j.g,j.b),"--brand-700":ae(rt.r,rt.g,rt.b),"--brand-800":ae(dt.r,dt.g,dt.b),"--brand-900":ae(Ge.r,Ge.g,Ge.b),"--brand-950":ae(kt.r,kt.g,kt.b)}},Z=ve(()=>U(ee.value)||{}),A=ve(()=>[{key:"default",labelKey:"settings.themePresetDefault",colors:{"--brand-50":"#eff6ff","--brand-100":"#dbeafe","--brand-200":"#bfdbfe","--brand-300":"#93c5fd","--brand-400":"#60a5fa","--brand-500":"#3b82f6","--brand-600":"#2563eb","--brand-700":"#1d4ed8","--brand-800":"#1e40af","--brand-900":"#1e3a8a","--brand-950":"#172554"}},{key:"emerald",labelKey:"settings.themePresetEmerald",colors:{"--brand-50":"#ecfdf5","--brand-100":"#d1fae5","--brand-200":"#a7f3d0","--brand-300":"#6ee7b7","--brand-400":"#34d399","--brand-500":"#10b981","--brand-600":"#059669","--brand-700":"#047857","--brand-800":"#065f46","--brand-900":"#064e3b","--brand-950":"#022c22"}},{key:"amber",labelKey:"settings.themePresetAmber",colors:{"--brand-50":"#fffbeb","--brand-100":"#fef3c7","--brand-200":"#fde68a","--brand-300":"#fcd34d","--brand-400":"#fbbf24","--brand-500":"#f59e0b","--brand-600":"#d97706","--brand-700":"#b45309","--brand-800":"#92400e","--brand-900":"#78350f","--brand-950":"#451a03"}},{key:"rose",labelKey:"settings.themePresetRose",colors:{"--brand-50":"#fff1f2","--brand-100":"#ffe4e6","--brand-200":"#fecdd3","--brand-300":"#fda4af","--brand-400":"#fb7185","--brand-500":"#f43f5e","--brand-600":"#e11d48","--brand-700":"#be123c","--brand-800":"#9f1239","--brand-900":"#881337","--brand-950":"#4c0519"}},{key:"custom",labelKey:"settings.themePresetCustom",colors:Z.value}]),I=me=>{const re=document.documentElement;Object.entries(me).forEach(([j,be])=>{re.style.setProperty(j,be)}),window.dispatchEvent(new CustomEvent("brand-theme-updated"))},X=me=>{localStorage.setItem("print-designer-brand-vars",JSON.stringify(me))},K=me=>{const re=A.value.find(j=>j.key===me)||A.value[0];re.colors&&(I(re.colors),X(re.colors),localStorage.setItem("print-designer-brand-key",re.key))};(()=>{const me=localStorage.getItem("print-designer-brand-vars");if(me)try{const re=JSON.parse(me);re&&typeof re=="object"&&I(re)}catch{}})();const V=async()=>{if(!D.value){if(ne.value){se();return}await Y()}},pe=async()=>{if(!oe.value){if(T.value){E();return}await W()}};Ae(w,me=>{l.value=me,localStorage.setItem("print-designer-language",me)}),Ae(i,me=>{d(me)}),Ae(()=>t.show,me=>{g.setDisableGlobalShortcuts(me)}),Ae(ee,me=>{me&&(localStorage.setItem("print-designer-brand-custom-hex",me),G.value==="custom"&&K("custom"))}),Ae(G,me=>{K(me)},{immediate:!0}),Ae([c,k],([me,re])=>{me!=="remote"||re!=="connected"||B()});const we=()=>{s("update:show",!1)},ge=me=>{t.show&&me.key==="Escape"&&(me.preventDefault(),we())};return Ve(()=>{window.addEventListener("keydown",ge)}),We(()=>{window.removeEventListener("keydown",ge),t.show&&g.setDisableGlobalShortcuts(!1)}),(me,re)=>(P(),Pe(et,{to:"body"},[r.show?(P(),q("div",{key:0,class:"fixed inset-0 z-[99999] flex items-center justify-center bg-black/50",onClick:Ke(we,["self"])},[o("div",Fv,[o("div",jv,[o("div",Nv,[o("h3",Hv,S(a(n)("settings.title")),1)]),o("div",Uv,[o("button",{onClick:re[0]||(re[0]=j=>c.value="basic"),class:ke(["w-full text-left px-4 py-3 flex items-center gap-3 transition-colors text-sm",c.value==="basic"?"bg-white text-blue-600 border-l-4 border-blue-600 font-medium":"text-gray-600 hover:bg-gray-100 border-l-4 border-transparent"])},[fe(a(ko),{class:"w-5 h-5"}),Ce(" "+S(a(n)("settings.basic")),1)],2),o("button",{onClick:re[1]||(re[1]=j=>c.value="language"),class:ke(["w-full text-left px-4 py-3 flex items-center gap-3 transition-colors text-sm",c.value==="language"?"bg-white text-blue-600 border-l-4 border-blue-600 font-medium":"text-gray-600 hover:bg-gray-100 border-l-4 border-transparent"])},[fe(a(Pv),{class:"w-5 h-5"}),Ce(" "+S(a(n)("settings.language")),1)],2),o("button",{onClick:re[2]||(re[2]=j=>c.value="local"),class:ke(["w-full text-left px-4 py-3 flex items-center gap-3 transition-colors text-sm",c.value==="local"?"bg-white text-blue-600 border-l-4 border-blue-600 font-medium":"text-gray-600 hover:bg-gray-100 border-l-4 border-transparent"])},[fe(a(_o),{class:"w-5 h-5"}),Ce(" "+S(a(n)("settings.localConnection")),1)],2),o("button",{onClick:re[3]||(re[3]=j=>c.value="remote"),class:ke(["w-full text-left px-4 py-3 flex items-center gap-3 transition-colors text-sm",c.value==="remote"?"bg-white text-blue-600 border-l-4 border-blue-600 font-medium":"text-gray-600 hover:bg-gray-100 border-l-4 border-transparent"])},[fe(a(Rv),{class:"w-5 h-5"}),Ce(" "+S(a(n)("settings.remoteConnection")),1)],2)])]),o("div",Vv,[o("div",Wv,[o("h3",Gv,S(c.value==="basic"?a(n)("settings.basic"):c.value==="language"?a(n)("settings.language"):c.value==="local"?a(n)("settings.localConnection"):a(n)("settings.remoteConnection")),1),o("button",{onClick:we,class:"p-1 hover:bg-gray-100 rounded-full transition-colors text-gray-500"},[fe(a(pt),{class:"w-4 h-4"})])]),o("div",Kv,[c.value==="basic"?(P(),q("div",Yv,[o("div",null,[o("div",Xv,S(a(n)("settings.theme")),1),o("div",Zv,[o("label",{class:ke(["flex items-center gap-2 px-3 py-2 border rounded cursor-pointer",a(i)==="system"?"border-blue-600 text-blue-700":"border-gray-300"])},[$e(o("input",{type:"radio",value:"system","onUpdate:modelValue":re[4]||(re[4]=j=>ut(i)?i.value=j:null)},null,512),[[st,a(i)]]),o("span",null,S(a(n)("settings.themeSystem")),1)],2),o("label",{class:ke(["flex items-center gap-2 px-3 py-2 border rounded cursor-pointer",a(i)==="light"?"border-blue-600 text-blue-700":"border-gray-300"])},[$e(o("input",{type:"radio",value:"light","onUpdate:modelValue":re[5]||(re[5]=j=>ut(i)?i.value=j:null)},null,512),[[st,a(i)]]),o("span",null,S(a(n)("settings.themeLight")),1)],2),o("label",{class:ke(["flex items-center gap-2 px-3 py-2 border rounded cursor-pointer",a(i)==="dark"?"border-blue-600 text-blue-700":"border-gray-300"])},[$e(o("input",{type:"radio",value:"dark","onUpdate:modelValue":re[6]||(re[6]=j=>ut(i)?i.value=j:null)},null,512),[[st,a(i)]]),o("span",null,S(a(n)("settings.themeDark")),1)],2)]),o("p",Jv,S(a(n)("settings.themeDesc")),1)]),o("div",Qv,[o("div",eb,S(a(n)("settings.themeColor")),1),o("div",tb,[(P(!0),q(Te,null,Me(A.value.filter(j=>j.key!=="custom"),j=>(P(),q("button",{key:j.key,type:"button",class:ke(["flex items-center gap-2 px-3 py-2 border rounded text-xs transition-colors",G.value===j.key?"border-blue-600 text-blue-700":"border-gray-300 text-gray-700 hover:bg-gray-50"]),onClick:be=>G.value=j.key},[o("span",{class:"inline-block w-3.5 h-3.5 rounded-full",style:_e({backgroundColor:j.colors["--brand-600"]})},null,4),o("span",null,S(a(n)(j.labelKey)),1)],10,rb))),128)),fe(vt,{"model-value":ee.value,"onUpdate:modelValue":re[8]||(re[8]=j=>{j&&(ee.value=j,G.value="custom")}),"default-color":ee.value,"teleport-to-body":!0},{trigger:it(({color:j,open:be})=>[o("button",{type:"button",class:ke(["flex items-center gap-2 px-3 py-2 border rounded text-xs transition-colors",G.value==="custom"?"border-blue-600 text-blue-700":"border-gray-300 text-gray-700 hover:bg-gray-50"]),onClick:re[7]||(re[7]=ze=>G.value="custom")},[o("span",{class:ke(["inline-block w-3.5 h-3.5 rounded-full border border-gray-200",{"ring-2 ring-blue-500 ring-offset-1":be}]),style:_e({backgroundColor:j||ee.value})},null,6),o("span",null,S(a(n)("settings.themePresetCustom")),1)],2)]),_:1},8,["model-value","default-color"])]),o("p",nb,S(a(n)("settings.themeColorDesc")),1)]),o("div",ob,[o("div",sb,[o("div",ab,S(a(n)("settings.autoSave")),1),o("button",{onClick:re[9]||(re[9]=j=>u.value=!a(u)),class:ke(["relative inline-flex h-6 w-11 flex-shrink-0 cursor-pointer rounded-full border-2 border-transparent transition-colors duration-200 ease-in-out focus:outline-none focus:ring-2 focus:ring-blue-600 focus:ring-offset-2",a(u)?"bg-blue-600":"bg-gray-200"])},[o("span",lb,S(a(n)("settings.autoSave")),1),o("span",{"aria-hidden":"true",class:ke(["pointer-events-none inline-block h-5 w-5 transform rounded-full bg-white shadow ring-0 transition duration-200 ease-in-out",a(u)?"translate-x-5":"translate-x-0"])},null,2)],2)]),o("p",ib,S(a(n)("settings.autoSaveDesc")),1)]),o("div",db,[o("div",ub,[o("div",cb,S(a(n)("settings.exportImageMerged")),1),o("button",{onClick:re[10]||(re[10]=j=>x.value=!a(x)),class:ke(["relative inline-flex h-6 w-11 flex-shrink-0 cursor-pointer rounded-full border-2 border-transparent transition-colors duration-200 ease-in-out focus:outline-none focus:ring-2 focus:ring-blue-600 focus:ring-offset-2",a(x)?"bg-blue-600":"bg-gray-200"])},[o("span",hb,S(a(n)("settings.exportImageMerged")),1),o("span",{"aria-hidden":"true",class:ke(["pointer-events-none inline-block h-5 w-5 transform rounded-full bg-white shadow ring-0 transition duration-200 ease-in-out",a(x)?"translate-x-5":"translate-x-0"])},null,2)],2)]),o("p",pb,S(a(n)("settings.exportImageMergedDesc")),1)]),o("div",fb,[o("div",null,[o("div",mb,S(a(n)("settings.printMode")),1),o("div",gb,[o("label",{class:ke(["flex items-center gap-2 px-3 py-2 border rounded cursor-pointer",a(y)==="browser"?"border-blue-600 text-blue-700":"border-gray-300"])},[$e(o("input",{type:"radio",value:"browser","onUpdate:modelValue":re[11]||(re[11]=j=>ut(y)?y.value=j:null)},null,512),[[st,a(y)]]),o("span",null,S(a(n)("settings.printModeBrowser")),1)],2),o("label",{class:ke(["flex items-center gap-2 px-3 py-2 border rounded cursor-pointer",a(y)==="local"?"border-blue-600 text-blue-700":"border-gray-300"])},[$e(o("input",{type:"radio",value:"local","onUpdate:modelValue":re[12]||(re[12]=j=>ut(y)?y.value=j:null),disabled:!ne.value},null,8,vb),[[st,a(y)]]),o("span",null,S(a(n)("settings.printModeLocal")),1)],2),o("label",{class:ke(["flex items-center gap-2 px-3 py-2 border rounded cursor-pointer",a(y)==="remote"?"border-blue-600 text-blue-700":"border-gray-300"])},[$e(o("input",{type:"radio",value:"remote","onUpdate:modelValue":re[13]||(re[13]=j=>ut(y)?y.value=j:null),disabled:!T.value},null,8,bb),[[st,a(y)]]),o("span",null,S(a(n)("settings.printModeRemote")),1)],2)]),o("p",yb,S(a(n)("settings.printModeDesc")),1)]),o("div",wb,[o("div",xb,S(a(n)("settings.silentPrint")),1),o("button",{onClick:re[14]||(re[14]=j=>m.value=!a(m)),class:ke(["relative inline-flex h-6 w-11 flex-shrink-0 cursor-pointer rounded-full border-2 border-transparent transition-colors duration-200 ease-in-out focus:outline-none focus:ring-2 focus:ring-blue-600 focus:ring-offset-2",a(m)?"bg-blue-600":"bg-gray-200"])},[o("span",_b,S(a(n)("settings.silentPrint")),1),o("span",{"aria-hidden":"true",class:ke(["pointer-events-none inline-block h-5 w-5 transform rounded-full bg-white shadow ring-0 transition duration-200 ease-in-out",a(m)?"translate-x-5":"translate-x-0"])},null,2)],2)]),o("p",kb,S(a(n)("settings.silentPrintDesc")),1)])])):xe("",!0),c.value==="language"?(P(),q("div",Sb,[o("div",Cb,S(a(n)("settings.selectLanguage")),1),o("div",Eb,[o("label",{class:ke(["flex items-center gap-2 px-3 py-2 border rounded cursor-pointer",w.value==="zh"?"border-blue-600 text-blue-700":"border-gray-300"])},[$e(o("input",{type:"radio",value:"zh","onUpdate:modelValue":re[15]||(re[15]=j=>w.value=j)},null,512),[[st,w.value]]),o("span",null,S(a(n)("settings.zhLabel")),1)],2),o("label",{class:ke(["flex items-center gap-2 px-3 py-2 border rounded cursor-pointer",w.value==="en"?"border-blue-600 text-blue-700":"border-gray-300"])},[$e(o("input",{type:"radio",value:"en","onUpdate:modelValue":re[16]||(re[16]=j=>w.value=j)},null,512),[[st,w.value]]),o("span",null,S(a(n)("settings.enLabel")),1)],2)]),o("p",Tb,S(a(n)("settings.languageDesc")),1)])):xe("",!0),c.value==="local"?(P(),q("div",$b,[o("div",Ib,[o("div",Ab,S(a(n)("settings.localClientTitle")),1),o("p",zb,S(a(n)("settings.localClientDesc")),1)]),o("div",Pb,[o("label",Lb,[o("span",Mb,S(a(n)("settings.wsAddress")),1),$e(o("input",{"onUpdate:modelValue":re[17]||(re[17]=j=>a(p).wsAddress=j),type:"text",class:"w-full px-3 py-2 border rounded focus:ring-2 focus:ring-blue-600 focus:border-blue-600",placeholder:a(n)("settings.localWsAddressPlaceholder")},null,8,Rb),[[Be,a(p).wsAddress]])]),o("label",Db,[o("span",Bb,S(a(n)("settings.secretKey")),1),$e(o("input",{"onUpdate:modelValue":re[18]||(re[18]=j=>a(p).secretKey=j),type:"text",class:"w-full px-3 py-2 border rounded focus:ring-2 focus:ring-blue-600 focus:border-blue-600"},null,512),[[Be,a(p).secretKey]])])]),o("div",Ob,[o("span",qb,S(a(n)("settings.connectionUrl"))+": ",1),o("span",null,S(a(F)),1)]),o("div",Fb,[o("button",{onClick:V,disabled:D.value||N.value>0||!ne.value&&!de.value,class:ke(["w-full inline-flex items-center justify-center gap-2 px-3 h-9 rounded transition-colors text-sm shadow-sm disabled:opacity-50 disabled:pointer-events-none disabled:cursor-not-allowed",he(J.value)])},[ne.value?(P(),Pe(a(Ha),{key:0,class:"w-4 h-4"})):(P(),Pe(a(Ua),{key:1,class:"w-4 h-4"})),o("span",null,S(ue.value),1)],10,jb),N.value>0&&!ne.value?(P(),q("div",Nb,[o("span",null,S(a(n)("settings.retrying",{count:N.value,max:10})),1),o("button",{onClick:re[19]||(re[19]=(...j)=>a(z)&&a(z)(...j)),class:"text-blue-600 hover:text-blue-700"},S(a(n)("settings.cancelRetry")),1)])):xe("",!0)])])):xe("",!0),c.value==="remote"?(P(),q("div",Hb,[o("div",Ub,[o("div",Vb,S(a(n)("settings.remoteLoginTitle")),1),o("p",Wb,S(a(n)("settings.remoteLoginDesc")),1)]),o("div",Gb,[o("label",Kb,[o("span",Yb,S(a(n)("settings.apiBaseUrl")),1),$e(o("input",{"onUpdate:modelValue":re[20]||(re[20]=j=>a(_).apiBaseUrl=j),type:"text",class:"w-full px-3 py-2 border rounded focus:ring-2 focus:ring-blue-600 focus:border-blue-600",placeholder:a(n)("settings.apiBasePlaceholder")},null,8,Xb),[[Be,a(_).apiBaseUrl]])]),o("label",Zb,[o("span",Jb,S(a(n)("settings.username")),1),$e(o("input",{"onUpdate:modelValue":re[21]||(re[21]=j=>a(_).username=j),type:"text",class:"w-full px-3 py-2 border rounded focus:ring-2 focus:ring-blue-600 focus:border-blue-600"},null,512),[[Be,a(_).username]])]),o("label",Qb,[o("span",e1,S(a(n)("settings.password")),1),$e(o("input",{"onUpdate:modelValue":re[22]||(re[22]=j=>a(_).password=j),type:"password",class:"w-full px-3 py-2 border rounded focus:ring-2 focus:ring-blue-600 focus:border-blue-600"},null,512),[[Be,a(_).password]])])]),o("div",t1,[o("div",r1,S(a(n)("settings.remoteWsTitle")),1),o("p",n1,S(a(n)("settings.remoteWsDesc")),1)]),o("div",o1,[o("label",s1,[o("span",a1,S(a(n)("settings.wsAddress")),1),$e(o("input",{"onUpdate:modelValue":re[23]||(re[23]=j=>a(_).wsAddress=j),type:"text",class:"w-full px-3 py-2 border rounded focus:ring-2 focus:ring-blue-600 focus:border-blue-600",placeholder:a(n)("settings.wsAddressPlaceholder")},null,8,l1),[[Be,a(_).wsAddress]])]),o("label",i1,[o("span",d1,S(a(n)("settings.remoteClient")),1),$e(o("select",{"onUpdate:modelValue":re[24]||(re[24]=j=>ut(M)?M.value=j:null),class:"w-full px-3 py-2 border rounded bg-white focus:ring-2 focus:ring-blue-600 focus:border-blue-600",disabled:$.value!=="connected"||O.value.length===0},[o("option",c1,S(a(n)("settings.remoteClientPlaceholder")),1),(P(!0),q(Te,null,Me(O.value,j=>(P(),q("option",{key:j.client_id,value:j.client_id,disabled:j.online===!1},S(j.client_name||j.client_id)+S(j.online===!1?" (offline)":""),9,h1))),128))],8,u1),[[Ze,a(M)]])])]),o("div",p1,[o("span",f1,S(a(n)("settings.connectionUrl"))+": ",1),o("span",null,S(a(R)),1)]),o("p",m1,S(a(n)("settings.remoteAuthHint")),1),o("div",g1,[o("button",{onClick:pe,disabled:oe.value||L.value>0||!T.value&&!te.value,class:ke(["w-full inline-flex items-center justify-center gap-2 px-3 h-9 rounded transition-colors text-sm shadow-sm disabled:opacity-50 disabled:pointer-events-none disabled:cursor-not-allowed",he($.value)])},[T.value?(P(),Pe(a(Ha),{key:0,class:"w-4 h-4"})):(P(),Pe(a(Ua),{key:1,class:"w-4 h-4"})),o("span",null,S(ie.value),1)],10,v1),L.value>0&&!T.value?(P(),q("div",b1,[o("span",null,S(a(n)("settings.retrying",{count:L.value,max:10})),1),o("button",{onClick:re[25]||(re[25]=(...j)=>a(H)&&a(H)(...j)),class:"text-blue-600 hover:text-blue-700"},S(a(n)("settings.cancelRetry")),1)])):xe("",!0)])])):xe("",!0)]),o("div",y1,[o("button",{onClick:we,class:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 transition-colors text-sm"},S(a(n)("common.close")),1)])])])])):xe("",!0)]))}}),x1={class:"h-14 bg-white border-b border-gray-200 flex items-center justify-between px-4 z-[2000] relative shadow-sm"},_1={class:"flex items-center gap-2"},k1=["src"],S1={key:1,class:"font-semibold text-gray-700"},C1=Le({__name:"Header",setup(r){const{t:e}=je(),t=De(),s=ve(()=>{var d;return((d=t.branding)==null?void 0:d.showLogo)!==!1}),n=ve(()=>{var d;return((d=t.branding)==null?void 0:d.showTitle)!==!1}),l=ve(()=>{var d;return((d=t.branding)==null?void 0:d.logoUrl)||jl}),i=ve(()=>{var d;return((d=t.branding)==null?void 0:d.title)||e("common.appTitle")});return(d,u)=>(P(),q("header",x1,[o("div",_1,[s.value?(P(),q("img",{key:0,src:l.value,alt:"Logo",class:"w-8 h-8 object-contain"},null,8,k1)):xe("",!0),n.value?(P(),q("h1",S1,S(i.value),1)):xe("",!0)]),fe(qg,{onToggleHelp:u[0]||(u[0]=g=>a(t).setShowHelp(!0)),onToggleSettings:u[1]||(u[1]=g=>a(t).setShowSettings(!0))}),fe(Iv,{show:a(t).showHelp,"onUpdate:show":u[2]||(u[2]=g=>a(t).setShowHelp(g))},null,8,["show"]),fe(w1,{show:a(t).showSettings,"onUpdate:show":u[3]||(u[3]=g=>a(t).setShowSettings(g))},null,8,["show"])]))}}),E1={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function T1(r,e){return P(),q("svg",E1,[...e[0]||(e[0]=[o("path",{fill:"currentColor",d:"M7 20V7H2V4h13v3h-5v13zm9 0v-8h-3V9h9v3h-3v8z"},null,-1)])])}const Va=Se({name:"material-symbols-text-fields",render:T1}),$1={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function I1(r,e){return P(),q("svg",$1,[...e[0]||(e[0]=[o("path",{fill:"currentColor",d:"m6 20l1-4H3l.5-2h4l1-4h-4L5 8h4l1-4h2l-1 4h4l1-4h2l-1 4h4l-.5 2h-4l-1 4h4l-.5 2h-4l-1 4h-2l1-4H9l-1 4zm3.5-6h4l1-4h-4z"},null,-1)])])}const Wa=Se({name:"material-symbols-numbers",render:I1}),A1={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function z1(r,e){return P(),q("svg",A1,[...e[0]||(e[0]=[o("path",{fill:"currentColor",d:"M3 8V5q0-.825.588-1.412T5 3h14q.825 0 1.413.588T21 5v3zm2 13q-.825 0-1.412-.587T3 19v-9h4.5v11zm11.5 0V10H21v9q0 .825-.587 1.413T19 21zm-7 0V10h5v11z"},null,-1)])])}const Ga=Se({name:"material-symbols-table-chart",render:z1}),P1={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function L1(r,e){return P(),q("svg",P1,[...e[0]||(e[0]=[o("path",{fill:"currentColor",d:"M1 19V5h2v14zm3 0V5h2v14zm3 0V5h1v14zm3 0V5h2v14zm3 0V5h3v14zm4 0V5h1v14zm3 0V5h3v14z"},null,-1)])])}const Ka=Se({name:"material-symbols-barcode",render:L1}),M1={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function R1(r,e){return P(),q("svg",M1,[...e[0]||(e[0]=[o("path",{fill:"currentColor",d:"M3 11V3h8v8zm2-2h4V5H5zM3 21v-8h8v8zm2-2h4v-4H5zm8-8V3h8v8zm2-2h4V5h-4zm4 12v-2h2v2zm-6-6v-2h2v2zm2 2v-2h2v2zm-2 2v-2h2v2zm2 2v-2h2v2zm2-2v-2h2v2zm0-4v-2h2v2zm2 2v-2h2v2z"},null,-1)])])}const Ya=Se({name:"material-symbols-qr-code",render:R1}),D1={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function B1(r,e){return P(),q("svg",D1,[...e[0]||(e[0]=[o("path",{fill:"currentColor",d:"M4 13v-2h16v2z"},null,-1)])])}const Xa=Se({name:"material-symbols-horizontal-rule",render:B1}),O1={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function q1(r,e){return P(),q("svg",O1,[...e[0]||(e[0]=[o("path",{fill:"currentColor",d:"M5 21q-.825 0-1.412-.587T3 19V5q0-.825.588-1.412T5 3h14q.825 0 1.413.588T21 5v14q0 .825-.587 1.413T19 21zm0-2h14V5H5z"},null,-1)])])}const Za=Se({name:"material-symbols-check-box-outline-blank",render:q1}),F1={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function j1(r,e){return P(),q("svg",F1,[...e[0]||(e[0]=[o("path",{fill:"currentColor",d:"M12 22q-2.075 0-3.9-.788t-3.175-2.137T2.788 15.9T2 12t.788-3.9t2.137-3.175T8.1 2.788T12 2t3.9.788t3.175 2.137T21.213 8.1T22 12t-.788 3.9t-2.137 3.175t-3.175 2.138T12 22m0-2q3.35 0 5.675-2.325T20 12t-2.325-5.675T12 4T6.325 6.325T4 12t2.325 5.675T12 20"},null,-1)])])}const Ja=Se({name:"material-symbols-radio-button-unchecked",render:j1}),N1={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function H1(r,e){return P(),q("svg",N1,[...e[0]||(e[0]=[o("path",{fill:"currentColor",d:"m5.825 21l1.625-7.025L2 9.25l7.2-.625L12 2l2.8 6.625l7.2.625l-5.45 4.725L18.175 21L12 17.275z"},null,-1)])])}const U1=Se({name:"material-symbols-star",render:H1}),V1={class:"w-64 bg-white border-r border-gray-200 flex flex-col h-full z-40"},W1={class:"p-4 border-b border-gray-200 bg-gray-50"},G1={class:"font-semibold text-gray-700"},K1={class:"text-xs text-gray-500 mt-1"},Y1={class:"flex border-b border-gray-200 bg-white"},X1={key:0,class:"absolute bottom-0 left-0 w-full h-0.5 bg-blue-600"},Z1={key:0,class:"absolute bottom-0 left-0 w-full h-0.5 bg-blue-600"},J1={class:"flex-1 overflow-y-auto"},Q1={class:"text-xs font-semibold text-gray-500 uppercase tracking-wider mb-3 px-1"},ey={class:"grid grid-cols-2 gap-3"},ty=["onDragstart"],ry={class:"text-sm font-medium text-gray-700"},ny={key:0,class:"p-6 text-center"},oy={class:"text-sm text-gray-500"},sy={key:1,class:"p-4 grid grid-cols-2 gap-3"},ay=["onDragstart"],ly=["title"],iy=["onClick","title"],dy=["onClick"],uy=["onClick"],cy=["onClick"],hy=["onClick"],py=["onClick"],fy=Le({__name:"Sidebar",setup(r){const{t:e}=je(),t=De(),s=ce("standard"),n=ve(()=>t.customElements),l=ce(null),i=ce({}),d=ce(!1),u=ce(null),g=ce(""),y=ce(!1),m=ce(""),x=ce(null),p=ce([]),_=[{title:"sidebar.general",items:[{type:ye.TEXT,label:"sidebar.text",icon:Va},{type:ye.IMAGE,label:"sidebar.image",icon:Oa},{type:ye.PAGE_NUMBER,label:"sidebar.pagination",icon:Wa}]},{title:"sidebar.dataCodes",items:[{type:ye.TABLE,label:"sidebar.table",icon:Ga},{type:ye.BARCODE,label:"sidebar.barcode",icon:Ka},{type:ye.QRCODE,label:"sidebar.qrcode",icon:Ya}]},{title:"sidebar.shapes",items:[{type:ye.LINE,label:"sidebar.line",icon:Xa},{type:ye.RECT,label:"sidebar.rect",icon:Za},{type:ye.CIRCLE,label:"sidebar.circle",icon:Ja}]}],v=(E,B)=>{E.dataTransfer&&(E.dataTransfer.setData("application/json",JSON.stringify({type:B})),E.dataTransfer.effectAllowed="copy")},k=(E,B)=>{E.dataTransfer&&(E.dataTransfer.setData("application/json",JSON.stringify({type:B.element.type,payload:B.element})),E.dataTransfer.effectAllowed="copy")},b=E=>{switch(E){case ye.TEXT:return Va;case ye.IMAGE:return Oa;case ye.TABLE:return Ga;case ye.PAGE_NUMBER:return Wa;case ye.BARCODE:return Ka;case ye.QRCODE:return Ya;case ye.LINE:return Xa;case ye.RECT:return Za;case ye.CIRCLE:return Ja;default:return U1}},f=(E,B)=>{if(E.stopPropagation(),l.value===B)l.value=null;else{const w=E.currentTarget.getBoundingClientRect();let G=w.right-128;G<5&&(G=w.left),window.innerHeight-w.bottom<210?i.value={bottom:`${window.innerHeight-w.top+5}px`,left:`${G}px`}:i.value={top:`${w.bottom+5}px`,left:`${G}px`},l.value=B}},C=()=>{l.value=null},M=E=>{l.value=null,u.value=E.id,g.value=E.name,d.value=!0},F=E=>{u.value&&E&&t.renameCustomElement(u.value,E)},R=E=>{l.value=null,t.addCustomElement(`${E.name} Copy`,E.element)},z=E=>{l.value=null,confirm(e("sidebar.confirmDelete",{name:E.name}))&&t.removeCustomElement(E.id)},H=E=>{if(l.value=null,t.editingCustomElementId!==E.id){if(t.editingCustomElementId&&t.editingCustomElementId!==E.id){const B=t.customElements.find(w=>w.id===t.editingCustomElementId),c=B?B.name:"";if(!confirm(e("sidebar.confirmSwitchEdit",{name:c})))return;t.cancelCustomElementEdit()}t.startCustomElementEdit(E.id)}},Y=E=>Fl(E.element),se=E=>{l.value=null,x.value=E;const B=E.testData||{},c=io(E.element,B);p.value=Object.keys(c),m.value=JSON.stringify(c,null,2),y.value=!0},W=()=>{var ee;const E=x.value,B=new Set(p.value||[]);if(x.value=null,p.value=[],!E)return;let c=null;try{const J=((ee=m.value)==null?void 0:ee.trim())||"{}",$=JSON.parse(J);$&&typeof $=="object"&&!Array.isArray($)&&(c=$)}catch{c=null}if(!c){alert(e("common.invalidJson"));return}if(B.size>0){const J=Object.keys(c);if(J.length!==B.size||J.some(N=>!B.has(N))){alert(e("common.testDataKeyChanged"));return}}const w=io(E.element,E.testData||{}),G={};Object.keys(w).forEach(J=>{(B.size===0||B.has(J))&&(G[J]=Object.prototype.hasOwnProperty.call(c,J)?c[J]:w[J])}),E.testData=G,t.saveCustomElements()};return Ve(()=>{document.addEventListener("click",C)}),We(()=>{document.removeEventListener("click",C)}),(E,B)=>(P(),q("aside",V1,[o("div",W1,[o("h2",G1,S(a(e)("sidebar.elements")),1),o("p",K1,S(a(e)("sidebar.dragToCanvas")),1)]),o("div",Y1,[o("button",{onClick:B[0]||(B[0]=c=>s.value="standard"),class:ke(["flex-1 py-3 text-sm font-medium transition-colors relative",s.value==="standard"?"text-blue-600":"text-gray-500 hover:text-gray-700 hover:bg-gray-50"])},[Ce(S(a(e)("sidebar.standard"))+" ",1),s.value==="standard"?(P(),q("div",X1)):xe("",!0)],2),o("button",{onClick:B[1]||(B[1]=c=>s.value="custom"),class:ke(["flex-1 py-3 text-sm font-medium transition-colors relative",s.value==="custom"?"text-blue-600":"text-gray-500 hover:text-gray-700 hover:bg-gray-50"])},[Ce(S(a(e)("sidebar.custom"))+" ",1),s.value==="custom"?(P(),q("div",Z1)):xe("",!0)],2)]),o("div",J1,[s.value==="standard"?(P(),q(Te,{key:0},Me(_,c=>o("div",{key:c.title,class:"p-4 border-b border-gray-100 last:border-0"},[o("h3",Q1,S(a(e)(c.title)),1),o("div",ey,[(P(!0),q(Te,null,Me(c.items,w=>(P(),q("div",{key:w.type,class:"flex flex-col items-center justify-center p-4 border border-gray-200 rounded-lg theme-hover-border theme-hover-bg cursor-move transition-all",draggable:"true",onDragstart:G=>v(G,w.type)},[(P(),Pe(Pt(w.icon),{class:"w-8 h-8 text-gray-600 mb-2"})),o("span",ry,S(a(e)(w.label)),1)],40,ty))),128))])])),64)):xe("",!0),s.value==="custom"?(P(),q(Te,{key:1},[n.value.length===0?(P(),q("div",ny,[o("p",oy,S(a(e)("sidebar.noCustomElements")),1)])):(P(),q("div",sy,[(P(!0),q(Te,null,Me(n.value,c=>(P(),q("div",{key:c.id,class:"group relative flex flex-col items-center justify-center p-4 border border-gray-200 rounded-lg theme-hover-border theme-hover-bg cursor-move transition-all",draggable:"true",onDragstart:w=>k(w,c)},[(P(),Pe(Pt(b(c.element.type)),{class:"w-8 h-8 text-gray-600 mb-2"})),o("span",{class:"text-sm font-medium text-gray-700 truncate w-full text-center",title:c.name},S(c.name),9,ly),o("button",{onClick:w=>f(w,c.id),class:ke(["absolute top-1 right-1 p-1 text-gray-400 hover:text-gray-600 rounded-full hover:bg-gray-100 opacity-0 group-hover:opacity-100 transition-opacity",{"opacity-100 bg-gray-100 text-gray-600":l.value===c.id}]),title:a(e)("sidebar.moreOptions")},[fe(a(ql),{class:"w-4 h-4"})],10,iy)],40,ay))),128))]))],64)):xe("",!0)]),(P(),Pe(et,{to:"body"},[l.value?(P(),q("div",{key:0,class:"fixed w-32 bg-white rounded shadow-lg border border-gray-100 z-[2001] py-1",style:_e(i.value),onClick:B[2]||(B[2]=Ke(()=>{},["stop"]))},[(P(!0),q(Te,null,Me(n.value,c=>(P(),q(Te,{key:c.id},[c.id===l.value?(P(),q(Te,{key:0},[o("button",{onClick:w=>H(c),class:"w-full text-left px-3 py-1.5 text-xs text-gray-700 hover:bg-gray-50 flex items-center gap-2"},[fe(a(lo),{class:"w-3.5 h-3.5"}),Ce(" "+S(a(e)("sidebar.editElement")),1)],8,dy),Y(c)?(P(),q("button",{key:0,onClick:w=>se(c),class:"w-full text-left px-3 py-1.5 text-xs text-gray-700 hover:bg-gray-50 flex items-center gap-2"},[fe(a(lt),{class:"w-3.5 h-3.5"}),Ce(" "+S(a(e)("common.testData")),1)],8,uy)):xe("",!0),o("button",{onClick:w=>M(c),class:"w-full text-left px-3 py-1.5 text-xs text-gray-700 hover:bg-gray-50 flex items-center gap-2"},[fe(a(lo),{class:"w-3.5 h-3.5"}),Ce(" "+S(a(e)("sidebar.rename")),1)],8,cy),o("button",{onClick:w=>R(c),class:"w-full text-left px-3 py-1.5 text-xs text-gray-700 hover:bg-gray-50 flex items-center gap-2"},[fe(a(xt),{class:"w-3.5 h-3.5"}),Ce(" "+S(a(e)("sidebar.copy")),1)],8,hy),o("button",{onClick:w=>z(c),class:"w-full text-left px-3 py-1.5 text-xs text-red-600 hover:bg-red-50 flex items-center gap-2"},[fe(a(wt),{class:"w-3.5 h-3.5"}),Ce(" "+S(a(e)("sidebar.delete")),1)],8,py)],64)):xe("",!0)],64))),128))],4)):xe("",!0)])),fe(Dt,{show:d.value,"initial-value":g.value,title:a(e)("sidebar.renameModalTitle"),placeholder:a(e)("sidebar.enterNamePlaceholder"),onClose:B[3]||(B[3]=c=>d.value=!1),onSave:F},null,8,["show","initial-value","title","placeholder"]),fe(Rt,{visible:y.value,"onUpdate:visible":B[4]||(B[4]=c=>y.value=c),title:a(e)("common.testData"),value:m.value,language:"json","onUpdate:value":B[5]||(B[5]=c=>m.value=c),onClose:W},null,8,["visible","title","value"])]))}}),my={sections:[{title:"properties.section.content",tab:"properties",fields:[{label:"properties.label.content",type:"textarea",target:"element",key:"content",placeholder:"properties.label.textContentPlaceholder"},{label:"properties.label.variable",type:"text",target:"element",key:"variable",placeholder:"@variable"}]},{title:"properties.section.typography",tab:"style",fields:[{label:"properties.label.writingMode",type:"select",target:"style",key:"writingMode",options:[{label:"properties.option.horizontal",value:"horizontal-tb"},{label:"properties.option.vertical",value:"vertical-rl"}]},{label:"properties.label.fontSize",type:"number",target:"style",key:"fontSize",min:8,max:96,step:1},{label:"properties.label.color",type:"color",target:"style",key:"color"},{label:"properties.label.textAlign",type:"select",target:"style",key:"textAlign",options:[{label:"properties.option.default",value:""},{label:"properties.option.left",value:"left"},{label:"properties.option.center",value:"center"},{label:"properties.option.right",value:"right"}]},{label:"properties.label.fontFamily",type:"select",target:"style",key:"fontFamily",options:[{label:"properties.option.default",value:""},{label:"properties.option.arial",value:"Arial, sans-serif"},{label:"properties.option.timesNewRoman",value:'"Times New Roman", serif'},{label:"properties.option.courierNew",value:'"Courier New", monospace'},{label:"properties.option.simSun",value:"SimSun, serif"},{label:"properties.option.simHei",value:"SimHei, sans-serif"}]},{label:"properties.label.fontWeight",type:"select",target:"style",key:"fontWeight",options:[{label:"properties.option.default",value:""},{label:"properties.option.normal",value:"400"},{label:"properties.option.medium",value:"500"},{label:"properties.option.bold",value:"700"}]}]},{title:"properties.section.border",tab:"style",fields:[{label:"properties.label.borderStyle",type:"select",target:"style",key:"borderStyle",options:[{label:"properties.option.none",value:"none"},{label:"properties.option.solid",value:"solid"},{label:"properties.option.dashed",value:"dashed"},{label:"properties.option.dotted",value:"dotted"}]},{label:"properties.label.borderWidth",type:"number",target:"style",key:"borderWidth",min:0,max:20,step:1},{label:"properties.label.borderColor",type:"color",target:"style",key:"borderColor"}]}]},Qa=Le({__name:"TextElement",props:{element:{}},setup(r){const e=r,t=De(),s=ve(()=>{const n=e.element.variable||"";if(t.isExporting&&n){const l=Bt(n);if(l&&Object.prototype.hasOwnProperty.call(t.testData,l)){const i=t.testData[l];if(i!=null)return String(i)}}return e.element.variable||e.element.content||"Double click to edit"});return(n,l)=>(P(),q("div",{class:"w-full h-full overflow-hidden",style:_e({fontSize:`${r.element.style.fontSize}px`,fontFamily:r.element.style.fontFamily,fontWeight:r.element.style.fontWeight,fontStyle:r.element.style.fontStyle,textAlign:r.element.style.textAlign,textDecoration:r.element.style.textDecoration,color:r.element.style.color,padding:`${r.element.style.padding}px`,writingMode:r.element.style.writingMode||"horizontal-tb"})},S(s.value),5))}}),gy={class:"w-full h-full overflow-hidden bg-gray-50 flex items-center justify-center"},vy=["src"],by={key:1,class:"text-gray-400 text-xs"},yy={sections:[{title:"properties.section.imageSource",tab:"properties",fields:[{label:"properties.label.imageSource",type:"image",target:"element",key:"content"}]},{title:"properties.section.border",tab:"style",fields:[{label:"properties.label.borderStyle",type:"select",target:"style",key:"borderStyle",options:[{label:"properties.option.none",value:"none"},{label:"properties.option.solid",value:"solid"},{label:"properties.option.dashed",value:"dashed"},{label:"properties.option.dotted",value:"dotted"}]},{label:"properties.label.borderWidth",type:"number",target:"style",key:"borderWidth",min:0,max:20,step:1},{label:"properties.label.borderColor",type:"color",target:"style",key:"borderColor"}]}]},wy=Le({__name:"ImageElement",props:{element:{}},setup(r){return(e,t)=>(P(),q("div",gy,[r.element.content?(P(),q("img",{key:0,src:r.element.content,class:"w-full h-full object-contain pointer-events-none",alt:"Element"},null,8,vy)):(P(),q("span",by,"No Image"))]))}}),xy=["data-tfoot-repeat","data-auto-paginate","data-custom-script"],_y=["onDblclick"],ky=["onMousedown"],Sy=["rowspan","colspan","data-field","onMousedown","onMouseover"],Cy={key:0},Ey=["colspan"],Ty={key:1,class:"h-full border-none bg-transparent"},$y=["colspan"],Iy={key:0},Ay=["rowspan","colspan","data-field","data-value","onMousedown","onMouseover","onDblclick"],zy={class:"text-sm font-semibold text-gray-700"},Py={class:"flex flex-col gap-1"},Ly={class:"text-xs text-gray-500"},My=["placeholder"],Ry={class:"flex flex-col gap-1"},Dy={class:"text-xs text-gray-500"},By=["placeholder"],Oy={class:"flex flex-col gap-1"},qy={class:"text-xs text-gray-500"},Fy=["placeholder"],jy={class:"flex flex-col gap-1"},Ny={class:"text-xs text-gray-500"},Hy=["placeholder"],Uy={class:"flex justify-end gap-2 mt-1"},Vy={sections:[{title:"properties.section.dataBehavior",tab:"properties",fields:[{label:"properties.label.autoPaginate",type:"switch",target:"element",key:"autoPaginate"},{label:"properties.label.repeatFooter",type:"switch",target:"element",key:"tfootRepeat"},{label:"properties.label.showFooter",type:"switch",target:"element",key:"showFooter"},{label:"properties.label.variable",type:"text",target:"element",key:"variable",placeholder:"@variable"},{label:"properties.label.columns",type:"code",language:"json",target:"element",key:"columns",placeholder:"properties.label.columnsPlaceholder"},{label:"properties.label.data",type:"code",language:"json",target:"element",key:"data",placeholder:"properties.label.dataPlaceholder"},{label:"properties.label.footerData",type:"code",language:"json",target:"element",key:"footerData",placeholder:"properties.label.footerDataPlaceholder"},{label:"properties.label.customScript",type:"code",language:"javascript",target:"element",key:"customScript",placeholder:"properties.label.customScriptPlaceholder"}]},{title:"properties.section.layoutDimensions",tab:"style",fields:[{label:"properties.label.headerHeight",type:"number",target:"style",key:"headerHeight",min:20,max:200,step:1},{label:"properties.label.rowHeight",type:"number",target:"style",key:"rowHeight",min:20,max:200,step:1},{label:"properties.label.footerHeight",type:"number",target:"style",key:"footerHeight",min:20,max:200,step:1}]},{title:"properties.section.appearance",tab:"style",fields:[{label:"properties.label.backgroundColor",type:"color",target:"style",key:"backgroundColor"},{label:"properties.label.textColor",type:"color",target:"style",key:"color"}]},{title:"properties.section.headerStyle",tab:"style",fields:[{label:"properties.label.background",type:"color",target:"style",key:"headerBackgroundColor"},{label:"properties.label.textColor",type:"color",target:"style",key:"headerColor"},{label:"properties.label.fontSize",type:"number",target:"style",key:"headerFontSize",min:8,max:72,step:1}]},{title:"properties.section.footerStyle",tab:"style",fields:[{label:"properties.label.background",type:"color",target:"style",key:"footerBackgroundColor"},{label:"properties.label.textColor",type:"color",target:"style",key:"footerColor"},{label:"properties.label.fontSize",type:"number",target:"style",key:"footerFontSize",min:8,max:72,step:1}]},{title:"properties.section.border",tab:"style",fields:[{label:"properties.label.borderStyle",type:"select",target:"style",key:"borderStyle",options:[{label:"properties.option.none",value:"none"},{label:"properties.option.solid",value:"solid"},{label:"properties.option.dashed",value:"dashed"},{label:"properties.option.dotted",value:"dotted"}]},{label:"properties.label.borderWidth",type:"number",target:"style",key:"borderWidth",min:0,max:20,step:1},{label:"properties.label.borderColor",type:"color",target:"style",key:"borderColor"}]}]},Wy=Le({__name:"TableElement",props:{element:{}},setup(r){const e=r,{t}=je(),s=De();function n($,N,L="body"){var O;return s.tableSelection&&s.tableSelection.elementId!==e.element.id?!1:((O=s.tableSelection)==null?void 0:O.cells.some(ne=>ne.rowIndex===$&&ne.colField===N&&(ne.section||"body")===L))??!1}const l=ce(null),i=ce(null),d=ce({header:"",field:"",value:"",variable:""}),u=ce({top:0,left:0}),g=ce(null),y=async($,N)=>{if(s.selectedElementId!==e.element.id||e.element.locked)return;const L=b.value.columns[N];if(L){if(l.value=N,i.value=null,d.value={header:L.header,field:L.field,value:"",variable:""},u.value={top:$.clientY+10,left:$.clientX+10},await Xe(),g.value){const O=g.value.getBoundingClientRect(),ne=window.innerWidth,T=window.innerHeight;u.value.left+O.width>ne&&(u.value.left=ne-O.width-20),u.value.top+O.height>T&&(u.value.top=T-O.height-20)}setTimeout(()=>{window.addEventListener("click",x)},100)}},m=async($,N,L)=>{if(s.selectedElementId!==e.element.id||e.element.locked)return;const O=b.value.footerData[N];if(!O)return;const ne=O[L];let T="",D="";if(ne&&typeof ne=="object"&&(T=ne.value||"",D=ne.field||""),i.value={rowIndex:N,colField:L},l.value=null,d.value={header:"",field:L,value:T,variable:D},u.value={top:$.clientY+10,left:$.clientX+10},await Xe(),g.value){const oe=g.value.getBoundingClientRect(),de=window.innerWidth,te=window.innerHeight;u.value.left+oe.width>de&&(u.value.left=de-oe.width-20),u.value.top+oe.height>te&&(u.value.top=te-oe.height-20)}setTimeout(()=>{window.addEventListener("click",x)},100)},x=$=>{g.value&&!g.value.contains($.target)&&p()},p=()=>{l.value=null,i.value=null,window.removeEventListener("click",x)},_=()=>{if(l.value!==null){const $=e.element.columns?[...e.element.columns]:[];if($.length===0&&b.value.columns.length>0){const N=JSON.parse(JSON.stringify(b.value.columns));N[l.value]&&(N[l.value].header=d.value.header,N[l.value].field=d.value.field,s.updateElement(e.element.id,{columns:N})),p();return}l.value<$.length&&($[l.value]={...$[l.value],header:d.value.header,field:d.value.field},s.updateElement(e.element.id,{columns:$}))}else if(i.value){const{rowIndex:$,colField:N}=i.value,L=e.element.footerData?JSON.parse(JSON.stringify(e.element.footerData)):[];if(!L[$])return;const O=L[$],ne=O[N];ne&&typeof ne=="object"?(ne.value=d.value.value,ne.field=d.value.variable):O[N]={value:d.value.value,field:d.value.variable},s.updateElement(e.element.id,{footerData:L})}p()},v=ce(!1),k=ce(null),b=ve(()=>{const $=e.element.columns||[];let N=e.element.data||[],L=e.element.footerData||[];if(s.isExporting&&e.element.variable){const T=Bt(e.element.variable),D=s.testData||{},oe=T?D[T]:void 0;Array.isArray(oe)&&(N=Ee(oe))}if(e.element.customScript)try{const D=new Function("data","footerData","columns","type",e.element.customScript)(Ee(N),Ee(L),Ee($),"global");if(D&&(D.data&&(N=D.data),D.footerData&&(L=D.footerData),D.columns))return{...D,columns:D.columns}}catch(T){console.error("Custom script error",T)}const O=Ee(L),ne=$.map(T=>T.field);return O.forEach(T=>{Object.keys(T).forEach(D=>{const oe=T[D];if(oe&&typeof oe=="object"&&oe.field&&ne.includes(oe.field)){const de=oe.field,te=N.reduce((ue,ie)=>{const he=parseFloat(ie[de]);return ue+(isNaN(he)?0:he)},0);oe.result=te}})}),{columns:$,data:N,footerData:O}}),f=ve(()=>({color:e.element.style.color||"#000000",fontFamily:e.element.style.fontFamily,borderColor:e.element.style.borderColor||"#000",borderWidth:(e.element.style.borderWidth||1)+"px",borderStyle:e.element.style.borderStyle||"solid"})),C=($,N)=>{if(!$)return"";const L=$[N];if(L&&typeof L=="object"){const O=L.value||"",ne=L.printValue!==void 0?L.printValue:L.result!==void 0?L.result:"";return O+ne}return L},M=($,N)=>{if(!$)return"";const L=$[N];if(L&&typeof L=="object"){const O=L.value||"",ne=L.result!==void 0?L.result:L.printValue!==void 0?L.printValue:"";return O+ne}return L},F=($,N)=>{const L=$[N];return L&&typeof L=="object"&&"rowSpan"in L?L.rowSpan:1},R=($,N)=>{const L=$[N];return L&&typeof L=="object"&&"colSpan"in L?L.colSpan:1},z=($,N)=>{const L=$[N];return!(L&&typeof L=="object"&&(L.rowSpan===0||L.colSpan===0))},H=($,N)=>{const L=$[N];return L&&typeof L=="object"&&L.style?L.style:{}},Y=ce({}),se=ce(null),W=ce(0),E=ce(0),B=($,N)=>{if(e.element.locked)return;$.preventDefault(),$.stopPropagation(),se.value=N,W.value=$.clientX;const L=b.value.columns[N];E.value=L.width||100,window.addEventListener("mousemove",c),window.addEventListener("mouseup",w)},c=$=>{if(se.value===null)return;const N=$.clientX-W.value,L=Math.max(20,E.value+N),O=b.value.columns[se.value];Y.value[O.field]=L},w=()=>{if(se.value!==null){const $=b.value.columns[se.value],N=Y.value[$.field];if(N){const L=[...e.element.columns||[]];L[se.value]&&(L[se.value]={...L[se.value],width:N},s.updateElement(e.element.id,{columns:L}))}}se.value=null,Y.value={},window.removeEventListener("mousemove",c),window.removeEventListener("mouseup",w)},G=($,N,L,O="body")=>{s.selectedElementId===e.element.id&&($.stopPropagation(),v.value=!0,k.value={rowIndex:N,colField:L,section:O},s.setTableSelection(e.element.id,{rowIndex:N,colField:L,section:O},!1))},ee=($,N,L="body")=>{if(!v.value||!k.value||k.value.section!==L)return;const O=k.value.rowIndex,ne=$,T=b.value.columns.findIndex(he=>he.field===k.value.colField),D=b.value.columns.findIndex(he=>he.field===N);if(T===-1||D===-1)return;const oe=Math.min(O,ne),de=Math.max(O,ne),te=Math.min(T,D),ue=Math.max(T,D),ie=[];for(let he=oe;he<=de;he++)for(let Q=te;Q<=ue;Q++)ie.push({rowIndex:he,colField:b.value.columns[Q].field,section:L});s.setTableSelectionCells(e.element.id,ie)},J=()=>{v.value=!1,k.value=null};return Ve(()=>{window.addEventListener("mouseup",J)}),We(()=>{window.removeEventListener("mouseup",J)}),($,N)=>(P(),q("div",{class:"w-full h-full overflow-hidden",style:_e({backgroundColor:r.element.style.backgroundColor||"transparent"})},[o("table",{class:ke(["w-full border-collapse",{"h-full":!a(s).isExporting}]),"data-tfoot-repeat":r.element.tfootRepeat,"data-auto-paginate":r.element.autoPaginate,"data-custom-script":r.element.customScript},[o("thead",null,[o("tr",null,[(P(!0),q(Te,null,Me(b.value.columns,(L,O)=>(P(),q("th",{key:L.field,class:"p-1 text-left font-bold text-sm relative group select-none",style:_e({...f.value,width:`${Y.value[L.field]||L.width}px`,height:r.element.style.headerHeight?`${r.element.style.headerHeight}px`:void 0,backgroundColor:r.element.style.headerBackgroundColor||"#f3f4f6",color:r.element.style.headerColor||"#000000",fontSize:r.element.style.headerFontSize?`${r.element.style.headerFontSize}px`:void 0,cursor:a(s).selectedElementId===r.element.id?"pointer":"default"}),onDblclick:ne=>y(ne,O)},[Ce(S(L.header)+" ",1),a(s).selectedElementId===r.element.id&&O<b.value.columns.length-1&&!r.element.locked?(P(),q("div",{key:0,class:ke(["absolute -right-1 top-0 bottom-0 w-2 cursor-col-resize hover:bg-blue-400 opacity-0 hover:opacity-100 z-10 transition-opacity",{"bg-blue-400 opacity-100":se.value===O}]),onMousedown:ne=>B(ne,O),onClick:N[0]||(N[0]=Ke(()=>{},["stop"]))},null,42,ky)):xe("",!0)],44,_y))),128))])]),o("tbody",null,[(P(!0),q(Te,null,Me(a(s).isExporting?b.value.data:b.value.data.slice(0,5),(L,O)=>(P(),q("tr",{key:O},[(P(!0),q(Te,null,Me(b.value.columns,ne=>(P(),q(Te,{key:ne.field},[z(L,ne.field)?(P(),q("td",{key:0,class:ke(["p-1 text-sm select-none",{"bg-blue-100 ring-1 ring-blue-400":n(O,ne.field)}]),style:_e({...f.value,...H(L,ne.field),height:r.element.style.rowHeight?`${r.element.style.rowHeight}px`:void 0}),rowspan:F(L,ne.field),colspan:R(L,ne.field),"data-field":ne.field,onMousedown:T=>G(T,O,ne.field),onMouseover:T=>ee(O,ne.field)},S(M(L,ne.field)),47,Sy)):xe("",!0)],64))),128))]))),128)),!a(s).isExporting&&b.value.data.length>5?(P(),q("tr",Cy,[o("td",{colspan:b.value.columns.length,class:"p-1 text-center text-gray-500 select-none",style:_e({...f.value,height:r.element.style.rowHeight?`${r.element.style.rowHeight}px`:void 0})}," ... ",12,Ey)])):xe("",!0),a(s).isExporting?xe("",!0):(P(),q("tr",Ty,[o("td",{colspan:b.value.columns.length||1,class:"border-none p-0"},null,8,$y)]))]),r.element.showFooter?(P(),q("tfoot",Iy,[(P(!0),q(Te,null,Me(b.value.footerData,(L,O)=>(P(),q("tr",{key:O},[(P(!0),q(Te,null,Me(b.value.columns,ne=>(P(),q(Te,{key:ne.field},[z(L,ne.field)?(P(),q("td",{key:0,class:ke(["p-1 text-sm font-bold select-none",{"!bg-blue-100 ring-1 ring-blue-400":n(O,ne.field,"footer")}]),style:_e({...f.value,...H(L,ne.field),height:r.element.style.footerHeight?`${r.element.style.footerHeight}px`:void 0,backgroundColor:r.element.style.footerBackgroundColor||"#f9fafb",color:r.element.style.footerColor||"#000000",fontSize:r.element.style.footerFontSize?`${r.element.style.footerFontSize}px`:void 0,cursor:a(s).selectedElementId===r.element.id?"pointer":"default"}),rowspan:F(L,ne.field),colspan:R(L,ne.field),"data-field":ne.field,"data-value":C(L,ne.field),onMousedown:T=>G(T,O,ne.field,"footer"),onMouseover:T=>ee(O,ne.field,"footer"),onDblclick:T=>m(T,O,ne.field)},S(M(L,ne.field)),47,Ay)):xe("",!0)],64))),128))]))),128))])):xe("",!0)],10,xy),(P(),Pe(et,{to:"body"},[l.value!==null||i.value?(P(),q("div",{key:0,ref_key:"editFormRef",ref:g,class:"fixed z-[9999] bg-white shadow-xl border border-gray-200 rounded-lg p-4 w-64 flex flex-col gap-3",style:_e({top:`${u.value.top}px`,left:`${u.value.left}px`}),onClick:N[5]||(N[5]=Ke(()=>{},["stop"]))},[o("h4",zy,S(i.value?a(t)("properties.label.editCell"):a(t)("properties.label.editColumn")),1),l.value!==null?(P(),q(Te,{key:0},[o("div",Py,[o("label",Ly,S(a(t)("properties.label.headerText")),1),$e(o("input",{"onUpdate:modelValue":N[1]||(N[1]=L=>d.value.header=L),class:"border border-gray-300 rounded px-2 py-1 text-sm focus:border-blue-500 focus:outline-none",placeholder:a(t)("properties.label.headerNamePlaceholder"),onKeydown:gt(_,["enter"]),autoFocus:""},null,40,My),[[Be,d.value.header]])]),o("div",Ry,[o("label",Dy,S(a(t)("properties.label.fieldKey")),1),$e(o("input",{"onUpdate:modelValue":N[2]||(N[2]=L=>d.value.field=L),class:"border border-gray-300 rounded px-2 py-1 text-sm focus:border-blue-500 focus:outline-none",placeholder:a(t)("properties.label.fieldKey"),onKeydown:gt(_,["enter"])},null,40,By),[[Be,d.value.field]])])],64)):xe("",!0),i.value?(P(),q(Te,{key:1},[o("div",Oy,[o("label",qy,S(a(t)("properties.label.content")),1),$e(o("input",{"onUpdate:modelValue":N[3]||(N[3]=L=>d.value.value=L),class:"border border-gray-300 rounded px-2 py-1 text-sm focus:border-blue-500 focus:outline-none",placeholder:a(t)("properties.label.displayTextPlaceholder"),onKeydown:gt(_,["enter"]),autoFocus:""},null,40,Fy),[[Be,d.value.value]])]),o("div",jy,[o("label",Ny,S(a(t)("properties.label.variableField")),1),$e(o("input",{"onUpdate:modelValue":N[4]||(N[4]=L=>d.value.variable=L),class:"border border-gray-300 rounded px-2 py-1 text-sm focus:border-blue-500 focus:outline-none",placeholder:a(t)("properties.label.dataFieldPlaceholder"),onKeydown:gt(_,["enter"])},null,40,Hy),[[Be,d.value.variable]])])],64)):xe("",!0),o("div",Uy,[o("button",{onClick:p,class:"px-3 py-1 text-xs text-gray-600 hover:bg-gray-100 rounded"},S(a(t)("common.cancel")),1),o("button",{onClick:_,class:"px-3 py-1 text-xs bg-blue-600 text-white hover:bg-blue-700 rounded"},S(a(t)("common.save")),1)])],4)):xe("",!0)]))],4))}}),Gy={class:"page-number-text"},Ky={sections:[{title:"properties.section.labelContent",tab:"properties",fields:[{label:"properties.label.labelText",type:"text",target:"element",key:"labelText",placeholder:"properties.label.labelTextPlaceholder"},{label:"properties.label.labelPosition",type:"select",target:"element",key:"labelPosition",options:[{label:"properties.option.before",value:"before"},{label:"properties.option.after",value:"after"}]},{label:"properties.label.pageFormat",type:"select",target:"element",key:"format",options:[{label:"properties.option.numberOnly",value:"1"},{label:"properties.option.page1",value:"Page 1"},{label:"properties.option.oneTotal",value:"1/Total"}]}]},{title:"properties.section.paginationTypography",tab:"style",fields:[{label:"properties.label.fontSize",type:"number",target:"style",key:"fontSize",min:8,max:96,step:1},{label:"properties.label.color",type:"color",target:"style",key:"color"},{label:"properties.label.textAlign",type:"select",target:"style",key:"textAlign",options:[{label:"properties.option.default",value:""},{label:"properties.option.left",value:"left"},{label:"properties.option.center",value:"center"},{label:"properties.option.right",value:"right"}]},{label:"properties.label.fontFamily",type:"select",target:"style",key:"fontFamily",options:[{label:"properties.option.default",value:""},{label:"properties.option.arial",value:"Arial, sans-serif"},{label:"properties.option.timesNewRoman",value:'"Times New Roman", serif'},{label:"properties.option.courierNew",value:'"Courier New", monospace'},{label:"properties.option.simSun",value:"SimSun, serif"},{label:"properties.option.simHei",value:"SimHei, sans-serif"}]},{label:"properties.label.fontWeight",type:"select",target:"style",key:"fontWeight",options:[{label:"properties.option.default",value:""},{label:"properties.option.normal",value:"400"},{label:"properties.option.medium",value:"500"},{label:"properties.option.bold",value:"700"}]}]},{title:"properties.section.labelStyle",tab:"style",fields:[{label:"properties.label.labelFontSize",type:"number",target:"element",key:"labelFontSize",min:8,max:96,step:1},{label:"properties.label.labelColor",type:"color",target:"element",key:"labelColor"},{label:"properties.label.labelFontFamily",type:"select",target:"element",key:"labelFontFamily",options:[{label:"properties.option.default",value:""},{label:"properties.option.arial",value:"Arial, sans-serif"},{label:"properties.option.timesNewRoman",value:'"Times New Roman", serif'},{label:"properties.option.courierNew",value:'"Courier New", monospace'},{label:"properties.option.simSun",value:"SimSun, serif"},{label:"properties.option.simHei",value:"SimHei, sans-serif"}]},{label:"properties.label.labelFontWeight",type:"select",target:"element",key:"labelFontWeight",options:[{label:"properties.option.default",value:""},{label:"properties.option.normal",value:"400"},{label:"properties.option.medium",value:"500"},{label:"properties.option.bold",value:"700"}]},{label:"properties.label.labelBackgroundColor",type:"color",target:"element",key:"labelBackgroundColor"},{label:"properties.label.labelBorderStyle",type:"select",target:"element",key:"labelBorderStyle",options:[{label:"properties.option.none",value:""},{label:"properties.option.solid",value:"solid"},{label:"properties.option.dashed",value:"dashed"},{label:"properties.option.dotted",value:"dotted"}]},{label:"properties.label.labelBorderWidth",type:"number",target:"element",key:"labelBorderWidth",min:0,max:20,step:1},{label:"properties.label.labelBorderColor",type:"color",target:"element",key:"labelBorderColor"}]},{title:"properties.section.frameBorder",tab:"style",fields:[{label:"properties.label.borderStyle",type:"select",target:"style",key:"borderStyle",options:[{label:"properties.option.none",value:"none"},{label:"properties.option.solid",value:"solid"},{label:"properties.option.dashed",value:"dashed"},{label:"properties.option.dotted",value:"dotted"}]},{label:"properties.label.borderWidth",type:"number",target:"style",key:"borderWidth",min:0,max:20,step:1},{label:"properties.label.borderColor",type:"color",target:"style",key:"borderColor"}]}]},Yy=Le({__name:"PageNumberElement",props:{element:{},pageIndex:{},totalPages:{}},setup(r){const e=r,{t}=je(),s=ve(()=>{const n=e.pageIndex+1,l=e.totalPages||1;switch(e.element.format||"1/Total"){case"1":return`${n}`;case"Page 1":return t("properties.option.page1").replace("1",n.toString());case"1/Total":return`${n}/${l}`;default:return`${n}/${l}`}});return(n,l)=>(P(),q("div",{class:"w-full h-full overflow-hidden","data-print-type":"page-number",style:_e({fontSize:`${r.element.style.fontSize}px`,fontFamily:r.element.style.fontFamily,fontWeight:r.element.style.fontWeight,fontStyle:r.element.style.fontStyle,textAlign:r.element.style.textAlign,color:r.element.style.color,padding:`${r.element.style.padding||0}px`})},[r.element.labelText&&r.element.labelPosition!=="after"?(P(),q("span",{key:0,style:_e({fontSize:r.element.labelFontSize?`${r.element.labelFontSize}px`:void 0,fontFamily:r.element.labelFontFamily||void 0,fontWeight:r.element.labelFontWeight||void 0,color:r.element.labelColor||void 0,backgroundColor:r.element.labelBackgroundColor||"transparent",borderStyle:r.element.labelBorderStyle||"none",borderWidth:`${r.element.labelBorderWidth||0}px`,borderColor:r.element.labelBorderColor||"transparent",marginRight:"4px",padding:"0 4px"})},S(r.element.labelText),5)):xe("",!0),o("span",Gy,S(s.value),1),r.element.labelText&&r.element.labelPosition==="after"?(P(),q("span",{key:1,style:_e({fontSize:r.element.labelFontSize?`${r.element.labelFontSize}px`:void 0,fontFamily:r.element.labelFontFamily||void 0,fontWeight:r.element.labelFontWeight||void 0,color:r.element.labelColor||void 0,backgroundColor:r.element.labelBackgroundColor||"transparent",borderStyle:r.element.labelBorderStyle||"none",borderWidth:`${r.element.labelBorderWidth||0}px`,borderColor:r.element.labelBorderColor||"transparent",marginLeft:"4px",padding:"0 4px"})},S(r.element.labelText),5)):xe("",!0)],4))}});var Xy=Jl();const Nl=bt(Xy),Zy={class:"w-full h-full flex items-center justify-center overflow-hidden"},Jy={sections:[{title:"properties.section.content",tab:"properties",fields:[{label:"properties.label.content",type:"text",target:"element",key:"content",placeholder:"properties.label.barcodeContentPlaceholder"},{label:"properties.label.variable",type:"text",target:"element",key:"variable",placeholder:"@variable"}]},{title:"properties.section.barcodeSettings",tab:"style",fields:[{label:"properties.label.format",type:"select",target:"style",key:"barcodeFormat",options:[{label:"properties.option.code128",value:"CODE128"},{label:"properties.option.ean13",value:"EAN13"},{label:"properties.option.upc",value:"UPC"},{label:"properties.option.code39",value:"CODE39"},{label:"properties.option.itf14",value:"ITF14"},{label:"properties.option.msi",value:"MSI"},{label:"properties.option.pharmacode",value:"pharmacode"}]},{label:"properties.label.showText",type:"select",target:"style",key:"showText",options:[{label:"properties.option.yes",value:!0},{label:"properties.option.no",value:!1}]},{label:"properties.label.color",type:"color",target:"style",key:"color"},{label:"properties.label.lineWidth",type:"number",target:"style",key:"barcodeWidth",placeholder:"2"},{label:"properties.label.barcodeHeight",type:"number",target:"style",key:"barcodeHeight",placeholder:"40"},{label:"properties.label.margin",type:"number",target:"style",key:"margin",placeholder:"0"},{label:"properties.label.fontSize",type:"number",target:"style",key:"fontSize",placeholder:"20"},{label:"properties.label.textPosition",type:"select",target:"style",key:"textPosition",options:[{label:"properties.option.bottom",value:"bottom"},{label:"properties.option.top",value:"top"}]},{label:"properties.label.textAlign",type:"select",target:"style",key:"textAlign",options:[{label:"properties.option.left",value:"left"},{label:"properties.option.center",value:"center"},{label:"properties.option.right",value:"right"}]}]}]},Qy=Le({__name:"BarcodeElement",props:{element:{}},setup(r){const e=r,t=De(),s=ce(null),n=ve(()=>{const i=e.element.variable||"";if(t.isExporting&&i){const d=Bt(i);if(d&&Object.prototype.hasOwnProperty.call(t.testData,d)){const u=t.testData[d];if(u!=null)return String(u)}}return e.element.variable||e.element.content||"12345678"}),l=()=>{if(s.value)try{const i=n.value,d=e.element.style;Nl(s.value,i,{format:d.barcodeFormat||"CODE128",lineColor:d.color||"#000000",width:Number(d.barcodeWidth)||2,height:Number(d.barcodeHeight)||40,displayValue:d.showText!==!1&&d.showText!=="false",fontOptions:d.fontOptions||"",font:d.font||"monospace",textAlign:d.textAlign||"center",textPosition:d.textPosition||"bottom",textMargin:Number(d.textMargin)||2,fontSize:Number(d.fontSize)||20,background:"transparent",margin:Number(d.margin)||0})}catch(i){console.error("Barcode render error",i)}};return Ve(()=>{Xe(l)}),Ae(()=>[e.element.content,e.element.variable,e.element.style,t.isExporting,t.testData],()=>{Xe(l)},{deep:!0}),(i,d)=>(P(),q("div",Zy,[o("img",{ref_key:"barcodeRef",ref:s,class:"w-full h-full object-contain pointer-events-none"},null,512)]))}});var e2=Ql();const Hl=bt(e2),t2={class:"w-full h-full flex items-center justify-center overflow-hidden"},r2=["src"],n2={sections:[{title:"properties.section.content",tab:"properties",fields:[{label:"properties.label.content",type:"text",target:"element",key:"content",placeholder:"properties.label.qrContentPlaceholder"},{label:"properties.label.variable",type:"text",target:"element",key:"variable",placeholder:"@variable"}]},{title:"properties.section.qrSettings",tab:"style",fields:[{label:"properties.label.errorCorrection",type:"select",target:"style",key:"qrErrorCorrection",options:[{label:"properties.option.eccLow",value:"L"},{label:"properties.option.eccMedium",value:"M"},{label:"properties.option.eccQuartile",value:"Q"},{label:"properties.option.eccHigh",value:"H"}]},{label:"properties.label.color",type:"color",target:"style",key:"color"}]}]},o2=Le({__name:"QRCodeElement",props:{element:{}},setup(r){const e=r,t=De(),s=ce(""),n=ve(()=>{const i=e.element.variable||"";if(t.isExporting&&i){const d=Bt(i);if(d&&Object.prototype.hasOwnProperty.call(t.testData,d)){const u=t.testData[d];if(u!=null)return String(u)}}return e.element.variable||e.element.content||"https://example.com"}),l=async()=>{try{const i=n.value;s.value=await Hl.toDataURL(i,{margin:0,color:{dark:e.element.style.color||"#000000",light:"#00000000"},errorCorrectionLevel:e.element.style.qrErrorCorrection||"M"})}catch(i){console.error("QR render error",i)}};return Ve(()=>Xe(l)),Ae(()=>[e.element.content,e.element.variable,e.element.style,t.isExporting,t.testData],()=>Xe(l),{deep:!0}),(i,d)=>(P(),q("div",t2,[s.value?(P(),q("img",{key:0,src:s.value,class:"w-full h-full object-contain pointer-events-none",draggable:"false"},null,8,r2)):xe("",!0)]))}}),s2={class:"w-full h-full flex items-center justify-center"},a2={sections:[{title:"properties.section.lineStyle",tab:"style",fields:[{label:"properties.label.color",type:"color",target:"style",key:"borderColor",defaultValue:"#000000"},{label:"properties.label.thickness",type:"number",target:"style",key:"borderWidth",min:1,max:100,step:1,defaultValue:1},{label:"properties.label.borderStyle",type:"select",target:"style",key:"borderStyle",defaultValue:"solid",options:[{label:"properties.option.solid",value:"solid"},{label:"properties.option.dashed",value:"dashed"},{label:"properties.option.dotted",value:"dotted"}]}]}]},l2=Le({__name:"LineElement",props:{element:{}},setup(r){return(e,t)=>(P(),q("div",s2,[o("div",{class:"w-full",style:_e({borderTopWidth:`${r.element.style.borderWidth||1}px`,borderTopStyle:r.element.style.borderStyle||"solid",borderTopColor:r.element.style.borderColor||"#000000"})},null,4)]))}}),i2={sections:[{title:"properties.section.appearance",tab:"style",fields:[{label:"properties.label.background",type:"color",target:"style",key:"backgroundColor",defaultValue:"transparent"},{label:"properties.label.borderColor",type:"color",target:"style",key:"borderColor",defaultValue:"#000000"},{label:"properties.label.borderWidth",type:"number",target:"style",key:"borderWidth",min:0,max:100,defaultValue:1},{label:"properties.label.borderStyle",type:"select",target:"style",key:"borderStyle",defaultValue:"solid",options:[{label:"properties.option.none",value:"none"},{label:"properties.option.solid",value:"solid"},{label:"properties.option.dashed",value:"dashed"},{label:"properties.option.dotted",value:"dotted"}]},{label:"properties.label.cornerRadius",type:"number",target:"style",key:"borderRadius",min:0,max:1e3}]}]},d2=Le({__name:"RectElement",props:{element:{}},setup(r){return(e,t)=>(P(),q("div",{class:"w-full h-full",style:_e({backgroundColor:r.element.style.backgroundColor||"transparent",borderWidth:`${r.element.style.borderWidth||1}px`,borderStyle:r.element.style.borderStyle||"solid",borderColor:r.element.style.borderColor||"#000000",borderRadius:`${r.element.style.borderRadius||0}px`})},null,4))}}),u2={sections:[{title:"properties.section.appearance",tab:"style",fields:[{label:"properties.label.background",type:"color",target:"style",key:"backgroundColor",defaultValue:"transparent"},{label:"properties.label.borderColor",type:"color",target:"style",key:"borderColor",defaultValue:"#000000"},{label:"properties.label.borderWidth",type:"number",target:"style",key:"borderWidth",min:0,max:100,defaultValue:1},{label:"properties.label.borderStyle",type:"select",target:"style",key:"borderStyle",defaultValue:"solid",options:[{label:"properties.option.none",value:"none"},{label:"properties.option.solid",value:"solid"},{label:"properties.option.dashed",value:"dashed"},{label:"properties.option.dotted",value:"dotted"}]}]}]},c2=Le({__name:"CircleElement",props:{element:{}},setup(r){return(e,t)=>(P(),q("div",{class:"w-full h-full rounded-full",style:_e({backgroundColor:r.element.style.backgroundColor||"transparent",borderWidth:`${r.element.style.borderWidth||1}px`,borderStyle:r.element.style.borderStyle||"solid",borderColor:r.element.style.borderColor||"#000000"})},null,4))}}),h2={key:0,class:"flex items-center justify-between"},p2={class:"text-sm text-gray-700 font-medium"},f2=["disabled"],m2={class:"sr-only"},g2={key:1},v2={class:"block text-xs text-gray-500 mb-1"},b2=["value","disabled","placeholder"],y2=["type","value","disabled","placeholder","min","max","step"],Ct=Le({__name:"PropertyInput",props:{label:{},value:{type:[String,Number,Boolean]},type:{},placeholder:{},min:{},max:{},step:{},disabled:{type:Boolean}},emits:["update:value"],setup(r,{emit:e}){const t=e,s=n=>{const l=n.target;t("update:value",l.value)};return(n,l)=>r.type==="switch"?(P(),q("div",h2,[o("label",p2,S(r.label),1),o("button",{type:"button",disabled:r.disabled,onClick:l[0]||(l[0]=i=>n.$emit("update:value",!r.value)),class:ke(["relative inline-flex h-6 w-11 flex-shrink-0 cursor-pointer rounded-full border-2 border-transparent transition-colors duration-200 ease-in-out focus:outline-none focus:ring-2 focus:ring-blue-600 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed",r.value?"bg-blue-600":"bg-gray-200"])},[o("span",m2,"Toggle "+S(r.label),1),o("span",{"aria-hidden":"true",class:ke(["pointer-events-none inline-block h-5 w-5 transform rounded-full bg-white shadow ring-0 transition duration-200 ease-in-out",r.value?"translate-x-5":"translate-x-0"])},null,2)],10,f2)])):(P(),q("div",g2,[o("label",v2,S(r.label),1),r.type==="textarea"?(P(),q("textarea",{key:0,value:r.value===void 0||r.value===null?"":String(r.value),disabled:r.disabled,placeholder:r.placeholder,onInput:s,class:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:border-blue-500 outline-none h-24 resize-y disabled:bg-gray-100 disabled:text-gray-500"},null,40,b2)):(P(),q("input",{key:1,type:r.type||"text",value:r.value===void 0||r.value===null?"":String(r.value),disabled:r.disabled,placeholder:r.placeholder,min:r.min,max:r.max,step:r.step,onInput:s,class:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:border-blue-500 outline-none disabled:bg-gray-100 disabled:text-gray-500"},null,40,y2))]))}}),w2={class:"block text-xs text-gray-500 mb-1"},x2=["value","disabled"],_2=["value"],k2=Le({__name:"PropertySelect",props:{label:{},value:{type:[String,Number,Boolean]},options:{},disabled:{type:Boolean}},emits:["update:value"],setup(r,{emit:e}){const t=r,s=e,n=l=>{const d=l.target.value,u=t.options.find(g=>String(g.value)===d);s("update:value",u?u.value:d)};return(l,i)=>(P(),q("div",null,[o("label",w2,S(r.label),1),o("select",{value:r.value,disabled:r.disabled,onChange:n,class:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:border-blue-500 outline-none disabled:bg-gray-100 disabled:text-gray-500"},[(P(!0),q(Te,null,Me(r.options,d=>(P(),q("option",{key:String(d.value),value:d.value},S(d.label),9,_2))),128))],40,x2)]))}}),S2={class:"flex items-center justify-between"},C2={class:"text-xs text-gray-500"},E2={class:"flex items-center gap-2"},T2={key:0,class:"absolute inset-0 flex items-center justify-center"},el=Le({__name:"PropertyColor",props:{label:{},value:{},disabled:{type:Boolean}},emits:["update:value"],setup(r,{emit:e}){const t=e;return(s,n)=>(P(),q("div",S2,[o("label",C2,S(r.label),1),o("div",E2,[fe(vt,{"model-value":r.value,"onUpdate:modelValue":n[0]||(n[0]=l=>t("update:value",l)),disabled:r.disabled,"allow-transparent":!0},{trigger:it(({color:l,open:i})=>[o("div",{class:ke(["w-8 h-6 rounded border border-gray-300 cursor-pointer relative overflow-hidden hover:border-blue-500 transition-colors",{"ring-2 ring-blue-500 ring-offset-1":i,"opacity-50 cursor-not-allowed":r.disabled}])},[n[2]||(n[2]=o("div",{class:"absolute inset-0 bg-[url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAIAAADZF8uwAAAAGUlEQVQYV2M4gwZ+5wNisxL//8n04mEeRAAAhNwX869V4DYAAAAASUVORK5CYII=')] opacity-50"},null,-1)),o("div",{class:"absolute inset-0",style:_e({backgroundColor:l==="transparent"?"transparent":l})},null,4),l==="transparent"?(P(),q("div",T2,[...n[1]||(n[1]=[o("div",{class:"w-full h-[1px] bg-red-500 rotate-45"},null,-1)])])):xe("",!0)],2)]),_:1},8,["model-value","disabled"])])]))}}),$2={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function I2(r,e){return P(),q("svg",$2,[...e[0]||(e[0]=[o("path",{fill:"currentColor",d:"M3 21v-8h2v4.6L17.6 5H13V3h8v8h-2V6.4L6.4 19H11v2z"},null,-1)])])}const A2=Se({name:"material-symbols-open-in-full",render:I2}),z2={class:"flex flex-col gap-1"},P2={class:"flex justify-between items-center"},L2={class:"text-xs text-gray-500 font-medium"},M2={class:"flex items-center gap-2"},R2={class:"text-[10px] text-gray-400 uppercase"},D2=Le({__name:"PropertyCode",props:{label:{},value:{},language:{},disabled:{type:Boolean},height:{}},emits:["update:value"],setup(r,{emit:e}){const t=e;De();const{isDark:s}=xo(),n=ce(!1),l=ve(()=>({minimap:{enabled:!1},lineNumbers:"on",glyphMargin:!1,folding:!0,wordWrap:"on",automaticLayout:!0,scrollBeyondLastLine:!1,theme:s.value?"vs-dark":"vs",fontSize:12,fontFamily:'Consolas, "Courier New", monospace',renderLineHighlight:"none",overviewRulerLanes:0,hideCursorInOverviewRuler:!0,contextmenu:!1})),i=y=>{t("update:value",y||"")},d=()=>{n.value=!n.value},u=()=>{n.value=!1},g=y=>{t("update:value",y)};return(y,m)=>(P(),q("div",z2,[o("div",P2,[o("label",L2,S(r.label),1),o("div",M2,[o("span",R2,S(r.language),1),o("button",{onClick:d,class:"text-gray-400 hover:text-blue-600 transition-colors p-0.5 rounded hover:bg-gray-100",title:"Expand Editor"},[fe(a(A2),{class:"w-3.5 h-3.5"})])])]),o("div",{class:"border border-gray-300 rounded overflow-hidden focus-within:border-blue-500 focus-within:ring-1 focus-within:ring-blue-500 resize-y relative group",style:_e({height:`${r.height||200}px`,minHeight:"100px",maxHeight:"600px"})},[fe(a(dl),{value:r.value,language:r.language,options:{...l.value,readOnly:r.disabled},"onUpdate:value":i,class:"w-full h-full"},null,8,["value","language","options"]),m[1]||(m[1]=o("div",{class:"absolute bottom-0 right-0 w-3 h-3 cursor-ns-resize pointer-events-none bg-gradient-to-tl from-gray-300 to-transparent opacity-50 group-hover:opacity-100"},null,-1))],4),fe(Rt,{visible:n.value,"onUpdate:visible":m[0]||(m[0]=x=>n.value=x),title:r.label,value:r.value,language:r.language,"read-only":r.disabled,"onUpdate:value":g,onClose:u},null,8,["visible","title","value","language","read-only"])]))}}),B2=_t(D2,[["__scopeId","data-v-44208768"]]),O2={class:"block text-xs text-gray-500 mb-1"},q2={class:"space-y-2"},F2=["value","disabled","placeholder"],j2={class:"flex flex-col gap-1"},N2=["disabled"],H2={class:"text-[10px] text-gray-400 text-center"},U2={key:0,class:"text-xs text-red-500 mt-1"},V2=Le({__name:"PropertyImage",props:{label:{},value:{},disabled:{type:Boolean},placeholder:{}},emits:["update:value"],setup(r,{emit:e}){const t=r,s=e,{t:n}=je(),l=ce(null),i=ce(""),d=()=>{var y;t.disabled||(y=l.value)==null||y.click()},u=y=>{var _;const m=y.target,x=(_=m.files)==null?void 0:_[0];if(!x)return;if(i.value="",x.size>2*1024*1024){i.value=n("properties.image.sizeError"),m.value="";return}const p=new FileReader;p.onload=v=>{var b;const k=(b=v.target)==null?void 0:b.result;s("update:value",k)},p.onerror=()=>{i.value=n("properties.image.readError")},p.readAsDataURL(x),m.value=""},g=y=>{const m=y.target;s("update:value",m.value)};return(y,m)=>(P(),q("div",null,[o("label",O2,S(r.label),1),o("div",q2,[o("input",{type:"text",value:r.value||"",disabled:r.disabled,placeholder:r.placeholder||a(n)("properties.image.urlPlaceholder"),onInput:g,class:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:border-blue-500 outline-none disabled:bg-gray-100 disabled:text-gray-500"},null,40,F2),o("div",j2,[o("button",{type:"button",onClick:d,disabled:r.disabled,class:"w-full py-1.5 px-3 bg-white text-gray-700 text-sm border border-gray-300 rounded hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2"},[m[0]||(m[0]=o("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12"})],-1)),Ce(" "+S(a(n)("properties.image.uploadBtn")),1)],8,N2),o("span",H2,S(a(n)("properties.image.uploadTip")),1)]),i.value?(P(),q("p",U2,S(i.value),1)):xe("",!0),o("input",{ref_key:"fileInput",ref:l,type:"file",accept:"image/*",class:"hidden",onChange:u},null,544)])]))}}),W2={class:"p-4 border-b border-gray-200 bg-gray-50 flex items-center justify-between"},G2={class:"font-semibold text-gray-700"},K2={class:"text-xs text-gray-500 mt-1"},Y2={key:0,class:"flex items-center text-red-500 gap-1 text-xs font-medium bg-red-50 px-2 py-1 rounded border border-red-100"},X2={key:0,class:"p-6 text-center"},Z2={class:"mb-4"},J2={class:"text-lg font-semibold text-gray-900"},Q2={class:"text-sm text-gray-500 mt-2"},ew={class:"font-medium"},tw={key:1,class:"flex flex-col h-full overflow-hidden"},rw={class:"flex border-b border-gray-200 bg-white"},nw=["onClick"],ow={key:0,class:"absolute bottom-0 left-0 w-full h-0.5 bg-blue-600"},sw={class:"p-4 space-y-6 overflow-y-auto flex-1 custom-scrollbar"},aw={key:0,class:"space-y-3"},lw={class:"text-xs font-bold text-gray-500 uppercase tracking-wider"},iw={class:"grid grid-cols-2 gap-3"},dw={key:1,class:"space-y-3 pt-2 border-t border-gray-100"},uw={class:"text-xs font-bold text-gray-500 uppercase tracking-wider"},cw={class:"grid grid-cols-2 gap-3"},hw=["disabled"],pw=["disabled"],fw={class:"text-xs font-bold text-gray-500 uppercase tracking-wider"},mw={class:"space-y-3"},gw={key:0},vw=["onClick","disabled"],bw={key:6},yw={class:"block text-xs text-gray-500 mb-1 font-medium"},ww=["placeholder","disabled","value","onChange"],xw={key:2,class:"space-y-3 pt-2 border-t border-gray-100"},_w={class:"text-xs font-bold text-gray-500 uppercase tracking-wider"},kw={key:3,class:"space-y-4"},Sw={class:"p-4 bg-gray-50 rounded border border-gray-200"},Cw={class:"text-sm font-medium text-gray-700 mb-3"},Ew={class:"space-y-3"},Tw={class:"text-xs text-gray-500 mb-1.5 font-medium"},$w={class:"flex items-center gap-2 bg-white border border-gray-200 rounded px-2 py-1.5 hover:border-blue-400 transition-colors"},Iw=["title"],Aw=["title"],zw={class:"text-xs text-gray-500 flex items-center justify-between border-t border-gray-100 pt-2"},Pw={class:"font-medium"},Lw={class:"px-2 py-0.5 bg-gray-100 rounded text-gray-600"},Mw=["disabled"],Rw={key:2,class:"p-6 text-center"},Dw={class:"mb-4"},Bw={class:"text-lg font-semibold text-gray-900"},Ow={class:"text-sm text-gray-500 mt-2"},qw=Le({__name:"PropertiesPanel",setup(r){const{t:e}=je(),t=De(),s=ve(()=>t.selectedElement),n=ve(()=>t.selectedElementIds.length>1),l=ve(()=>{var T;return((T=s.value)==null?void 0:T.locked)||!1}),i=ce(!1),d=ce(""),u=ve(()=>s.value?[ye.LINE,ye.RECT,ye.CIRCLE].includes(s.value.type):!1),g=ve(()=>t.tableSelection?t.tableSelection.cells.length>1:!1),y=ve(()=>{if(!t.tableSelection||t.tableSelection.cells.length!==1)return!1;const T=t.tableSelection.cells[0],D=t.selectedElement;if(!D||D.type!==ye.TABLE)return!1;const de=(T.section||"body")==="footer"?D.footerData:D.data;if(!de)return!1;const te=de[T.rowIndex];if(!te)return!1;const ue=te[T.colField];return ue&&typeof ue=="object"?(ue.rowSpan||1)>1||(ue.colSpan||1)>1:!1}),m=ce("properties"),x=ce(!1),p=ve(()=>t.unit||"mm"),_=ve(()=>t.unit||"mm"),v=new Set(["fontSize","borderWidth","barcodeWidth","barcodeHeight","margin","borderRadius","headerHeight","rowHeight","footerHeight","labelFontSize","labelBorderWidth"]),k=T=>T.type!=="number"||!T.key?!1:v.has(T.key),b=T=>{const D=e(T.label);return k(T)?`${D} (${_.value})`:D},f=T=>{const D=J(T);return k(T)&&typeof D=="number"?nt(D,p.value):D},C=(T,D)=>k(T)?Ye(Number(D),p.value):D,M=T=>{if(!(T.min===void 0||T.min===null))return k(T)?nt(T.min,p.value):T.min},F=T=>{if(!(T.max===void 0||T.max===null))return k(T)?nt(T.max,p.value):T.max},R=T=>{if(!(T.step===void 0||T.step===null))return k(T)?nt(T.step,p.value):T.step},z=()=>{s.value&&(navigator.clipboard.writeText(s.value.id),x.value=!0,setTimeout(()=>{x.value=!1},2e3))},H=()=>{s.value&&(d.value=s.value.type,i.value=!0)},Y=T=>{s.value&&T&&t.addCustomElement(T,s.value)},se=(T,D)=>{s.value&&t.updateElement(s.value.id,{[T]:D})},W=(T,D)=>{s.value&&t.updateElement(s.value.id,{style:{...s.value.style,[T]:D}})},E=(T,D)=>{try{const oe=D.target.value;se(T,JSON.parse(oe))}catch{window.alert("Invalid JSON")}},B=T=>{const D=J(T);return T.language==="json"&&typeof D=="object"?JSON.stringify(D,null,2):D||""},c=(T,D)=>{if(T.language==="json")try{const oe=JSON.parse(D);se(T.key,oe)}catch{}else se(T.key,D)},w=T=>{switch(T){case ye.TEXT:return my;case ye.IMAGE:return yy;case ye.TABLE:return Vy;case ye.PAGE_NUMBER:return Ky;case ye.BARCODE:return Jy;case ye.QRCODE:return n2;case ye.LINE:return a2;case ye.RECT:return i2;case ye.CIRCLE:return u2;default:return null}},G=ve(()=>s.value?w(s.value.type):null),ee=ve(()=>G.value?G.value.sections.filter(T=>(T.tab||"properties")===m.value):[]),J=T=>s.value?(T.target==="style"?s.value.style:s.value)[T.key]??T.defaultValue:T.defaultValue,$=(T,D)=>{s.value&&(T.target==="style"&&T.key?W(T.key,D):T.target==="element"&&T.key&&se(T.key,D))},N=T=>{!s.value||!T.actionName||(T.actionName==="paginateTable"?t.paginateTable(s.value.id):T.actionName==="removeBorder"&&t.updateElement(s.value.id,{style:{...s.value.style,borderStyle:void 0,borderWidth:void 0,borderColor:void 0,border:"none"}}))},L=()=>{n.value?t.removeSelectedElements():s.value&&t.removeElement(s.value.id)},O=T=>{T.relatedTarget&&T.currentTarget.contains(T.relatedTarget)||t.setDisableGlobalShortcuts(!0)},ne=T=>{T.relatedTarget&&T.currentTarget.contains(T.relatedTarget)||t.setDisableGlobalShortcuts(!1)};return(T,D)=>(P(),q(Te,null,[o("aside",{class:"w-[380px] bg-white border-l border-gray-200 flex flex-col h-full z-40 overflow-hidden",onFocusin:O,onFocusout:ne},[o("div",W2,[o("div",null,[o("h2",G2,S(a(e)("properties.title")),1),o("p",K2,S(a(e)("properties.subtitle")),1)]),l.value?(P(),q("div",Y2,[fe(a(Xt),{class:"w-3 h-3"}),o("span",null,S(a(e)("properties.locked")),1)])):xe("",!0)]),n.value?(P(),q("div",X2,[o("div",Z2,[o("h3",J2,S(a(e)("properties.multiSelectMode")),1),o("p",Q2,[o("span",ew,S(a(t).selectedElementIds.length),1),Ce(" "+S(a(e)("properties.selectedElements",{n:""}).replace("{n}","")),1)])]),o("button",{onClick:L,class:"w-full py-2 bg-red-50 text-red-600 rounded border border-red-200 hover:bg-red-100 transition-colors text-sm font-medium"},S(a(e)("properties.deleteSelected")),1)])):s.value?(P(),q("div",tw,[o("div",rw,[(P(),q(Te,null,Me(["properties","style","advanced"],oe=>o("button",{key:oe,onClick:de=>m.value=oe,class:ke(["flex-1 py-3 text-sm font-medium transition-colors relative",m.value===oe?"text-blue-600":"text-gray-500 hover:text-gray-700 hover:bg-gray-50"])},[Ce(S(a(e)(`properties.tab.${oe}`))+" ",1),m.value===oe?(P(),q("div",ow)):xe("",!0)],10,nw)),64))]),o("div",sw,[m.value==="properties"?(P(),q("div",aw,[o("h3",lw,S(a(e)("properties.section.positionSize")),1),o("div",iw,[fe(Ct,{label:`${a(e)("properties.label.x")} (${_.value})`,type:"number",disabled:l.value,value:a(nt)(s.value.x,p.value),"onUpdate:value":D[0]||(D[0]=oe=>se("x",a(Ye)(Number(oe),p.value)))},null,8,["label","disabled","value"]),fe(Ct,{label:`${a(e)("properties.label.y")} (${_.value})`,type:"number",disabled:l.value,value:a(nt)(s.value.y,p.value),"onUpdate:value":D[1]||(D[1]=oe=>se("y",a(Ye)(Number(oe),p.value)))},null,8,["label","disabled","value"]),fe(Ct,{label:`${a(e)("properties.label.width")} (${_.value})`,type:"number",disabled:l.value,value:a(nt)(s.value.width,p.value),"onUpdate:value":D[2]||(D[2]=oe=>se("width",a(Ye)(Number(oe),p.value)))},null,8,["label","disabled","value"]),fe(Ct,{label:`${a(e)("properties.label.height")} (${_.value})`,type:"number",disabled:l.value,value:a(nt)(s.value.height,p.value),"onUpdate:value":D[3]||(D[3]=oe=>se("height",a(Ye)(Number(oe),p.value)))},null,8,["label","disabled","value"])])])):xe("",!0),m.value==="properties"&&s.value.type==="table"&&a(t).tableSelection?(P(),q("div",dw,[o("h3",uw,S(a(e)("properties.section.cellOperations")),1),o("div",cw,[o("button",{onClick:D[4]||(D[4]=oe=>a(t).mergeSelectedCells()),disabled:!g.value||l.value,class:"w-full py-2 bg-blue-50 text-blue-600 rounded border border-blue-200 hover:bg-blue-100 transition-colors text-xs font-medium disabled:opacity-50 disabled:cursor-not-allowed disabled:bg-gray-50 disabled:text-gray-400 disabled:border-gray-200"},S(a(e)("properties.action.mergeCells")),9,hw),o("button",{onClick:D[5]||(D[5]=oe=>a(t).splitSelectedCells()),disabled:!y.value||l.value,class:"w-full py-2 bg-white text-gray-600 rounded border border-gray-200 hover:bg-gray-50 transition-colors text-xs font-medium disabled:opacity-50 disabled:cursor-not-allowed"},S(a(e)("properties.action.splitCells")),9,pw)])])):xe("",!0),(P(!0),q(Te,null,Me(ee.value,(oe,de)=>(P(),q("div",{key:de,class:"space-y-3 pt-2 first:pt-0 border-t first:border-0 border-gray-100"},[o("h3",fw,S(a(e)(oe.title)),1),o("div",mw,[(P(!0),q(Te,null,Me(oe.fields,(te,ue)=>(P(),q(Te,{key:ue},[te.type==="action"?(P(),q("div",gw,[o("button",{onClick:ie=>N(te),disabled:l.value,class:"w-full py-2 bg-blue-600 text-white rounded hover:bg-blue-700 transition-colors text-sm font-medium shadow-sm disabled:opacity-50 disabled:cursor-not-allowed disabled:bg-gray-400"},S(a(e)(te.label)),9,vw)])):te.type==="text"||te.type==="number"||te.type==="switch"?(P(),Pe(Ct,{key:1,label:b(te),type:te.type,min:M(te),max:F(te),step:R(te),disabled:l.value,placeholder:te.placeholder?te.placeholder.startsWith("properties.")?a(e)(te.placeholder):te.placeholder:"",value:f(te),"onUpdate:value":ie=>$(te,C(te,ie))},null,8,["label","type","min","max","step","disabled","placeholder","value","onUpdate:value"])):te.type==="select"?(P(),Pe(k2,{key:2,label:a(e)(te.label),options:(te.options||[]).map(ie=>({...ie,label:a(e)(ie.label)})),disabled:l.value,value:J(te),"onUpdate:value":ie=>$(te,ie)},null,8,["label","options","disabled","value","onUpdate:value"])):te.type==="color"?(P(),Pe(el,{key:3,label:a(e)(te.label),disabled:l.value,value:J(te),"onUpdate:value":ie=>$(te,ie)},null,8,["label","disabled","value","onUpdate:value"])):te.type==="image"?(P(),Pe(V2,{key:4,label:a(e)(te.label),disabled:l.value,placeholder:te.placeholder?te.placeholder.startsWith("properties.")?a(e)(te.placeholder):te.placeholder:void 0,value:J(te),"onUpdate:value":ie=>$(te,ie)},null,8,["label","disabled","placeholder","value","onUpdate:value"])):te.type==="code"?(P(),Pe(B2,{key:5,label:a(e)(te.label),language:te.language||"javascript",disabled:l.value,value:B(te),"onUpdate:value":ie=>c(te,ie)},null,8,["label","language","disabled","value","onUpdate:value"])):te.type==="textarea"?(P(),q("div",bw,[o("label",yw,S(a(e)(te.label)),1),o("textarea",{placeholder:te.placeholder?te.placeholder.startsWith("properties.")?a(e)(te.placeholder):te.placeholder:"",disabled:l.value,value:["data","columns","footerData"].includes(te.key)?JSON.stringify(s.value[te.key],null,2):J(te),onChange:ie=>["data","columns","footerData"].includes(te.key)?E(te.key,ie):$(te,ie.target.value),class:"w-full px-3 py-2 text-sm border border-gray-300 rounded focus:border-blue-500 outline-none h-24 resize-y font-mono disabled:bg-gray-100 disabled:text-gray-500"},null,40,ww)])):xe("",!0)],64))),128))])]))),128)),m.value==="style"&&!u.value?(P(),q("div",xw,[o("h3",_w,S(a(e)("properties.section.appearance")),1),fe(el,{label:a(e)("properties.label.backgroundColor"),disabled:l.value,value:s.value.style.backgroundColor||"#ffffff","onUpdate:value":D[6]||(D[6]=oe=>W("backgroundColor",oe))},null,8,["label","disabled","value"])])):xe("",!0),m.value==="advanced"?(P(),q("div",kw,[o("div",Sw,[o("h4",Cw,S(a(e)("properties.section.elementInfo")),1),o("div",Ew,[o("div",null,[o("p",Tw,S(a(e)("properties.label.id")),1),o("div",$w,[o("span",{class:"font-mono text-xs text-gray-600 flex-1 truncate select-all",title:s.value.id},S(s.value.id),9,Iw),o("button",{onClick:z,class:"text-gray-400 hover:text-blue-600 transition-colors p-1 rounded hover:bg-gray-100 flex-shrink-0",title:x.value?a(e)("properties.action.copied"):a(e)("properties.action.copyId")},[x.value?(P(),Pe(a(eh),{key:0,class:"w-3.5 h-3.5 text-green-500"})):(P(),Pe(a(xt),{key:1,class:"w-3.5 h-3.5"}))],8,Aw)])]),o("div",zw,[o("span",Pw,S(a(e)("properties.label.type")),1),o("span",Lw,S(a(e)("elements."+s.value.type)),1)])])]),o("button",{onClick:H,class:"w-full py-2 bg-white text-blue-600 rounded border border-blue-200 hover:bg-blue-50 transition-colors text-sm font-medium flex items-center justify-center gap-2 mb-2 disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:bg-white"},[fe(a(So),{class:"w-4 h-4"}),Ce(" "+S(a(e)("properties.action.saveCustom")),1)]),o("button",{onClick:L,disabled:l.value,class:"w-full py-2 bg-white text-red-600 rounded border border-red-200 hover:bg-red-50 transition-colors text-sm font-medium flex items-center justify-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:bg-white"},[fe(a(wt),{class:"w-4 h-4"}),Ce(" "+S(a(e)("properties.action.deleteElement")),1)],8,Mw)])):xe("",!0)])])):(P(),q("div",Rw,[o("div",Dw,[o("h3",Bw,S(a(e)("properties.empty.noSelection")),1),o("p",Ow,S(a(e)("properties.empty.selectInstruction")),1)])]))],32),fe(Dt,{show:i.value,"initial-value":d.value,title:a(e)("properties.action.saveCustomModal"),placeholder:a(e)("sidebar.enterNamePlaceholder"),onClose:D[7]||(D[7]=oe=>i.value=!1),onSave:Y},null,8,["show","initial-value","title","placeholder"])],64))}}),Fw=_t(qw,[["__scopeId","data-v-35d350fc"]]),jw={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function Nw(r,e){return P(),q("svg",jw,[...e[0]||(e[0]=[o("path",{fill:"currentColor",d:"M13.05 22v-2.05q.85-.125 1.663-.45t1.537-.85l1.4 1.45q-1.05.8-2.2 1.287t-2.4.613m-2 0q-3.45-.45-5.725-2.988T3.05 13.05q0-1.875.713-3.512t1.925-2.85t2.85-1.925t3.512-.713h.15L10.65 2.5l1.4-1.45l4 4l-4 4l-1.4-1.4l1.6-1.6h-.2q-2.925 0-4.962 2.038T5.05 13.05q0 2.6 1.7 4.563t4.3 2.337zm8.05-3.35l-1.45-1.4q.525-.725.85-1.537t.45-1.663H21q-.125 1.25-.612 2.4t-1.288 2.2m1.9-6.6h-2.05q-.125-.85-.45-1.662t-.85-1.538l1.45-1.4q.8.975 1.275 2.15T21 12.05"},null,-1)])])}const Hw=Se({name:"material-symbols-rotate-right",render:Nw}),Uw={key:0,"data-print-exclude":"true",class:"absolute -top-3 -right-3 bg-red-500 rounded-full p-1 shadow-md z-50"},Vw=["title"],tl=Le({__name:"ElementWrapper",props:{element:{},isSelected:{type:Boolean},zoom:{},pageIndex:{},readOnly:{type:Boolean}},setup(r){const e=r,{t}=je(),s=De(),n=ce(null),l=ve(()=>{const M=!e.isSelected&&s.selectedElementIds.includes(e.element.id),F=!e.readOnly&&(e.isSelected||M),R={left:`${e.element.x}px`,top:`${e.element.y}px`,width:`${e.element.width}px`,height:`${e.element.height}px`,zIndex:e.element.style.zIndex||1,transform:`rotate(${e.element.style.rotate||0}deg)`,...e.element.style},z=[ye.TABLE,ye.LINE,ye.RECT,ye.CIRCLE];return z.includes(e.element.type)&&(delete R.backgroundColor,delete R.border,delete R.borderWidth,delete R.borderStyle,delete R.borderColor,delete R.borderRadius),F?R.border=e.element.locked?"2px solid #ef4444":"2px solid var(--brand-500)":!z.includes(e.element.type)&&e.element.style.borderStyle&&e.element.style.borderStyle!=="none"?(R.borderStyle=e.element.style.borderStyle,R.borderWidth=`${e.element.style.borderWidth||1}px`,R.borderColor=e.element.style.borderColor||"#000",delete R.border):!z.includes(e.element.type)&&e.element.style.border?R.border=e.element.style.border:R.border="1px dashed transparent",R});let i=0,d=0,u=0,g=0,y=!1,m=!1;const x=M=>{e.readOnly||M.button!==0||M.target.closest(".resize-handle")||M.target.closest(".rotate-handle")||(M.ctrlKey||M.metaKey?s.selectElement(e.element.id,!0):s.selectedElementIds.includes(e.element.id)||s.selectElement(e.element.id,!1),e.element.locked)||(y=!0,s.setDragging(!0),m=!1,i=M.clientX,d=M.clientY,u=e.element.x,g=e.element.y,window.addEventListener("mousemove",p),window.addEventListener("mouseup",_))},p=M=>{if(!y)return;const F=(M.clientX-i)/e.zoom,R=(M.clientY-d)/e.zoom;(Math.abs(F)>2||Math.abs(R)>2)&&(m||(s.snapshot(),m=!0),s.selectedElementIds.length>1&&s.selectedElementIds.includes(e.element.id)?s.moveSelectedElements(e.element.id,u+F,g+R,!1,!1):s.moveElementWithSnap(e.element.id,u+F,g+R,!1,!1))},_=M=>{if(y&&m){const R=document.elementsFromPoint(M.clientX,M.clientY).find(z=>z.classList.contains("print-page"));if(R){const z=R.id,H=parseInt(z.replace("page-",""),10);if(!isNaN(H)&&H!==e.pageIndex){const Y=document.getElementById(`page-${e.pageIndex}`);if(Y){const se=Y.getBoundingClientRect(),W=R.getBoundingClientRect(),E=(se.left-W.left)/e.zoom,B=(se.top-W.top)/e.zoom;(s.selectedElementIds.length>1&&s.selectedElementIds.includes(e.element.id)?[...s.selectedElementIds]:[e.element.id]).forEach(w=>{const ee=s.pages[e.pageIndex].elements.find(J=>J.id===w);ee&&s.moveElementToPage(w,H,ee.x+E,ee.y+B)})}}else s.selectedElementIds.length>1&&s.selectedElementIds.includes(e.element.id)?s.moveSelectedElements(e.element.id,e.element.x,e.element.y,!1,!0):s.moveElementWithSnap(e.element.id,e.element.x,e.element.y,!1,!0)}}y&&!m&&(M.ctrlKey||M.metaKey||s.selectElement(e.element.id,!1)),y=!1,s.setDragging(!1),window.removeEventListener("mousemove",p),window.removeEventListener("mouseup",_),s.setHighlightedGuide(null),s.setHighlightedEdge(null)},v=ce(!1),k=ce(!1),b=ce(0),f=M=>{if(M.stopPropagation(),M.preventDefault(),!n.value)return;v.value=!0,k.value=!1,m=!1,b.value=e.element.style.rotate||0;const F=n.value.getBoundingClientRect(),R=F.left+F.width/2,z=F.top+F.height/2,H=Math.atan2(M.clientY-z,M.clientX-R),Y=e.element.style.rotate||0,se=E=>{const c=(Math.atan2(E.clientY-z,E.clientX-R)-H)*(180/Math.PI);let w=Y+c;if(w=w%360,w<0&&(w+=360),k.value=!1,E.shiftKey)w=Math.round(w/45)*45,k.value=!0;else if(!E.ctrlKey){const ee=[0,90,180,270,360];for(const J of ee)if(Math.abs(w-J)<=5){w=J===360?0:J,k.value=!0;break}}w=Math.round(w),w===360&&(w=0),b.value=w,m||(s.snapshot(),m=!0),s.updateElement(e.element.id,{style:{...e.element.style,rotate:w}},!1)},W=()=>{v.value=!1,window.removeEventListener("mousemove",se),window.removeEventListener("mouseup",W)};window.addEventListener("mousemove",se),window.addEventListener("mouseup",W)},C=M=>{M.stopPropagation(),M.preventDefault();const F=M.clientX,R=M.clientY,z=e.element.width,H=e.element.height;m=!1;const Y=W=>{const E=(W.clientX-F)/e.zoom,B=(W.clientY-R)/e.zoom;m||(s.snapshot(),m=!0);let c=z+E,w=H+B;if(W.shiftKey){const G=z/H;Math.abs(c/z-1)>Math.abs(w/H-1)?w=c/G:c=w*G}s.updateElement(e.element.id,{width:Math.max(10,c),height:Math.max(10,w)},!1)},se=()=>{window.removeEventListener("mousemove",Y),window.removeEventListener("mouseup",se)};window.addEventListener("mousemove",Y),window.addEventListener("mouseup",se)};return(M,F)=>(P(),q("div",{ref_key:"elementRef",ref:n,class:ke(["element-wrapper absolute select-none",[r.readOnly?"cursor-not-allowed":"group theme-outline-hover",!r.readOnly&&r.element.locked?"cursor-not-allowed":"",!r.readOnly&&!r.element.locked?"cursor-move":""]]),style:_e(l.value),onMousedown:x},[il(M.$slots,"default"),!r.readOnly&&r.element.locked&&r.isSelected?(P(),q("div",Uw,[fe(a(Xt),{class:"w-3 h-3 text-white"})])):xe("",!0),!r.readOnly&&r.isSelected&&a(s).selectedElementIds.length<=1&&!r.element.locked?(P(),q(Te,{key:1},[o("div",{"data-print-exclude":"true",class:"resize-handle absolute bottom-0 right-0 w-3 h-3 bg-blue-600 cursor-se-resize z-50",onMousedown:C},null,32),o("div",{"data-print-exclude":"true",class:"rotate-handle absolute -top-4 -right-5 w-5 h-5 flex items-center justify-center cursor-grab z-50 theme-text theme-text-hover",title:a(t)("common.rotate"),onMousedown:f},[fe(a(Hw),{class:"w-3 h-3"}),v.value?(P(),q("div",{key:0,class:ke(["absolute top-6 left-1/2 transform -translate-x-1/2 text-xs px-2 py-1 rounded whitespace-nowrap z-50 pointer-events-none font-sans font-normal not-italic leading-none tracking-normal normal-case",k.value?"theme-bg-strong text-white":"theme-bg-soft text-white"])},S(b.value)+"° ",3)):xe("",!0)],40,Vw)],64)):xe("",!0)],38))}}),Ww={class:"absolute top-0 -right-12 flex flex-col gap-2 z-10"},Gw=["title"],Kw=["title","onClick"],Yw=["title","onClick"],Xw=["title","onClick"],Zw=["id","onDrop","onMousedown","onContextmenu"],Jw={key:0,"data-print-exclude":"true",class:"absolute inset-0 pointer-events-none opacity-50",style:{"background-image":"linear-gradient(#e5e7eb 1px, transparent 1px), linear-gradient(90deg, #e5e7eb 1px, transparent 1px)","background-size":"20px 20px"}},Qw=["onMousedown"],ex=["onMousedown"],tx={key:5,"data-print-exclude":"true",class:"marker absolute inset-0 pointer-events-none z-50 opacity-50"},Ul=Le({__name:"Canvas",setup(r){const e=De(),{t}=je(),s=ve(()=>e.pages),n=ve(()=>e.zoom),l=ve(()=>e.pageSpacingY||0),i=ve(()=>e.pageSpacingX||0),d=ve(()=>e.pageSpacingX||0),u=ve(()=>e.pageSpacingY||0),g=ve(()=>e.pageSpacingY||0),y=ce(!1),m=ce(null),x=ce(null),p=($,N)=>{$.preventDefault(),$.stopPropagation(),y.value=!0,m.value=N;const L=$.target;x.value=L.closest(".print-page"),window.addEventListener("mousemove",_),window.addEventListener("mouseup",v)},_=$=>{if(!y.value||!x.value)return;const N=x.value.getBoundingClientRect(),L=($.clientY-N.top)/e.zoom,O=Math.max(0,Math.min(e.canvasSize.height,L));m.value==="header"?e.setHeaderHeight(Math.round(O)):m.value==="footer"&&e.setFooterHeight(Math.round(e.canvasSize.height-O))},v=()=>{y.value=!1,m.value=null,x.value=null,window.removeEventListener("mousemove",_),window.removeEventListener("mouseup",v)};We(()=>{window.removeEventListener("mousemove",_),window.removeEventListener("mouseup",v)});const k=ve(()=>{const $={width:`${e.canvasSize.width}px`,height:`${e.canvasSize.height}px`,backgroundColor:e.canvasBackground};return f.value?{...$,...f.value}:$}),b=$=>$.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;"),f=ve(()=>{const $=e.watermark;if(!$||!$.enabled||!$.text)return null;const N=b($.text),L=Number.isFinite($.angle)?$.angle:-30,O=Math.max(6,$.size||24),ne=Math.max(40,$.density||160),T=$.color||"#000000",D=Math.min(1,Math.max(0,$.opacity??.1)),oe=`<?xml version="1.0" encoding="UTF-8"?><svg xmlns="http://www.w3.org/2000/svg" width="${ne}" height="${ne}"><text x="50%" y="50%" dominant-baseline="middle" text-anchor="middle" fill="${T}" fill-opacity="${D}" font-size="${O}" transform="rotate(${L} ${ne/2} ${ne/2})">${N}</text></svg>`;return{backgroundImage:`url("data:image/svg+xml,${encodeURIComponent(oe)}")`,backgroundRepeat:"repeat",backgroundSize:`${ne}px ${ne}px`}}),C=ve(()=>!e.isDragging||!e.selectedElementId?-1:e.pages.findIndex($=>$.elements.some(N=>N.id===e.selectedElementId))),M=ce(!1),F=ce({x:0,y:0}),R=ce({x:0,y:0}),z=ce(null),H=ce(!1),Y=ve(()=>{if(!M.value)return{display:"none"};const $=Math.min(F.value.x,R.value.x),N=Math.min(F.value.y,R.value.y),L=Math.abs(R.value.x-F.value.x),O=Math.abs(R.value.y-F.value.y);return{position:"absolute",left:`${$}px`,top:`${N}px`,width:`${L}px`,height:`${O}px`,border:"1px solid var(--brand-500)",backgroundColor:"var(--brand-500-alpha-10)",pointerEvents:"none",zIndex:1e3}}),se=$=>{switch($){case ye.TEXT:return Qa;case ye.IMAGE:return wy;case ye.TABLE:return Wy;case ye.PAGE_NUMBER:return Yy;case ye.BARCODE:return Qy;case ye.QRCODE:return o2;case ye.LINE:return l2;case ye.RECT:return d2;case ye.CIRCLE:return c2;default:return Qa}},W=($,N)=>{var ie;$.preventDefault();const L=(ie=$.dataTransfer)==null?void 0:ie.getData("application/json");if(!L)return;const{type:O,payload:ne}=JSON.parse(L),T=$.currentTarget.getBoundingClientRect(),D=($.clientX-T.left)/e.zoom,oe=($.clientY-T.top)/e.zoom;if(ne){e.addElement({...ne,x:D,y:oe,locked:!1},N);return}const de={[ye.PAGE_NUMBER]:52,[ye.BARCODE]:200,[ye.QRCODE]:100,[ye.LINE]:200,[ye.RECT]:100,[ye.CIRCLE]:100},te={[ye.PAGE_NUMBER]:20,[ye.BARCODE]:80,[ye.QRCODE]:100,[ye.TABLE]:150,[ye.LINE]:20,[ye.RECT]:100,[ye.CIRCLE]:100},ue={type:O,x:D,y:oe,width:de[O]||200,height:te[O]||100,variable:"",style:{fontSize:14,color:"#000000",...O===ye.RECT||O===ye.CIRCLE||O===ye.PAGE_NUMBER?{backgroundColor:"transparent"}:{},...O===ye.TABLE?{headerBackgroundColor:"#f3f4f6",headerColor:"#000000",footerBackgroundColor:"#f9fafb",footerColor:"#000000"}:{}},content:O===ye.TEXT?t("canvas.newText"):O===ye.BARCODE?"12345678":O===ye.QRCODE?"https://example.com":"",format:O===ye.PAGE_NUMBER?"1/Total":void 0,columns:O===ye.TABLE?[{field:"id",header:t("canvas.defaultTableHeaders.id"),width:50},{field:"name",header:t("canvas.defaultTableHeaders.name"),width:100},{field:"qty",header:t("canvas.defaultTableHeaders.qty"),width:60},{field:"price",header:t("canvas.defaultTableHeaders.price"),width:80},{field:"total",header:t("canvas.defaultTableHeaders.total"),width:80}]:void 0,data:O===ye.TABLE?Array.from({length:30},(he,Q)=>({id:Q+1,name:`${t("canvas.defaultTableData.item")} ${Q+1}`,qty:Q%5+1,price:100+Q*10,total:(Q%5+1)*(100+Q*10)})):void 0,showFooter:O===ye.TABLE?!0:void 0,tfootRepeat:O===ye.TABLE?!0:void 0,autoPaginate:O===ye.TABLE?!0:void 0,footerData:O===ye.TABLE?[{id:{value:t("canvas.defaultTableData.pageSum")},qty:{value:"",field:"{#pageQty}"},total:{value:"",field:"{#pageSum}"}},{id:{value:t("canvas.defaultTableData.total")},qty:{value:"",field:"{#totalQty}"},total:{value:"",field:"{#totalSum}"}},{id:{value:t("canvas.defaultTableData.inWords")},total:{value:"",field:"{#totalCap}"}}]:void 0,customScript:O===ye.TABLE?`// RMB Uppercase Conversion
try {
  function digitUppercase(n) {
      var fraction = ['角', '分'];
      var digit = [
          '零', '壹', '贰', '叁', '肆',
          '伍', '陆', '柒', '捌', '玖'
      ];
      var unit = [
          ['元', '万', '亿'],
          ['', '拾', '佰', '仟']
      ];
      var head = n < 0 ? '欠' : '';
      n = Math.abs(n);
      var s = '';
      for (var i = 0; i < fraction.length; i++) {
          s += (digit[Math.floor(n * 10 * Math.pow(10, i)) % 10] + fraction[i]).replace(/零./, '');
      }
      s = s || '整';
      n = Math.floor(n);
      for (var i = 0; i < unit[0].length && n > 0; i++) {
          var p = '';
          for (var j = 0; j < unit[1].length && n > 0; j++) {
              p = digit[n % 10] + unit[1][j] + p;
              n = Math.floor(n / 10);
          }
          s = p.replace(/(零.)*零$/, '').replace(/^$/, '零') + unit[0][i] + s;
      }
      return head + s.replace(/(零.)*零元/, '元')
          .replace(/(零.)+/g, '零')
          .replace(/^整$/, '零元整');
  }

  // 1. Calculate Total (works for both Global and Page data)
  let totalAmount = 0;
  let totalQty = 0;
  if (data && Array.isArray(data)) {
    data.forEach(row => {
      // Ensure numeric values
      const val = Number(row.total) || 0;
      const qty = Number(row.qty) || 0;
      totalAmount += val;
      totalQty += qty;
    });
  }

  // 2. Update Footer Data
  if (footerData && Array.isArray(footerData)) {
    footerData.forEach(row => {
      Object.keys(row).forEach(key => {
        const val = row[key];
        const processValue = (v) => {
           if (typeof v !== 'string') return v;
           
           // Global replacements (Grand Total)
           if (typeof type === 'undefined' || type !== 'page') {
               if (v.includes('{#totalSum}')) return v.replace('{#totalSum}', totalAmount.toFixed(2));
               if (v.includes('{#totalQty}')) return v.replace('{#totalQty}', String(totalQty));
               if (v.includes('{#totalCap}')) return v.replace('{#totalCap}', digitUppercase(totalAmount));
               
               // For {#pageSum}, we want to show the Grand Total in the Designer (visual feedback),
               // but pass the original {#pageSum} token to the Print logic (via data-value).
               if (v.includes('{#pageSum}')) {
                   const displayVal = v.replace('{#pageSum}', totalAmount.toFixed(2));
                   // printValue keeps {#pageSum} but resolves other globals
                   const printVal = v.replace('{#totalSum}', totalAmount.toFixed(2))
                                   .replace('{#totalQty}', String(totalQty))
                                   .replace('{#totalCap}', digitUppercase(totalAmount)); 
                   
                   return { value: displayVal, printValue: printVal };
               }

               // For {#pageQty}
               if (v.includes('{#pageQty}')) {
                   const displayVal = v.replace('{#pageQty}', String(totalQty));
                   // printValue keeps {#pageQty} but resolves other globals
                   const printVal = v.replace('{#totalSum}', totalAmount.toFixed(2))
                                   .replace('{#totalQty}', String(totalQty))
                                   .replace('{#totalCap}', digitUppercase(totalAmount)); 
                   
                   return { value: displayVal, printValue: printVal };
               }
           }
           
           // Page replacements (Page Sum)
           if (typeof type !== 'undefined' && type === 'page') {
               if (v.includes('{#pageSum}')) return v.replace('{#pageSum}', totalAmount.toFixed(2));
               if (v.includes('{#pageQty}')) return v.replace('{#pageQty}', String(totalQty));
           }
           return v;
        };

        // Handle object values
        if (val && typeof val === 'object') {
           // If it has a 'field' property, check if it contains a variable
           if (val.field && typeof val.field === 'string') {
               const processed = processValue(val.field);
               // If processed is different from field (meaning a replacement happened)
               // OR if processValue returned an object (for {#pageSum})
               if (processed !== val.field || typeof processed === 'object') {
                   if (typeof processed === 'object') {
                       val.result = processed.value; // Store in result, keep val.value as text
                       val.printValue = processed.printValue;
                   } else {
                       val.result = processed;
                   }
               }
           }
           // Also check 'value' if it was set manually and looks like a variable
           else if (val.value && typeof val.value === 'string') {
               // Only process if value looks like a variable, otherwise it's just text
               if (val.value.includes('{#')) {
                  const processed = processValue(val.value);
                  if (typeof processed === 'object') {
                       val.result = processed.value;
                       val.printValue = processed.printValue;
                   } else {
                       val.result = processed;
                   }
               }
           }
        }
      });
    });
  }

  return { data, footerData };
} catch (e) {
  console.error('Script Execution Error:', e);
  return { data, footerData };
}`:void 0};e.addElement(ue,N)},E=$=>{$.preventDefault()},B=$=>{!$.ctrlKey&&!$.metaKey&&!H.value&&e.selectElement(null)},c=($,N)=>{if($.button!==0||$.ctrlKey||$.metaKey||$.target.closest(".element-wrapper"))return;$.preventDefault(),M.value=!0,z.value=N;const ne=$.currentTarget.getBoundingClientRect();F.value={x:($.clientX-ne.left)/n.value,y:($.clientY-ne.top)/n.value},R.value={...F.value},window.addEventListener("mousemove",w),window.addEventListener("mouseup",G)},w=$=>{if(!M.value||z.value===null)return;const N=document.getElementById(`page-${z.value}`);if(!N)return;const L=N.getBoundingClientRect();R.value={x:($.clientX-L.left)/n.value,y:($.clientY-L.top)/n.value}},G=()=>{if(!M.value)return;const $=Math.min(F.value.x,R.value.x),N=Math.min(F.value.y,R.value.y),L=Math.abs(R.value.x-F.value.x),O=Math.abs(R.value.y-F.value.y),ne=[];if(z.value!==null){const T=s.value[z.value];if(T)for(const D of T.elements){const oe=D.x+D.width,de=D.y+D.height,te=$+L,ue=N+O;D.x<te&&oe>$&&D.y<ue&&de>N&&ne.push(D.id)}}e.setSelection(ne),M.value=!1,z.value=null,H.value=!0,setTimeout(()=>{H.value=!1},50),window.removeEventListener("mousemove",w),window.removeEventListener("mouseup",G)},ee=($,N)=>{var te;const O=$.currentTarget.getBoundingClientRect(),ne=($.clientX-O.left)/n.value,T=($.clientY-O.top)/n.value,D=s.value[N];if(!D)return;let oe=null,de=-1/0;for(let ue=0;ue<D.elements.length;ue++){const ie=D.elements[ue];if(ne>=ie.x&&ne<=ie.x+ie.width&&T>=ie.y&&T<=ie.y+ie.height){const Q=((te=ie.style)==null?void 0:te.zIndex)??1;Q>=de&&(de=Q,oe=ie.id)}}oe&&e.selectElement(oe,!1)},J=()=>s.value.length===0?[]:s.value[0].elements.filter(N=>e.showHeaderLine&&N.y<e.headerHeight||e.showFooterLine&&N.y>=e.canvasSize.height-e.footerHeight);return($,N)=>(P(),q("div",{class:"flex flex-col",style:_e({transform:`scale(${n.value})`,transformOrigin:"top left",width:"fit-content",rowGap:`${l.value}px`})},[(P(!0),q(Te,null,Me(s.value,(L,O)=>(P(),q("div",{key:L.id,class:"relative group"},[o("div",Ww,[o("button",{class:"w-8 h-8 flex items-center justify-center bg-white border border-gray-200 rounded shadow hover:bg-blue-50 hover:text-blue-600 text-gray-600 transition-colors",title:a(t)("canvas.addPage"),onClick:N[0]||(N[0]=ne=>a(e).addPage())},[fe(a(To))],8,Gw),o("button",{class:"w-8 h-8 flex items-center justify-center bg-white border border-gray-200 rounded shadow hover:bg-blue-50 hover:text-blue-600 text-gray-600 transition-colors",title:a(t)("canvas.copyPage"),onClick:ne=>a(e).copyPage(O)},[fe(a(xt))],8,Kw),a(e).copiedPage?(P(),q("button",{key:0,class:"w-8 h-8 flex items-center justify-center bg-white border border-gray-200 rounded shadow hover:bg-blue-50 hover:text-blue-600 text-gray-600 transition-colors",title:a(t)("canvas.pastePage"),onClick:ne=>a(e).pastePage(O)},[fe(a(Co))],8,Yw)):xe("",!0),O>0?(P(),q("button",{key:1,class:"w-8 h-8 flex items-center justify-center bg-white border border-gray-200 rounded shadow hover:bg-red-50 hover:text-red-600 text-gray-600 transition-colors",title:a(t)("canvas.deletePage"),onClick:ne=>a(e).removePage(O)},[fe(a(wt))],8,Xw)):xe("",!0)]),o("div",{id:`page-${O}`,class:"print-page shadow-lg relative overflow-hidden transition-all",style:_e([k.value,{overflow:C.value===O?"visible":"hidden",zIndex:C.value===O?50:1}]),onDrop:ne=>W(ne,O),onDragover:E,onMousedown:ne=>c(ne,O),onContextmenu:ne=>ee(ne,O),onClick:Ke(B,["self"])},[a(e).showGrid?(P(),q("div",Jw)):xe("",!0),M.value&&z.value===O?(P(),q("div",{key:1,"data-print-exclude":"true",style:_e(Y.value)},null,4)):xe("",!0),a(e).showHeaderLine?(P(),q("div",{key:2,"data-print-exclude":"true",class:ke(["absolute left-0 w-full z-20 group flex flex-col justify-center items-center",O===0?"cursor-row-resize":"cursor-default"]),style:_e({top:`${a(e).headerHeight}px`,height:"12px",marginTop:"-6px"}),onMousedown:ne=>O===0&&p(ne,"header")},[o("div",{class:"w-full h-px",style:_e({backgroundImage:O===0?"linear-gradient(to right, #f87171 60%, transparent 40%)":"linear-gradient(to right, #d1d5db 60%, transparent 40%)",backgroundSize:"20px 1px",backgroundRepeat:"repeat-x"})},null,4),o("div",{class:ke(["absolute right-0 -top-4 text-xs bg-white/80 px-1 pointer-events-none",O===0?"text-red-400":"text-gray-400"])},S(a(t)("canvas.headerLabel")),3)],46,Qw)):xe("",!0),a(e).showFooterLine?(P(),q("div",{key:3,"data-print-exclude":"true",class:ke(["absolute left-0 w-full z-20 group flex flex-col justify-center items-center",O===0?"cursor-row-resize":"cursor-default"]),style:_e({bottom:`${a(e).footerHeight}px`,height:"12px",marginBottom:"-6px"}),onMousedown:ne=>O===0&&p(ne,"footer")},[o("div",{class:"w-full h-px",style:_e({backgroundImage:O===0?"linear-gradient(to right, #f87171 60%, transparent 40%)":"linear-gradient(to right, #d1d5db 60%, transparent 40%)",backgroundSize:"20px 1px",backgroundRepeat:"repeat-x"})},null,4),o("div",{class:ke(["absolute right-0 -bottom-4 text-xs bg-white/80 px-1 pointer-events-none",O===0?"text-red-400":"text-gray-400"])},S(a(t)("canvas.footerLabel")),3)],46,ex)):xe("",!0),O>0&&s.value.length>0?(P(!0),q(Te,{key:4},Me(J(),ne=>(P(),Pe(tl,{key:`global-${ne.id}`,element:ne,"is-selected":a(e).selectedElementId===ne.id||a(e).selectedElementIds.includes(ne.id),zoom:n.value,"page-index":0,"read-only":!0},{default:it(()=>[(P(),Pe(Pt(se(ne.type)),{element:ne,"page-index":O,"total-pages":s.value.length},null,8,["element","page-index","total-pages"]))]),_:2},1032,["element","is-selected","zoom"]))),128)):xe("",!0),(P(!0),q(Te,null,Me(L.elements,ne=>(P(),Pe(tl,{key:ne.id,element:ne,"is-selected":a(e).selectedElementId===ne.id||a(e).selectedElementIds.includes(ne.id),zoom:n.value,"page-index":O},{default:it(()=>[(P(),Pe(Pt(se(ne.type)),{element:ne,"page-index":O,"total-pages":s.value.length},null,8,["element","page-index","total-pages"]))]),_:2},1032,["element","is-selected","zoom","page-index"]))),128)),a(e).showCornerMarkers?(P(),q("div",tx,[o("div",{class:"absolute w-3 h-3 border-t-2 border-l-2 border-gray-300",style:_e({top:`${u.value}px`,left:`${i.value}px`})},null,4),o("div",{class:"absolute w-3 h-3 border-t-2 border-r-2 border-gray-300",style:_e({top:`${u.value}px`,right:`${d.value}px`})},null,4),o("div",{class:"absolute w-3 h-3 border-b-2 border-l-2 border-gray-300",style:_e({bottom:`${g.value}px`,left:`${i.value}px`})},null,4),o("div",{class:"absolute w-3 h-3 border-b-2 border-r-2 border-gray-300",style:_e({bottom:`${g.value}px`,right:`${d.value}px`})},null,4)])):xe("",!0)],44,Zw)]))),128))],4))}}),rl=Le({__name:"Ruler",props:{type:{},zoom:{},scroll:{},offset:{},thick:{},indicators:{},unit:{}},emits:["guide-drag-start"],setup(r,{emit:e}){const t=r,s=ce(null),n=t.thick||20;let l=null;const i=()=>{const y=s.value;if(!y)return;const m=y.getContext("2d");if(!m)return;const x=y.width,p=y.height,{zoom:_,scroll:v,offset:k,type:b,indicators:f}=t,C=document.documentElement.classList.contains("dark");if(m.clearRect(0,0,x,p),m.fillStyle=C?"#1f2937":"#F9FAFB",m.fillRect(0,0,x,p),f&&f.length>0)for(const c of f){const w=k+c.position*_-v;m.fillStyle=c.color,b==="horizontal"?m.fillRect(w-2,0,4,n):m.fillRect(0,w-2,n,4)}m.strokeStyle=C?"#6b7280":"#9CA3AF",m.fillStyle=C?"#9ca3af":"#6B7280",m.lineWidth=1,m.font="10px sans-serif",m.beginPath();const M=t.unit==="mm"?Al:t.unit==="pt"?zl:1,z=50/(M*_),H=[1,2,5,10,20,50,100,200,500,1e3];let Y=H[H.length-1];for(const c of H)if(c>=z-.001){Y=c;break}const se=b==="horizontal"?x:p,W=(-k+v)/(_*M),E=(se-k+v)/(_*M),B=Math.floor(W/Y)*Y;for(let c=B;c<=E;c+=Y){const w=k+c*M*_-v,G=Number(c.toFixed(1)).toString();b==="horizontal"?(m.moveTo(w,0),m.lineTo(w,n),m.fillText(G,w+2,10)):(m.moveTo(0,w),m.lineTo(n,w),m.save(),m.translate(10,w+2),m.rotate(-Math.PI/2),m.fillText(G,0,0),m.restore());const ee=Y/5;for(let J=1;J<5;J++){const $=c+ee*J,N=k+$*M*_-v;b==="horizontal"?(m.moveTo(N,n-5),m.lineTo(N,n)):(m.moveTo(n-5,N),m.lineTo(n,N))}}m.stroke()},d=new ResizeObserver(y=>{for(const m of y){const x=s.value;if(x){const{width:p,height:_}=m.contentRect;x.width=p,x.height=_,i()}}});Ve(()=>{s.value&&(d.observe(s.value.parentElement),i()),l=new MutationObserver(()=>{i()}),l.observe(document.documentElement,{attributes:!0,attributeFilter:["class"]})}),We(()=>{l==null||l.disconnect(),l=null}),Ae(()=>[t.zoom,t.scroll,t.offset,t.indicators,t.unit],i,{deep:!0});const u=e,g=y=>{u("guide-drag-start",y)};return(y,m)=>(P(),q("div",{class:"w-full h-full overflow-hidden bg-gray-50 relative",onMousedown:g},[o("canvas",{ref_key:"canvasRef",ref:s,class:"block"},null,512)],32))}}),rx={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function nx(r,e){return P(),q("svg",rx,[...e[0]||(e[0]=[o("path",{fill:"currentColor",d:"m19 21l-7-7l-2.35 2.35q.2.375.275.8T10 18q0 1.65-1.175 2.825T6 22t-2.825-1.175T2 18t1.175-2.825T6 14q.425 0 .85.075t.8.275L10 12L7.65 9.65q-.375.2-.8.275T6 10q-1.65 0-2.825-1.175T2 6t1.175-2.825T6 2t2.825 1.175T10 6q0 .425-.075.85t-.275.8L22 20v1zm-4-10l-2-2l6-6h3v1zM6 8q.825 0 1.413-.587T8 6t-.587-1.412T6 4t-1.412.588T4 6t.588 1.413T6 8m6 4.5q.2 0 .35-.15t.15-.35t-.15-.35t-.35-.15t-.35.15t-.15.35t.15.35t.35.15M6 20q.825 0 1.413-.587T8 18t-.587-1.412T6 16t-1.412.588T4 18t.588 1.413T6 20"},null,-1)])])}const ox=Se({name:"material-symbols-content-cut",render:nx}),sx={class:"bg-white border border-gray-200 shadow-xl rounded-md min-w-[160px] py-1"},ax=["disabled"],lx=["disabled"],ix=["disabled"],dx=["disabled"],ux=["disabled"],cx=Le({__name:"Shortcuts",setup(r){const{t:e}=je(),t=De(),s=ce(!1),n=ce(0),l=ce(0),i=ce(0),d=ce(0),u=ce(null),g=ce(!1),y=ce(0),m=ce(0),x=f=>{y.value=f.clientX,m.value=f.clientY},p=(f,C)=>{const M=document.querySelectorAll(".print-page");if(M.length===0)return;let F=null,R=1/0,z=0;for(let H=0;H<M.length;H++){const Y=M[H],se=Y.getBoundingClientRect();if(f>=se.left&&f<=se.right&&C>=se.top&&C<=se.bottom)return{pageIndex:H,x:(f-se.left)/t.zoom,y:(C-se.top)/t.zoom};const W=Math.max(se.left-f,0,f-se.right),E=Math.max(se.top-C,0,C-se.bottom),B=Math.sqrt(W*W+E*E);B<R&&(R=B,F=Y,z=H)}if(F){const H=F.getBoundingClientRect();let Y=(f-H.left)/t.zoom,se=(C-H.top)/t.zoom;return Y=Math.max(0,Math.min(t.canvasSize.width,Y)),se=Math.max(0,Math.min(t.canvasSize.height,se)),{pageIndex:z,x:Y,y:se}}},_=f=>{if(t.disableGlobalShortcuts)return;if((f.ctrlKey||f.metaKey)&&f.altKey&&f.key.toLowerCase()==="n"){f.preventDefault(),f.stopPropagation(),window.dispatchEvent(new CustomEvent("designer:new-template"));return}if((f.ctrlKey||f.metaKey)&&f.key===","){f.preventDefault(),f.stopPropagation(),t.setShowSettings(!0);return}const C=f.target;if(C&&C.closest('input, textarea, select, [contenteditable="true"]'))return;if(["ArrowLeft","ArrowRight","ArrowUp","ArrowDown"].includes(f.key)){const R=f.shiftKey?10:1;if(t.selectedGuideId){const z=t.guides.find(H=>H.id===t.selectedGuideId);if(z){f.preventDefault();const H=z.position;let Y=H;if(z.type==="vertical")if(f.key==="ArrowLeft")Y-=R;else if(f.key==="ArrowRight")Y+=R;else return;else if(f.key==="ArrowUp")Y-=R;else if(f.key==="ArrowDown")Y+=R;else return;(H>0&&Y<0||H<0&&Y>0||Y===0)&&(Y=0),t.updateGuide(z.id,Y),t.setHighlightedGuide(z.id)}}else if(t.selectedElementIds.length>0){f.preventDefault();const z=f.key==="ArrowLeft"?-R:f.key==="ArrowRight"?R:0,H=f.key==="ArrowUp"?-R:f.key==="ArrowDown"?R:0;t.nudgeSelectedElements(z,H)}return}if((f.ctrlKey||f.metaKey)&&f.key.toLowerCase()==="a"){if(f.preventDefault(),t.pages[t.currentPageIndex]){const R=t.pages[t.currentPageIndex].elements.map(z=>z.id);t.setSelection(R)}return}if(f.key==="Delete"){t.selectedElementIds.length>1?(f.preventDefault(),t.removeSelectedElements()):t.selectedElementId?(f.preventDefault(),t.removeElement(t.selectedElementId)):t.selectedGuideId&&(f.preventDefault(),t.removeGuide(t.selectedGuideId));return}if((f.ctrlKey||f.metaKey)&&f.key.toLowerCase()==="c"){t.selectedElementId&&(f.preventDefault(),t.copy());return}if((f.ctrlKey||f.metaKey)&&f.key.toLowerCase()==="x"){t.selectedElementId&&(f.preventDefault(),t.cut());return}if((f.ctrlKey||f.metaKey)&&f.key.toLowerCase()==="v"){t.clipboard.length>0&&(f.preventDefault(),t.paste(p(y.value,m.value)));return}if((f.ctrlKey||f.metaKey)&&f.key.toLowerCase()==="h"){f.preventDefault(),t.setShowHelp(!0);return}if(t.showHelp&&f.key==="Escape"){f.preventDefault(),t.setShowHelp(!1);return}if((f.ctrlKey||f.metaKey)&&f.key.toLowerCase()==="z"&&!f.shiftKey){f.preventDefault(),t.undo();return}if((f.ctrlKey||f.metaKey)&&(f.key.toLowerCase()==="y"||f.key.toLowerCase()==="z"&&f.shiftKey)){f.preventDefault(),t.redo();return}if((f.ctrlKey||f.metaKey)&&f.key.toLowerCase()==="l"){f.preventDefault(),t.toggleLock();return}if((f.ctrlKey||f.metaKey)&&f.shiftKey&&f.key.toLowerCase()==="p"){f.preventDefault(),window.dispatchEvent(new CustomEvent("designer:preview"));return}const M=f.ctrlKey||f.metaKey,F=f.key.toLowerCase();if(!(t.editingCustomElementId&&M&&(F==="s"||F==="q"))){if(M&&f.shiftKey&&F==="s"){f.preventDefault(),window.dispatchEvent(new CustomEvent("designer:save-as"));return}if(M&&F==="s"){f.preventDefault(),window.dispatchEvent(new CustomEvent("designer:save"));return}if((f.ctrlKey||f.metaKey)&&f.key.toLowerCase()==="p"&&!f.shiftKey){f.preventDefault(),window.dispatchEvent(new CustomEvent("designer:print"));return}if((f.ctrlKey||f.metaKey)&&f.shiftKey&&f.key.toLowerCase()==="e"){f.preventDefault(),window.dispatchEvent(new CustomEvent("designer:export-pdf"));return}if((f.ctrlKey||f.metaKey)&&f.shiftKey&&f.key.toLowerCase()==="j"){f.preventDefault(),window.dispatchEvent(new CustomEvent("designer:view-json"));return}}},v=f=>{["ArrowLeft","ArrowRight","ArrowUp","ArrowDown"].includes(f.key)&&(t.setHighlightedGuide(null),t.setHighlightedEdge(null))},k=async f=>{const C=f.target,M=document.querySelector(".overflow-auto");if(!M||!M.contains(C))return;if(f.preventDefault(),s.value=!0,n.value=f.clientX,l.value=f.clientY,i.value=f.clientX,d.value=f.clientY,await Xe(),u.value){const z=u.value.getBoundingClientRect(),H=window.innerWidth,Y=window.innerHeight;f.clientX+z.width>H&&(n.value=H-z.width-5),f.clientY+z.height>Y&&(l.value=Y-z.height-5)}const F=document.querySelectorAll(".print-page");let R=!1;F.forEach(z=>{const H=z.getBoundingClientRect();f.clientX>=H.left&&f.clientX<=H.right&&f.clientY>=H.top&&f.clientY<=H.bottom&&(R=!0)}),g.value=R,window.addEventListener("click",b)},b=()=>{s.value=!1,window.removeEventListener("click",b)};return Ve(()=>{window.addEventListener("keydown",_,{capture:!0}),window.addEventListener("contextmenu",k),window.addEventListener("keyup",v),window.addEventListener("mousemove",x)}),We(()=>{window.removeEventListener("keydown",_,{capture:!0}),window.removeEventListener("contextmenu",k),window.removeEventListener("click",b),window.removeEventListener("keyup",v),window.removeEventListener("mousemove",x)}),(f,C)=>{var M,F,R,z,H;return s.value?(P(),q("div",{key:0,ref_key:"menuRef",ref:u,class:"fixed z-[9999]",style:_e({left:`${n.value}px`,top:`${l.value}px`})},[o("div",sx,[o("button",{class:"w-full text-left px-3 py-2 text-sm hover:bg-gray-100 disabled:opacity-50 flex items-center gap-2",disabled:a(t).selectedElementIds.length===0&&!a(t).selectedGuideId||((M=a(t).selectedElement)==null?void 0:M.locked),onClick:C[0]||(C[0]=()=>{a(t).selectedElementIds.length>1?a(t).removeSelectedElements():a(t).selectedElementId?a(t).removeElement(a(t).selectedElementId):a(t).selectedGuideId&&a(t).removeGuide(a(t).selectedGuideId),s.value=!1})},[fe(a(wt),{class:"w-4 h-4"}),o("span",null,S(a(e)("common.delete"))+S(a(t).selectedElementIds.length>1?` (${a(t).selectedElementIds.length})`:""),1)],8,ax),o("button",{class:"w-full text-left px-3 py-2 text-sm hover:bg-gray-100 disabled:opacity-50 flex items-center gap-2",disabled:!a(t).selectedElementId||((F=a(t).selectedElement)==null?void 0:F.locked),onClick:C[1]||(C[1]=()=>{a(t).cut(),s.value=!1})},[fe(a(ox),{class:"w-4 h-4"}),o("span",null,S(a(e)("common.cut")),1)],8,lx),o("button",{class:"w-full text-left px-3 py-2 text-sm hover:bg-gray-100 disabled:opacity-50 flex items-center gap-2",disabled:!a(t).selectedElementId||((R=a(t).selectedElement)==null?void 0:R.locked),onClick:C[2]||(C[2]=()=>{a(t).copy(),s.value=!1})},[fe(a(xt),{class:"w-4 h-4"}),o("span",null,S(a(e)("common.copy")),1)],8,ix),o("button",{class:"w-full text-left px-3 py-2 text-sm hover:bg-gray-100 disabled:opacity-50 flex items-center gap-2",disabled:a(t).clipboard.length===0,onClick:C[3]||(C[3]=()=>{a(t).paste(p(i.value,d.value)),s.value=!1})},[fe(a(Co),{class:"w-4 h-4"}),o("span",null,S(a(e)("common.paste")),1)],8,dx),o("button",{class:"w-full text-left px-3 py-2 text-sm hover:bg-gray-100 disabled:opacity-50 flex items-center gap-2",disabled:a(t).selectedElementIds.length===0,onClick:C[4]||(C[4]=()=>{a(t).toggleLock(),s.value=!1})},[(P(),Pe(Pt((z=a(t).selectedElement)!=null&&z.locked?a(Bl):a(Xt)),{class:"w-4 h-4"})),o("span",null,S((H=a(t).selectedElement)!=null&&H.locked?a(e)("common.unlock"):a(e)("common.lock")),1)],8,ux),C[7]||(C[7]=o("div",{class:"border-t border-gray-200 my-1"},null,-1)),o("button",{class:"w-full text-left px-3 py-2 text-sm hover:bg-gray-100 flex items-center gap-2",onClick:C[5]||(C[5]=Y=>{a(t).undo(),s.value=!1})},[fe(a(Rl),{class:"w-4 h-4"}),o("span",null,S(a(e)("common.undo")),1)]),o("button",{class:"w-full text-left px-3 py-2 text-sm hover:bg-gray-100 flex items-center gap-2",onClick:C[6]||(C[6]=Y=>{a(t).redo(),s.value=!1})},[fe(a(Dl),{class:"w-4 h-4"}),o("span",null,S(a(e)("common.redo")),1)])])],4)):xe("",!0)}}}),hx={class:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 text-sm leading-none text-gray-300 z-10"},px={key:2,class:"w-full h-full bg-gray-200 flex items-center justify-center overflow-hidden"},fx=["src"],mx={key:3,class:"w-full h-full bg-gray-100 flex items-center justify-center overflow-hidden"},gx=["src"],vx={key:4,class:"w-full h-full bg-gray-100 flex items-center justify-center overflow-hidden"},bx=["src"],yx={key:2,class:"w-full h-full bg-gray-200 flex items-center justify-center overflow-hidden"},wx=["src"],xx={key:3,class:"w-full h-full bg-gray-100 flex items-center justify-center overflow-hidden"},_x=["src"],kx={key:4,class:"w-full h-full bg-gray-100 flex items-center justify-center overflow-hidden"},Sx=["src"],nl=180,ol=120,sl=300,Cx=32,Ex=Le({__name:"Minimap",props:{scrollWidth:{},scrollHeight:{},viewportWidth:{},viewportHeight:{},scrollLeft:{},scrollTop:{},pages:{},pageWidth:{},pageHeight:{},zoom:{},contentOffsetX:{},contentOffsetY:{},canvasBackground:{},showHeaderLine:{type:Boolean},showFooterLine:{type:Boolean},headerHeight:{},footerHeight:{},watermark:{}},emits:["update:scroll"],setup(r,{emit:e}){const t=r,s=e,n=ve(()=>{if(t.scrollWidth<=0||t.scrollHeight<=0)return .1;let W=nl/t.scrollWidth;return t.scrollHeight*W>sl&&(W=sl/t.scrollHeight),t.scrollWidth*W<ol&&(W=ol/t.scrollWidth),W}),l=ve(()=>t.scrollHeight*n.value),i=ve(()=>({left:`${t.scrollLeft*n.value}px`,top:`${t.scrollTop*n.value}px`,width:`${t.viewportWidth*n.value}px`,height:`${t.viewportHeight*n.value}px`})),d=W=>W.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;"),u=ve(()=>{const W=t.watermark;if(!W||!W.enabled||!W.text)return null;const E=d(W.text),B=Number.isFinite(W.angle)?W.angle:-30,c=Math.max(6,W.size||24),w=Math.max(40,W.density||160),G=W.color||"#000000",ee=Math.min(1,Math.max(0,W.opacity??.1)),J=`<?xml version="1.0" encoding="UTF-8"?><svg xmlns="http://www.w3.org/2000/svg" width="${w}" height="${w}"><text x="50%" y="50%" dominant-baseline="middle" text-anchor="middle" fill="${G}" fill-opacity="${ee}" font-size="${c}" transform="rotate(${B} ${w/2} ${w/2})">${E}</text></svg>`;return{backgroundImage:`url("data:image/svg+xml,${encodeURIComponent(J)}")`,backgroundRepeat:"repeat",backgroundSize:`${w}px ${w}px`}}),g=W=>{const E={left:`${t.contentOffsetX*n.value}px`,top:`${(t.contentOffsetY+W*(t.pageHeight+Cx)*t.zoom)*n.value}px`,width:`${t.pageWidth*t.zoom*n.value}px`,height:`${t.pageHeight*t.zoom*n.value}px`,backgroundColor:t.canvasBackground||"#ffffff"};return u.value?{...E,...u.value}:E},y=()=>{if(!t.pages||t.pages.length===0)return[];const W=t.pages[0];return W!=null&&W.elements?W.elements.filter(E=>t.showHeaderLine&&E.y<t.headerHeight||t.showFooterLine&&E.y>=t.pageHeight-t.footerHeight):[]},m=W=>{const E=Math.max(1,W.width*t.zoom*n.value),B=Math.max(1,W.height*t.zoom*n.value);return{width:E,height:B}},x=W=>{var w,G,ee,J,$,N,L,O,ne,T,D,oe;const{width:E,height:B}=m(W),c={left:`${W.x*t.zoom*n.value}px`,top:`${W.y*t.zoom*n.value}px`,width:`${E}px`,height:`${B}px`,fontSize:`${(((w=W.style)==null?void 0:w.fontSize)||12)*t.zoom*n.value}px`,zIndex:((G=W.style)==null?void 0:G.zIndex)||1,transform:`rotate(${((ee=W.style)==null?void 0:ee.rotate)||0}deg)`};if(W.type===ye.LINE){const de=((J=W.style)==null?void 0:J.borderColor)||"#111827",te=Math.max(1,((($=W.style)==null?void 0:$.borderWidth)||1)*t.zoom*n.value);return{...c,height:`${te}px`,backgroundColor:de,top:`${W.y*t.zoom*n.value+(B-te)/2}px`}}if(W.type===ye.RECT||W.type===ye.CIRCLE){const de=((N=W.style)==null?void 0:N.borderColor)||"#111827",te=Math.max(1,(((L=W.style)==null?void 0:L.borderWidth)||1)*t.zoom*n.value);return{...c,backgroundColor:((O=W.style)==null?void 0:O.backgroundColor)||"transparent",borderColor:de,borderWidth:`${te}px`,borderStyle:((ne=W.style)==null?void 0:ne.borderStyle)||"solid",borderRadius:W.type===ye.CIRCLE?"9999px":`${((T=W.style)==null?void 0:T.borderRadius)||0}px`}}return W.type===ye.BARCODE||W.type===ye.QRCODE?{...c,backgroundColor:"rgba(17, 24, 39, 0.15)",border:"1px solid rgba(17, 24, 39, 0.3)"}:W.type===ye.PAGE_NUMBER?{...c,color:((D=W.style)==null?void 0:D.color)||"#111827",backgroundColor:((oe=W.style)==null?void 0:oe.backgroundColor)||"transparent"}:{...c,backgroundColor:W.type===ye.IMAGE?"#e5e7eb":void 0}},p=(W,E)=>{var G;const B=E+1,c=((G=t.pages)==null?void 0:G.length)||1,w=W.format||"1/Total";return w==="1"?`${B}`:w==="Page 1"?`Page ${B}`:`${B}/${c}`},_=W=>{const E=W.style?JSON.stringify(W.style):"";return`${W.id}:${W.type}:${W.variable||""}:${W.content||""}:${E}`},v=ce({}),k=ce({});let b=0;const f=W=>W.type===ye.BARCODE?W.variable||W.content||"12345678":W.type===ye.QRCODE?W.variable||W.content||"https://example.com":W.variable||W.content||"",C=W=>{try{const E=document.createElement("canvas"),B=W.style||{};return Nl(E,f(W),{format:B.barcodeFormat||"CODE128",lineColor:B.color||"#000000",width:Number(B.barcodeWidth)||2,height:Number(B.barcodeHeight)||40,displayValue:B.showText!==!1&&B.showText!=="false",fontOptions:B.fontOptions||"",font:B.font||"monospace",textAlign:B.textAlign||"center",textPosition:B.textPosition||"bottom",textMargin:Number(B.textMargin)||2,fontSize:Number(B.fontSize)||20,background:"transparent",margin:Number(B.margin)||0}),E.toDataURL("image/png")}catch{return""}},M=async W=>{var E,B;try{return await Hl.toDataURL(f(W),{margin:0,color:{dark:((E=W.style)==null?void 0:E.color)||"#000000",light:"#00000000"},errorCorrectionLevel:((B=W.style)==null?void 0:B.qrErrorCorrection)||"M"})}catch{return""}},F=async()=>{const W=++b,E={},B={},c=t.pages||[];for(const w of c){const G=(w==null?void 0:w.elements)||[];for(const ee of G){const J=_(ee);if(ee.type===ye.BARCODE){const $=C(ee);$&&(E[J]=$)}else if(ee.type===ye.QRCODE){const $=await M(ee);$&&(B[J]=$)}}}W===b&&(v.value=E,k.value=B)},R=W=>v.value[_(W)]||"",z=W=>k.value[_(W)]||"";Ae(()=>t.pages,()=>{F()},{deep:!0,immediate:!0});const H=ce(!1),Y=ce(null);Ae(()=>t.scrollTop,()=>{if(!Y.value)return;const W=t.scrollTop*n.value,E=t.viewportHeight*n.value,B=Y.value.clientHeight,c=Y.value.scrollTop;W<c?Y.value.scrollTop=W:W+E>c+B&&(Y.value.scrollTop=W+E-B)});const se=W=>{W.preventDefault();const E=W.currentTarget,B=E.getBoundingClientRect(),c=W.clientX-B.left,w=W.clientY-B.top,G=t.scrollLeft*n.value,ee=t.scrollTop*n.value,J=t.viewportWidth*n.value,$=t.viewportHeight*n.value;let N=0,L=0;if(c>=G&&c<=G+J&&w>=ee&&w<=ee+$)N=c-G,L=w-ee;else{const T=c/n.value-t.viewportWidth/2,D=w/n.value-t.viewportHeight/2;s("update:scroll",{left:T,top:D}),N=J/2,L=$/2}H.value=!0;const O=T=>{const D=E.getBoundingClientRect(),oe=T.clientX-D.left,de=T.clientY-D.top,te=oe-N,ue=de-L;s("update:scroll",{left:te/n.value,top:ue/n.value})},ne=()=>{H.value=!1,window.removeEventListener("mousemove",O),window.removeEventListener("mouseup",ne)};window.addEventListener("mousemove",O),window.addEventListener("mouseup",ne)};return(W,E)=>(P(),q("div",{ref_key:"scrollContainer",ref:Y,class:"bg-white border border-gray-200 shadow-lg rounded max-h-[300px] overflow-y-auto overflow-x-hidden box-content no-scrollbar",style:_e({width:`${t.scrollWidth*n.value}px`,maxWidth:`${nl}px`})},[o("div",{class:"relative select-none box-content overflow-hidden",style:_e({width:`${t.scrollWidth*n.value}px`,height:`${l.value}px`}),onMousedown:se},[E[0]||(E[0]=o("div",{class:"absolute inset-0 bg-gray-100"},null,-1)),(P(!0),q(Te,null,Me(r.pages,(B,c)=>(P(),q("div",{key:c,class:"absolute shadow-sm border border-gray-300 overflow-hidden",style:_e(g(c))},[o("div",hx,S(c+1),1),(P(!0),q(Te,null,Me(B.elements,w=>{var G,ee;return P(),q("div",{key:w.id,class:"absolute",style:_e(x(w))},[w.type===a(ye).TEXT?(P(),q("div",{key:0,class:"w-full h-full overflow-hidden whitespace-nowrap",style:_e({color:w.style.color||"#000000",fontFamily:w.style.fontFamily,fontWeight:w.style.fontWeight,fontStyle:w.style.fontStyle,textAlign:w.style.textAlign,lineHeight:1})},S(w.variable||w.content),5)):w.type===a(ye).PAGE_NUMBER?(P(),q("div",{key:1,class:"w-full h-full overflow-hidden whitespace-nowrap",style:_e({color:w.style.color||"#000000",fontFamily:w.style.fontFamily,fontWeight:w.style.fontWeight,fontStyle:w.style.fontStyle,textAlign:w.style.textAlign,lineHeight:1})},S(p(w,c)),5)):w.type===a(ye).IMAGE?(P(),q("div",px,[w.content?(P(),q("img",{key:0,src:w.content,class:"w-full h-full object-cover"},null,8,fx)):xe("",!0)])):w.type===a(ye).BARCODE?(P(),q("div",mx,[R(w)?(P(),q("img",{key:0,src:R(w),class:"w-full h-full object-contain"},null,8,gx)):xe("",!0)])):w.type===a(ye).QRCODE?(P(),q("div",vx,[z(w)?(P(),q("img",{key:0,src:z(w),class:"w-full h-full object-contain"},null,8,bx)):xe("",!0)])):w.type===a(ye).TABLE?(P(),q("div",{key:5,class:"w-full h-full border border-gray-300 bg-white grid",style:_e({gridTemplateColumns:`repeat(${((G=w.columns)==null?void 0:G.length)||2}, 1fr)`})},[(P(!0),q(Te,null,Me(Math.min(6,(((ee=w.columns)==null?void 0:ee.length)||2)*2),J=>(P(),q("div",{key:J,class:"border-[0.5px] border-gray-100"}))),128))],4)):xe("",!0)],4)}),128)),c>0?(P(!0),q(Te,{key:0},Me(y(),w=>{var G,ee;return P(),q("div",{key:`global-${c}-${w.id}`,class:"absolute",style:_e(x(w))},[w.type===a(ye).TEXT?(P(),q("div",{key:0,class:"w-full h-full overflow-hidden whitespace-nowrap",style:_e({color:w.style.color||"#000000",fontFamily:w.style.fontFamily,fontWeight:w.style.fontWeight,fontStyle:w.style.fontStyle,textAlign:w.style.textAlign,lineHeight:1})},S(w.variable||w.content),5)):w.type===a(ye).PAGE_NUMBER?(P(),q("div",{key:1,class:"w-full h-full overflow-hidden whitespace-nowrap",style:_e({color:w.style.color||"#000000",fontFamily:w.style.fontFamily,fontWeight:w.style.fontWeight,fontStyle:w.style.fontStyle,textAlign:w.style.textAlign,lineHeight:1})},S(p(w,c)),5)):w.type===a(ye).IMAGE?(P(),q("div",yx,[w.content?(P(),q("img",{key:0,src:w.content,class:"w-full h-full object-cover"},null,8,wx)):xe("",!0)])):w.type===a(ye).BARCODE?(P(),q("div",xx,[R(w)?(P(),q("img",{key:0,src:R(w),class:"w-full h-full object-contain"},null,8,_x)):xe("",!0)])):w.type===a(ye).QRCODE?(P(),q("div",kx,[z(w)?(P(),q("img",{key:0,src:z(w),class:"w-full h-full object-contain"},null,8,Sx)):xe("",!0)])):w.type===a(ye).TABLE?(P(),q("div",{key:5,class:"w-full h-full border border-gray-300 bg-white grid",style:_e({gridTemplateColumns:`repeat(${((G=w.columns)==null?void 0:G.length)||2}, 1fr)`})},[(P(!0),q(Te,null,Me(Math.min(6,(((ee=w.columns)==null?void 0:ee.length)||2)*2),J=>(P(),q("div",{key:J,class:"border-[0.5px] border-gray-100"}))),128))],4)):xe("",!0)],4)}),128)):xe("",!0)],4))),128)),o("div",{class:"absolute border-2 border-blue-500 bg-blue-500/10 cursor-move z-[1000]",style:_e(i.value)},null,4)],36)],4))}}),Tx=_t(Ex,[["__scopeId","data-v-8d64f846"]]),$x={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function Ix(r,e){return P(),q("svg",$x,[...e[0]||(e[0]=[o("path",{fill:"currentColor",d:"M5 21q-.825 0-1.412-.587T3 19V5q0-.825.588-1.412T5 3h7v2H5v14h7v2zm11-4l-1.375-1.45l2.55-2.55H9v-2h8.175l-2.55-2.55L16 7l5 5z"},null,-1)])])}const Ax=Se({name:"material-symbols-logout",render:Ix}),zx={class:"h-screen w-screen flex flex-col bg-gray-100 overflow-hidden"},Px={class:"flex-1 flex overflow-hidden"},Lx={class:"flex-1 overflow-hidden relative flex flex-col"},Mx={key:0,class:"flex items-center justify-between px-4 py-2 bg-blue-50 border-b border-blue-200 text-blue-900 dark:bg-blue-950 dark:border-blue-800 dark:text-blue-100"},Rx={class:"text-sm font-medium"},Dx={class:"flex items-center gap-2"},Bx={class:"relative w-full h-full flex flex-col overflow-hidden"},Ox={class:"flex-none h-5 bg-gray-50 border-b border-gray-300 flex z-20"},qx={class:"flex-1 relative overflow-hidden"},Fx={class:"flex-1 flex overflow-hidden relative"},jx={class:"w-5 flex-none bg-gray-50 border-r border-gray-300 h-full relative z-20 overflow-hidden"},Nx=["onMousedown"],Hx={class:"absolute left-2 -top-4 theme-bg text-white text-[10px] px-1 rounded opacity-0 group-hover:opacity-100 pointer-events-none whitespace-nowrap"},Ux=["onMousedown"],Vx={class:"absolute top-2 -left-4 theme-bg text-white text-[10px] px-1 rounded opacity-0 group-hover:opacity-100 pointer-events-none whitespace-nowrap"},Wx={key:2,class:"absolute pointer-events-none"},Gx={key:1,class:"absolute bottom-4 right-4 z-50"},Kx=Le({__name:"PrintDesigner",setup(r){const e=De(),t=Yt(),{autoSave:s}=Tl(),{t:n}=je(),l=ce(null),i=ce(null),d=ce(null),u=ce(!1),g=ce(0),y=()=>{g.value+=1},m=(Q,ae)=>{const h=getComputedStyle(document.documentElement).getPropertyValue(Q).trim(),U=zt(h);return U?Nd(U.h,U.s,U.v,ae):`rgba(59, 130, 246, ${ae})`},x=ve(()=>e.editingCustomElement),p=ve(()=>x.value?`${x.value.name} Copy`:"");Ve(()=>{Xe(()=>{G()}),window.addEventListener("resize",G),window.addEventListener("keydown",oe),window.addEventListener("keydown",C),window.addEventListener("keyup",oe),window.addEventListener("blur",de),window.addEventListener("brand-theme-updated",y),Ae([()=>e.pages.length,()=>e.canvasSize.width,()=>e.canvasSize.height,()=>e.zoom,()=>e.showMinimap],()=>{Xe(G)}),Ae([()=>e.pages,()=>e.canvasSize,()=>e.guides,()=>e.headerHeight,()=>e.footerHeight,()=>e.showHeaderLine,()=>e.showFooterLine,()=>e.canvasBackground,()=>e.pageSpacingX,()=>e.pageSpacingY,()=>e.watermark,()=>e.showMinimap],()=>{_()},{deep:!0})});const _=Dd(()=>{if(!e.editingCustomElementId&&s.value&&t.currentTemplateId&&!t.isSaving){const Q=t.templates.find(ae=>ae.id===t.currentTemplateId);Q&&t.saveCurrentTemplate(Q.name)}},1e3),v=()=>{if(!e.commitCustomElementEdit()){alert(n("sidebar.editSaveFailed"));return}e.cancelCustomElementEdit()},k=Q=>{const ae=Q.trim();if(!ae)return;if(!e.saveCustomElementEditAs(ae)){alert(n("sidebar.editSaveFailed"));return}e.cancelCustomElementEdit()},b=()=>{confirm(n("sidebar.confirmExitEdit"))&&(e.cancelCustomElementEdit(),requestAnimationFrame(()=>{var Q,ae;(ae=(Q=l.value)==null?void 0:Q.focus)==null||ae.call(Q)}))},f=Q=>{var U;const ae=Q;if(!ae)return!1;if(ae.isContentEditable)return!0;const h=(U=ae.tagName)==null?void 0:U.toLowerCase();return h==="input"||h==="textarea"||h==="select"},C=Q=>{if(e.disableGlobalShortcuts||!e.editingCustomElementId||u.value||f(Q.target)||!(Q.ctrlKey||Q.metaKey))return;const h=Q.key.toLowerCase();if(h==="s"&&Q.shiftKey){Q.preventDefault(),Q.stopPropagation(),u.value=!0;return}if(h==="s"){Q.preventDefault(),Q.stopPropagation(),v();return}h==="q"&&(Q.preventDefault(),Q.stopPropagation(),b())},M=ce(0),F=ce(0),R=ce(0),z=ce(0),H=Q=>{const ae=Q.target;M.value=ae.scrollLeft,F.value=ae.scrollTop},Y=ce(0),se=ce(0),W=ce(0),E=ce(0),B=ve(()=>e.unit||"mm"),c=Q=>{const ae=nt(Q,e.unit||"mm");return e.unit==="px"?Math.round(ae):Number(ae.toFixed(1))},w=ve(()=>{const Q=e.pages.length,ae=e.canvasSize.height,h=e.canvasSize.width,U=e.pageSpacingY||0,Z=Q>0?Q*ae+(Q-1)*U:0;return{width:`${h*e.zoom}px`,height:`${Z*e.zoom}px`}}),G=()=>{if(l.value&&d.value){const Q=l.value.clientWidth,ae=l.value.clientHeight;W.value=Q,E.value=ae;const h=parseFloat(w.value.width),U=parseFloat(w.value.height),Z=64,A=64;Y.value=Math.max(Q,h+Z),se.value=Math.max(ae,U+A),h+Z<=Q&&(Y.value=Q),U+A<=ae&&(se.value=ae);const I=l.value.getBoundingClientRect(),X=d.value.getBoundingClientRect();M.value=l.value.scrollLeft,F.value=l.value.scrollTop,R.value=X.left-I.left+l.value.scrollLeft,z.value=X.top-I.top+l.value.scrollTop}};We(()=>{var Q;_.cancel(),window.removeEventListener("resize",G),window.removeEventListener("mousemove",ne),window.removeEventListener("mouseup",T),window.removeEventListener("keydown",oe),window.removeEventListener("keydown",C),window.removeEventListener("keyup",oe),window.removeEventListener("blur",de),window.removeEventListener("brand-theme-updated",y),(Q=l.value)==null||Q.removeEventListener("wheel",D)});const ee=ce(!1),J=ce(null),$=ce("horizontal"),N=ce(0),L=(Q,ae,h=null)=>{ee.value=!0,J.value=h,$.value=ae,O(Q),window.addEventListener("mousemove",ne),window.addEventListener("mouseup",T)},O=Q=>{if(!l.value)return;const ae=l.value.getBoundingClientRect(),h=e.zoom;if($.value==="horizontal"){const U=Q.clientY-ae.top+l.value.scrollTop;N.value=(U-z.value)/h}else{const U=Q.clientX-ae.left+l.value.scrollLeft;N.value=(U-R.value)/h}},ne=Q=>{ee.value&&(Q.preventDefault(),O(Q),J.value&&e.updateGuide(J.value,N.value))},T=Q=>{if(!ee.value)return;const ae=l.value.getBoundingClientRect();let h=!1;$.value==="horizontal"?Q.clientY<ae.top&&(h=!0):Q.clientX<ae.left&&(h=!0),h?J.value&&e.removeGuide(J.value):J.value?e.updateGuide(J.value,N.value):e.addGuide({type:$.value,position:N.value}),ee.value=!1,J.value=null,window.removeEventListener("mousemove",ne),window.removeEventListener("mouseup",T)},D=Q=>{Q.ctrlKey&&(Q.preventDefault(),Q.deltaY<0?e.setZoom(Math.min(5,e.zoom+.1)):e.setZoom(Math.max(.2,e.zoom-.1)))},oe=Q=>{var ae,h;e.disableGlobalShortcuts||(Q.key==="Control"||Q.key==="Meta")&&(Q.type==="keydown"&&!Q.repeat?(ae=l.value)==null||ae.addEventListener("wheel",D,{passive:!1}):Q.type==="keyup"&&((h=l.value)==null||h.removeEventListener("wheel",D)))},de=()=>{var Q;(Q=l.value)==null||Q.removeEventListener("wheel",D)},te=Q=>{l.value&&l.value.scrollTo({left:Q.left,top:Q.top,behavior:"auto"})},ue=Q=>{var we;const ae=((we=Q.style)==null?void 0:we.rotate)||0;if(ae===0)return{minX:Q.x,maxX:Q.x+Q.width,minY:Q.y,maxY:Q.y+Q.height};const h=Q.x+Q.width/2,U=Q.y+Q.height/2,Z=ae*Math.PI/180,A=Math.cos(Z),I=Math.sin(Z),X=[{x:Q.x,y:Q.y},{x:Q.x+Q.width,y:Q.y},{x:Q.x,y:Q.y+Q.height},{x:Q.x+Q.width,y:Q.y+Q.height}];let K=1/0,le=-1/0,V=1/0,pe=-1/0;for(const ge of X){const me=h+(ge.x-h)*A-(ge.y-U)*I,re=U+(ge.x-h)*I+(ge.y-U)*A;me<K&&(K=me),me>le&&(le=me),re<V&&(V=re),re>pe&&(pe=re)}return{minX:K,maxX:le,minY:V,maxY:pe}},ie=ve(()=>{if(!e.isDragging||e.selectedElementIds.length===0)return null;const Q=[];for(const X of e.selectedElementIds)for(const K of e.pages){const le=K.elements.find(V=>V.id===X);le&&Q.push(le)}if(Q.length===0)return null;let ae=1/0,h=-1/0,U=1/0,Z=-1/0;for(const X of Q){const K=ue(X);K.minX<ae&&(ae=K.minX),K.maxX>h&&(h=K.maxX),K.minY<U&&(U=K.minY),K.maxY>Z&&(Z=K.maxY)}const A=(ae+h)/2,I=(U+Z)/2;return{minX:ae,maxX:h,minY:U,maxY:Z,centerX:A,centerY:I}}),he=ve(()=>{if(!ie.value)return{h:[],v:[]};g.value;const Q=m("--brand-500",.5),{minX:ae,maxX:h,minY:U,maxY:Z}=ie.value;return{h:[{position:ae,color:Q},{position:h,color:Q}],v:[{position:U,color:Q},{position:Z,color:Q}]}});return(Q,ae)=>{var h;return P(),q("div",zx,[fe(C1),o("div",Px,[fe(fy),o("main",Lx,[a(e).editingCustomElementId?(P(),q("div",Mx,[o("div",Rx,S(a(n)("sidebar.editingElement",{name:((h=x.value)==null?void 0:h.name)||""})),1),o("div",Dx,[o("button",{onClick:v,class:"px-3 py-1.5 text-xs font-medium bg-blue-600 text-white rounded hover:bg-blue-700 dark:bg-blue-500 dark:hover:bg-blue-400 inline-flex items-center gap-1.5"},[fe(a(So),{class:"w-4 h-4"}),Ce(" "+S(a(n)("sidebar.saveEdit")),1)]),o("button",{onClick:ae[0]||(ae[0]=U=>u.value=!0),class:"px-3 py-1.5 text-xs font-medium bg-blue-200 text-blue-900 rounded hover:bg-blue-300 dark:bg-blue-700 dark:hover:bg-blue-600 dark:text-white inline-flex items-center gap-1.5"},[fe(a(Ml),{class:"w-4 h-4"}),Ce(" "+S(a(n)("sidebar.saveAs")),1)]),o("button",{onClick:b,class:"px-3 py-1.5 text-xs font-medium bg-slate-200 text-slate-900 rounded hover:bg-slate-300 dark:bg-slate-700 dark:hover:bg-slate-600 dark:text-slate-100 inline-flex items-center gap-1.5"},[fe(a(Ax),{class:"w-4 h-4"}),Ce(" "+S(a(n)("sidebar.exitEdit")),1)])])])):xe("",!0),fe(cx),o("div",Bx,[o("div",Ox,[ae[5]||(ae[5]=o("div",{class:"w-5 flex-none bg-gray-100 border-r border-gray-300"},null,-1)),o("div",qx,[fe(rl,{type:"horizontal",zoom:a(e).zoom,scroll:M.value,offset:R.value,thick:20,unit:a(e).unit||"mm",indicators:he.value.h,onGuideDragStart:ae[1]||(ae[1]=U=>L(U,"horizontal"))},null,8,["zoom","scroll","offset","unit","indicators"])])]),o("div",Fx,[o("div",jx,[fe(rl,{type:"vertical",zoom:a(e).zoom,scroll:F.value,offset:z.value,thick:20,unit:a(e).unit||"mm",indicators:he.value.v,onGuideDragStart:ae[2]||(ae[2]=U=>L(U,"vertical"))},null,8,["zoom","scroll","offset","unit","indicators"])]),o("div",{ref_key:"scrollContainer",ref:l,tabindex:"-1",class:"flex-1 overflow-auto p-8 flex relative canvas-scroll bg-gray-100 focus:outline-none",onScroll:H,onClick:ae[3]||(ae[3]=U=>{(U.target===l.value||U.target===U.currentTarget)&&a(e).selectGuide(null)})},[o("div",{ref_key:"canvasWrapper",ref:d,style:_e(w.value),class:"mx-auto relative"},[fe(Ul,{ref_key:"canvasContainer",ref:i,class:"absolute top-0 left-0"},null,512)],4),o("div",{class:"absolute top-0 left-0 pointer-events-none z-50",style:_e({width:`${Y.value}px`,height:`${se.value}px`})},[ie.value?(P(),q(Te,{key:0},[o("div",{class:"absolute w-full border-t border-blue-500 border-dashed",style:_e({top:`${z.value+ie.value.minY*a(e).zoom}px`,left:0})},[o("div",{class:"absolute -top-6 bg-blue-500 text-white text-xs px-1.5 py-0.5 rounded shadow-sm",style:_e({left:`${M.value+10}px`})},S(c(ie.value.minY))+" "+S(B.value),5)],4),o("div",{class:"absolute w-full border-t border-dashed theme-border",style:_e({top:`${z.value+ie.value.maxY*a(e).zoom}px`,left:0})},[o("div",{class:"absolute -top-6 theme-bg text-white text-xs px-1.5 py-0.5 rounded shadow-sm",style:_e({left:`${M.value+10}px`})},S(c(ie.value.maxY))+" "+S(B.value),5)],4),o("div",{class:"absolute h-full border-l border-dashed theme-border",style:_e({left:`${R.value+ie.value.minX*a(e).zoom}px`,top:0})},[o("div",{class:"absolute -left-2 transform -translate-x-full theme-bg text-white text-xs px-1.5 py-0.5 rounded shadow-sm whitespace-nowrap",style:_e({top:`${F.value+10}px`})},S(c(ie.value.minX))+" "+S(B.value),5)],4),o("div",{class:"absolute h-full border-l border-dashed theme-border",style:_e({left:`${R.value+ie.value.maxX*a(e).zoom}px`,top:0})},[o("div",{class:"absolute -left-2 transform -translate-x-full theme-bg text-white text-xs px-1.5 py-0.5 rounded shadow-sm whitespace-nowrap",style:_e({top:`${F.value+10}px`})},S(c(ie.value.maxX))+" "+S(B.value),5)],4)],64)):xe("",!0),(P(!0),q(Te,null,Me(a(e).guides,U=>(P(),q(Te,{key:U.id},[U.type==="horizontal"?(P(),q("div",{key:0,class:"absolute left-0 w-full h-3 -mt-1.5 cursor-row-resize pointer-events-auto group flex flex-col justify-center",style:_e({top:`${z.value+U.position*a(e).zoom}px`}),onMousedown:Ke(Z=>{a(e).selectGuide(U.id),L(Z,"horizontal",U.id)},["stop"])},[o("div",{class:ke(["w-full",a(e).highlightedGuideId===U.id?"border-t-2 theme-border-strong":"border-t theme-border","theme-border-hover"])},null,2),o("div",Hx,S(c(U.position))+S(B.value),1)],44,Nx)):(P(),q("div",{key:1,class:"absolute top-0 h-full w-3 -ml-1.5 cursor-col-resize pointer-events-auto group flex flex-row justify-center",style:_e({left:`${R.value+U.position*a(e).zoom}px`}),onMousedown:Ke(Z=>{a(e).selectGuide(U.id),L(Z,"vertical",U.id)},["stop"])},[o("div",{class:ke(["h-full",a(e).highlightedGuideId===U.id?"border-l-2 theme-border-strong":"border-l theme-border","theme-border-hover"])},null,2),o("div",Vx,S(c(U.position))+S(B.value),1)],44,Ux))],64))),128)),ee.value&&!J.value?(P(),q("div",{key:1,class:ke(["absolute border-dashed pointer-events-none theme-border",$.value==="horizontal"?"left-0 w-full border-t":"top-0 h-full border-l"]),style:_e({top:$.value==="horizontal"?`${z.value+N.value*a(e).zoom}px`:void 0,left:$.value==="vertical"?`${R.value+N.value*a(e).zoom}px`:void 0})},[o("div",{class:ke(["absolute theme-bg text-white text-[10px] px-1 rounded",$.value==="horizontal"?"left-2 -top-4":"top-2 -left-4"])},S(c(N.value))+S(B.value),3)],6)):xe("",!0),a(e).highlightedEdge?(P(),q("div",Wx,[a(e).highlightedEdge==="top"?(P(),q("div",{key:0,class:"absolute left-0 w-full border-t theme-border",style:_e({top:`${z.value}px`})},null,4)):a(e).highlightedEdge==="bottom"?(P(),q("div",{key:1,class:"absolute left-0 w-full border-t theme-border",style:_e({top:`${z.value+a(e).canvasSize.height*a(e).zoom}px`})},null,4)):a(e).highlightedEdge==="left"?(P(),q("div",{key:2,class:"absolute top-0 h-full border-l theme-border",style:_e({left:`${R.value}px`})},null,4)):a(e).highlightedEdge==="right"?(P(),q("div",{key:3,class:"absolute top-0 h-full border-l theme-border",style:_e({left:`${R.value+a(e).canvasSize.width*a(e).zoom}px`})},null,4)):xe("",!0)])):xe("",!0)],4)],544)])]),a(e).showMinimap?(P(),q("div",Gx,[fe(Tx,{"scroll-width":Y.value,"scroll-height":se.value,"viewport-width":W.value,"viewport-height":E.value,"scroll-left":M.value,"scroll-top":F.value,pages:a(e).pages,"page-width":a(e).canvasSize.width,"page-height":a(e).canvasSize.height,zoom:a(e).zoom,"content-offset-x":R.value,"content-offset-y":z.value,"canvas-background":a(e).canvasBackground,"show-header-line":a(e).showHeaderLine,"show-footer-line":a(e).showFooterLine,"header-height":a(e).headerHeight,"footer-height":a(e).footerHeight,watermark:a(e).watermark||null,"onUpdate:scroll":te},null,8,["scroll-width","scroll-height","viewport-width","viewport-height","scroll-left","scroll-top","pages","page-width","page-height","zoom","content-offset-x","content-offset-y","canvas-background","show-header-line","show-footer-line","header-height","footer-height","watermark"])])):xe("",!0)]),fe(Fw)]),fe(Dt,{show:u.value,"initial-value":p.value,title:a(n)("sidebar.saveAsCustomElement"),placeholder:a(n)("sidebar.enterNamePlaceholder"),onClose:ae[4]||(ae[4]=U=>u.value=!1),onSave:k},null,8,["show","initial-value","title","placeholder"])])}}}),Yx={class:"print-renderer"},Xx=Le({__name:"PrintRenderer",setup(r){const e=De(),t=new URLSearchParams(window.location.search).get("printToken")||"",s=window.location.origin,n=g=>{window.parent&&window.parent.postMessage({type:g,token:t},s)},l=async(g=2e3)=>{const y=document.fonts;!y||!y.ready||await Promise.race([y.ready,new Promise(m=>setTimeout(m,g))])},i=async(g=2e3)=>{const m=Array.from(document.images||[]).filter(x=>!x.complete);m.length!==0&&await Promise.race([Promise.all(m.map(x=>new Promise(p=>{const _=()=>{x.removeEventListener("load",_),x.removeEventListener("error",_),p()};x.addEventListener("load",_,{once:!0}),x.addEventListener("error",_,{once:!0})}))),new Promise(x=>setTimeout(x,g))])},d=async g=>{e.$patch({pages:Ee(g.pages||[]),canvasSize:g.canvasSize||e.canvasSize,canvasBackground:g.canvasBackground||e.canvasBackground,headerHeight:g.headerHeight??e.headerHeight,footerHeight:g.footerHeight??e.footerHeight,showHeaderLine:g.showHeaderLine??!1,showFooterLine:g.showFooterLine??!1,showGrid:!1,showCornerMarkers:!1,zoom:1,currentPageIndex:0,selectedElementId:null,selectedElementIds:[],guides:[],testData:g.testData||{}}),g.watermark&&(e.watermark=Ee(g.watermark)),g.unit&&(e.unit=g.unit),e.setIsExporting(!0),document.body.classList.add("exporting"),await Xe(),await l(),await i(),requestAnimationFrame(()=>{n("print-renderer-rendered")})},u=g=>{if(g.origin!==s)return;const y=g.data;!y||y.type!=="print-renderer-payload"||y.token!==t||d(y.payload||{})};return Ve(()=>{document.body.style.margin="0",document.body.style.background="#ffffff",window.addEventListener("message",u),n("print-renderer-ready")}),We(()=>{window.removeEventListener("message",u)}),(g,y)=>(P(),q("div",Yx,[fe(Ul)]))}}),Zx=_t(Xx,[["__scopeId","data-v-e32c25e7"]]),Jx=Le({__name:"App",setup(r){const e=new URLSearchParams(window.location.search).get("print")==="1";return(t,s)=>e?(P(),Pe(Zx,{key:0})):(P(),Pe(Kx,{key:1}))}}),Qx=Wl(),$o=Gl(Jx),e5=()=>{const r=localStorage.getItem("print-designer-brand-vars");if(r)try{const e=JSON.parse(r);if(!e||typeof e!="object")return;const t=document.documentElement;Object.entries(e).forEach(([s,n])=>{t.style.setProperty(s,n)})}catch{}};e5();$o.use(Qx);$o.use(oi);$o.mount("#app");
