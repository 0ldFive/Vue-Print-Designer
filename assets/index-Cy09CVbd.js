import{b as Kl,e as dl,r as ie,w as Ae,c as fe,m as Se,f as z,g as F,i as o,j as yt,n as Xe,d as Pe,u as Ne,a as We,o as Ge,k as ze,T as tt,l as Ke,t as E,p as ce,q as a,v as be,F as Te,x as $e,y as De,z as ye,A as Ce,B as ul,C as Le,D as _e,E as wt,G as Je,H as ct,I as it,J as ft,K as Rt,L as Yl,M as Xl}from"./vendor-57TSdUMR.js";import{c as dt,g as _t,C as Zl}from"./canvg-0PdlMh_v.js";import{v as He,r as Jl}from"./utils-CRAcIz2K.js";import{r as Ql,E as ei}from"./pdf-DGXcMhCb.js";import{V as cl}from"./monaco-BtpKTOhI.js";import{r as ti,a as ri}from"./barcode-BoWGE6Vo.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))s(n);new MutationObserver(n=>{for(const l of n)if(l.type==="childList")for(const i of l.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&s(i)}).observe(document,{childList:!0,subtree:!0});function t(n){const l={};return n.integrity&&(l.integrity=n.integrity),n.referrerPolicy&&(l.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?l.credentials="include":n.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function s(n){if(n.ep)return;n.ep=!0;const l=t(n);fetch(n.href,l)}})();const ni={common:{save:"Save",cancel:"Cancel",confirm:"Confirm",close:"Close",delete:"Delete",edit:"Edit",copy:"Copy",cut:"Cut",paste:"Paste",undo:"Undo",redo:"Redo",rename:"Rename",loading:"Loading...",success:"Success",input:"Input",actions:"Actions",width:"Width",height:"Height",mm:"mm",px:"px",pt:"pt",rotate:"Rotate",lock:"Lock",unlock:"Unlock",appTitle:"Print Designer",testData:"Test Data",invalidJson:"Invalid JSON. Changes were not saved.",testDataKeyChanged:"Test data keys cannot be changed. Please only edit values."},template:{select:"Select Template",noTemplates:"No templates yet",new:"New Template",rename:"Rename Template",confirmDelete:'Are you sure you want to delete "{name}"?'},editor:{preview:"Print Preview",exportPdf:"Export PDF",exportImage:"Export Image",print:"Print",viewJson:"View JSON",viewBlob:"View Blob",viewImageBlob:"View Image Blob",viewPdfBlob:"View PDF Blob",zoomIn:"Zoom In",zoomOut:"Zoom Out",zoomLevel:"Zoom Level",zoomSettings:"Zoom Settings",unit:"Unit",advancedSettings:"Advanced Settings",watermark:"Watermark",watermarkEnable:"Enable",watermarkText:"Text",watermarkTextPlaceholder:"Enter watermark text",watermarkAngle:"Angle",watermarkColor:"Color",watermarkOpacity:"Opacity (%)",watermarkSize:"Size",watermarkDensity:"Density",template:"Template",newTemplate:"New Template",saveTemplate:"Save Template",saveAsTemplate:"Save As Template",templates:"Templates",shortcuts:"Shortcuts",help:"Help",about:"About",paperSettings:"Paper Settings",sizePreset:"Size Preset",custom:"Custom",spacingX:"Horizontal Margin",spacingY:"Vertical Margin",showCornerMarkers:"Show Corner Markers",showGrid:"Show Grid",showMinimap:"Show Minimap",headerFooter:"Header & Footer",headerLine:"Header Line",footerLine:"Footer Line",addNewPage:"Add New Page",fonts:{default:"Default",arial:"Arial",timesNewRoman:"Times New Roman",courierNew:"Courier New",simSun:"SimSun (宋体)",simHei:"SimHei (黑体)"},bold:"Bold",italic:"Italic",underline:"Underline",verticalText:"Vertical Text",textColor:"Text Color",backgroundColor:"Background Color",resetRotation:"Reset Rotation",alignLeft:"Align Left",alignCenter:"Align Center",alignRight:"Align Right",alignTop:"Align Top",alignMiddle:"Align Middle",alignBottom:"Align Bottom",group:"Group",lock:"Lock",unlock:"Unlock",fontFamily:"Font Family",settings:"Settings"},canvas:{addPage:"Add Page",copyPage:"Copy Page",pastePage:"Paste Page",deletePage:"Delete Page",newText:"New Text",headerLabel:"Header",footerLabel:"Footer",defaultTableHeaders:{id:"ID",name:"Name",qty:"Qty",price:"Price",total:"Total"},defaultTableData:{item:"Item",pageSum:"Page Sum",total:"Total",inWords:"In Words"}},sidebar:{elements:"Elements",dragToCanvas:"Drag elements to the canvas",standard:"Standard",custom:"Custom",general:"General",dataCodes:"Data & Codes",shapes:"Shapes",text:"Text",image:"Image",pagination:"Pagination",table:"Table",barcode:"Barcode",qrcode:"QR Code",line:"Line",rect:"Rect",circle:"Circle",noCustomElements:"No custom elements saved yet.",moreOptions:"More options",editElement:"Edit Element",rename:"Rename",copy:"Copy",delete:"Delete",renameModalTitle:"Rename Custom Element",enterNamePlaceholder:"Enter element name...",confirmDelete:'Are you sure you want to delete "{name}"?',confirmSwitchEdit:'Exit current edit for "{name}"?',confirmExitEdit:"You have unsaved changes. Exit anyway?",editingElement:"Editing custom element: {name}",saveEdit:"Save",saveAs:"Save As",exitEdit:"Exit",saveAsCustomElement:"Save as Custom Element",editSaveFailed:"Nothing to save. Please select an element."},elements:{text:"Text",image:"Image",table:"Table",line:"Line",rect:"Rect",circle:"Circle",barcode:"Barcode",qrcode:"QR Code",pageNumber:"Page Number",custom:"Custom",layers:"Layers"},properties:{title:"Properties",subtitle:"Edit element properties",locked:"Locked",multiSelectMode:"Multi-select mode",selectedElements:"{n} elements selected",deleteSelected:"Delete Selected Elements",tab:{properties:"Properties",style:"Style",advanced:"Advanced"},section:{positionSize:"Position & Size",dataBehavior:"Data & Behavior",layoutDimensions:"Layout & Dimensions",headerStyle:"Header Style",footerStyle:"Footer Style",cellOperations:"Cell Operations",appearance:"Appearance",elementInfo:"Element Info",content:"Content",typography:"Typography",border:"Border",barcodeSettings:"Barcode Settings",qrSettings:"QR Settings",labelContent:"Label Content",paginationTypography:"Pagination Typography",labelStyle:"Label Style",frameBorder:"Frame Border",lineStyle:"Line Style",imageSource:"Image Source"},action:{mergeCells:"Merge Cells",splitCells:"Split Cells",copyId:"Copy ID",copied:"Copied!",saveCustom:"Save as Custom Element",deleteElement:"Delete Current Element",saveCustomModal:"Save Custom Element"},empty:{noSelection:"No Selection",selectInstruction:"Select an element to edit properties"},label:{type:"Type",x:"X",y:"Y",width:"Width",height:"Height",content:"Content",variable:"Variable",writingMode:"Writing Mode",fontSize:"Font Size",color:"Color",textAlign:"Text Align",fontFamily:"Font Family",fontWeight:"Font Weight",borderStyle:"Border Style",borderWidth:"Border Width",borderColor:"Border Color",backgroundColor:"Background Color",imageSource:"Image Source",format:"Format",showText:"Show Text",lineWidth:"Line Width",barcodeHeight:"Height",margin:"Margin",textPosition:"Text Position",errorCorrection:"Error Correction",thickness:"Thickness",cornerRadius:"Corner Radius",background:"Background",autoPaginate:"Auto Paginate",repeatFooter:"Repeat Footer",showFooter:"Show Footer",columns:"Columns (JSON)",data:"Data (JSON)",footerData:"Footer Data (JSON)",customScript:"Custom Script",headerHeight:"Header Height",rowHeight:"Row Height",footerHeight:"Footer Height",textColor:"Text Color",editCell:"Edit Cell",editColumn:"Edit Column",headerText:"Header Text",fieldKey:"Field Key",variableField:"Variable Field",headerNamePlaceholder:"Header Name",displayTextPlaceholder:"Display Text (e.g. Total:)",dataFieldPlaceholder:"Data Field (e.g. {#amount})",id:"ID",labelBorderColor:"Label Border Color",barcodeContentPlaceholder:"Barcode Value",qrContentPlaceholder:"QR Code Value",textContentPlaceholder:"Enter text content",variablePlaceholder:"Variable Name (e.g. @name)",labelText:"Label Text",labelPosition:"Label Position",labelFontSize:"Label Font Size",labelColor:"Label Color",labelFontFamily:"Label Font Family",labelFontWeight:"Label Font Weight",labelBackgroundColor:"Label Background Color",labelBorderStyle:"Label Border Style",labelBorderWidth:"Label Border Width",pageFormat:"Page Format",labelTextPlaceholder:"e.g. Page",columnsPlaceholder:'[{ "field": "name", "header": "Name", "width": 100 }]',dataPlaceholder:"[{...}]",footerDataPlaceholder:'[{ "id": { "value": "Total" }, "amount": { "value": "Total:", "field": "{#sum}" } }]',customScriptPlaceholder:"return { data: ... };",fontStyle:"Font Style",padding:"Padding (px)"},option:{horizontal:"Horizontal",vertical:"Vertical",default:"Default",left:"Left",center:"Center",right:"Right",normal:"Normal",medium:"Medium",bold:"Bold",none:"None",solid:"Solid",dashed:"Dashed",dotted:"Dotted",yes:"Yes",no:"No",top:"Top",bottom:"Bottom",before:"Before",after:"After",eccLow:"Low (7%)",eccMedium:"Medium (15%)",eccQuartile:"Quartile (25%)",eccHigh:"High (30%)",arial:"Arial",timesNewRoman:"Times New Roman",courierNew:"Courier New",simSun:"SimSun (宋体)",simHei:"SimHei (黑体)",page1:"Page 1",oneTotal:"1/Total",code128:"CODE128",ean13:"EAN-13",upc:"UPC",code39:"CODE39",itf14:"ITF-14",msi:"MSI",pharmacode:"Pharmacode",numberOnly:"Number (1)"},image:{urlPlaceholder:"https://... or data:image/...",uploadBtn:"Upload Image",uploadTip:"Max 2MB, converts to Base64",sizeError:"Image size must be less than 2MB",readError:"Failed to read file"}},shortcuts:{title:"Shortcuts",keyboardShortcuts:"Keyboard Shortcuts",general:"General",editing:"Editing",manipulation:"Manipulation",newTemplate:"New Template",openSettings:"Open Settings",openHelp:"Open Help",zoom:"Zoom In/Out",closeModal:"Close Modal",selectAll:"Select All",multiSelect:"Multi-select",move:"Move",fastMove:"Fast Move",snapRotate:"Snap Rotate",resize:"Proportional Resize",saveAsTemplate:"Save As Template",customEditSave:"Save Custom Edit",customEditSaveAs:"Save Custom Edit As",customEditExit:"Exit Custom Edit",ctrl:"Ctrl",shift:"Shift",alt:"Alt",esc:"Esc",del:"Delete",enter:"Enter",arrow:"Arrow Keys",drag:"Drag",click:"Click",wheel:"Wheel"},help:{title:"Help Center",about:"About",aboutProject:"About {name}",github:"Project URL",dependencies:"Open Source Dependencies",package:"Package",version:"Version"},colorPicker:{clear:"Clear",transparent:"Transparent"},settings:{title:"Settings",basic:"Basic",language:"Language",connection:"Connections",themeColor:"Theme Color",themeColorDesc:"Pick a preset theme color and apply instantly.",themePresetDefault:"Blue",themePresetEmerald:"Emerald",themePresetAmber:"Amber",themePresetRose:"Rose",themePresetCustom:"Custom",theme:"Theme",themeSystem:"Follow System",themeLight:"Light",themeDark:"Dark",themeDesc:"Defaults to following system; you can force Light or Dark.",autoSave:"Auto Save",autoSaveDesc:"Automatically save changes (saved templates only).",exportImageMerged:"Export Image As Single",exportImageMergedDesc:"When off, export each page as a separate image inside a ZIP file.",languageDesc:"Choose the interface language.",connectionDesc:"Connection settings placeholder.",printMode:"Print Mode",printModeLocal:"Local Client",printModeRemote:"Remote Cloud",printModeBrowser:"Browser",printModeDesc:"Local and remote options require a successful connection test.",silentPrint:"Silent Print",silentPrintDesc:"When enabled, skip the custom print dialog; browser print still uses the browser dialog.",localConnection:"Local Client Print",remoteConnection:"Remote Cloud Print",host:"Host",port:"Port",wsPath:"WS Path",protocol:"Protocol",wsAddress:"WS Address",wsAddressPlaceholder:"ws://host:port/ws/request",localWsAddressPlaceholder:"ws://host:port/ws",secretKey:"Secret Key",connectionUrl:"Connection URL",connect:"Connect",disconnect:"Disconnect",connecting:"Connecting...",connectionTesting:"Testing connection...",connectionOk:"Connection OK",connectionOkWithUser:"Connection OK (User: {userId})",connectionFailed:"Connection failed",connectionTimeout:"Connection timeout",connectionMissingFields:"Please fill in API URL, username, and password.",connectionMissingToken:"Login succeeded but token is missing.",apiBaseUrl:"Login URL",apiBasePlaceholder:"http://host:port/api/login",username:"Username",password:"Password",remoteLoginTitle:"Login (HTTP)",remoteLoginDesc:"Used to obtain the JWT token. Enter the full login URL.",remoteWsTitle:"WebSocket (Print Relay)",remoteWsDesc:"Used for printing and client/printer queries. Token is appended to the WS URL.",localClientTitle:"Local Client",localClientDesc:"Configure the local client WebSocket and secret key for on-device printing.",remoteClient:"Default Client",remoteClientPlaceholder:"Select a client",remoteAuthHint:"Remote WS URL appends ?token=JWT for browser WebSocket authentication.",status:{connected:"Connected",connecting:"Connecting",disconnected:"Disconnected",error:"Error"},retrying:"Retrying ({count}/{max})",cancelRetry:"Cancel Retry",selectLanguage:"Select Language",zhLabel:"Chinese",enLabel:"English"},printDialog:{title:"Print Options",titleLocal:"Local Client Print Options",titleRemote:"Remote Cloud Print Options",sectionBasic:"Basic",sectionAdvanced:"Advanced",printer:"Printer",printerSelect:"Select printer",printerEmpty:"No printers found.",remoteClient:"Client",remoteClientPlaceholder:"Select client",remoteClientEmpty:"No clients found.",remotePrinterInfo:"Type: {type} | Paper: {paper} | Formats: {format}",printerPlaceholder:"Printer name",jobName:"Job Name",jobNamePlaceholder:"Optional job name",copies:"Copies",intervalMs:"Interval (ms)",pageRange:"Page Range",pageRangePlaceholder:"e.g. 1-3,5",pageSet:"Page Set",pageSetAll:"All",pageSetOdd:"Odd",pageSetEven:"Even",scale:"Scale",scaleNo:"No Scale",scaleShrink:"Shrink",scaleFit:"Fit",orientation:"Orientation",portrait:"Portrait",landscape:"Landscape",colorMode:"Color Mode",color:"Color",monochrome:"Monochrome",sidesMode:"Duplex",simplex:"Simplex",duplex:"Duplex",duplexShort:"Duplex (Short Edge)",duplexLong:"Duplex (Long Edge)",paperSize:"Paper Size",paperSizePlaceholder:"e.g. A4",trayBin:"Tray",trayBinPlaceholder:"e.g. 2 or Manual",confirm:"Print"},preview:{title:"Print Preview",templateJson:"Template JSON",zoomIn:"Zoom In",zoomOut:"Zoom Out"},input:{title:"Input",placeholder:"Enter value..."}},oi={common:{save:"保存",cancel:"取消",confirm:"确认",close:"关闭",delete:"删除",edit:"编辑",copy:"复制",cut:"剪切",paste:"粘贴",undo:"撤销",redo:"重做",rename:"重命名",loading:"加载中...",success:"成功",input:"输入",actions:"操作",width:"宽度",height:"高度",mm:"毫米",px:"像素",pt:"磅",rotate:"旋转",lock:"锁定",unlock:"解锁",appTitle:"打印设计器",testData:"测试数据",invalidJson:"JSON 无效，未保存更改。",testDataKeyChanged:"测试数据的键不允许修改，请仅编辑值。"},template:{select:"选择模版",noTemplates:"暂无模版",new:"新建模版",rename:"重命名模版",confirmDelete:'确定要删除 "{name}" 吗？'},editor:{preview:"打印预览",exportPdf:"导出 PDF",exportImage:"导出图片",print:"打印",viewJson:"查看 JSON",viewBlob:"查看 Blob",viewImageBlob:"查看图片 Blob",viewPdfBlob:"查看 PDF Blob",zoomIn:"放大",zoomOut:"缩小",zoomLevel:"缩放级别",zoomSettings:"缩放设置",unit:"单位",advancedSettings:"高级设置",watermark:"水印",watermarkEnable:"启用",watermarkText:"文字",watermarkTextPlaceholder:"请输入水印文字",watermarkAngle:"方向",watermarkColor:"颜色",watermarkOpacity:"透明度（%）",watermarkSize:"大小",watermarkDensity:"密度",template:"模版",newTemplate:"新建模版",saveTemplate:"保存模版",saveAsTemplate:"另存为模版",templates:"模版列表",shortcuts:"快捷键",help:"帮助",about:"关于",paperSettings:"页面设置",sizePreset:"纸张尺寸",custom:"自定义",spacingX:"水平边距",spacingY:"垂直边距",showCornerMarkers:"显示角标",showGrid:"显示网格",showMinimap:"显示缩略图",headerFooter:"页眉页脚",headerLine:"页眉线",footerLine:"页脚线",addNewPage:"添加新页",fonts:{default:"默认",arial:"Arial",timesNewRoman:"Times New Roman",courierNew:"Courier New",simSun:"宋体",simHei:"黑体"},bold:"加粗",italic:"斜体",underline:"下划线",verticalText:"竖排文本",textColor:"文本颜色",backgroundColor:"背景颜色",resetRotation:"重置旋转",alignLeft:"左对齐",alignCenter:"水平居中",alignRight:"右对齐",alignTop:"顶部对齐",alignMiddle:"垂直居中",alignBottom:"底部对齐",group:"组合",lock:"锁定",unlock:"解锁",fontFamily:"字体",settings:"设置"},canvas:{addPage:"添加页",copyPage:"复制页",pastePage:"粘贴页",deletePage:"删除页",newText:"新文本",headerLabel:"页眉",footerLabel:"页脚",defaultTableHeaders:{id:"ID",name:"名称",qty:"数量",price:"单价",total:"合计"},defaultTableData:{item:"商品",pageSum:"本页合计",total:"总计",inWords:"大写金额"}},sidebar:{custom:"自定义",elements:"组件库",dragToCanvas:"拖拽组件到画布",standard:"标准组件",general:"通用",dataCodes:"数据 & 条码",shapes:"图形",text:"文本",image:"图片",pagination:"页码",table:"表格",barcode:"条形码",qrcode:"二维码",line:"直线",rect:"矩形",circle:"圆形",noCustomElements:"暂无自定义组件",moreOptions:"更多选项",editElement:"编辑元素",rename:"重命名",copy:"复制",delete:"删除",renameModalTitle:"重命名自定义组件",enterNamePlaceholder:"输入组件名称...",confirmDelete:'确定要删除 "{name}" 吗？',confirmSwitchEdit:'退出当前对 "{name}" 的编辑？',confirmExitEdit:"存在未保存的更改，确定退出吗？",editingElement:"正在编辑自定义元素：{name}",saveEdit:"保存",saveAs:"另存为",exitEdit:"退出",saveAsCustomElement:"另存为自定义元素",editSaveFailed:"没有可保存的元素，请先选中一个元素。"},elements:{text:"文本",image:"图片",table:"表格",line:"直线",rect:"矩形",circle:"圆形",barcode:"条形码",qrcode:"二维码",pageNumber:"页码",custom:"自定义",layers:"图层"},properties:{title:"属性面板",subtitle:"编辑组件属性",locked:"已锁定",multiSelectMode:"多选模式",selectedElements:"已选择 {n} 个组件",deleteSelected:"删除选中组件",tab:{properties:"属性",style:"样式",advanced:"高级"},section:{positionSize:"位置 & 尺寸",dataBehavior:"数据 & 行为",layoutDimensions:"布局 & 尺寸",headerStyle:"表头样式",footerStyle:"表脚样式",cellOperations:"单元格操作",appearance:"外观",elementInfo:"组件信息",content:"内容",typography:"排版",border:"边框",barcodeSettings:"条形码设置",qrSettings:"二维码设置",labelContent:"标签内容",paginationTypography:"页码排版",labelStyle:"标签样式",frameBorder:"框架边框",lineStyle:"线条样式",imageSource:"图片来源"},action:{mergeCells:"合并单元格",splitCells:"拆分单元格",copyId:"复制 ID",copied:"已复制!",saveCustom:"保存为自定义组件",deleteElement:"删除当前组件",saveCustomModal:"保存自定义组件"},empty:{noSelection:"未选择",selectInstruction:"选择一个组件以编辑属性"},label:{type:"类型",x:"X",y:"Y",width:"宽度",height:"高度",content:"内容",variable:"变量",writingMode:"书写模式",fontSize:"字号",color:"颜色",textAlign:"对齐方式",fontFamily:"字体",fontWeight:"字重",borderStyle:"边框样式",borderWidth:"边框宽度",borderColor:"边框颜色",backgroundColor:"背景颜色",imageSource:"图片来源",format:"格式",showText:"显示文本",lineWidth:"线宽",barcodeHeight:"高度",margin:"边距",textPosition:"文本位置",errorCorrection:"纠错等级",thickness:"粗细",cornerRadius:"圆角半径",background:"背景",autoPaginate:"自动分页",repeatFooter:"重复表脚",showFooter:"显示表脚",columns:"列定义 (JSON)",data:"数据 (JSON)",footerData:"表脚数据 (JSON)",customScript:"自定义脚本",headerHeight:"表头高度",rowHeight:"行高",footerHeight:"表脚高度",textColor:"文本颜色",editCell:"编辑单元格",editColumn:"编辑列",headerText:"表头文本",fieldKey:"字段键",variableField:"变量字段",headerNamePlaceholder:"表头名称",displayTextPlaceholder:"显示文本 (如: 合计:)",dataFieldPlaceholder:"数据字段 (如: {#amount})",id:"ID",labelBorderColor:"标签边框颜色",barcodeContentPlaceholder:"条码内容",qrContentPlaceholder:"二维码内容",textContentPlaceholder:"请输入文本内容",variablePlaceholder:"变量名 (例如 @name)",labelText:"标签文本",labelPosition:"标签位置",labelFontSize:"标签字号",labelColor:"标签颜色",labelFontFamily:"标签字体",labelFontWeight:"标签字重",labelBackgroundColor:"标签背景颜色",labelBorderStyle:"标签边框样式",labelBorderWidth:"标签边框宽度",pageFormat:"页码格式",labelTextPlaceholder:"例如：第",columnsPlaceholder:'[{ "field": "name", "header": "姓名", "width": 100 }]',dataPlaceholder:"[{...}]",footerDataPlaceholder:'[{ "id": { "value": "合计" }, "amount": { "value": "合计:", "field": "{#sum}" } }]',customScriptPlaceholder:"return { data: ... };",fontStyle:"字体样式",padding:"内边距 (px)"},option:{horizontal:"水平",vertical:"垂直",default:"默认",left:"左对齐",center:"居中",right:"右对齐",normal:"常规",medium:"中等",bold:"加粗",none:"无",solid:"实线",dashed:"虚线",dotted:"点线",yes:"是",no:"否",top:"顶部",bottom:"底部",before:"之前",after:"之后",eccLow:"低 (7%)",eccMedium:"中 (15%)",eccQuartile:"四分 (25%)",eccHigh:"高 (30%)",arial:"Arial",timesNewRoman:"Times New Roman",courierNew:"Courier New",simSun:"宋体",simHei:"黑体",page1:"第 1 页",oneTotal:"1/共几页",code128:"CODE128",ean13:"EAN-13",upc:"UPC",code39:"CODE39",itf14:"ITF-14",msi:"MSI",pharmacode:"Pharmacode",numberOnly:"数字 (1)"},image:{urlPlaceholder:"请输入图片地址或 Base64...",uploadBtn:"上传图片",uploadTip:"最大 2MB，自动转换为 Base64",sizeError:"图片大小不能超过 2MB",readError:"读取文件失败"}},shortcuts:{title:"快捷键",keyboardShortcuts:"键盘快捷键",general:"通用",editing:"编辑",manipulation:"操作",themeColor:"主题色",themeColorDesc:"选择一个预设主题色，立即生效。",themePresetDefault:"蓝色",themePresetEmerald:"绿色",themePresetAmber:"橙色",themePresetRose:"玫红",themePresetCustom:"自定义",newTemplate:"新建模版",openSettings:"打开设置",openHelp:"打开帮助",zoom:"缩放",closeModal:"关闭弹窗",selectAll:"全选",multiSelect:"多选",move:"移动",fastMove:"快速移动",snapRotate:"吸附旋转",resize:"等比缩放",saveAsTemplate:"另存为模版",customEditSave:"保存自定义编辑",customEditSaveAs:"另存自定义编辑",customEditExit:"退出自定义编辑",ctrl:"Ctrl",shift:"Shift",alt:"Alt",esc:"Esc",del:"Delete",enter:"Enter",arrow:"方向键",drag:"拖拽",click:"点击",wheel:"滚轮"},help:{title:"帮助中心",about:"关于",aboutProject:"关于 {name}",github:"项目地址",dependencies:"开源依赖",package:"依赖包",version:"版本"},colorPicker:{clear:"清除",transparent:"透明"},settings:{title:"设置",basic:"基础",language:"语言",connection:"连接",themeColor:"主题色",themeColorDesc:"选择一个预设主题色，立即生效。",themePresetDefault:"蓝色",themePresetEmerald:"绿色",themePresetAmber:"橙色",themePresetRose:"玫红",themePresetCustom:"自定义",theme:"主题",themeSystem:"跟随系统",themeLight:"亮色",themeDark:"暗色",themeDesc:"默认跟随系统；可手动切换为亮色或暗色。",autoSave:"自动保存",autoSaveDesc:"当模版发生变更时自动保存（仅对已保存过的模版生效）。",exportImageMerged:"导出为整张图片",exportImageMergedDesc:"关闭后将每一页导出为单张图片，并打包为 ZIP。",languageDesc:"选择界面的显示语言。",connectionDesc:"连接设置占位内容。",printMode:"打印方式",printModeLocal:"本地客户端打印",printModeRemote:"远程云打印",printModeBrowser:"浏览器打印",printModeDesc:"本地/远程需连接测试成功后才能启用。",silentPrint:"静默打印",silentPrintDesc:"开启后跳过自定义打印对话框；浏览器打印仍会弹出浏览器打印设置。",localConnection:"本地客户端打印",remoteConnection:"远程云打印",host:"主机",port:"端口",wsPath:"WS 路径",protocol:"协议",wsAddress:"WS 地址",wsAddressPlaceholder:"ws://host:port/ws/request",localWsAddressPlaceholder:"ws://host:port/ws",secretKey:"密钥",connectionUrl:"连接地址",connect:"连接",disconnect:"断开",connecting:"连接中...",connectionTesting:"正在测试连接...",connectionOk:"连接成功",connectionOkWithUser:"连接成功（用户：{userId}）",connectionFailed:"连接失败",connectionTimeout:"连接超时",connectionMissingFields:"请填写 API 地址、用户名和密码。",connectionMissingToken:"登录成功但未返回 Token。",apiBaseUrl:"登录地址",apiBasePlaceholder:"http://host:port/api/login",username:"用户名",password:"密码",remoteLoginTitle:"登录（HTTP）",remoteLoginDesc:"用于获取 JWT，请填写完整的登录地址。",remoteWsTitle:"WebSocket（打印中转）",remoteWsDesc:"用于打印与查询客户端/打印机，Token 会拼到 WS 地址。",localClientTitle:"本地客户端",localClientDesc:"配置本地客户端的 WebSocket 与密钥，用于本机打印。",remoteClient:"默认客户端",remoteClientPlaceholder:"请选择客户端",remoteAuthHint:"远程 WS 地址会附加 ?token=JWT 以便浏览器鉴权。",status:{connected:"已连接",connecting:"连接中",disconnected:"未连接",error:"错误"},retrying:"重试中（{count}/{max}）",cancelRetry:"停止重试",selectLanguage:"选择语言",zhLabel:"中文",enLabel:"English"},printDialog:{title:"打印参数",titleLocal:"本地客户端打印参数",titleRemote:"远程云打印参数",sectionBasic:"基础",sectionAdvanced:"高级",printer:"打印机",printerSelect:"请选择打印机",printerEmpty:"未获取到打印机。",remoteClient:"客户端",remoteClientPlaceholder:"请选择客户端",remoteClientEmpty:"未获取到客户端。",remotePrinterInfo:"类型：{type} | 纸张：{paper} | 格式：{format}",printerPlaceholder:"打印机名称",jobName:"任务名称",jobNamePlaceholder:"可选任务名称",copies:"打印份数",intervalMs:"份数间隔(ms)",pageRange:"页码范围",pageRangePlaceholder:"如 1-3,5",pageSet:"奇偶页",pageSetAll:"全部",pageSetOdd:"奇数页",pageSetEven:"偶数页",scale:"缩放",scaleNo:"不缩放",scaleShrink:"缩小",scaleFit:"适应",orientation:"方向",portrait:"纵向",landscape:"横向",colorMode:"颜色模式",color:"彩色",monochrome:"黑白",sidesMode:"单双面",simplex:"单面",duplex:"双面",duplexShort:"双面（短边翻转）",duplexLong:"双面（长边翻转）",paperSize:"纸张",paperSizePlaceholder:"如 A4",trayBin:"纸盒",trayBinPlaceholder:"如 2 或 Manual",confirm:"打印"},preview:{title:"打印预览",templateJson:"模版 JSON",zoomIn:"放大",zoomOut:"缩小"},input:{title:"输入",placeholder:"请输入..."}},si={en:ni,zh:oi},ai=()=>{const r=localStorage.getItem("print-designer-language");return r&&(r==="zh"||r==="en")?r:navigator.language.toLowerCase().startsWith("zh")?"zh":"en"},li=Kl({legacy:!1,locale:ai(),fallbackLocale:"en",messages:si});var tr,Po;function ii(){if(Po)return tr;Po=1;function r(){this.__data__=[],this.size=0}return tr=r,tr}var rr,Lo;function hl(){if(Lo)return rr;Lo=1;function r(e,t){return e===t||e!==e&&t!==t}return rr=r,rr}var nr,Mo;function Wt(){if(Mo)return nr;Mo=1;var r=hl();function e(t,s){for(var n=t.length;n--;)if(r(t[n][0],s))return n;return-1}return nr=e,nr}var or,Ro;function di(){if(Ro)return or;Ro=1;var r=Wt(),e=Array.prototype,t=e.splice;function s(n){var l=this.__data__,i=r(l,n);if(i<0)return!1;var d=l.length-1;return i==d?l.pop():t.call(l,i,1),--this.size,!0}return or=s,or}var sr,Do;function ui(){if(Do)return sr;Do=1;var r=Wt();function e(t){var s=this.__data__,n=r(s,t);return n<0?void 0:s[n][1]}return sr=e,sr}var ar,Bo;function ci(){if(Bo)return ar;Bo=1;var r=Wt();function e(t){return r(this.__data__,t)>-1}return ar=e,ar}var lr,Oo;function hi(){if(Oo)return lr;Oo=1;var r=Wt();function e(t,s){var n=this.__data__,l=r(n,t);return l<0?(++this.size,n.push([t,s])):n[l][1]=s,this}return lr=e,lr}var ir,qo;function Gt(){if(qo)return ir;qo=1;var r=ii(),e=di(),t=ui(),s=ci(),n=hi();function l(i){var d=-1,u=i==null?0:i.length;for(this.clear();++d<u;){var g=i[d];this.set(g[0],g[1])}}return l.prototype.clear=r,l.prototype.delete=e,l.prototype.get=t,l.prototype.has=s,l.prototype.set=n,ir=l,ir}var dr,Fo;function pi(){if(Fo)return dr;Fo=1;var r=Gt();function e(){this.__data__=new r,this.size=0}return dr=e,dr}var ur,No;function fi(){if(No)return ur;No=1;function r(e){var t=this.__data__,s=t.delete(e);return this.size=t.size,s}return ur=r,ur}var cr,jo;function mi(){if(jo)return cr;jo=1;function r(e){return this.__data__.get(e)}return cr=r,cr}var hr,Ho;function gi(){if(Ho)return hr;Ho=1;function r(e){return this.__data__.has(e)}return hr=r,hr}var pr,Uo;function pl(){if(Uo)return pr;Uo=1;var r=typeof dt=="object"&&dt&&dt.Object===Object&&dt;return pr=r,pr}var fr,Vo;function rt(){if(Vo)return fr;Vo=1;var r=pl(),e=typeof self=="object"&&self&&self.Object===Object&&self,t=r||e||Function("return this")();return fr=t,fr}var mr,Wo;function po(){if(Wo)return mr;Wo=1;var r=rt(),e=r.Symbol;return mr=e,mr}var gr,Go;function vi(){if(Go)return gr;Go=1;var r=po(),e=Object.prototype,t=e.hasOwnProperty,s=e.toString,n=r?r.toStringTag:void 0;function l(i){var d=t.call(i,n),u=i[n];try{i[n]=void 0;var g=!0}catch{}var y=s.call(i);return g&&(d?i[n]=u:delete i[n]),y}return gr=l,gr}var vr,Ko;function bi(){if(Ko)return vr;Ko=1;var r=Object.prototype,e=r.toString;function t(s){return e.call(s)}return vr=t,vr}var br,Yo;function Bt(){if(Yo)return br;Yo=1;var r=po(),e=vi(),t=bi(),s="[object Null]",n="[object Undefined]",l=r?r.toStringTag:void 0;function i(d){return d==null?d===void 0?n:s:l&&l in Object(d)?e(d):t(d)}return br=i,br}var yr,Xo;function mt(){if(Xo)return yr;Xo=1;function r(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}return yr=r,yr}var wr,Zo;function fl(){if(Zo)return wr;Zo=1;var r=Bt(),e=mt(),t="[object AsyncFunction]",s="[object Function]",n="[object GeneratorFunction]",l="[object Proxy]";function i(d){if(!e(d))return!1;var u=r(d);return u==s||u==n||u==t||u==l}return wr=i,wr}var xr,Jo;function yi(){if(Jo)return xr;Jo=1;var r=rt(),e=r["__core-js_shared__"];return xr=e,xr}var _r,Qo;function wi(){if(Qo)return _r;Qo=1;var r=yi(),e=(function(){var s=/[^.]+$/.exec(r&&r.keys&&r.keys.IE_PROTO||"");return s?"Symbol(src)_1."+s:""})();function t(s){return!!e&&e in s}return _r=t,_r}var kr,es;function ml(){if(es)return kr;es=1;var r=Function.prototype,e=r.toString;function t(s){if(s!=null){try{return e.call(s)}catch{}try{return s+""}catch{}}return""}return kr=t,kr}var Sr,ts;function xi(){if(ts)return Sr;ts=1;var r=fl(),e=wi(),t=mt(),s=ml(),n=/[\\^$.*+?()[\]{}|]/g,l=/^\[object .+?Constructor\]$/,i=Function.prototype,d=Object.prototype,u=i.toString,g=d.hasOwnProperty,y=RegExp("^"+u.call(g).replace(n,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function m(x){if(!t(x)||e(x))return!1;var p=r(x)?y:l;return p.test(s(x))}return Sr=m,Sr}var Cr,rs;function _i(){if(rs)return Cr;rs=1;function r(e,t){return e==null?void 0:e[t]}return Cr=r,Cr}var Er,ns;function gt(){if(ns)return Er;ns=1;var r=xi(),e=_i();function t(s,n){var l=e(s,n);return r(l)?l:void 0}return Er=t,Er}var Tr,os;function fo(){if(os)return Tr;os=1;var r=gt(),e=rt(),t=r(e,"Map");return Tr=t,Tr}var $r,ss;function Kt(){if(ss)return $r;ss=1;var r=gt(),e=r(Object,"create");return $r=e,$r}var Ir,as;function ki(){if(as)return Ir;as=1;var r=Kt();function e(){this.__data__=r?r(null):{},this.size=0}return Ir=e,Ir}var Ar,ls;function Si(){if(ls)return Ar;ls=1;function r(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}return Ar=r,Ar}var zr,is;function Ci(){if(is)return zr;is=1;var r=Kt(),e="__lodash_hash_undefined__",t=Object.prototype,s=t.hasOwnProperty;function n(l){var i=this.__data__;if(r){var d=i[l];return d===e?void 0:d}return s.call(i,l)?i[l]:void 0}return zr=n,zr}var Pr,ds;function Ei(){if(ds)return Pr;ds=1;var r=Kt(),e=Object.prototype,t=e.hasOwnProperty;function s(n){var l=this.__data__;return r?l[n]!==void 0:t.call(l,n)}return Pr=s,Pr}var Lr,us;function Ti(){if(us)return Lr;us=1;var r=Kt(),e="__lodash_hash_undefined__";function t(s,n){var l=this.__data__;return this.size+=this.has(s)?0:1,l[s]=r&&n===void 0?e:n,this}return Lr=t,Lr}var Mr,cs;function $i(){if(cs)return Mr;cs=1;var r=ki(),e=Si(),t=Ci(),s=Ei(),n=Ti();function l(i){var d=-1,u=i==null?0:i.length;for(this.clear();++d<u;){var g=i[d];this.set(g[0],g[1])}}return l.prototype.clear=r,l.prototype.delete=e,l.prototype.get=t,l.prototype.has=s,l.prototype.set=n,Mr=l,Mr}var Rr,hs;function Ii(){if(hs)return Rr;hs=1;var r=$i(),e=Gt(),t=fo();function s(){this.size=0,this.__data__={hash:new r,map:new(t||e),string:new r}}return Rr=s,Rr}var Dr,ps;function Ai(){if(ps)return Dr;ps=1;function r(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}return Dr=r,Dr}var Br,fs;function Yt(){if(fs)return Br;fs=1;var r=Ai();function e(t,s){var n=t.__data__;return r(s)?n[typeof s=="string"?"string":"hash"]:n.map}return Br=e,Br}var Or,ms;function zi(){if(ms)return Or;ms=1;var r=Yt();function e(t){var s=r(this,t).delete(t);return this.size-=s?1:0,s}return Or=e,Or}var qr,gs;function Pi(){if(gs)return qr;gs=1;var r=Yt();function e(t){return r(this,t).get(t)}return qr=e,qr}var Fr,vs;function Li(){if(vs)return Fr;vs=1;var r=Yt();function e(t){return r(this,t).has(t)}return Fr=e,Fr}var Nr,bs;function Mi(){if(bs)return Nr;bs=1;var r=Yt();function e(t,s){var n=r(this,t),l=n.size;return n.set(t,s),this.size+=n.size==l?0:1,this}return Nr=e,Nr}var jr,ys;function Ri(){if(ys)return jr;ys=1;var r=Ii(),e=zi(),t=Pi(),s=Li(),n=Mi();function l(i){var d=-1,u=i==null?0:i.length;for(this.clear();++d<u;){var g=i[d];this.set(g[0],g[1])}}return l.prototype.clear=r,l.prototype.delete=e,l.prototype.get=t,l.prototype.has=s,l.prototype.set=n,jr=l,jr}var Hr,ws;function Di(){if(ws)return Hr;ws=1;var r=Gt(),e=fo(),t=Ri(),s=200;function n(l,i){var d=this.__data__;if(d instanceof r){var u=d.__data__;if(!e||u.length<s-1)return u.push([l,i]),this.size=++d.size,this;d=this.__data__=new t(u)}return d.set(l,i),this.size=d.size,this}return Hr=n,Hr}var Ur,xs;function Bi(){if(xs)return Ur;xs=1;var r=Gt(),e=pi(),t=fi(),s=mi(),n=gi(),l=Di();function i(d){var u=this.__data__=new r(d);this.size=u.size}return i.prototype.clear=e,i.prototype.delete=t,i.prototype.get=s,i.prototype.has=n,i.prototype.set=l,Ur=i,Ur}var Vr,_s;function Oi(){if(_s)return Vr;_s=1;function r(e,t){for(var s=-1,n=e==null?0:e.length;++s<n&&t(e[s],s,e)!==!1;);return e}return Vr=r,Vr}var Wr,ks;function qi(){if(ks)return Wr;ks=1;var r=gt(),e=(function(){try{var t=r(Object,"defineProperty");return t({},"",{}),t}catch{}})();return Wr=e,Wr}var Gr,Ss;function gl(){if(Ss)return Gr;Ss=1;var r=qi();function e(t,s,n){s=="__proto__"&&r?r(t,s,{configurable:!0,enumerable:!0,value:n,writable:!0}):t[s]=n}return Gr=e,Gr}var Kr,Cs;function vl(){if(Cs)return Kr;Cs=1;var r=gl(),e=hl(),t=Object.prototype,s=t.hasOwnProperty;function n(l,i,d){var u=l[i];(!(s.call(l,i)&&e(u,d))||d===void 0&&!(i in l))&&r(l,i,d)}return Kr=n,Kr}var Yr,Es;function Xt(){if(Es)return Yr;Es=1;var r=vl(),e=gl();function t(s,n,l,i){var d=!l;l||(l={});for(var u=-1,g=n.length;++u<g;){var y=n[u],m=i?i(l[y],s[y],y,l,s):void 0;m===void 0&&(m=s[y]),d?e(l,y,m):r(l,y,m)}return l}return Yr=t,Yr}var Xr,Ts;function Fi(){if(Ts)return Xr;Ts=1;function r(e,t){for(var s=-1,n=Array(e);++s<e;)n[s]=t(s);return n}return Xr=r,Xr}var Zr,$s;function kt(){if($s)return Zr;$s=1;function r(e){return e!=null&&typeof e=="object"}return Zr=r,Zr}var Jr,Is;function Ni(){if(Is)return Jr;Is=1;var r=Bt(),e=kt(),t="[object Arguments]";function s(n){return e(n)&&r(n)==t}return Jr=s,Jr}var Qr,As;function ji(){if(As)return Qr;As=1;var r=Ni(),e=kt(),t=Object.prototype,s=t.hasOwnProperty,n=t.propertyIsEnumerable,l=r((function(){return arguments})())?r:function(i){return e(i)&&s.call(i,"callee")&&!n.call(i,"callee")};return Qr=l,Qr}var en,zs;function mo(){if(zs)return en;zs=1;var r=Array.isArray;return en=r,en}var It={exports:{}},tn,Ps;function Hi(){if(Ps)return tn;Ps=1;function r(){return!1}return tn=r,tn}It.exports;var Ls;function bl(){return Ls||(Ls=1,(function(r,e){var t=rt(),s=Hi(),n=e&&!e.nodeType&&e,l=n&&!0&&r&&!r.nodeType&&r,i=l&&l.exports===n,d=i?t.Buffer:void 0,u=d?d.isBuffer:void 0,g=u||s;r.exports=g})(It,It.exports)),It.exports}var rn,Ms;function Ui(){if(Ms)return rn;Ms=1;var r=9007199254740991,e=/^(?:0|[1-9]\d*)$/;function t(s,n){var l=typeof s;return n=n??r,!!n&&(l=="number"||l!="symbol"&&e.test(s))&&s>-1&&s%1==0&&s<n}return rn=t,rn}var nn,Rs;function yl(){if(Rs)return nn;Rs=1;var r=9007199254740991;function e(t){return typeof t=="number"&&t>-1&&t%1==0&&t<=r}return nn=e,nn}var on,Ds;function Vi(){if(Ds)return on;Ds=1;var r=Bt(),e=yl(),t=kt(),s="[object Arguments]",n="[object Array]",l="[object Boolean]",i="[object Date]",d="[object Error]",u="[object Function]",g="[object Map]",y="[object Number]",m="[object Object]",x="[object RegExp]",p="[object Set]",k="[object String]",v="[object WeakMap]",S="[object ArrayBuffer]",b="[object DataView]",f="[object Float32Array]",T="[object Float64Array]",M="[object Int8Array]",H="[object Int16Array]",R="[object Int32Array]",A="[object Uint8Array]",W="[object Uint8ClampedArray]",X="[object Uint16Array]",se="[object Uint32Array]",G={};G[f]=G[T]=G[M]=G[H]=G[R]=G[A]=G[W]=G[X]=G[se]=!0,G[s]=G[n]=G[S]=G[l]=G[b]=G[i]=G[d]=G[u]=G[g]=G[y]=G[m]=G[x]=G[p]=G[k]=G[v]=!1;function $(O){return t(O)&&e(O.length)&&!!G[r(O)]}return on=$,on}var sn,Bs;function go(){if(Bs)return sn;Bs=1;function r(e){return function(t){return e(t)}}return sn=r,sn}var At={exports:{}};At.exports;var Os;function vo(){return Os||(Os=1,(function(r,e){var t=pl(),s=e&&!e.nodeType&&e,n=s&&!0&&r&&!r.nodeType&&r,l=n&&n.exports===s,i=l&&t.process,d=(function(){try{var u=n&&n.require&&n.require("util").types;return u||i&&i.binding&&i.binding("util")}catch{}})();r.exports=d})(At,At.exports)),At.exports}var an,qs;function Wi(){if(qs)return an;qs=1;var r=Vi(),e=go(),t=vo(),s=t&&t.isTypedArray,n=s?e(s):r;return an=n,an}var ln,Fs;function wl(){if(Fs)return ln;Fs=1;var r=Fi(),e=ji(),t=mo(),s=bl(),n=Ui(),l=Wi(),i=Object.prototype,d=i.hasOwnProperty;function u(g,y){var m=t(g),x=!m&&e(g),p=!m&&!x&&s(g),k=!m&&!x&&!p&&l(g),v=m||x||p||k,S=v?r(g.length,String):[],b=S.length;for(var f in g)(y||d.call(g,f))&&!(v&&(f=="length"||p&&(f=="offset"||f=="parent")||k&&(f=="buffer"||f=="byteLength"||f=="byteOffset")||n(f,b)))&&S.push(f);return S}return ln=u,ln}var dn,Ns;function bo(){if(Ns)return dn;Ns=1;var r=Object.prototype;function e(t){var s=t&&t.constructor,n=typeof s=="function"&&s.prototype||r;return t===n}return dn=e,dn}var un,js;function xl(){if(js)return un;js=1;function r(e,t){return function(s){return e(t(s))}}return un=r,un}var cn,Hs;function Gi(){if(Hs)return cn;Hs=1;var r=xl(),e=r(Object.keys,Object);return cn=e,cn}var hn,Us;function Ki(){if(Us)return hn;Us=1;var r=bo(),e=Gi(),t=Object.prototype,s=t.hasOwnProperty;function n(l){if(!r(l))return e(l);var i=[];for(var d in Object(l))s.call(l,d)&&d!="constructor"&&i.push(d);return i}return hn=n,hn}var pn,Vs;function _l(){if(Vs)return pn;Vs=1;var r=fl(),e=yl();function t(s){return s!=null&&e(s.length)&&!r(s)}return pn=t,pn}var fn,Ws;function yo(){if(Ws)return fn;Ws=1;var r=wl(),e=Ki(),t=_l();function s(n){return t(n)?r(n):e(n)}return fn=s,fn}var mn,Gs;function Yi(){if(Gs)return mn;Gs=1;var r=Xt(),e=yo();function t(s,n){return s&&r(n,e(n),s)}return mn=t,mn}var gn,Ks;function Xi(){if(Ks)return gn;Ks=1;function r(e){var t=[];if(e!=null)for(var s in Object(e))t.push(s);return t}return gn=r,gn}var vn,Ys;function Zi(){if(Ys)return vn;Ys=1;var r=mt(),e=bo(),t=Xi(),s=Object.prototype,n=s.hasOwnProperty;function l(i){if(!r(i))return t(i);var d=e(i),u=[];for(var g in i)g=="constructor"&&(d||!n.call(i,g))||u.push(g);return u}return vn=l,vn}var bn,Xs;function wo(){if(Xs)return bn;Xs=1;var r=wl(),e=Zi(),t=_l();function s(n){return t(n)?r(n,!0):e(n)}return bn=s,bn}var yn,Zs;function Ji(){if(Zs)return yn;Zs=1;var r=Xt(),e=wo();function t(s,n){return s&&r(n,e(n),s)}return yn=t,yn}var zt={exports:{}};zt.exports;var Js;function Qi(){return Js||(Js=1,(function(r,e){var t=rt(),s=e&&!e.nodeType&&e,n=s&&!0&&r&&!r.nodeType&&r,l=n&&n.exports===s,i=l?t.Buffer:void 0,d=i?i.allocUnsafe:void 0;function u(g,y){if(y)return g.slice();var m=g.length,x=d?d(m):new g.constructor(m);return g.copy(x),x}r.exports=u})(zt,zt.exports)),zt.exports}var wn,Qs;function ed(){if(Qs)return wn;Qs=1;function r(e,t){var s=-1,n=e.length;for(t||(t=Array(n));++s<n;)t[s]=e[s];return t}return wn=r,wn}var xn,ea;function td(){if(ea)return xn;ea=1;function r(e,t){for(var s=-1,n=e==null?0:e.length,l=0,i=[];++s<n;){var d=e[s];t(d,s,e)&&(i[l++]=d)}return i}return xn=r,xn}var _n,ta;function kl(){if(ta)return _n;ta=1;function r(){return[]}return _n=r,_n}var kn,ra;function xo(){if(ra)return kn;ra=1;var r=td(),e=kl(),t=Object.prototype,s=t.propertyIsEnumerable,n=Object.getOwnPropertySymbols,l=n?function(i){return i==null?[]:(i=Object(i),r(n(i),function(d){return s.call(i,d)}))}:e;return kn=l,kn}var Sn,na;function rd(){if(na)return Sn;na=1;var r=Xt(),e=xo();function t(s,n){return r(s,e(s),n)}return Sn=t,Sn}var Cn,oa;function Sl(){if(oa)return Cn;oa=1;function r(e,t){for(var s=-1,n=t.length,l=e.length;++s<n;)e[l+s]=t[s];return e}return Cn=r,Cn}var En,sa;function Cl(){if(sa)return En;sa=1;var r=xl(),e=r(Object.getPrototypeOf,Object);return En=e,En}var Tn,aa;function El(){if(aa)return Tn;aa=1;var r=Sl(),e=Cl(),t=xo(),s=kl(),n=Object.getOwnPropertySymbols,l=n?function(i){for(var d=[];i;)r(d,t(i)),i=e(i);return d}:s;return Tn=l,Tn}var $n,la;function nd(){if(la)return $n;la=1;var r=Xt(),e=El();function t(s,n){return r(s,e(s),n)}return $n=t,$n}var In,ia;function Tl(){if(ia)return In;ia=1;var r=Sl(),e=mo();function t(s,n,l){var i=n(s);return e(s)?i:r(i,l(s))}return In=t,In}var An,da;function od(){if(da)return An;da=1;var r=Tl(),e=xo(),t=yo();function s(n){return r(n,t,e)}return An=s,An}var zn,ua;function sd(){if(ua)return zn;ua=1;var r=Tl(),e=El(),t=wo();function s(n){return r(n,t,e)}return zn=s,zn}var Pn,ca;function ad(){if(ca)return Pn;ca=1;var r=gt(),e=rt(),t=r(e,"DataView");return Pn=t,Pn}var Ln,ha;function ld(){if(ha)return Ln;ha=1;var r=gt(),e=rt(),t=r(e,"Promise");return Ln=t,Ln}var Mn,pa;function id(){if(pa)return Mn;pa=1;var r=gt(),e=rt(),t=r(e,"Set");return Mn=t,Mn}var Rn,fa;function dd(){if(fa)return Rn;fa=1;var r=gt(),e=rt(),t=r(e,"WeakMap");return Rn=t,Rn}var Dn,ma;function _o(){if(ma)return Dn;ma=1;var r=ad(),e=fo(),t=ld(),s=id(),n=dd(),l=Bt(),i=ml(),d="[object Map]",u="[object Object]",g="[object Promise]",y="[object Set]",m="[object WeakMap]",x="[object DataView]",p=i(r),k=i(e),v=i(t),S=i(s),b=i(n),f=l;return(r&&f(new r(new ArrayBuffer(1)))!=x||e&&f(new e)!=d||t&&f(t.resolve())!=g||s&&f(new s)!=y||n&&f(new n)!=m)&&(f=function(T){var M=l(T),H=M==u?T.constructor:void 0,R=H?i(H):"";if(R)switch(R){case p:return x;case k:return d;case v:return g;case S:return y;case b:return m}return M}),Dn=f,Dn}var Bn,ga;function ud(){if(ga)return Bn;ga=1;var r=Object.prototype,e=r.hasOwnProperty;function t(s){var n=s.length,l=new s.constructor(n);return n&&typeof s[0]=="string"&&e.call(s,"index")&&(l.index=s.index,l.input=s.input),l}return Bn=t,Bn}var On,va;function cd(){if(va)return On;va=1;var r=rt(),e=r.Uint8Array;return On=e,On}var qn,ba;function ko(){if(ba)return qn;ba=1;var r=cd();function e(t){var s=new t.constructor(t.byteLength);return new r(s).set(new r(t)),s}return qn=e,qn}var Fn,ya;function hd(){if(ya)return Fn;ya=1;var r=ko();function e(t,s){var n=s?r(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.byteLength)}return Fn=e,Fn}var Nn,wa;function pd(){if(wa)return Nn;wa=1;var r=/\w*$/;function e(t){var s=new t.constructor(t.source,r.exec(t));return s.lastIndex=t.lastIndex,s}return Nn=e,Nn}var jn,xa;function fd(){if(xa)return jn;xa=1;var r=po(),e=r?r.prototype:void 0,t=e?e.valueOf:void 0;function s(n){return t?Object(t.call(n)):{}}return jn=s,jn}var Hn,_a;function md(){if(_a)return Hn;_a=1;var r=ko();function e(t,s){var n=s?r(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.length)}return Hn=e,Hn}var Un,ka;function gd(){if(ka)return Un;ka=1;var r=ko(),e=hd(),t=pd(),s=fd(),n=md(),l="[object Boolean]",i="[object Date]",d="[object Map]",u="[object Number]",g="[object RegExp]",y="[object Set]",m="[object String]",x="[object Symbol]",p="[object ArrayBuffer]",k="[object DataView]",v="[object Float32Array]",S="[object Float64Array]",b="[object Int8Array]",f="[object Int16Array]",T="[object Int32Array]",M="[object Uint8Array]",H="[object Uint8ClampedArray]",R="[object Uint16Array]",A="[object Uint32Array]";function W(X,se,G){var $=X.constructor;switch(se){case p:return r(X);case l:case i:return new $(+X);case k:return e(X,G);case v:case S:case b:case f:case T:case M:case H:case R:case A:return n(X,G);case d:return new $;case u:case m:return new $(X);case g:return t(X);case y:return new $;case x:return s(X)}}return Un=W,Un}var Vn,Sa;function vd(){if(Sa)return Vn;Sa=1;var r=mt(),e=Object.create,t=(function(){function s(){}return function(n){if(!r(n))return{};if(e)return e(n);s.prototype=n;var l=new s;return s.prototype=void 0,l}})();return Vn=t,Vn}var Wn,Ca;function bd(){if(Ca)return Wn;Ca=1;var r=vd(),e=Cl(),t=bo();function s(n){return typeof n.constructor=="function"&&!t(n)?r(e(n)):{}}return Wn=s,Wn}var Gn,Ea;function yd(){if(Ea)return Gn;Ea=1;var r=_o(),e=kt(),t="[object Map]";function s(n){return e(n)&&r(n)==t}return Gn=s,Gn}var Kn,Ta;function wd(){if(Ta)return Kn;Ta=1;var r=yd(),e=go(),t=vo(),s=t&&t.isMap,n=s?e(s):r;return Kn=n,Kn}var Yn,$a;function xd(){if($a)return Yn;$a=1;var r=_o(),e=kt(),t="[object Set]";function s(n){return e(n)&&r(n)==t}return Yn=s,Yn}var Xn,Ia;function _d(){if(Ia)return Xn;Ia=1;var r=xd(),e=go(),t=vo(),s=t&&t.isSet,n=s?e(s):r;return Xn=n,Xn}var Zn,Aa;function kd(){if(Aa)return Zn;Aa=1;var r=Bi(),e=Oi(),t=vl(),s=Yi(),n=Ji(),l=Qi(),i=ed(),d=rd(),u=nd(),g=od(),y=sd(),m=_o(),x=ud(),p=gd(),k=bd(),v=mo(),S=bl(),b=wd(),f=mt(),T=_d(),M=yo(),H=wo(),R=1,A=2,W=4,X="[object Arguments]",se="[object Array]",G="[object Boolean]",$="[object Date]",O="[object Error]",h="[object Function]",w="[object GeneratorFunction]",Y="[object Map]",te="[object Number]",Q="[object Object]",I="[object RegExp]",V="[object Set]",L="[object String]",B="[object Symbol]",re="[object WeakMap]",Z="[object ArrayBuffer]",ne="[object DataView]",ve="[object Float32Array]",xe="[object Float64Array]",de="[object Int8Array]",ke="[object Int16Array]",we="[object Int32Array]",ae="[object Uint8Array]",K="[object Uint8ClampedArray]",oe="[object Uint16Array]",c="[object Uint32Array]",N={};N[X]=N[se]=N[Z]=N[ne]=N[G]=N[$]=N[ve]=N[xe]=N[de]=N[ke]=N[we]=N[Y]=N[te]=N[Q]=N[I]=N[V]=N[L]=N[B]=N[ae]=N[K]=N[oe]=N[c]=!0,N[O]=N[h]=N[re]=!1;function q(_,C,j,P,J,D){var le,he=C&R,ue=C&A,pe=C&W;if(j&&(le=J?j(_,P,J,D):j(_)),le!==void 0)return le;if(!f(_))return _;var ee=v(_);if(ee){if(le=x(_),!he)return i(_,le)}else{var U=m(_),me=U==h||U==w;if(S(_))return l(_,he);if(U==Q||U==X||me&&!J){if(le=ue||me?{}:k(_),!he)return ue?u(_,n(le,_)):d(_,s(le,_))}else{if(!N[U])return J?_:{};le=p(_,U,he)}}D||(D=new r);var Oe=D.get(_);if(Oe)return Oe;D.set(_,le),T(_)?_.forEach(function(Ie){le.add(q(Ie,C,j,Ie,_,D))}):b(_)&&_.forEach(function(Ie,Fe){le.set(Fe,q(Ie,C,j,Fe,_,D))});var Be=pe?ue?y:g:ue?H:M,Ue=ee?void 0:Be(_);return e(Ue||_,function(Ie,Fe){Ue&&(Fe=Ie,Ie=_[Fe]),t(le,Fe,q(Ie,C,j,Fe,_,D))}),le}return Zn=q,Zn}var Jn,za;function Sd(){if(za)return Jn;za=1;var r=kd(),e=1,t=4;function s(n){return r(n,e|t)}return Jn=s,Jn}var Cd=Sd();const Ee=_t(Cd);var ge=(r=>(r.TEXT="text",r.IMAGE="image",r.TABLE="table",r.PAGE_NUMBER="pageNumber",r.BARCODE="barcode",r.QRCODE="qrcode",r.LINE="line",r.RECT="rect",r.CIRCLE="circle",r))(ge||{});const Ed={mode:"local",endpoints:{baseUrl:"",templates:{list:"/api/print/templates",get:"/api/print/templates/{id}",upsert:"/api/print/templates",delete:"/api/print/templates/{id}"},customElements:{list:"/api/print/custom-elements",get:"/api/print/custom-elements/{id}",upsert:"/api/print/custom-elements",delete:"/api/print/custom-elements/{id}"}},headers:{"Content-Type":"application/json"}};let Pt={...Ed};const Td=(r,e)=>({...r}),Qe=()=>({mode:Pt.mode,endpoints:Td(Pt.endpoints),headers:{...Pt.headers||{}},fetcher:Pt.fetcher}),$d=r=>{const e=Pt.endpoints.baseUrl||"";return r?/^https?:\/\//i.test(r)||!e?r:r.startsWith("/")?`${e.replace(/\/+$/,"")}${r}`:`${e.replace(/\/+$/,"")}/${r}`:e||""},et=(r,e)=>{const t=r||"",s=e?t.replace("{id}",e):t;return $d(s)},Lt={enabled:!1,text:"",angle:-30,color:"#000000",opacity:.1,size:24,density:160},Id={title:"",logoUrl:"",showTitle:!0,showLogo:!0},Ad=()=>{const r=localStorage.getItem("print-designer-watermark");if(!r)return{...Lt};try{return{...Lt,...JSON.parse(r)}}catch{return{...Lt}}},Re=dl("designer",{state:()=>({unit:localStorage.getItem("print-designer-unit")||"mm",watermark:Ad(),branding:{...Id},pages:[{id:He(),elements:[]}],currentPageIndex:0,customElements:JSON.parse(localStorage.getItem("print-designer-custom-elements")||"[]"),testData:{},editingCustomElementId:null,customElementEditSnapshot:null,selectedElementId:null,selectedElementIds:[],selectedGuideId:null,highlightedGuideId:null,highlightedEdge:null,canvasSize:{width:794,height:1123},zoom:1,isDragging:!1,showGrid:!0,showCornerMarkers:!0,headerHeight:100,footerHeight:100,showHeaderLine:!1,showFooterLine:!1,showMinimap:!1,showHelp:!1,showSettings:!1,canvasBackground:"#ffffff",pageSpacingX:32,pageSpacingY:32,guides:[],historyPast:[],historyFuture:[],clipboard:[],copiedPage:null,isExporting:!1,disableGlobalShortcuts:!1,disableShortcutsCount:0,tableSelection:null}),actions:{setBranding(r){if(!r||typeof r!="object")return;const e={...this.branding,...r};r.showTitle!==void 0&&(e.showTitle=!!r.showTitle),r.showLogo!==void 0&&(e.showLogo=!!r.showLogo),this.branding=e},setWatermark(r){this.watermark={...this.watermark||Lt,...r},localStorage.setItem("print-designer-watermark",JSON.stringify(this.watermark))},setUnit(r){this.unit=r,localStorage.setItem("print-designer-unit",r)},setDragging(r){this.isDragging=r},setDisableGlobalShortcuts(r){const e=this.disableShortcutsCount||0;r?this.disableShortcutsCount=e+1:this.disableShortcutsCount=Math.max(0,e-1),this.disableGlobalShortcuts=this.disableShortcutsCount>0},setIsExporting(r){this.isExporting=r},setPageSpacingX(r){this.pageSpacingX=Math.max(0,Math.round(r))},setPageSpacingY(r){this.pageSpacingY=Math.max(0,Math.round(r))},resetCanvas(){this.watermark={...Lt},localStorage.setItem("print-designer-watermark",JSON.stringify(this.watermark)),this.pages=[{id:He(),elements:[]}],this.currentPageIndex=0,this.testData={},this.selectedElementId=null,this.selectedElementIds=[],this.selectedGuideId=null,this.guides=[],this.historyPast=[],this.historyFuture=[],this.headerHeight=100,this.footerHeight=100,this.showHeaderLine=!1,this.showFooterLine=!1,this.canvasBackground="#ffffff",this.pageSpacingX=32,this.pageSpacingY=32,this.canvasSize={width:794,height:1123},this.zoom=1,this.showGrid=!0,this.showCornerMarkers=!0,this.showMinimap=!1,this.showHelp=!1,this.showSettings=!1,this.copiedPage=null},startCustomElementEdit(r){const e=this.customElements.find(s=>s.id===r);if(!e)return;this.customElementEditSnapshot||(this.customElementEditSnapshot={pages:Ee(this.pages),historyPast:Ee(this.historyPast),historyFuture:Ee(this.historyFuture),canvasSize:Ee(this.canvasSize),guides:Ee(this.guides),zoom:this.zoom,showGrid:this.showGrid,headerHeight:this.headerHeight,footerHeight:this.footerHeight,showHeaderLine:this.showHeaderLine,showFooterLine:this.showFooterLine,showMinimap:this.showMinimap,canvasBackground:this.canvasBackground,pageSpacingX:this.pageSpacingX,pageSpacingY:this.pageSpacingY,unit:this.unit,watermark:Ee(this.watermark),testData:Ee(this.testData),currentPageIndex:this.currentPageIndex,selectedElementId:this.selectedElementId,selectedElementIds:Ee(this.selectedElementIds),selectedGuideId:this.selectedGuideId,highlightedGuideId:this.highlightedGuideId,highlightedEdge:this.highlightedEdge}),this.editingCustomElementId=r,this.resetCanvas();const t=Ee(e.element);t.id=He(),this.pages=[{id:He(),elements:[t]}],this.currentPageIndex=0,this.selectedElementId=t.id,this.selectedElementIds=[t.id],this.historyPast=[],this.historyFuture=[],this.guides=[],this.tableSelection=null},cancelCustomElementEdit(){const r=this.customElementEditSnapshot;this.editingCustomElementId=null,this.customElementEditSnapshot=null,r&&(this.pages=r.pages,this.historyPast=r.historyPast||[],this.historyFuture=r.historyFuture||[],this.canvasSize=r.canvasSize,this.guides=r.guides,this.zoom=r.zoom,this.showGrid=r.showGrid,this.headerHeight=r.headerHeight,this.footerHeight=r.footerHeight,this.showHeaderLine=r.showHeaderLine,this.showFooterLine=r.showFooterLine,this.showMinimap=r.showMinimap,this.canvasBackground=r.canvasBackground,this.pageSpacingX=r.pageSpacingX??this.pageSpacingX,this.pageSpacingY=r.pageSpacingY??this.pageSpacingY,this.unit=r.unit||this.unit,r.unit&&localStorage.setItem("print-designer-unit",r.unit),r.watermark&&(this.watermark=Ee(r.watermark),localStorage.setItem("print-designer-watermark",JSON.stringify(this.watermark))),this.testData=r.testData||{},this.currentPageIndex=r.currentPageIndex,this.selectedElementId=r.selectedElementId,this.selectedElementIds=r.selectedElementIds,this.selectedGuideId=r.selectedGuideId,this.highlightedGuideId=r.highlightedGuideId,this.highlightedEdge=r.highlightedEdge,this.tableSelection=null)},commitCustomElementEdit(){var t;if(!this.editingCustomElementId)return!1;const r=this.customElements.find(s=>s.id===this.editingCustomElementId);if(!r)return!1;const e=this.selectedElement||((t=this.pages[0])==null?void 0:t.elements[0]);return e?(r.element=Ee(e),this.saveCustomElements(),!0):!1},saveCustomElementEditAs(r){var t;const e=this.selectedElement||((t=this.pages[0])==null?void 0:t.elements[0]);return e?(this.addCustomElement(r,e),!0):!1},copyPage(r){const e=this.pages[r];e&&(this.copiedPage=Ee(e))},pastePage(r){if(!this.copiedPage)return;this.snapshot();const e=Ee(this.copiedPage);e.id=He(),e.elements.forEach(t=>{t.id=He()}),this.pages.splice(r+1,0,e),this.currentPageIndex=r+1},addPage(){this.snapshot(),this.pages.push({id:He(),elements:[]}),this.currentPageIndex=this.pages.length-1},removePage(r){this.pages.length<=1||(this.snapshot(),this.pages.splice(r,1),this.currentPageIndex>=this.pages.length&&(this.currentPageIndex=this.pages.length-1))},setTableSelection(r,e,t){if(this.tableSelection&&this.tableSelection.elementId!==r){this.tableSelection={elementId:r,cells:[e]};return}if(!this.tableSelection){this.tableSelection={elementId:r,cells:[e]};return}if(t){const s=this.tableSelection.cells.findIndex(n=>n.rowIndex===e.rowIndex&&n.colField===e.colField&&n.section===e.section);s>=0?(this.tableSelection.cells.splice(s,1),this.tableSelection.cells.length===0&&(this.tableSelection=null)):this.tableSelection.cells.length>0&&this.tableSelection.cells[0].section!==e.section?this.tableSelection={elementId:r,cells:[e]}:this.tableSelection.cells.push(e)}else this.tableSelection={elementId:r,cells:[e]}},setTableSelectionCells(r,e){this.tableSelection={elementId:r,cells:e}},clearTableSelection(){this.tableSelection=null},mergeSelectedCells(){if(!this.tableSelection||this.tableSelection.cells.length<2)return;const{elementId:r,cells:e}=this.tableSelection,t=e[0].section||"body";let s=null,n=-1,l=-1;for(let b=0;b<this.pages.length;b++){const f=this.pages[b].elements.findIndex(T=>T.id===r);if(f!==-1){s=this.pages[b].elements[f],n=b,l=f;break}}if(!s||!s.columns)return;const i=t==="footer"?"footerData":"data";if(!s[i])return;const d=e.map(b=>b.rowIndex),u=Math.min(...d),g=Math.max(...d),y=s.columns.map(b=>b.field),m=e.map(b=>y.indexOf(b.colField)).filter(b=>b!==-1);if(m.length!==e.length)return;const x=Math.min(...m),p=Math.max(...m),k=g-u+1,v=p-x+1;this.snapshot();const S=Ee(s[i]);for(let b=u;b<=g;b++)for(let f=x;f<=p;f++){const T=y[f],M=S[b];M&&(typeof M[T]!="object"||M[T]===null?M[T]={value:M[T]}:"value"in M[T],b===u&&f===x?(M[T].rowSpan=k,M[T].colSpan=v):(M[T].rowSpan=0,M[T].colSpan=0,M[T].value=""))}this.pages[n].elements[l]={...s,[i]:S},this.tableSelection=null},splitSelectedCells(){if(!this.tableSelection||this.tableSelection.cells.length!==1)return;const{elementId:r,cells:e}=this.tableSelection,t=e[0],s=t.section||"body";let n=null,l=-1,i=-1;for(let v=0;v<this.pages.length;v++){const S=this.pages[v].elements.findIndex(b=>b.id===r);if(S!==-1){n=this.pages[v].elements[S],l=v,i=S;break}}if(!n||!n.columns)return;const d=s==="footer"?"footerData":"data";if(!n[d])return;const u=n[d][t.rowIndex];if(!u)return;const g=u[t.colField];if(!g||typeof g!="object"||!g.rowSpan&&!g.colSpan)return;const y=g.rowSpan||1,m=g.colSpan||1;if(y<=1&&m<=1)return;this.snapshot();const x=Ee(n[d]),p=n.columns.map(v=>v.field),k=p.indexOf(t.colField);for(let v=t.rowIndex;v<t.rowIndex+y;v++)for(let S=k;S<k+m;S++){const b=p[S],f=x[v];f&&f[b]&&typeof f[b]=="object"&&(f[b].rowSpan=1,f[b].colSpan=1)}this.pages[l].elements[i]={...n,[d]:x},this.tableSelection=null},setHeaderHeight(r){this.headerHeight=r},setFooterHeight(r){this.footerHeight=r},setShowHeaderLine(r){this.showHeaderLine=r},setShowFooterLine(r){this.showFooterLine=r},setShowMinimap(r){this.showMinimap=r},setShowHelp(r){this.showHelp=r},setShowSettings(r){this.showSettings=r},setCanvasBackground(r){this.canvasBackground=r},snapshot(){this.historyPast.length>=20&&this.historyPast.shift(),this.historyPast.push(Ee(this.pages)),this.historyFuture=[]},undo(){if(this.historyPast.length===0)return;const r=this.historyPast.pop();this.historyFuture.push(Ee(this.pages)),this.pages=Ee(r),this.selectedElementId&&(this.pages.some(t=>t.elements.some(s=>s.id===this.selectedElementId))||(this.selectedElementId=null,this.selectedElementIds=[])),this.selectedElementIds=this.selectedElementIds.filter(e=>this.pages.some(t=>t.elements.some(s=>s.id===e))),this.currentPageIndex>=this.pages.length&&(this.currentPageIndex=Math.max(0,this.pages.length-1))},redo(){if(this.historyFuture.length===0)return;const r=this.historyFuture.pop();this.historyPast.push(Ee(this.pages)),this.pages=Ee(r),this.currentPageIndex>=this.pages.length&&(this.currentPageIndex=Math.max(0,this.pages.length-1))},addGuide(r){this.guides.push({...r,id:He()})},updateGuide(r,e){const t=this.guides.find(s=>s.id===r);t&&(t.position=e)},removeGuide(r){const e=this.guides.findIndex(t=>t.id===r);e!==-1&&(this.guides.splice(e,1),this.selectedGuideId===r&&(this.selectedGuideId=null))},clearGuides(){this.guides=[]},selectGuide(r){this.selectedGuideId=r,r&&(this.selectedElementId=null,this.selectedElementIds=[],this.tableSelection=null)},setHighlightedGuide(r){this.highlightedGuideId=r},setHighlightedEdge(r){this.highlightedEdge=r},setShowCornerMarkers(r){this.showCornerMarkers=r},getSnapPosition(r,e,t,s=!1,n=!0,l=-1){let d=e,u=t,g=null,y=null;const m=(f,T,M)=>{const H=Math.abs(f-M);if(H>5)return!1;if(s){const R=Math.abs(T-M);return H<R}return!0},x=Math.max(0,this.canvasSize.width-r.width),p=Math.max(0,this.canvasSize.height-r.height);m(d,r.x,0)?(d=0,y="left"):m(d+r.width,r.x+r.width,this.canvasSize.width)&&(d=x,y="right"),m(u,r.y,0)?(u=0,y=y||"top"):m(u+r.height,r.y+r.height,this.canvasSize.height)&&(u=p,y=y||"bottom");for(const f of this.guides)f.type==="vertical"?m(d,r.x,f.position)?(d=f.position,g=f.id):m(d+r.width,r.x+r.width,f.position)&&(d=f.position-r.width,g=f.id):m(u,r.y,f.position)?(u=f.position,g=f.id):m(u+r.height,r.y+r.height,f.position)&&(u=f.position-r.height,g=f.id);let k=n,v=n,S=!1,b=!1;return n||(this.pages.length<=1?(k=!0,v=!0):(k=!0,l===0&&(S=!0),l===this.pages.length-1&&(b=!0))),k&&(d=Math.min(Math.max(0,d),x)),v?u=Math.min(Math.max(0,u),p):(S&&(u=Math.max(0,u)),b&&(u=Math.min(u,p))),{x:d,y:u,highlightedGuideId:g,highlightedEdge:y}},moveElementWithSnap(r,e,t,s=!0,n=!0){for(let l=0;l<this.pages.length;l++){const i=this.pages[l],d=i.elements.findIndex(u=>u.id===r);if(d!==-1){const u=i.elements[d];if(u.locked)return;const g=this.getSnapPosition(u,e,t,!1,n,l);this.setHighlightedGuide(g.highlightedGuideId||null),this.setHighlightedEdge(g.highlightedEdge||null),this.updateElement(r,{x:g.x,y:g.y},s);return}}},moveSelectedElements(r,e,t,s=!0,n=!0){s&&this.snapshot();let l=null,i=-1;const d=[],u=new Set(this.selectedElementIds);for(let k=0;k<this.pages.length;k++){const v=this.pages[k];for(let S=0;S<v.elements.length;S++){const b=v.elements[S];b.id===r&&(l=b,i=k),u.has(b.id)&&!b.locked&&d.push({pageIndex:k,elementIndex:S,element:b})}}if(!l||l.locked)return;const g=this.getSnapPosition(l,e,t,!1,n,i);this.setHighlightedGuide(g.highlightedGuideId||null),this.setHighlightedEdge(g.highlightedEdge||null);let y=g.x-l.x,m=g.y-l.y;if(y===0&&m===0)return;let x=n,p=n;if(n||(this.pages.length<=1?(x=!0,p=!0):(x=!0,p=!1)),x||p||!p&&this.pages.length>1)for(const k of d){const v=k.element,S=k.pageIndex;if(x)if(y>0){const b=this.canvasSize.width-v.width;v.x+y>b&&(y=b-v.x)}else y<0&&v.x+y<0&&(y=-v.x);if(p)if(m>0){const b=this.canvasSize.height-v.height;v.y+m>b&&(m=b-v.y)}else m<0&&v.y+m<0&&(m=-v.y);else if(S===0&&m<0&&v.y+m<0&&(m=-v.y),S===this.pages.length-1&&m>0){const b=this.canvasSize.height-v.height;v.y+m>b&&(m=b-v.y)}}if(!(y===0&&m===0))for(const k of d){const{pageIndex:v,elementIndex:S,element:b}=k;this.pages[v].elements[S]={...b,x:b.x+y,y:b.y+m}}},nudgeSelectedElements(r,e){if(this.selectedElementIds.length===0)return;const t=this.selectedElementIds.filter(y=>{for(const m of this.pages){const x=m.elements.find(p=>p.id===y);if(x&&!x.locked)return!0}return!1});if(t.length===0)return;this.snapshot();let s=this.selectedElementId;(!s||!t.includes(s))&&(s=t[0]);let n=null;for(const y of this.pages){const m=y.elements.find(x=>x.id===s);if(m){n=m;break}}if(!n)return;const l=n.x+r,i=n.y+e,d=this.getSnapPosition(n,l,i,!0);this.setHighlightedGuide(d.highlightedGuideId||null),this.setHighlightedEdge(d.highlightedEdge||null);let u=d.x-n.x,g=d.y-n.y;for(const y of t)for(const m of this.pages){const x=m.elements.find(p=>p.id===y);if(x){if(u>0){const p=this.canvasSize.width-x.width;x.x+u>p&&(u=p-x.x)}else u<0&&x.x+u<0&&(u=-x.x);if(g>0){const p=this.canvasSize.height-x.height;x.y+g>p&&(g=p-x.y)}else g<0&&x.y+g<0&&(g=-x.y)}}if(!(u===0&&g===0))for(const y of t)for(const m of this.pages){const x=m.elements.findIndex(p=>p.id===y);if(x!==-1){const p=m.elements[x];m.elements[x]={...p,x:p.x+u,y:p.y+g};break}}},addElement(r,e){this.snapshot();const t={...r,id:He()},s=e!==void 0&&e>=0&&e<this.pages.length?e:this.currentPageIndex;this.pages[s].elements.push(t),this.selectedElementId=t.id,this.currentPageIndex=s},moveElementToPage(r,e,t,s){this.snapshot();let n=-1,l=-1,i;for(let d=0;d<this.pages.length;d++){const u=this.pages[d].elements.findIndex(g=>g.id===r);if(u!==-1){n=d,l=u,i=this.pages[d].elements[u];break}}!i||n===-1||(this.pages[n].elements.splice(l,1),i.x=t,i.y=s,e>=0&&e<this.pages.length?(this.pages[e].elements.push(i),this.currentPageIndex=e):this.pages[n].elements.push(i))},updateElement(r,e,t=!0){t&&this.snapshot();for(const s of this.pages){const n=s.elements.findIndex(l=>l.id===r);if(n!==-1){if(s.elements[n].locked&&e.locked===void 0)return;s.elements[n]={...s.elements[n],...e};return}}},removeElement(r){for(const e of this.pages){const t=e.elements.find(s=>s.id===r);if(t&&t.locked)return}this.snapshot();for(const e of this.pages){const t=e.elements.findIndex(s=>s.id===r);if(t!==-1){e.elements.splice(t,1),this.selectedElementId===r&&(this.selectedElementId=null),this.tableSelection&&this.tableSelection.elementId===r&&(this.tableSelection=null);const s=this.selectedElementIds.indexOf(r);s!==-1&&this.selectedElementIds.splice(s,1);return}}},selectElement(r,e=!1){if(r&&(this.selectedGuideId=null),this.tableSelection&&(this.tableSelection=null),e&&r){if(this.selectedElementIds.includes(r)){const t=this.selectedElementIds.indexOf(r);this.selectedElementIds.splice(t,1)}else this.selectedElementIds.push(r);this.selectedElementId=this.selectedElementIds.length>0?this.selectedElementIds[this.selectedElementIds.length-1]:null}else this.selectedElementId=r,this.selectedElementIds=r?[r]:[];if(r){const t=this.pages.findIndex(s=>s.elements.some(n=>n.id===r));t!==-1&&(this.currentPageIndex=t)}},clearSelection(){this.selectedElementId=null,this.selectedElementIds=[],this.tableSelection=null},setSelection(r){if(this.tableSelection=null,r.length>0&&(this.selectedGuideId=null),this.selectedElementIds=r,this.selectedElementId=r.length>0?r[r.length-1]:null,r.length>0){const e=this.pages.findIndex(t=>t.elements.some(s=>s.id===this.selectedElementId));e!==-1&&(this.currentPageIndex=e)}},removeSelectedElements(){if(this.selectedElementIds.length===0)return;const r=this.selectedElementIds.filter(e=>{for(const t of this.pages){const s=t.elements.find(n=>n.id===e);if(s&&!s.locked)return!0}return!1});if(r.length!==0){this.snapshot();for(const e of r)for(const t of this.pages){const s=t.elements.findIndex(n=>n.id===e);if(s!==-1){t.elements.splice(s,1);break}}this.selectedElementId=null,this.selectedElementIds=[],this.tableSelection=null}},alignSelectedElements(r){if(this.selectedElementIds.length===0)return;const e=[];for(const t of this.selectedElementIds)for(const s of this.pages){const n=s.elements.find(l=>l.id===t);if(n&&!n.locked){e.push(n);break}}if(e.length!==0)if(this.snapshot(),e.length===1){const t=e[0],s=this.canvasSize.width,n=this.canvasSize.height;switch(r){case"left":t.x=0;break;case"center":t.x=(s-t.width)/2;break;case"right":t.x=s-t.width;break;case"top":t.y=0;break;case"middle":t.y=(n-t.height)/2;break;case"bottom":t.y=n-t.height;break}}else{const t=Math.min(...e.map(u=>u.x)),s=Math.max(...e.map(u=>u.x+u.width)),n=Math.min(...e.map(u=>u.y)),l=Math.max(...e.map(u=>u.y+u.height)),i=(t+s)/2,d=(n+l)/2;e.forEach(u=>{switch(r){case"left":u.x=t;break;case"center":u.x=i-u.width/2;break;case"right":u.x=s-u.width;break;case"top":u.y=n;break;case"middle":u.y=d-u.height/2;break;case"bottom":u.y=l-u.height;break}})}},resizeSelectedElements(r,e){if(this.selectedElementIds.length===0)return;const t=this.selectedElementIds.filter(s=>{for(const n of this.pages){const l=n.elements.find(i=>i.id===s);if(l&&!l.locked)return!0}return!1});if(t.length!==0){this.snapshot();for(const s of t)for(const n of this.pages){const l=n.elements.findIndex(i=>i.id===s);if(l!==-1){const i=n.elements[l],d=Math.max(10,i.width+r),u=Math.max(10,i.height+e);n.elements[l]={...i,width:d,height:u};break}}}},updateSelectedElementsStyle(r){if(this.selectedElementIds.length===0)return;this.selectedElementIds.some(t=>{for(const s of this.pages){const n=s.elements.find(l=>l.id===t);if(n&&n.locked)return!0}return!1});const e=this.selectedElementIds.filter(t=>{for(const s of this.pages){const n=s.elements.find(l=>l.id===t);if(n&&!n.locked)return!0}return!1});if(e.length!==0){this.snapshot();for(const t of e)for(const s of this.pages){const n=s.elements.findIndex(l=>l.id===t);if(n!==-1){const l=s.elements[n];s.elements[n]={...l,style:{...l.style,...r}};break}}}},toggleLock(){if(this.selectedElementIds.length===0)return;this.snapshot();let r=!0;const e=this.selectedElement;e&&(r=!e.locked);for(const t of this.selectedElementIds)for(const s of this.pages){const n=s.elements.findIndex(l=>l.id===t);if(n!==-1){s.elements[n].locked=r;break}}},setZoom(r){this.zoom=r},setCanvasSize(r,e){this.snapshot(),this.canvasSize={width:r,height:e}},setShowGrid(r){this.showGrid=r},deletePage(r){this.pages.length>1&&(this.snapshot(),this.pages.splice(r,1),this.currentPageIndex>=this.pages.length&&(this.currentPageIndex=this.pages.length-1))},copy(){if(this.selectedElementIds.length===0)return;const r=[];for(const e of this.selectedElementIds)for(const t of this.pages){const s=t.elements.find(n=>n.id===e);if(s&&!s.locked){r.push(Ee(s));break}}this.clipboard=r},cut(){this.selectedElementIds.length!==0&&(this.copy(),this.removeSelectedElements())},paste(r){if(this.clipboard.length===0)return;this.snapshot();const e=[],t=(r==null?void 0:r.pageIndex)??this.currentPageIndex;let s=1/0,n=1/0;if(r)for(const l of this.clipboard)s=Math.min(s,l.x),n=Math.min(n,l.y);for(const l of this.clipboard){const i=Ee(l);if(i.id=He(),r){const d=l.x-s,u=l.y-n;i.x=r.x+d,i.y=r.y+u}else i.x+=20,i.y+=20;i.x+i.width>this.canvasSize.width&&(i.x=Math.max(0,this.canvasSize.width-i.width)),i.y+i.height>this.canvasSize.height&&(i.y=Math.max(0,this.canvasSize.height-i.height)),i.x=Math.max(0,i.x),i.y=Math.max(0,i.y),this.pages[t]?this.pages[t].elements.push(i):this.pages[this.currentPageIndex].elements.push(i),e.push(i.id)}t!==this.currentPageIndex&&this.pages[t]&&(this.currentPageIndex=t),this.setSelection(e)},paginateTable(r){this.snapshot();let e=-1,t;for(let v=0;v<this.pages.length;v++){const S=this.pages[v].elements.findIndex(b=>b.id===r);if(S!==-1){e=v,t=this.pages[v].elements[S];break}}if(!t||t.type!==ge.TABLE||!t.data)return;const s=this.canvasSize.height,n=50,l=t.style.headerHeight||40,i=t.style.rowHeight||30,d=t.y,g=s-d-n-l,y=Math.floor(Math.max(0,g)/i);if(y>=t.data.length)return;const m=t.data.slice(0,y),x=t.data.slice(y);this.updateElement(t.id,{data:m,height:l+m.length*i});const p=e+1;p>=this.pages.length&&this.addPage();const k={...Ee(t),id:He(),y:50,data:x,height:l+x.length*i};this.pages[p].elements.push(k),this.paginateTable(k.id)},groupSelectedElements(){this.selectedElementIds.length<2||(console.log("Group selected elements:",this.selectedElementIds),alert("Grouping feature is under development"))},async loadCustomElements(){var n;const{mode:r,endpoints:e,headers:t,fetcher:s}=Qe();if(r==="remote")try{const l=et(((n=e.customElements)==null?void 0:n.list)||""),d=await(await(s||fetch)(l,{headers:t})).json(),u=Array.isArray(d)?d:(d==null?void 0:d.customElements)||[];this.customElements=u.filter(g=>g&&typeof g.id=="string"&&typeof g.name=="string"&&g.element).map(g=>({id:g.id,name:g.name,element:Ee(g.element)}))}catch(l){console.error("Failed to load custom elements",l)}},async addCustomElement(r,e){var d;const{mode:t,endpoints:s,headers:n,fetcher:l}=Qe(),i={id:He(),name:r,element:Ee(e)};if(t==="remote")try{const u=et(((d=s.customElements)==null?void 0:d.upsert)||""),y=await(await(l||fetch)(u,{method:"POST",headers:n,body:JSON.stringify(i)})).json();i.id=(y==null?void 0:y.id)||i.id}catch(u){console.error("Failed to add custom element",u)}this.customElements.push(i),t!=="remote"&&this.saveCustomElements()},async removeCustomElement(r){var i;const{mode:e,endpoints:t,headers:s,fetcher:n}=Qe(),l=this.customElements.findIndex(d=>d.id===r);if(l!==-1){if(this.customElements.splice(l,1),e==="remote"){try{const d=et(((i=t.customElements)==null?void 0:i.delete)||"",r);await(n||fetch)(d,{method:"DELETE",headers:s})}catch(d){console.error("Failed to remove custom element",d)}return}this.saveCustomElements()}},async renameCustomElement(r,e){var d;const{mode:t,endpoints:s,headers:n,fetcher:l}=Qe(),i=this.customElements.find(u=>u.id===r);if(i){if(i.name=e,t==="remote"){try{const u=et(((d=s.customElements)==null?void 0:d.upsert)||"");await(l||fetch)(u,{method:"POST",headers:n,body:JSON.stringify(i)})}catch(u){console.error("Failed to rename custom element",u)}return}this.saveCustomElements()}},saveCustomElements(){localStorage.setItem("print-designer-custom-elements",JSON.stringify(this.customElements))}},getters:{selectedElement:r=>{if(!r.selectedElementId)return null;for(const e of r.pages){const t=e.elements.find(s=>s.id===r.selectedElementId);if(t)return t}return null},currentPage:r=>r.pages[r.currentPageIndex],editingCustomElement:r=>r.editingCustomElementId&&r.customElements.find(e=>e.id===r.editingCustomElementId)||null}}),Zt=dl("templates",{state:()=>({templates:[],currentTemplateId:null,isSaving:!1}),actions:{async loadTemplates(){var l;const{mode:r,endpoints:e,headers:t,fetcher:s}=Qe();if(r==="remote")try{const i=et(((l=e.templates)==null?void 0:l.list)||""),u=await(await(s||fetch)(i,{headers:t})).json(),g=Array.isArray(u)?u:(u==null?void 0:u.templates)||[];this.templates=g.filter(y=>y&&typeof y.id=="string"&&typeof y.name=="string").map(y=>({id:y.id,name:y.name,data:y.data||{},updatedAt:y.updatedAt||Date.now()})).sort((y,m)=>m.updatedAt-y.updatedAt);return}catch(i){console.error("Failed to load templates",i)}const n=localStorage.getItem("print-designer-templates");if(n)try{this.templates=JSON.parse(n),this.templates.sort((i,d)=>d.updatedAt-i.updatedAt)}catch(i){console.error("Failed to parse templates",i),this.templates=[]}},saveToLocalStorage(){localStorage.setItem("print-designer-templates",JSON.stringify(this.templates))},async saveCurrentTemplate(r){var u;const{mode:e,endpoints:t,headers:s,fetcher:n}=Qe(),l=Re(),i=this.currentTemplateId,d={pages:Ee(l.pages),canvasSize:Ee(l.canvasSize),guides:Ee(l.guides),zoom:l.zoom,showGrid:l.showGrid,headerHeight:l.headerHeight,footerHeight:l.footerHeight,showHeaderLine:l.showHeaderLine,showFooterLine:l.showFooterLine,showMinimap:l.showMinimap,canvasBackground:l.canvasBackground,pageSpacingX:l.pageSpacingX,pageSpacingY:l.pageSpacingY,unit:l.unit,watermark:Ee(l.watermark),testData:Ee(l.testData||{})};this.isSaving=!0;try{if(e==="remote"){const g={id:i||He(),name:r,data:d,updatedAt:Date.now()},y=et(((u=t.templates)==null?void 0:u.upsert)||""),x=await(await(n||fetch)(y,{method:"POST",headers:s,body:JSON.stringify(g)})).json(),p=(x==null?void 0:x.id)||g.id,k=this.templates.findIndex(S=>S.id===p),v={...g,id:p};k>=0?this.templates[k]=v:this.templates.unshift(v),this.currentTemplateId=p;return}if(i){const g=this.templates.findIndex(y=>y.id===i);g!==-1?(this.templates[g].data=d,this.templates[g].name=r,this.templates[g].updatedAt=Date.now()):this.createTemplate(r,d)}else this.createTemplate(r,d);this.saveToLocalStorage()}finally{this.isSaving=!1}},async createTemplate(r,e){var g;const{mode:t,endpoints:s,headers:n,fetcher:l}=Qe(),i=Re(),d=e||{pages:i.pages,canvasSize:i.canvasSize,pageSpacingX:i.pageSpacingX,pageSpacingY:i.pageSpacingY,unit:i.unit,watermark:i.watermark,testData:Ee(i.testData||{})},u={id:He(),name:r,data:d,updatedAt:Date.now()};if(t==="remote")try{const y=et(((g=s.templates)==null?void 0:g.upsert)||""),x=await(await(l||fetch)(y,{method:"POST",headers:n,body:JSON.stringify(u)})).json(),p=(x==null?void 0:x.id)||u.id;u.id=p}catch(y){console.error("Failed to create template",y)}this.templates.unshift(u),this.currentTemplateId=u.id,t!=="remote"&&this.saveToLocalStorage()},async deleteTemplate(r){var l;const{mode:e,endpoints:t,headers:s,fetcher:n}=Qe();if(this.templates=this.templates.filter(i=>i.id!==r),this.currentTemplateId===r&&(this.currentTemplateId=null),e==="remote"){try{const i=et(((l=t.templates)==null?void 0:l.delete)||"",r);await(n||fetch)(i,{method:"DELETE",headers:s})}catch(i){console.error("Failed to delete template",i)}return}this.saveToLocalStorage()},async renameTemplate(r,e){var d;const{mode:t,endpoints:s,headers:n,fetcher:l}=Qe(),i=this.templates.find(u=>u.id===r);if(i){if(i.name=e,i.updatedAt=Date.now(),t==="remote"){try{const u=et(((d=s.templates)==null?void 0:d.upsert)||"");await(l||fetch)(u,{method:"POST",headers:n,body:JSON.stringify(i)})}catch(u){console.error("Failed to rename template",u)}return}this.saveToLocalStorage()}},async copyTemplate(r){var i;const{mode:e,endpoints:t,headers:s,fetcher:n}=Qe(),l=this.templates.find(d=>d.id===r);if(l){const d={id:He(),name:`${l.name} Copy`,data:JSON.parse(JSON.stringify(l.data)),updatedAt:Date.now()};if(e==="remote")try{const u=et(((i=t.templates)==null?void 0:i.upsert)||""),y=await(await(n||fetch)(u,{method:"POST",headers:s,body:JSON.stringify(d)})).json();d.id=(y==null?void 0:y.id)||d.id}catch(u){console.error("Failed to copy template",u)}this.templates.unshift(d),e!=="remote"&&this.saveToLocalStorage()}},async loadTemplate(r){var i;const{mode:e,endpoints:t,headers:s,fetcher:n}=Qe();if(e==="remote")try{const d=et(((i=t.templates)==null?void 0:i.get)||"",r),g=await(await(n||fetch)(d,{headers:s})).json(),y=(g==null?void 0:g.template)||g;if(!y)return;const m=Re();m.resetCanvas();const x=y.data||{};x.pages&&(m.pages=x.pages),x.canvasSize&&(m.canvasSize=x.canvasSize),x.guides&&(m.guides=x.guides),x.zoom!==void 0&&(m.zoom=x.zoom),x.showGrid!==void 0&&(m.showGrid=x.showGrid),x.headerHeight!==void 0&&(m.headerHeight=x.headerHeight),x.footerHeight!==void 0&&(m.footerHeight=x.footerHeight),x.showHeaderLine!==void 0&&(m.showHeaderLine=x.showHeaderLine),x.showFooterLine!==void 0&&(m.showFooterLine=x.showFooterLine),x.showMinimap!==void 0&&(m.showMinimap=x.showMinimap),x.canvasBackground!==void 0&&(m.canvasBackground=x.canvasBackground),x.pageSpacingX!==void 0&&(m.pageSpacingX=x.pageSpacingX),x.pageSpacingY!==void 0&&(m.pageSpacingY=x.pageSpacingY),x.unit!==void 0&&(m.unit=x.unit),x.watermark!==void 0&&(m.watermark=x.watermark),m.testData=x.testData||{},m.selectedElementId=null,m.selectedGuideId=null,m.historyPast=[],m.historyFuture=[],this.currentTemplateId=y.id||r;return}catch(d){console.error("Failed to load template",d);return}const l=this.templates.find(d=>d.id===r);if(l){const d=Re();d.resetCanvas();const u=l.data;u.pages&&(d.pages=u.pages),u.canvasSize&&(d.canvasSize=u.canvasSize),u.guides&&(d.guides=u.guides),u.zoom!==void 0&&(d.zoom=u.zoom),u.showGrid!==void 0&&(d.showGrid=u.showGrid),u.headerHeight!==void 0&&(d.headerHeight=u.headerHeight),u.footerHeight!==void 0&&(d.footerHeight=u.footerHeight),u.showHeaderLine!==void 0&&(d.showHeaderLine=u.showHeaderLine),u.showFooterLine!==void 0&&(d.showFooterLine=u.showFooterLine),u.showMinimap!==void 0&&(d.showMinimap=u.showMinimap),u.canvasBackground!==void 0&&(d.canvasBackground=u.canvasBackground),u.pageSpacingX!==void 0&&(d.pageSpacingX=u.pageSpacingX),u.pageSpacingY!==void 0&&(d.pageSpacingY=u.pageSpacingY),u.unit!==void 0&&(d.unit=u.unit),u.watermark!==void 0&&(d.watermark=u.watermark),d.testData=u.testData||{},d.selectedElementId=null,d.selectedGuideId=null,d.historyPast=[],d.historyFuture=[],this.currentTemplateId=r}}}}),$l=ie(localStorage.getItem("print-designer-autosave")!=="false");Ae($l,r=>{localStorage.setItem("print-designer-autosave",String(r))});function Il(){return{autoSave:$l}}const Ut=ie(localStorage.getItem("print-designer-theme")||"system"),Al=ie(window.matchMedia("(prefers-color-scheme: dark)").matches),Qn=window.matchMedia("(prefers-color-scheme: dark)");var il;(il=Qn.addEventListener)==null||il.call(Qn,"change",r=>{Al.value=r.matches});const zl=fe(()=>Ut.value==="dark"?!0:Ut.value==="light"?!1:Al.value),zd=r=>{Ut.value=r,localStorage.setItem("print-designer-theme",r)};Ae(zl,r=>{document.documentElement.classList.toggle("dark",r)},{immediate:!0});function So(){return{theme:Ut,isDark:zl,setTheme:zd}}var eo,Pa;function Pd(){if(Pa)return eo;Pa=1;var r=rt(),e=function(){return r.Date.now()};return eo=e,eo}var to,La;function Ld(){if(La)return to;La=1;var r=/\s/;function e(t){for(var s=t.length;s--&&r.test(t.charAt(s)););return s}return to=e,to}var ro,Ma;function Md(){if(Ma)return ro;Ma=1;var r=Ld(),e=/^\s+/;function t(s){return s&&s.slice(0,r(s)+1).replace(e,"")}return ro=t,ro}var no,Ra;function Rd(){if(Ra)return no;Ra=1;var r=Bt(),e=kt(),t="[object Symbol]";function s(n){return typeof n=="symbol"||e(n)&&r(n)==t}return no=s,no}var oo,Da;function Dd(){if(Da)return oo;Da=1;var r=Md(),e=mt(),t=Rd(),s=NaN,n=/^[-+]0x[0-9a-f]+$/i,l=/^0b[01]+$/i,i=/^0o[0-7]+$/i,d=parseInt;function u(g){if(typeof g=="number")return g;if(t(g))return s;if(e(g)){var y=typeof g.valueOf=="function"?g.valueOf():g;g=e(y)?y+"":y}if(typeof g!="string")return g===0?g:+g;g=r(g);var m=l.test(g);return m||i.test(g)?d(g.slice(2),m?2:8):n.test(g)?s:+g}return oo=u,oo}var so,Ba;function Bd(){if(Ba)return so;Ba=1;var r=mt(),e=Pd(),t=Dd(),s="Expected a function",n=Math.max,l=Math.min;function i(d,u,g){var y,m,x,p,k,v,S=0,b=!1,f=!1,T=!0;if(typeof d!="function")throw new TypeError(s);u=t(u)||0,r(g)&&(b=!!g.leading,f="maxWait"in g,x=f?n(t(g.maxWait)||0,u):x,T="trailing"in g?!!g.trailing:T);function M(O){var h=y,w=m;return y=m=void 0,S=O,p=d.apply(w,h),p}function H(O){return S=O,k=setTimeout(W,u),b?M(O):p}function R(O){var h=O-v,w=O-S,Y=u-h;return f?l(Y,x-w):Y}function A(O){var h=O-v,w=O-S;return v===void 0||h>=u||h<0||f&&w>=x}function W(){var O=e();if(A(O))return X(O);k=setTimeout(W,R(O))}function X(O){return k=void 0,T&&y?M(O):(y=m=void 0,p)}function se(){k!==void 0&&clearTimeout(k),S=0,y=v=m=k=void 0}function G(){return k===void 0?p:X(e())}function $(){var O=e(),h=A(O);if(y=arguments,m=this,v=O,h){if(k===void 0)return H(v);if(f)return clearTimeout(k),k=setTimeout(W,u),M(v)}return k===void 0&&(k=setTimeout(W,u)),p}return $.cancel=se,$.flush=G,$}return so=i,so}var Od=Bd();const qd=_t(Od),Pl=96/25.4,Fd=25.4/96,Ll=96/72,Nd=72/96;function uo(r){return Number((r*Fd).toFixed(1))}function jd(r){return Math.round(r*Pl)}function Hd(r){return Number((r*Nd).toFixed(1))}function Ud(r){return Math.round(r*Ll)}function ot(r,e){return e==="mm"?uo(r):e==="pt"?Hd(r):Math.round(r)}function Ye(r,e){return e==="mm"?jd(r):e==="pt"?Ud(r):Math.round(r)}function Dt(r,e,t){r=r%360,r<0&&(r+=360),e=Math.max(0,Math.min(1,e)),t=Math.max(0,Math.min(1,t));const s=t*e,n=s*(1-Math.abs(r/60%2-1)),l=t-s;let i=0,d=0,u=0;return r>=0&&r<60?(i=s,d=n,u=0):r>=60&&r<120?(i=n,d=s,u=0):r>=120&&r<180?(i=0,d=s,u=n):r>=180&&r<240?(i=0,d=n,u=s):r>=240&&r<300?(i=n,d=0,u=s):(i=s,d=0,u=n),{r:Math.round((i+l)*255),g:Math.round((d+l)*255),b:Math.round((u+l)*255)}}function Oa(r,e,t){r/=255,e/=255,t/=255;const s=Math.max(r,e,t),n=Math.min(r,e,t),l=s-n;let i=0;const d=s===0?0:l/s,u=s;if(s!==n){switch(s){case r:i=(e-t)/l+(e<t?6:0);break;case e:i=(t-r)/l+2;break;case t:i=(r-e)/l+4;break}i/=6}return{h:i*360,s:d,v:u}}function Mt(r){if(!r)return null;if(r==="transparent")return{h:0,s:0,v:0,a:0};if(r.startsWith("#")){const e=r.slice(1);let t=0,s=0,n=0,l=1;if(e.length===3)t=parseInt(e[0]+e[0],16),s=parseInt(e[1]+e[1],16),n=parseInt(e[2]+e[2],16);else if(e.length===6)t=parseInt(e.substring(0,2),16),s=parseInt(e.substring(2,4),16),n=parseInt(e.substring(4,6),16);else if(e.length===8)t=parseInt(e.substring(0,2),16),s=parseInt(e.substring(2,4),16),n=parseInt(e.substring(4,6),16),l=parseInt(e.substring(6,8),16)/255;else return null;return{...Oa(t,s,n),a:l}}if(r.startsWith("rgb")){const e=r.match(/rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*([\d.]+))?\)/);if(e){const t=parseInt(e[1]),s=parseInt(e[2]),n=parseInt(e[3]),l=e[4]!==void 0?parseFloat(e[4]):1;return{...Oa(t,s,n),a:l}}}return null}function qa(r,e,t,s=1){const{r:n,g:l,b:i}=Dt(r,e,t),d=u=>{const g=Math.round(u).toString(16);return g.length===1?"0"+g:g};if(s>=1)return`#${d(n)}${d(l)}${d(i)}`;{const u=Math.round(s*255);return`#${d(n)}${d(l)}${d(i)}${d(u)}`}}function Vd(r,e,t,s=1){const{r:n,g:l,b:i}=Dt(r,e,t);return`rgba(${n}, ${l}, ${i}, ${parseFloat(s.toFixed(2))})`}const Wd={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function Gd(r,e){return z(),F("svg",Wd,[...e[0]||(e[0]=[o("path",{fill:"currentColor",d:"M18 7H6V3h12zm0 5.5q.425 0 .713-.288T19 11.5t-.288-.712T18 10.5t-.712.288T17 11.5t.288.713t.712.287M16 19v-4H8v4zm2 2H6v-4H2v-6q0-1.275.875-2.137T5 8h14q1.275 0 2.138.863T22 11v6h-4z"},null,-1)])])}const Co=Se({name:"material-symbols-print",render:Gd}),Kd={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function Yd(r,e){return z(),F("svg",Kd,[...e[0]||(e[0]=[o("path",{fill:"currentColor",d:"M5 21q-.825 0-1.412-.587T3 19V5q0-.825.588-1.412T5 3h14q.825 0 1.413.588T21 5v14q0 .825-.587 1.413T19 21zm0-2h14V7H5zm7-2q-2.05 0-3.662-1.112T6 13q.725-1.775 2.338-2.887T12 9t3.663 1.113T18 13q-.725 1.775-2.337 2.888T12 17m0-2.5q-.625 0-1.062-.437T10.5 13t.438-1.062T12 11.5t1.063.438T13.5 13t-.437 1.063T12 14.5m0 1q1.05 0 1.775-.725T14.5 13t-.725-1.775T12 10.5t-1.775.725T9.5 13t.725 1.775T12 15.5"},null,-1)])])}const Xd=Se({name:"material-symbols-preview",render:Yd}),Zd={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function Jd(r,e){return z(),F("svg",Zd,[...e[0]||(e[0]=[o("path",{fill:"currentColor",d:"m12 16l-5-5l1.4-1.45l2.6 2.6V4h2v8.15l2.6-2.6L17 11zm-6 4q-.825 0-1.412-.587T4 18v-3h2v3h12v-3h2v3q0 .825-.587 1.413T18 20z"},null,-1)])])}const Vt=Se({name:"material-symbols-file-download",render:Jd}),Qd={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function eu(r,e){return z(),F("svg",Qd,[...e[0]||(e[0]=[o("path",{fill:"currentColor",d:"M9 12.5h1v-2h1q.425 0 .713-.288T12 9.5v-1q0-.425-.288-.712T11 7.5H9zm1-3v-1h1v1zm3 3h2q.425 0 .713-.288T16 11.5v-3q0-.425-.288-.712T15 7.5h-2zm1-1v-3h1v3zm3 1h1v-2h1v-1h-1v-1h1v-1h-2zM8 18q-.825 0-1.412-.587T6 16V4q0-.825.588-1.412T8 2h12q.825 0 1.413.588T22 4v12q0 .825-.587 1.413T20 18zm-4 4q-.825 0-1.412-.587T2 20V6h2v14h14v2z"},null,-1)])])}Se({name:"material-symbols-picture-as-pdf",render:eu});const tu={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function ru(r,e){return z(),F("svg",tu,[...e[0]||(e[0]=[o("path",{fill:"currentColor",d:"M5 21q-.825 0-1.412-.587T3 19V5q0-.825.588-1.412T5 3h14q.825 0 1.413.588T21 5v14q0 .825-.587 1.413T19 21zm1-4h12l-3.75-5l-3 4L9 13z"},null,-1)])])}const Fa=Se({name:"material-symbols-image",render:ru}),nu={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function ou(r,e){return z(),F("svg",nu,[...e[0]||(e[0]=[o("path",{fill:"currentColor",d:"m19.6 21l-6.3-6.3q-.75.6-1.725.95T9.5 16q-2.725 0-4.612-1.888T3 9.5t1.888-4.612T9.5 3t4.613 1.888T16 9.5q0 1.1-.35 2.075T14.7 13.3l6.3 6.3zM9.5 14q1.875 0 3.188-1.312T14 9.5t-1.312-3.187T9.5 5T6.313 6.313T5 9.5t1.313 3.188T9.5 14m-1-1.5v-2h-2v-2h2v-2h2v2h2v2h-2v2z"},null,-1)])])}const Ml=Se({name:"material-symbols-zoom-in",render:ou}),su={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function au(r,e){return z(),F("svg",su,[...e[0]||(e[0]=[o("path",{fill:"currentColor",d:"m19.6 21l-6.3-6.3q-.75.6-1.725.95T9.5 16q-2.725 0-4.612-1.888T3 9.5t1.888-4.612T9.5 3t4.613 1.888T16 9.5q0 1.1-.35 2.075T14.7 13.3l6.3 6.3zM9.5 14q1.875 0 3.188-1.312T14 9.5t-1.312-3.187T9.5 5T6.313 6.313T5 9.5t1.313 3.188T9.5 14M7 10.5v-2h5v2z"},null,-1)])])}const Rl=Se({name:"material-symbols-zoom-out",render:au}),lu={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function iu(r,e){return z(),F("svg",lu,[...e[0]||(e[0]=[o("path",{fill:"currentColor",d:"m9.25 22l-.4-3.2q-.325-.125-.612-.3t-.563-.375L4.7 19.375l-2.75-4.75l2.575-1.95Q4.5 12.5 4.5 12.338v-.675q0-.163.025-.338L1.95 9.375l2.75-4.75l2.975 1.25q.275-.2.575-.375t.6-.3l.4-3.2h5.5l.4 3.2q.325.125.613.3t.562.375l2.975-1.25l2.75 4.75l-2.575 1.95q.025.175.025.338v.674q0 .163-.05.338l2.575 1.95l-2.75 4.75l-2.95-1.25q-.275.2-.575.375t-.6.3l-.4 3.2zm2.8-6.5q1.45 0 2.475-1.025T15.55 12t-1.025-2.475T12.05 8.5q-1.475 0-2.488 1.025T8.55 12t1.013 2.475T12.05 15.5"},null,-1)])])}const Eo=Se({name:"material-symbols-settings",render:iu}),du={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function uu(r,e){return z(),F("svg",du,[...e[0]||(e[0]=[o("path",{fill:"currentColor",d:"M21 7v12q0 .825-.587 1.413T19 21H5q-.825 0-1.412-.587T3 19V5q0-.825.588-1.412T5 3h12zm-9 11q1.25 0 2.125-.875T15 15t-.875-2.125T12 12t-2.125.875T9 15t.875 2.125T12 18m-6-8h9V6H6z"},null,-1)])])}const To=Se({name:"material-symbols-save",render:uu}),cu={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function hu(r,e){return z(),F("svg",cu,[...e[0]||(e[0]=[o("path",{fill:"currentColor",d:"M13 23v-3.075l5.525-5.5q.225-.225.5-.325t.55-.1q.3 0 .575.113t.5.337l.925.925q.2.225.313.5t.112.55t-.1.563t-.325.512l-5.5 5.5zM6 10h9V6H6zm13.575 7.4l.925-.975l-.925-.925l-.95.95zM11 21H5q-.825 0-1.412-.587T3 19V5q0-.825.588-1.412T5 3h12l4 4v5.3q-.475-.2-.987-.262T19 12.05t-.975.313t-.875.612L15 15.125V15q0-1.25-.875-2.125T12 12t-2.125.875T9 15t.875 2.125T12 18h.1L11 19.1z"},null,-1)])])}const Dl=Se({name:"material-symbols-save-as",render:hu}),pu={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function fu(r,e){return z(),F("svg",pu,[...e[0]||(e[0]=[o("path",{fill:"currentColor",d:"M12 22q-2.05 0-3.875-.788t-3.187-2.15t-2.15-3.187T2 12q0-2.075.788-3.887t2.15-3.175t3.187-2.15T12 2q.425 0 .713.288T13 3t-.288.713T12 4Q8.675 4 6.337 6.338T4 12t2.338 5.663T12 20t5.663-2.337T20 12q0-.425.288-.712T21 11t.713.288T22 12q0 2.05-.788 3.875t-2.15 3.188t-3.175 2.15T12 22"},null,-1)])])}const mu=Se({name:"material-symbols-progress-activity",render:fu}),gu={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function vu(r,e){return z(),F("svg",gu,[...e[0]||(e[0]=[o("path",{fill:"currentColor",d:"M7 19v-2h7.1q1.575 0 2.738-1T18 13.5T16.838 11T14.1 10H7.8l2.6 2.6L9 14L4 9l5-5l1.4 1.4L7.8 8h6.3q2.425 0 4.163 1.575T20 13.5t-1.737 3.925T14.1 19z"},null,-1)])])}const Bl=Se({name:"material-symbols-undo",render:vu}),bu={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function yu(r,e){return z(),F("svg",bu,[...e[0]||(e[0]=[o("path",{fill:"currentColor",d:"M9.9 19q-2.425 0-4.163-1.575T4 13.5t1.738-3.925T9.9 8h6.3l-2.6-2.6L15 4l5 5l-5 5l-1.4-1.4l2.6-2.6H9.9q-1.575 0-2.738 1T6 13.5T7.163 16T9.9 17H17v2z"},null,-1)])])}const Ol=Se({name:"material-symbols-redo",render:yu}),wu={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function xu(r,e){return z(),F("svg",wu,[...e[0]||(e[0]=[o("path",{fill:"currentColor",d:"M7 21q-.825 0-1.412-.587T5 19V6H4V4h5V3h6v1h5v2h-1v13q0 .825-.587 1.413T17 21zm2-4h2V8H9zm4 0h2V8h-2z"},null,-1)])])}const St=Se({name:"material-symbols-delete",render:xu}),_u={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function ku(r,e){return z(),F("svg",_u,[...e[0]||(e[0]=[o("path",{fill:"currentColor",d:"M11.95 18q.525 0 .888-.363t.362-.887t-.362-.888t-.888-.362t-.887.363t-.363.887t.363.888t.887.362m-.9-3.85h1.85q0-.825.188-1.3t1.062-1.3q.65-.65 1.025-1.238T15.55 8.9q0-1.4-1.025-2.15T12.1 6q-1.425 0-2.312.75T8.55 8.55l1.65.65q.125-.45.563-.975T12.1 7.7q.8 0 1.2.438t.4.962q0 .5-.3.938t-.75.812q-1.1.975-1.35 1.475t-.25 1.825M12 22q-2.075 0-3.9-.787t-3.175-2.138T2.788 15.9T2 12t.788-3.9t2.137-3.175T8.1 2.788T12 2t3.9.788t3.175 2.137T21.213 8.1T22 12t-.788 3.9t-2.137 3.175t-3.175 2.138T12 22"},null,-1)])])}const Su=Se({name:"material-symbols-help",render:ku}),Cu={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function Eu(r,e){return z(),F("svg",Cu,[...e[0]||(e[0]=[o("path",{fill:"currentColor",d:"M3 21v-2h18v2zm0-4v-2h12v2zm0-4v-2h18v2zm0-4V7h12v2zm0-4V3h18v2z"},null,-1)])])}const Tu=Se({name:"material-symbols-format-align-left",render:Eu}),$u={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function Iu(r,e){return z(),F("svg",$u,[...e[0]||(e[0]=[o("path",{fill:"currentColor",d:"M3 21v-2h18v2zm4-4v-2h10v2zm-4-4v-2h18v2zm4-4V7h10v2zM3 5V3h18v2z"},null,-1)])])}const Au=Se({name:"material-symbols-format-align-center",render:Iu}),zu={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function Pu(r,e){return z(),F("svg",zu,[...e[0]||(e[0]=[o("path",{fill:"currentColor",d:"M3 5V3h18v2zm6 4V7h12v2zm-6 4v-2h18v2zm6 4v-2h12v2zm-6 4v-2h18v2z"},null,-1)])])}const Lu=Se({name:"material-symbols-format-align-right",render:Pu}),Mu={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function Ru(r,e){return z(),F("svg",Mu,[...e[0]||(e[0]=[o("path",{fill:"currentColor",d:"M4 5V3h16v2zm7 16V10.8l-2.6 2.6L7 12l5-5l5 5l-1.4 1.4l-2.6-2.6V21z"},null,-1)])])}const Du=Se({name:"material-symbols-vertical-align-top",render:Ru}),Bu={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function Ou(r,e){return z(),F("svg",Bu,[...e[0]||(e[0]=[o("path",{fill:"currentColor",d:"M11 22v-4.2l-1.6 1.6L8 18l4-4l4 4l-1.4 1.4l-1.6-1.6V22zm-7-9v-2h16v2zm8-3L8 6l1.4-1.4L11 6.2V2h2v4.2l1.6-1.6L16 6z"},null,-1)])])}const qu=Se({name:"material-symbols-vertical-align-center",render:Ou}),Fu={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function Nu(r,e){return z(),F("svg",Fu,[...e[0]||(e[0]=[o("path",{fill:"currentColor",d:"M4 21v-2h16v2zm8-4l-5-5l1.4-1.4l2.6 2.6V3h2v10.2l2.6-2.6L17 12z"},null,-1)])])}const ju=Se({name:"material-symbols-vertical-align-bottom",render:Nu}),Hu={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function Uu(r,e){return z(),F("svg",Hu,[...e[0]||(e[0]=[o("path",{fill:"currentColor",d:"M6.8 19V5h5.525q1.625 0 3 1T16.7 8.775q0 1.275-.575 1.963t-1.075.987q.625.275 1.388 1.025T17.2 15q0 2.225-1.625 3.113t-3.05.887zm3.025-2.8h2.6q1.2 0 1.463-.612t.262-.888t-.262-.887t-1.538-.613H9.825zm0-5.7h2.325q.825 0 1.2-.425t.375-.95q0-.6-.425-.975t-1.1-.375H9.825z"},null,-1)])])}const Vu=Se({name:"material-symbols-format-bold",render:Uu}),Wu={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function Gu(r,e){return z(),F("svg",Wu,[...e[0]||(e[0]=[o("path",{fill:"currentColor",d:"M5 19v-2.5h4l3-9H8V5h10v2.5h-3.5l-3 9H15V19z"},null,-1)])])}const Ku=Se({name:"material-symbols-format-italic",render:Gu}),Yu={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function Xu(r,e){return z(),F("svg",Yu,[...e[0]||(e[0]=[o("path",{fill:"currentColor",d:"M5 21v-2h14v2zm7-4q-2.525 0-3.925-1.575t-1.4-4.175V3H9.25v8.4q0 1.4.7 2.275t2.05.875t2.05-.875t.7-2.275V3h2.575v8.25q0 2.6-1.4 4.175T12 17"},null,-1)])])}const Zu=Se({name:"material-symbols-format-underlined",render:Xu}),Ju={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function Qu(r,e){return z(),F("svg",Ju,[...e[0]||(e[0]=[o("path",{fill:"currentColor",d:"M10.9 16L15 5h2l4.1 11h-1.9l-1-2.8h-4.4l-1 2.8zm3.45-4.4h3.3l-1.6-4.55h-.1zM6 20l-3.5-3.5l1.4-1.4L5 16.15V3h2v13.15l1.1-1.05l1.4 1.4z"},null,-1)])])}const ec=Se({name:"material-symbols-text-rotate-vertical",render:Qu}),tc={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function rc(r,e){return z(),F("svg",tc,[...e[0]||(e[0]=[o("path",{fill:"currentColor",d:"M11 22q-1.25-.125-2.4-.612T6.4 20.1l1.4-1.45q.725.525 1.538.85t1.662.45zm2 0v-2.05q2.6-.375 4.3-2.337T19 13.05q0-2.925-2.037-4.962T12 6.05h-.2l1.6 1.6l-1.4 1.4l-4-4l4-4l1.4 1.45l-1.55 1.55H12q1.875 0 3.513.713t2.85 1.925t1.925 2.85T21 13.05q0 3.425-2.275 5.963T13 22m-8.05-3.35q-.8-1.05-1.288-2.2t-.612-2.4H5.1q.125.85.45 1.663t.85 1.537zm-1.9-6.6q.15-1.275.625-2.45T4.95 7.45l1.45 1.4q-.525.725-.85 1.538T5.1 12.05z"},null,-1)])])}const nc=Se({name:"material-symbols-rotate-left",render:rc}),oc={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function sc(r,e){return z(),F("svg",oc,[...e[0]||(e[0]=[o("path",{fill:"currentColor",d:"M9 18q-.825 0-1.412-.587T7 16V4q0-.825.588-1.412T9 2h9q.825 0 1.413.588T20 4v12q0 .825-.587 1.413T18 18zm-4 4q-.825 0-1.412-.587T3 20V6h2v14h11v2z"},null,-1)])])}const Ct=Se({name:"material-symbols-content-copy",render:sc}),ac={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function lc(r,e){return z(),F("svg",ac,[...e[0]||(e[0]=[o("path",{fill:"currentColor",d:"M6.4 18h2.1l1.1-3.05h4.8L15.5 18h2.1L13.05 6h-2.1zm3.8-4.8l1.75-4.95h.1l1.75 4.95zM4 22q-.825 0-1.412-.587T2 20V4q0-.825.588-1.412T4 2h16q.825 0 1.413.588T22 4v16q0 .825-.587 1.413T20 22z"},null,-1)])])}const ic=Se({name:"material-symbols-font-download",render:lc}),dc={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function uc(r,e){return z(),F("svg",dc,[...e[0]||(e[0]=[o("path",{fill:"currentColor",d:"M6.175 1.4L7.6 0l8.575 8.575q.575.575.575 1.425t-.575 1.425l-4.75 4.75q-.575.575-1.425.575t-1.425-.575l-4.75-4.75Q3.25 10.85 3.25 10t.575-1.425L8.575 3.8zM10 5.225L5.225 10h9.55zM19 17q-.825 0-1.412-.587T17 15q0-.525.313-1.125T18 12.75q.225-.3.475-.625T19 11.5q.275.3.525.625t.475.625q.375.525.688 1.125T21 15q0 .825-.587 1.413T19 17M2 24v-4h20v4z"},null,-1)])])}const cc=Se({name:"material-symbols-format-color-fill",render:uc}),hc={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function pc(r,e){return z(),F("svg",hc,[...e[0]||(e[0]=[o("path",{fill:"currentColor",d:"M5 21q-.825 0-1.412-.587T3 19V5q0-.825.588-1.412T5 3h4.175q.275-.875 1.075-1.437T12 1q1 0 1.788.563T14.85 3H19q.825 0 1.413.588T21 5v14q0 .825-.587 1.413T19 21zm0-2h14V5h-2v3H7V5H5zm7-14q.425 0 .713-.288T13 4t-.288-.712T12 3t-.712.288T11 4t.288.713T12 5"},null,-1)])])}const $o=Se({name:"material-symbols-content-paste",render:pc}),fc={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function mc(r,e){return z(),F("svg",fc,[...e[0]||(e[0]=[o("path",{fill:"currentColor",d:"M8 16q.825 0 1.413-.587T10 14t-.587-1.412T8 12t-1.412.588T6 14t.588 1.413T8 16m8 0q.825 0 1.413-.587T18 14t-.587-1.412T16 12t-1.412.588T14 14t.588 1.413T16 16m-4-6q.825 0 1.413-.587T14 8t-.587-1.412T12 6t-1.412.588T10 8t.588 1.413T12 10m0 12q-2.075 0-3.9-.788t-3.175-2.137T2.788 15.9T2 12t.788-3.9t2.137-3.175T8.1 2.788T12 2t3.9.788t3.175 2.137T21.213 8.1T22 12t-.788 3.9t-2.137 3.175t-3.175 2.138T12 22"},null,-1)])])}const gc=Se({name:"material-symbols-group-work",render:mc}),vc={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function bc(r,e){return z(),F("svg",vc,[...e[0]||(e[0]=[o("path",{fill:"currentColor",d:"M6 22q-.825 0-1.412-.587T4 20V10q0-.825.588-1.412T6 8h1V6q0-2.075 1.463-3.537T12 1t3.538 1.463T17 6v2h1q.825 0 1.413.588T20 10v10q0 .825-.587 1.413T18 22zm6-5q.825 0 1.413-.587T14 15t-.587-1.412T12 13t-1.412.588T10 15t.588 1.413T12 17M9 8h6V6q0-1.25-.875-2.125T12 3t-2.125.875T9 6z"},null,-1)])])}const Jt=Se({name:"material-symbols-lock",render:bc}),yc={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function wc(r,e){return z(),F("svg",yc,[...e[0]||(e[0]=[o("path",{fill:"currentColor",d:"M6 8h9V6q0-1.25-.875-2.125T12 3t-2.125.875T9 6H7q0-2.075 1.463-3.537T12 1t3.538 1.463T17 6v2h1q.825 0 1.413.588T20 10v10q0 .825-.587 1.413T18 22H6q-.825 0-1.412-.587T4 20V10q0-.825.588-1.412T6 8m6 9q.825 0 1.413-.587T14 15t-.587-1.412T12 13t-1.412.588T10 15t.588 1.413T12 17"},null,-1)])])}const ql=Se({name:"material-symbols-lock-open",render:wc}),xc={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function _c(r,e){return z(),F("svg",xc,[...e[0]||(e[0]=[o("path",{fill:"currentColor",d:"m12 15.375l-6-6l1.4-1.4l4.6 4.6l4.6-4.6l1.4 1.4z"},null,-1)])])}const Io=Se({name:"material-symbols-expand-more",render:_c});var kc=Ql();const Sc=_t(kc);function Nt(r){throw new Error('Could not dynamically require "'+r+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var ao={exports:{}};/*!

JSZip v3.10.1 - A JavaScript class for generating and reading zip files
<http://stuartk.com/jszip>

(c) 2009-2016 Stuart Knightley <stuart [at] stuartk.com>
Dual licenced under the MIT license or GPLv3. See https://raw.github.com/Stuk/jszip/main/LICENSE.markdown.

JSZip uses the library pako released under the MIT license :
https://github.com/nodeca/pako/blob/main/LICENSE
*/var Na;function Cc(){return Na||(Na=1,(function(r,e){(function(t){r.exports=t()})(function(){return(function t(s,n,l){function i(g,y){if(!n[g]){if(!s[g]){var m=typeof Nt=="function"&&Nt;if(!y&&m)return m(g,!0);if(d)return d(g,!0);var x=new Error("Cannot find module '"+g+"'");throw x.code="MODULE_NOT_FOUND",x}var p=n[g]={exports:{}};s[g][0].call(p.exports,function(k){var v=s[g][1][k];return i(v||k)},p,p.exports,t,s,n,l)}return n[g].exports}for(var d=typeof Nt=="function"&&Nt,u=0;u<l.length;u++)i(l[u]);return i})({1:[function(t,s,n){var l=t("./utils"),i=t("./support"),d="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";n.encode=function(u){for(var g,y,m,x,p,k,v,S=[],b=0,f=u.length,T=f,M=l.getTypeOf(u)!=="string";b<u.length;)T=f-b,m=M?(g=u[b++],y=b<f?u[b++]:0,b<f?u[b++]:0):(g=u.charCodeAt(b++),y=b<f?u.charCodeAt(b++):0,b<f?u.charCodeAt(b++):0),x=g>>2,p=(3&g)<<4|y>>4,k=1<T?(15&y)<<2|m>>6:64,v=2<T?63&m:64,S.push(d.charAt(x)+d.charAt(p)+d.charAt(k)+d.charAt(v));return S.join("")},n.decode=function(u){var g,y,m,x,p,k,v=0,S=0,b="data:";if(u.substr(0,b.length)===b)throw new Error("Invalid base64 input, it looks like a data url.");var f,T=3*(u=u.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(u.charAt(u.length-1)===d.charAt(64)&&T--,u.charAt(u.length-2)===d.charAt(64)&&T--,T%1!=0)throw new Error("Invalid base64 input, bad content length.");for(f=i.uint8array?new Uint8Array(0|T):new Array(0|T);v<u.length;)g=d.indexOf(u.charAt(v++))<<2|(x=d.indexOf(u.charAt(v++)))>>4,y=(15&x)<<4|(p=d.indexOf(u.charAt(v++)))>>2,m=(3&p)<<6|(k=d.indexOf(u.charAt(v++))),f[S++]=g,p!==64&&(f[S++]=y),k!==64&&(f[S++]=m);return f}},{"./support":30,"./utils":32}],2:[function(t,s,n){var l=t("./external"),i=t("./stream/DataWorker"),d=t("./stream/Crc32Probe"),u=t("./stream/DataLengthProbe");function g(y,m,x,p,k){this.compressedSize=y,this.uncompressedSize=m,this.crc32=x,this.compression=p,this.compressedContent=k}g.prototype={getContentWorker:function(){var y=new i(l.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new u("data_length")),m=this;return y.on("end",function(){if(this.streamInfo.data_length!==m.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),y},getCompressedWorker:function(){return new i(l.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},g.createWorkerFrom=function(y,m,x){return y.pipe(new d).pipe(new u("uncompressedSize")).pipe(m.compressWorker(x)).pipe(new u("compressedSize")).withStreamInfo("compression",m)},s.exports=g},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(t,s,n){var l=t("./stream/GenericWorker");n.STORE={magic:"\0\0",compressWorker:function(){return new l("STORE compression")},uncompressWorker:function(){return new l("STORE decompression")}},n.DEFLATE=t("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(t,s,n){var l=t("./utils"),i=(function(){for(var d,u=[],g=0;g<256;g++){d=g;for(var y=0;y<8;y++)d=1&d?3988292384^d>>>1:d>>>1;u[g]=d}return u})();s.exports=function(d,u){return d!==void 0&&d.length?l.getTypeOf(d)!=="string"?(function(g,y,m,x){var p=i,k=x+m;g^=-1;for(var v=x;v<k;v++)g=g>>>8^p[255&(g^y[v])];return-1^g})(0|u,d,d.length,0):(function(g,y,m,x){var p=i,k=x+m;g^=-1;for(var v=x;v<k;v++)g=g>>>8^p[255&(g^y.charCodeAt(v))];return-1^g})(0|u,d,d.length,0):0}},{"./utils":32}],5:[function(t,s,n){n.base64=!1,n.binary=!1,n.dir=!1,n.createFolders=!0,n.date=null,n.compression=null,n.compressionOptions=null,n.comment=null,n.unixPermissions=null,n.dosPermissions=null},{}],6:[function(t,s,n){var l=null;l=typeof Promise<"u"?Promise:t("lie"),s.exports={Promise:l}},{lie:37}],7:[function(t,s,n){var l=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",i=t("pako"),d=t("./utils"),u=t("./stream/GenericWorker"),g=l?"uint8array":"array";function y(m,x){u.call(this,"FlateWorker/"+m),this._pako=null,this._pakoAction=m,this._pakoOptions=x,this.meta={}}n.magic="\b\0",d.inherits(y,u),y.prototype.processChunk=function(m){this.meta=m.meta,this._pako===null&&this._createPako(),this._pako.push(d.transformTo(g,m.data),!1)},y.prototype.flush=function(){u.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},y.prototype.cleanUp=function(){u.prototype.cleanUp.call(this),this._pako=null},y.prototype._createPako=function(){this._pako=new i[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var m=this;this._pako.onData=function(x){m.push({data:x,meta:m.meta})}},n.compressWorker=function(m){return new y("Deflate",m)},n.uncompressWorker=function(){return new y("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(t,s,n){function l(p,k){var v,S="";for(v=0;v<k;v++)S+=String.fromCharCode(255&p),p>>>=8;return S}function i(p,k,v,S,b,f){var T,M,H=p.file,R=p.compression,A=f!==g.utf8encode,W=d.transformTo("string",f(H.name)),X=d.transformTo("string",g.utf8encode(H.name)),se=H.comment,G=d.transformTo("string",f(se)),$=d.transformTo("string",g.utf8encode(se)),O=X.length!==H.name.length,h=$.length!==se.length,w="",Y="",te="",Q=H.dir,I=H.date,V={crc32:0,compressedSize:0,uncompressedSize:0};k&&!v||(V.crc32=p.crc32,V.compressedSize=p.compressedSize,V.uncompressedSize=p.uncompressedSize);var L=0;k&&(L|=8),A||!O&&!h||(L|=2048);var B=0,re=0;Q&&(B|=16),b==="UNIX"?(re=798,B|=(function(ne,ve){var xe=ne;return ne||(xe=ve?16893:33204),(65535&xe)<<16})(H.unixPermissions,Q)):(re=20,B|=(function(ne){return 63&(ne||0)})(H.dosPermissions)),T=I.getUTCHours(),T<<=6,T|=I.getUTCMinutes(),T<<=5,T|=I.getUTCSeconds()/2,M=I.getUTCFullYear()-1980,M<<=4,M|=I.getUTCMonth()+1,M<<=5,M|=I.getUTCDate(),O&&(Y=l(1,1)+l(y(W),4)+X,w+="up"+l(Y.length,2)+Y),h&&(te=l(1,1)+l(y(G),4)+$,w+="uc"+l(te.length,2)+te);var Z="";return Z+=`
\0`,Z+=l(L,2),Z+=R.magic,Z+=l(T,2),Z+=l(M,2),Z+=l(V.crc32,4),Z+=l(V.compressedSize,4),Z+=l(V.uncompressedSize,4),Z+=l(W.length,2),Z+=l(w.length,2),{fileRecord:m.LOCAL_FILE_HEADER+Z+W+w,dirRecord:m.CENTRAL_FILE_HEADER+l(re,2)+Z+l(G.length,2)+"\0\0\0\0"+l(B,4)+l(S,4)+W+w+G}}var d=t("../utils"),u=t("../stream/GenericWorker"),g=t("../utf8"),y=t("../crc32"),m=t("../signature");function x(p,k,v,S){u.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=k,this.zipPlatform=v,this.encodeFileName=S,this.streamFiles=p,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}d.inherits(x,u),x.prototype.push=function(p){var k=p.meta.percent||0,v=this.entriesCount,S=this._sources.length;this.accumulate?this.contentBuffer.push(p):(this.bytesWritten+=p.data.length,u.prototype.push.call(this,{data:p.data,meta:{currentFile:this.currentFile,percent:v?(k+100*(v-S-1))/v:100}}))},x.prototype.openedSource=function(p){this.currentSourceOffset=this.bytesWritten,this.currentFile=p.file.name;var k=this.streamFiles&&!p.file.dir;if(k){var v=i(p,k,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:v.fileRecord,meta:{percent:0}})}else this.accumulate=!0},x.prototype.closedSource=function(p){this.accumulate=!1;var k=this.streamFiles&&!p.file.dir,v=i(p,k,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(v.dirRecord),k)this.push({data:(function(S){return m.DATA_DESCRIPTOR+l(S.crc32,4)+l(S.compressedSize,4)+l(S.uncompressedSize,4)})(p),meta:{percent:100}});else for(this.push({data:v.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},x.prototype.flush=function(){for(var p=this.bytesWritten,k=0;k<this.dirRecords.length;k++)this.push({data:this.dirRecords[k],meta:{percent:100}});var v=this.bytesWritten-p,S=(function(b,f,T,M,H){var R=d.transformTo("string",H(M));return m.CENTRAL_DIRECTORY_END+"\0\0\0\0"+l(b,2)+l(b,2)+l(f,4)+l(T,4)+l(R.length,2)+R})(this.dirRecords.length,v,p,this.zipComment,this.encodeFileName);this.push({data:S,meta:{percent:100}})},x.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},x.prototype.registerPrevious=function(p){this._sources.push(p);var k=this;return p.on("data",function(v){k.processChunk(v)}),p.on("end",function(){k.closedSource(k.previous.streamInfo),k._sources.length?k.prepareNextSource():k.end()}),p.on("error",function(v){k.error(v)}),this},x.prototype.resume=function(){return!!u.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},x.prototype.error=function(p){var k=this._sources;if(!u.prototype.error.call(this,p))return!1;for(var v=0;v<k.length;v++)try{k[v].error(p)}catch{}return!0},x.prototype.lock=function(){u.prototype.lock.call(this);for(var p=this._sources,k=0;k<p.length;k++)p[k].lock()},s.exports=x},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(t,s,n){var l=t("../compressions"),i=t("./ZipFileWorker");n.generateWorker=function(d,u,g){var y=new i(u.streamFiles,g,u.platform,u.encodeFileName),m=0;try{d.forEach(function(x,p){m++;var k=(function(f,T){var M=f||T,H=l[M];if(!H)throw new Error(M+" is not a valid compression method !");return H})(p.options.compression,u.compression),v=p.options.compressionOptions||u.compressionOptions||{},S=p.dir,b=p.date;p._compressWorker(k,v).withStreamInfo("file",{name:x,dir:S,date:b,comment:p.comment||"",unixPermissions:p.unixPermissions,dosPermissions:p.dosPermissions}).pipe(y)}),y.entriesCount=m}catch(x){y.error(x)}return y}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(t,s,n){function l(){if(!(this instanceof l))return new l;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var i=new l;for(var d in this)typeof this[d]!="function"&&(i[d]=this[d]);return i}}(l.prototype=t("./object")).loadAsync=t("./load"),l.support=t("./support"),l.defaults=t("./defaults"),l.version="3.10.1",l.loadAsync=function(i,d){return new l().loadAsync(i,d)},l.external=t("./external"),s.exports=l},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(t,s,n){var l=t("./utils"),i=t("./external"),d=t("./utf8"),u=t("./zipEntries"),g=t("./stream/Crc32Probe"),y=t("./nodejsUtils");function m(x){return new i.Promise(function(p,k){var v=x.decompressed.getContentWorker().pipe(new g);v.on("error",function(S){k(S)}).on("end",function(){v.streamInfo.crc32!==x.decompressed.crc32?k(new Error("Corrupted zip : CRC32 mismatch")):p()}).resume()})}s.exports=function(x,p){var k=this;return p=l.extend(p||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:d.utf8decode}),y.isNode&&y.isStream(x)?i.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):l.prepareContent("the loaded zip file",x,!0,p.optimizedBinaryString,p.base64).then(function(v){var S=new u(p);return S.load(v),S}).then(function(v){var S=[i.Promise.resolve(v)],b=v.files;if(p.checkCRC32)for(var f=0;f<b.length;f++)S.push(m(b[f]));return i.Promise.all(S)}).then(function(v){for(var S=v.shift(),b=S.files,f=0;f<b.length;f++){var T=b[f],M=T.fileNameStr,H=l.resolve(T.fileNameStr);k.file(H,T.decompressed,{binary:!0,optimizedBinaryString:!0,date:T.date,dir:T.dir,comment:T.fileCommentStr.length?T.fileCommentStr:null,unixPermissions:T.unixPermissions,dosPermissions:T.dosPermissions,createFolders:p.createFolders}),T.dir||(k.file(H).unsafeOriginalName=M)}return S.zipComment.length&&(k.comment=S.zipComment),k})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(t,s,n){var l=t("../utils"),i=t("../stream/GenericWorker");function d(u,g){i.call(this,"Nodejs stream input adapter for "+u),this._upstreamEnded=!1,this._bindStream(g)}l.inherits(d,i),d.prototype._bindStream=function(u){var g=this;(this._stream=u).pause(),u.on("data",function(y){g.push({data:y,meta:{percent:0}})}).on("error",function(y){g.isPaused?this.generatedError=y:g.error(y)}).on("end",function(){g.isPaused?g._upstreamEnded=!0:g.end()})},d.prototype.pause=function(){return!!i.prototype.pause.call(this)&&(this._stream.pause(),!0)},d.prototype.resume=function(){return!!i.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},s.exports=d},{"../stream/GenericWorker":28,"../utils":32}],13:[function(t,s,n){var l=t("readable-stream").Readable;function i(d,u,g){l.call(this,u),this._helper=d;var y=this;d.on("data",function(m,x){y.push(m)||y._helper.pause(),g&&g(x)}).on("error",function(m){y.emit("error",m)}).on("end",function(){y.push(null)})}t("../utils").inherits(i,l),i.prototype._read=function(){this._helper.resume()},s.exports=i},{"../utils":32,"readable-stream":16}],14:[function(t,s,n){s.exports={isNode:typeof Buffer<"u",newBufferFrom:function(l,i){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(l,i);if(typeof l=="number")throw new Error('The "data" argument must not be a number');return new Buffer(l,i)},allocBuffer:function(l){if(Buffer.alloc)return Buffer.alloc(l);var i=new Buffer(l);return i.fill(0),i},isBuffer:function(l){return Buffer.isBuffer(l)},isStream:function(l){return l&&typeof l.on=="function"&&typeof l.pause=="function"&&typeof l.resume=="function"}}},{}],15:[function(t,s,n){function l(H,R,A){var W,X=d.getTypeOf(R),se=d.extend(A||{},y);se.date=se.date||new Date,se.compression!==null&&(se.compression=se.compression.toUpperCase()),typeof se.unixPermissions=="string"&&(se.unixPermissions=parseInt(se.unixPermissions,8)),se.unixPermissions&&16384&se.unixPermissions&&(se.dir=!0),se.dosPermissions&&16&se.dosPermissions&&(se.dir=!0),se.dir&&(H=b(H)),se.createFolders&&(W=S(H))&&f.call(this,W,!0);var G=X==="string"&&se.binary===!1&&se.base64===!1;A&&A.binary!==void 0||(se.binary=!G),(R instanceof m&&R.uncompressedSize===0||se.dir||!R||R.length===0)&&(se.base64=!1,se.binary=!0,R="",se.compression="STORE",X="string");var $=null;$=R instanceof m||R instanceof u?R:k.isNode&&k.isStream(R)?new v(H,R):d.prepareContent(H,R,se.binary,se.optimizedBinaryString,se.base64);var O=new x(H,$,se);this.files[H]=O}var i=t("./utf8"),d=t("./utils"),u=t("./stream/GenericWorker"),g=t("./stream/StreamHelper"),y=t("./defaults"),m=t("./compressedObject"),x=t("./zipObject"),p=t("./generate"),k=t("./nodejsUtils"),v=t("./nodejs/NodejsStreamInputAdapter"),S=function(H){H.slice(-1)==="/"&&(H=H.substring(0,H.length-1));var R=H.lastIndexOf("/");return 0<R?H.substring(0,R):""},b=function(H){return H.slice(-1)!=="/"&&(H+="/"),H},f=function(H,R){return R=R!==void 0?R:y.createFolders,H=b(H),this.files[H]||l.call(this,H,null,{dir:!0,createFolders:R}),this.files[H]};function T(H){return Object.prototype.toString.call(H)==="[object RegExp]"}var M={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(H){var R,A,W;for(R in this.files)W=this.files[R],(A=R.slice(this.root.length,R.length))&&R.slice(0,this.root.length)===this.root&&H(A,W)},filter:function(H){var R=[];return this.forEach(function(A,W){H(A,W)&&R.push(W)}),R},file:function(H,R,A){if(arguments.length!==1)return H=this.root+H,l.call(this,H,R,A),this;if(T(H)){var W=H;return this.filter(function(se,G){return!G.dir&&W.test(se)})}var X=this.files[this.root+H];return X&&!X.dir?X:null},folder:function(H){if(!H)return this;if(T(H))return this.filter(function(X,se){return se.dir&&H.test(X)});var R=this.root+H,A=f.call(this,R),W=this.clone();return W.root=A.name,W},remove:function(H){H=this.root+H;var R=this.files[H];if(R||(H.slice(-1)!=="/"&&(H+="/"),R=this.files[H]),R&&!R.dir)delete this.files[H];else for(var A=this.filter(function(X,se){return se.name.slice(0,H.length)===H}),W=0;W<A.length;W++)delete this.files[A[W].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(H){var R,A={};try{if((A=d.extend(H||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:i.utf8encode})).type=A.type.toLowerCase(),A.compression=A.compression.toUpperCase(),A.type==="binarystring"&&(A.type="string"),!A.type)throw new Error("No output type specified.");d.checkSupport(A.type),A.platform!=="darwin"&&A.platform!=="freebsd"&&A.platform!=="linux"&&A.platform!=="sunos"||(A.platform="UNIX"),A.platform==="win32"&&(A.platform="DOS");var W=A.comment||this.comment||"";R=p.generateWorker(this,A,W)}catch(X){(R=new u("error")).error(X)}return new g(R,A.type||"string",A.mimeType)},generateAsync:function(H,R){return this.generateInternalStream(H).accumulate(R)},generateNodeStream:function(H,R){return(H=H||{}).type||(H.type="nodebuffer"),this.generateInternalStream(H).toNodejsStream(R)}};s.exports=M},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(t,s,n){s.exports=t("stream")},{stream:void 0}],17:[function(t,s,n){var l=t("./DataReader");function i(d){l.call(this,d);for(var u=0;u<this.data.length;u++)d[u]=255&d[u]}t("../utils").inherits(i,l),i.prototype.byteAt=function(d){return this.data[this.zero+d]},i.prototype.lastIndexOfSignature=function(d){for(var u=d.charCodeAt(0),g=d.charCodeAt(1),y=d.charCodeAt(2),m=d.charCodeAt(3),x=this.length-4;0<=x;--x)if(this.data[x]===u&&this.data[x+1]===g&&this.data[x+2]===y&&this.data[x+3]===m)return x-this.zero;return-1},i.prototype.readAndCheckSignature=function(d){var u=d.charCodeAt(0),g=d.charCodeAt(1),y=d.charCodeAt(2),m=d.charCodeAt(3),x=this.readData(4);return u===x[0]&&g===x[1]&&y===x[2]&&m===x[3]},i.prototype.readData=function(d){if(this.checkOffset(d),d===0)return[];var u=this.data.slice(this.zero+this.index,this.zero+this.index+d);return this.index+=d,u},s.exports=i},{"../utils":32,"./DataReader":18}],18:[function(t,s,n){var l=t("../utils");function i(d){this.data=d,this.length=d.length,this.index=0,this.zero=0}i.prototype={checkOffset:function(d){this.checkIndex(this.index+d)},checkIndex:function(d){if(this.length<this.zero+d||d<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+d+"). Corrupted zip ?")},setIndex:function(d){this.checkIndex(d),this.index=d},skip:function(d){this.setIndex(this.index+d)},byteAt:function(){},readInt:function(d){var u,g=0;for(this.checkOffset(d),u=this.index+d-1;u>=this.index;u--)g=(g<<8)+this.byteAt(u);return this.index+=d,g},readString:function(d){return l.transformTo("string",this.readData(d))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var d=this.readInt(4);return new Date(Date.UTC(1980+(d>>25&127),(d>>21&15)-1,d>>16&31,d>>11&31,d>>5&63,(31&d)<<1))}},s.exports=i},{"../utils":32}],19:[function(t,s,n){var l=t("./Uint8ArrayReader");function i(d){l.call(this,d)}t("../utils").inherits(i,l),i.prototype.readData=function(d){this.checkOffset(d);var u=this.data.slice(this.zero+this.index,this.zero+this.index+d);return this.index+=d,u},s.exports=i},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(t,s,n){var l=t("./DataReader");function i(d){l.call(this,d)}t("../utils").inherits(i,l),i.prototype.byteAt=function(d){return this.data.charCodeAt(this.zero+d)},i.prototype.lastIndexOfSignature=function(d){return this.data.lastIndexOf(d)-this.zero},i.prototype.readAndCheckSignature=function(d){return d===this.readData(4)},i.prototype.readData=function(d){this.checkOffset(d);var u=this.data.slice(this.zero+this.index,this.zero+this.index+d);return this.index+=d,u},s.exports=i},{"../utils":32,"./DataReader":18}],21:[function(t,s,n){var l=t("./ArrayReader");function i(d){l.call(this,d)}t("../utils").inherits(i,l),i.prototype.readData=function(d){if(this.checkOffset(d),d===0)return new Uint8Array(0);var u=this.data.subarray(this.zero+this.index,this.zero+this.index+d);return this.index+=d,u},s.exports=i},{"../utils":32,"./ArrayReader":17}],22:[function(t,s,n){var l=t("../utils"),i=t("../support"),d=t("./ArrayReader"),u=t("./StringReader"),g=t("./NodeBufferReader"),y=t("./Uint8ArrayReader");s.exports=function(m){var x=l.getTypeOf(m);return l.checkSupport(x),x!=="string"||i.uint8array?x==="nodebuffer"?new g(m):i.uint8array?new y(l.transformTo("uint8array",m)):new d(l.transformTo("array",m)):new u(m)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(t,s,n){n.LOCAL_FILE_HEADER="PK",n.CENTRAL_FILE_HEADER="PK",n.CENTRAL_DIRECTORY_END="PK",n.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",n.ZIP64_CENTRAL_DIRECTORY_END="PK",n.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(t,s,n){var l=t("./GenericWorker"),i=t("../utils");function d(u){l.call(this,"ConvertWorker to "+u),this.destType=u}i.inherits(d,l),d.prototype.processChunk=function(u){this.push({data:i.transformTo(this.destType,u.data),meta:u.meta})},s.exports=d},{"../utils":32,"./GenericWorker":28}],25:[function(t,s,n){var l=t("./GenericWorker"),i=t("../crc32");function d(){l.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}t("../utils").inherits(d,l),d.prototype.processChunk=function(u){this.streamInfo.crc32=i(u.data,this.streamInfo.crc32||0),this.push(u)},s.exports=d},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(t,s,n){var l=t("../utils"),i=t("./GenericWorker");function d(u){i.call(this,"DataLengthProbe for "+u),this.propName=u,this.withStreamInfo(u,0)}l.inherits(d,i),d.prototype.processChunk=function(u){if(u){var g=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=g+u.data.length}i.prototype.processChunk.call(this,u)},s.exports=d},{"../utils":32,"./GenericWorker":28}],27:[function(t,s,n){var l=t("../utils"),i=t("./GenericWorker");function d(u){i.call(this,"DataWorker");var g=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,u.then(function(y){g.dataIsReady=!0,g.data=y,g.max=y&&y.length||0,g.type=l.getTypeOf(y),g.isPaused||g._tickAndRepeat()},function(y){g.error(y)})}l.inherits(d,i),d.prototype.cleanUp=function(){i.prototype.cleanUp.call(this),this.data=null},d.prototype.resume=function(){return!!i.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,l.delay(this._tickAndRepeat,[],this)),!0)},d.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(l.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},d.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var u=null,g=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":u=this.data.substring(this.index,g);break;case"uint8array":u=this.data.subarray(this.index,g);break;case"array":case"nodebuffer":u=this.data.slice(this.index,g)}return this.index=g,this.push({data:u,meta:{percent:this.max?this.index/this.max*100:0}})},s.exports=d},{"../utils":32,"./GenericWorker":28}],28:[function(t,s,n){function l(i){this.name=i||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}l.prototype={push:function(i){this.emit("data",i)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(i){this.emit("error",i)}return!0},error:function(i){return!this.isFinished&&(this.isPaused?this.generatedError=i:(this.isFinished=!0,this.emit("error",i),this.previous&&this.previous.error(i),this.cleanUp()),!0)},on:function(i,d){return this._listeners[i].push(d),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(i,d){if(this._listeners[i])for(var u=0;u<this._listeners[i].length;u++)this._listeners[i][u].call(this,d)},pipe:function(i){return i.registerPrevious(this)},registerPrevious:function(i){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=i.streamInfo,this.mergeStreamInfo(),this.previous=i;var d=this;return i.on("data",function(u){d.processChunk(u)}),i.on("end",function(){d.end()}),i.on("error",function(u){d.error(u)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var i=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),i=!0),this.previous&&this.previous.resume(),!i},flush:function(){},processChunk:function(i){this.push(i)},withStreamInfo:function(i,d){return this.extraStreamInfo[i]=d,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var i in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,i)&&(this.streamInfo[i]=this.extraStreamInfo[i])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var i="Worker "+this.name;return this.previous?this.previous+" -> "+i:i}},s.exports=l},{}],29:[function(t,s,n){var l=t("../utils"),i=t("./ConvertWorker"),d=t("./GenericWorker"),u=t("../base64"),g=t("../support"),y=t("../external"),m=null;if(g.nodestream)try{m=t("../nodejs/NodejsStreamOutputAdapter")}catch{}function x(k,v){return new y.Promise(function(S,b){var f=[],T=k._internalType,M=k._outputType,H=k._mimeType;k.on("data",function(R,A){f.push(R),v&&v(A)}).on("error",function(R){f=[],b(R)}).on("end",function(){try{var R=(function(A,W,X){switch(A){case"blob":return l.newBlob(l.transformTo("arraybuffer",W),X);case"base64":return u.encode(W);default:return l.transformTo(A,W)}})(M,(function(A,W){var X,se=0,G=null,$=0;for(X=0;X<W.length;X++)$+=W[X].length;switch(A){case"string":return W.join("");case"array":return Array.prototype.concat.apply([],W);case"uint8array":for(G=new Uint8Array($),X=0;X<W.length;X++)G.set(W[X],se),se+=W[X].length;return G;case"nodebuffer":return Buffer.concat(W);default:throw new Error("concat : unsupported type '"+A+"'")}})(T,f),H);S(R)}catch(A){b(A)}f=[]}).resume()})}function p(k,v,S){var b=v;switch(v){case"blob":case"arraybuffer":b="uint8array";break;case"base64":b="string"}try{this._internalType=b,this._outputType=v,this._mimeType=S,l.checkSupport(b),this._worker=k.pipe(new i(b)),k.lock()}catch(f){this._worker=new d("error"),this._worker.error(f)}}p.prototype={accumulate:function(k){return x(this,k)},on:function(k,v){var S=this;return k==="data"?this._worker.on(k,function(b){v.call(S,b.data,b.meta)}):this._worker.on(k,function(){l.delay(v,arguments,S)}),this},resume:function(){return l.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(k){if(l.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new m(this,{objectMode:this._outputType!=="nodebuffer"},k)}},s.exports=p},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(t,s,n){if(n.base64=!0,n.array=!0,n.string=!0,n.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",n.nodebuffer=typeof Buffer<"u",n.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")n.blob=!1;else{var l=new ArrayBuffer(0);try{n.blob=new Blob([l],{type:"application/zip"}).size===0}catch{try{var i=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);i.append(l),n.blob=i.getBlob("application/zip").size===0}catch{n.blob=!1}}}try{n.nodestream=!!t("readable-stream").Readable}catch{n.nodestream=!1}},{"readable-stream":16}],31:[function(t,s,n){for(var l=t("./utils"),i=t("./support"),d=t("./nodejsUtils"),u=t("./stream/GenericWorker"),g=new Array(256),y=0;y<256;y++)g[y]=252<=y?6:248<=y?5:240<=y?4:224<=y?3:192<=y?2:1;g[254]=g[254]=1;function m(){u.call(this,"utf-8 decode"),this.leftOver=null}function x(){u.call(this,"utf-8 encode")}n.utf8encode=function(p){return i.nodebuffer?d.newBufferFrom(p,"utf-8"):(function(k){var v,S,b,f,T,M=k.length,H=0;for(f=0;f<M;f++)(64512&(S=k.charCodeAt(f)))==55296&&f+1<M&&(64512&(b=k.charCodeAt(f+1)))==56320&&(S=65536+(S-55296<<10)+(b-56320),f++),H+=S<128?1:S<2048?2:S<65536?3:4;for(v=i.uint8array?new Uint8Array(H):new Array(H),f=T=0;T<H;f++)(64512&(S=k.charCodeAt(f)))==55296&&f+1<M&&(64512&(b=k.charCodeAt(f+1)))==56320&&(S=65536+(S-55296<<10)+(b-56320),f++),S<128?v[T++]=S:(S<2048?v[T++]=192|S>>>6:(S<65536?v[T++]=224|S>>>12:(v[T++]=240|S>>>18,v[T++]=128|S>>>12&63),v[T++]=128|S>>>6&63),v[T++]=128|63&S);return v})(p)},n.utf8decode=function(p){return i.nodebuffer?l.transformTo("nodebuffer",p).toString("utf-8"):(function(k){var v,S,b,f,T=k.length,M=new Array(2*T);for(v=S=0;v<T;)if((b=k[v++])<128)M[S++]=b;else if(4<(f=g[b]))M[S++]=65533,v+=f-1;else{for(b&=f===2?31:f===3?15:7;1<f&&v<T;)b=b<<6|63&k[v++],f--;1<f?M[S++]=65533:b<65536?M[S++]=b:(b-=65536,M[S++]=55296|b>>10&1023,M[S++]=56320|1023&b)}return M.length!==S&&(M.subarray?M=M.subarray(0,S):M.length=S),l.applyFromCharCode(M)})(p=l.transformTo(i.uint8array?"uint8array":"array",p))},l.inherits(m,u),m.prototype.processChunk=function(p){var k=l.transformTo(i.uint8array?"uint8array":"array",p.data);if(this.leftOver&&this.leftOver.length){if(i.uint8array){var v=k;(k=new Uint8Array(v.length+this.leftOver.length)).set(this.leftOver,0),k.set(v,this.leftOver.length)}else k=this.leftOver.concat(k);this.leftOver=null}var S=(function(f,T){var M;for((T=T||f.length)>f.length&&(T=f.length),M=T-1;0<=M&&(192&f[M])==128;)M--;return M<0||M===0?T:M+g[f[M]]>T?M:T})(k),b=k;S!==k.length&&(i.uint8array?(b=k.subarray(0,S),this.leftOver=k.subarray(S,k.length)):(b=k.slice(0,S),this.leftOver=k.slice(S,k.length))),this.push({data:n.utf8decode(b),meta:p.meta})},m.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:n.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},n.Utf8DecodeWorker=m,l.inherits(x,u),x.prototype.processChunk=function(p){this.push({data:n.utf8encode(p.data),meta:p.meta})},n.Utf8EncodeWorker=x},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(t,s,n){var l=t("./support"),i=t("./base64"),d=t("./nodejsUtils"),u=t("./external");function g(v){return v}function y(v,S){for(var b=0;b<v.length;++b)S[b]=255&v.charCodeAt(b);return S}t("setimmediate"),n.newBlob=function(v,S){n.checkSupport("blob");try{return new Blob([v],{type:S})}catch{try{var b=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return b.append(v),b.getBlob(S)}catch{throw new Error("Bug : can't construct the Blob.")}}};var m={stringifyByChunk:function(v,S,b){var f=[],T=0,M=v.length;if(M<=b)return String.fromCharCode.apply(null,v);for(;T<M;)S==="array"||S==="nodebuffer"?f.push(String.fromCharCode.apply(null,v.slice(T,Math.min(T+b,M)))):f.push(String.fromCharCode.apply(null,v.subarray(T,Math.min(T+b,M)))),T+=b;return f.join("")},stringifyByChar:function(v){for(var S="",b=0;b<v.length;b++)S+=String.fromCharCode(v[b]);return S},applyCanBeUsed:{uint8array:(function(){try{return l.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}})(),nodebuffer:(function(){try{return l.nodebuffer&&String.fromCharCode.apply(null,d.allocBuffer(1)).length===1}catch{return!1}})()}};function x(v){var S=65536,b=n.getTypeOf(v),f=!0;if(b==="uint8array"?f=m.applyCanBeUsed.uint8array:b==="nodebuffer"&&(f=m.applyCanBeUsed.nodebuffer),f)for(;1<S;)try{return m.stringifyByChunk(v,b,S)}catch{S=Math.floor(S/2)}return m.stringifyByChar(v)}function p(v,S){for(var b=0;b<v.length;b++)S[b]=v[b];return S}n.applyFromCharCode=x;var k={};k.string={string:g,array:function(v){return y(v,new Array(v.length))},arraybuffer:function(v){return k.string.uint8array(v).buffer},uint8array:function(v){return y(v,new Uint8Array(v.length))},nodebuffer:function(v){return y(v,d.allocBuffer(v.length))}},k.array={string:x,array:g,arraybuffer:function(v){return new Uint8Array(v).buffer},uint8array:function(v){return new Uint8Array(v)},nodebuffer:function(v){return d.newBufferFrom(v)}},k.arraybuffer={string:function(v){return x(new Uint8Array(v))},array:function(v){return p(new Uint8Array(v),new Array(v.byteLength))},arraybuffer:g,uint8array:function(v){return new Uint8Array(v)},nodebuffer:function(v){return d.newBufferFrom(new Uint8Array(v))}},k.uint8array={string:x,array:function(v){return p(v,new Array(v.length))},arraybuffer:function(v){return v.buffer},uint8array:g,nodebuffer:function(v){return d.newBufferFrom(v)}},k.nodebuffer={string:x,array:function(v){return p(v,new Array(v.length))},arraybuffer:function(v){return k.nodebuffer.uint8array(v).buffer},uint8array:function(v){return p(v,new Uint8Array(v.length))},nodebuffer:g},n.transformTo=function(v,S){if(S=S||"",!v)return S;n.checkSupport(v);var b=n.getTypeOf(S);return k[b][v](S)},n.resolve=function(v){for(var S=v.split("/"),b=[],f=0;f<S.length;f++){var T=S[f];T==="."||T===""&&f!==0&&f!==S.length-1||(T===".."?b.pop():b.push(T))}return b.join("/")},n.getTypeOf=function(v){return typeof v=="string"?"string":Object.prototype.toString.call(v)==="[object Array]"?"array":l.nodebuffer&&d.isBuffer(v)?"nodebuffer":l.uint8array&&v instanceof Uint8Array?"uint8array":l.arraybuffer&&v instanceof ArrayBuffer?"arraybuffer":void 0},n.checkSupport=function(v){if(!l[v.toLowerCase()])throw new Error(v+" is not supported by this platform")},n.MAX_VALUE_16BITS=65535,n.MAX_VALUE_32BITS=-1,n.pretty=function(v){var S,b,f="";for(b=0;b<(v||"").length;b++)f+="\\x"+((S=v.charCodeAt(b))<16?"0":"")+S.toString(16).toUpperCase();return f},n.delay=function(v,S,b){setImmediate(function(){v.apply(b||null,S||[])})},n.inherits=function(v,S){function b(){}b.prototype=S.prototype,v.prototype=new b},n.extend=function(){var v,S,b={};for(v=0;v<arguments.length;v++)for(S in arguments[v])Object.prototype.hasOwnProperty.call(arguments[v],S)&&b[S]===void 0&&(b[S]=arguments[v][S]);return b},n.prepareContent=function(v,S,b,f,T){return u.Promise.resolve(S).then(function(M){return l.blob&&(M instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(M))!==-1)&&typeof FileReader<"u"?new u.Promise(function(H,R){var A=new FileReader;A.onload=function(W){H(W.target.result)},A.onerror=function(W){R(W.target.error)},A.readAsArrayBuffer(M)}):M}).then(function(M){var H=n.getTypeOf(M);return H?(H==="arraybuffer"?M=n.transformTo("uint8array",M):H==="string"&&(T?M=i.decode(M):b&&f!==!0&&(M=(function(R){return y(R,l.uint8array?new Uint8Array(R.length):new Array(R.length))})(M))),M):u.Promise.reject(new Error("Can't read the data of '"+v+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(t,s,n){var l=t("./reader/readerFor"),i=t("./utils"),d=t("./signature"),u=t("./zipEntry"),g=t("./support");function y(m){this.files=[],this.loadOptions=m}y.prototype={checkSignature:function(m){if(!this.reader.readAndCheckSignature(m)){this.reader.index-=4;var x=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+i.pretty(x)+", expected "+i.pretty(m)+")")}},isSignature:function(m,x){var p=this.reader.index;this.reader.setIndex(m);var k=this.reader.readString(4)===x;return this.reader.setIndex(p),k},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var m=this.reader.readData(this.zipCommentLength),x=g.uint8array?"uint8array":"array",p=i.transformTo(x,m);this.zipComment=this.loadOptions.decodeFileName(p)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var m,x,p,k=this.zip64EndOfCentralSize-44;0<k;)m=this.reader.readInt(2),x=this.reader.readInt(4),p=this.reader.readData(x),this.zip64ExtensibleData[m]={id:m,length:x,value:p}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var m,x;for(m=0;m<this.files.length;m++)x=this.files[m],this.reader.setIndex(x.localHeaderOffset),this.checkSignature(d.LOCAL_FILE_HEADER),x.readLocalPart(this.reader),x.handleUTF8(),x.processAttributes()},readCentralDir:function(){var m;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(d.CENTRAL_FILE_HEADER);)(m=new u({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(m);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var m=this.reader.lastIndexOfSignature(d.CENTRAL_DIRECTORY_END);if(m<0)throw this.isSignature(0,d.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(m);var x=m;if(this.checkSignature(d.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===i.MAX_VALUE_16BITS||this.diskWithCentralDirStart===i.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===i.MAX_VALUE_16BITS||this.centralDirRecords===i.MAX_VALUE_16BITS||this.centralDirSize===i.MAX_VALUE_32BITS||this.centralDirOffset===i.MAX_VALUE_32BITS){if(this.zip64=!0,(m=this.reader.lastIndexOfSignature(d.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(m),this.checkSignature(d.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,d.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(d.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(d.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var p=this.centralDirOffset+this.centralDirSize;this.zip64&&(p+=20,p+=12+this.zip64EndOfCentralSize);var k=x-p;if(0<k)this.isSignature(x,d.CENTRAL_FILE_HEADER)||(this.reader.zero=k);else if(k<0)throw new Error("Corrupted zip: missing "+Math.abs(k)+" bytes.")},prepareReader:function(m){this.reader=l(m)},load:function(m){this.prepareReader(m),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},s.exports=y},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(t,s,n){var l=t("./reader/readerFor"),i=t("./utils"),d=t("./compressedObject"),u=t("./crc32"),g=t("./utf8"),y=t("./compressions"),m=t("./support");function x(p,k){this.options=p,this.loadOptions=k}x.prototype={isEncrypted:function(){return(1&this.bitFlag)==1},useUTF8:function(){return(2048&this.bitFlag)==2048},readLocalPart:function(p){var k,v;if(p.skip(22),this.fileNameLength=p.readInt(2),v=p.readInt(2),this.fileName=p.readData(this.fileNameLength),p.skip(v),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if((k=(function(S){for(var b in y)if(Object.prototype.hasOwnProperty.call(y,b)&&y[b].magic===S)return y[b];return null})(this.compressionMethod))===null)throw new Error("Corrupted zip : compression "+i.pretty(this.compressionMethod)+" unknown (inner file : "+i.transformTo("string",this.fileName)+")");this.decompressed=new d(this.compressedSize,this.uncompressedSize,this.crc32,k,p.readData(this.compressedSize))},readCentralPart:function(p){this.versionMadeBy=p.readInt(2),p.skip(2),this.bitFlag=p.readInt(2),this.compressionMethod=p.readString(2),this.date=p.readDate(),this.crc32=p.readInt(4),this.compressedSize=p.readInt(4),this.uncompressedSize=p.readInt(4);var k=p.readInt(2);if(this.extraFieldsLength=p.readInt(2),this.fileCommentLength=p.readInt(2),this.diskNumberStart=p.readInt(2),this.internalFileAttributes=p.readInt(2),this.externalFileAttributes=p.readInt(4),this.localHeaderOffset=p.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");p.skip(k),this.readExtraFields(p),this.parseZIP64ExtraField(p),this.fileComment=p.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var p=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),p==0&&(this.dosPermissions=63&this.externalFileAttributes),p==3&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||this.fileNameStr.slice(-1)!=="/"||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var p=l(this.extraFields[1].value);this.uncompressedSize===i.MAX_VALUE_32BITS&&(this.uncompressedSize=p.readInt(8)),this.compressedSize===i.MAX_VALUE_32BITS&&(this.compressedSize=p.readInt(8)),this.localHeaderOffset===i.MAX_VALUE_32BITS&&(this.localHeaderOffset=p.readInt(8)),this.diskNumberStart===i.MAX_VALUE_32BITS&&(this.diskNumberStart=p.readInt(4))}},readExtraFields:function(p){var k,v,S,b=p.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});p.index+4<b;)k=p.readInt(2),v=p.readInt(2),S=p.readData(v),this.extraFields[k]={id:k,length:v,value:S};p.setIndex(b)},handleUTF8:function(){var p=m.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=g.utf8decode(this.fileName),this.fileCommentStr=g.utf8decode(this.fileComment);else{var k=this.findExtraFieldUnicodePath();if(k!==null)this.fileNameStr=k;else{var v=i.transformTo(p,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(v)}var S=this.findExtraFieldUnicodeComment();if(S!==null)this.fileCommentStr=S;else{var b=i.transformTo(p,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(b)}}},findExtraFieldUnicodePath:function(){var p=this.extraFields[28789];if(p){var k=l(p.value);return k.readInt(1)!==1||u(this.fileName)!==k.readInt(4)?null:g.utf8decode(k.readData(p.length-5))}return null},findExtraFieldUnicodeComment:function(){var p=this.extraFields[25461];if(p){var k=l(p.value);return k.readInt(1)!==1||u(this.fileComment)!==k.readInt(4)?null:g.utf8decode(k.readData(p.length-5))}return null}},s.exports=x},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(t,s,n){function l(k,v,S){this.name=k,this.dir=S.dir,this.date=S.date,this.comment=S.comment,this.unixPermissions=S.unixPermissions,this.dosPermissions=S.dosPermissions,this._data=v,this._dataBinary=S.binary,this.options={compression:S.compression,compressionOptions:S.compressionOptions}}var i=t("./stream/StreamHelper"),d=t("./stream/DataWorker"),u=t("./utf8"),g=t("./compressedObject"),y=t("./stream/GenericWorker");l.prototype={internalStream:function(k){var v=null,S="string";try{if(!k)throw new Error("No output type specified.");var b=(S=k.toLowerCase())==="string"||S==="text";S!=="binarystring"&&S!=="text"||(S="string"),v=this._decompressWorker();var f=!this._dataBinary;f&&!b&&(v=v.pipe(new u.Utf8EncodeWorker)),!f&&b&&(v=v.pipe(new u.Utf8DecodeWorker))}catch(T){(v=new y("error")).error(T)}return new i(v,S,"")},async:function(k,v){return this.internalStream(k).accumulate(v)},nodeStream:function(k,v){return this.internalStream(k||"nodebuffer").toNodejsStream(v)},_compressWorker:function(k,v){if(this._data instanceof g&&this._data.compression.magic===k.magic)return this._data.getCompressedWorker();var S=this._decompressWorker();return this._dataBinary||(S=S.pipe(new u.Utf8EncodeWorker)),g.createWorkerFrom(S,k,v)},_decompressWorker:function(){return this._data instanceof g?this._data.getContentWorker():this._data instanceof y?this._data:new d(this._data)}};for(var m=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],x=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},p=0;p<m.length;p++)l.prototype[m[p]]=x;s.exports=l},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(t,s,n){(function(l){var i,d,u=l.MutationObserver||l.WebKitMutationObserver;if(u){var g=0,y=new u(k),m=l.document.createTextNode("");y.observe(m,{characterData:!0}),i=function(){m.data=g=++g%2}}else if(l.setImmediate||l.MessageChannel===void 0)i="document"in l&&"onreadystatechange"in l.document.createElement("script")?function(){var v=l.document.createElement("script");v.onreadystatechange=function(){k(),v.onreadystatechange=null,v.parentNode.removeChild(v),v=null},l.document.documentElement.appendChild(v)}:function(){setTimeout(k,0)};else{var x=new l.MessageChannel;x.port1.onmessage=k,i=function(){x.port2.postMessage(0)}}var p=[];function k(){var v,S;d=!0;for(var b=p.length;b;){for(S=p,p=[],v=-1;++v<b;)S[v]();b=p.length}d=!1}s.exports=function(v){p.push(v)!==1||d||i()}}).call(this,typeof dt<"u"?dt:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(t,s,n){var l=t("immediate");function i(){}var d={},u=["REJECTED"],g=["FULFILLED"],y=["PENDING"];function m(b){if(typeof b!="function")throw new TypeError("resolver must be a function");this.state=y,this.queue=[],this.outcome=void 0,b!==i&&v(this,b)}function x(b,f,T){this.promise=b,typeof f=="function"&&(this.onFulfilled=f,this.callFulfilled=this.otherCallFulfilled),typeof T=="function"&&(this.onRejected=T,this.callRejected=this.otherCallRejected)}function p(b,f,T){l(function(){var M;try{M=f(T)}catch(H){return d.reject(b,H)}M===b?d.reject(b,new TypeError("Cannot resolve promise with itself")):d.resolve(b,M)})}function k(b){var f=b&&b.then;if(b&&(typeof b=="object"||typeof b=="function")&&typeof f=="function")return function(){f.apply(b,arguments)}}function v(b,f){var T=!1;function M(A){T||(T=!0,d.reject(b,A))}function H(A){T||(T=!0,d.resolve(b,A))}var R=S(function(){f(H,M)});R.status==="error"&&M(R.value)}function S(b,f){var T={};try{T.value=b(f),T.status="success"}catch(M){T.status="error",T.value=M}return T}(s.exports=m).prototype.finally=function(b){if(typeof b!="function")return this;var f=this.constructor;return this.then(function(T){return f.resolve(b()).then(function(){return T})},function(T){return f.resolve(b()).then(function(){throw T})})},m.prototype.catch=function(b){return this.then(null,b)},m.prototype.then=function(b,f){if(typeof b!="function"&&this.state===g||typeof f!="function"&&this.state===u)return this;var T=new this.constructor(i);return this.state!==y?p(T,this.state===g?b:f,this.outcome):this.queue.push(new x(T,b,f)),T},x.prototype.callFulfilled=function(b){d.resolve(this.promise,b)},x.prototype.otherCallFulfilled=function(b){p(this.promise,this.onFulfilled,b)},x.prototype.callRejected=function(b){d.reject(this.promise,b)},x.prototype.otherCallRejected=function(b){p(this.promise,this.onRejected,b)},d.resolve=function(b,f){var T=S(k,f);if(T.status==="error")return d.reject(b,T.value);var M=T.value;if(M)v(b,M);else{b.state=g,b.outcome=f;for(var H=-1,R=b.queue.length;++H<R;)b.queue[H].callFulfilled(f)}return b},d.reject=function(b,f){b.state=u,b.outcome=f;for(var T=-1,M=b.queue.length;++T<M;)b.queue[T].callRejected(f);return b},m.resolve=function(b){return b instanceof this?b:d.resolve(new this(i),b)},m.reject=function(b){var f=new this(i);return d.reject(f,b)},m.all=function(b){var f=this;if(Object.prototype.toString.call(b)!=="[object Array]")return this.reject(new TypeError("must be an array"));var T=b.length,M=!1;if(!T)return this.resolve([]);for(var H=new Array(T),R=0,A=-1,W=new this(i);++A<T;)X(b[A],A);return W;function X(se,G){f.resolve(se).then(function($){H[G]=$,++R!==T||M||(M=!0,d.resolve(W,H))},function($){M||(M=!0,d.reject(W,$))})}},m.race=function(b){var f=this;if(Object.prototype.toString.call(b)!=="[object Array]")return this.reject(new TypeError("must be an array"));var T=b.length,M=!1;if(!T)return this.resolve([]);for(var H=-1,R=new this(i);++H<T;)A=b[H],f.resolve(A).then(function(W){M||(M=!0,d.resolve(R,W))},function(W){M||(M=!0,d.reject(R,W))});var A;return R}},{immediate:36}],38:[function(t,s,n){var l={};(0,t("./lib/utils/common").assign)(l,t("./lib/deflate"),t("./lib/inflate"),t("./lib/zlib/constants")),s.exports=l},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(t,s,n){var l=t("./zlib/deflate"),i=t("./utils/common"),d=t("./utils/strings"),u=t("./zlib/messages"),g=t("./zlib/zstream"),y=Object.prototype.toString,m=0,x=-1,p=0,k=8;function v(b){if(!(this instanceof v))return new v(b);this.options=i.assign({level:x,method:k,chunkSize:16384,windowBits:15,memLevel:8,strategy:p,to:""},b||{});var f=this.options;f.raw&&0<f.windowBits?f.windowBits=-f.windowBits:f.gzip&&0<f.windowBits&&f.windowBits<16&&(f.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new g,this.strm.avail_out=0;var T=l.deflateInit2(this.strm,f.level,f.method,f.windowBits,f.memLevel,f.strategy);if(T!==m)throw new Error(u[T]);if(f.header&&l.deflateSetHeader(this.strm,f.header),f.dictionary){var M;if(M=typeof f.dictionary=="string"?d.string2buf(f.dictionary):y.call(f.dictionary)==="[object ArrayBuffer]"?new Uint8Array(f.dictionary):f.dictionary,(T=l.deflateSetDictionary(this.strm,M))!==m)throw new Error(u[T]);this._dict_set=!0}}function S(b,f){var T=new v(f);if(T.push(b,!0),T.err)throw T.msg||u[T.err];return T.result}v.prototype.push=function(b,f){var T,M,H=this.strm,R=this.options.chunkSize;if(this.ended)return!1;M=f===~~f?f:f===!0?4:0,typeof b=="string"?H.input=d.string2buf(b):y.call(b)==="[object ArrayBuffer]"?H.input=new Uint8Array(b):H.input=b,H.next_in=0,H.avail_in=H.input.length;do{if(H.avail_out===0&&(H.output=new i.Buf8(R),H.next_out=0,H.avail_out=R),(T=l.deflate(H,M))!==1&&T!==m)return this.onEnd(T),!(this.ended=!0);H.avail_out!==0&&(H.avail_in!==0||M!==4&&M!==2)||(this.options.to==="string"?this.onData(d.buf2binstring(i.shrinkBuf(H.output,H.next_out))):this.onData(i.shrinkBuf(H.output,H.next_out)))}while((0<H.avail_in||H.avail_out===0)&&T!==1);return M===4?(T=l.deflateEnd(this.strm),this.onEnd(T),this.ended=!0,T===m):M!==2||(this.onEnd(m),!(H.avail_out=0))},v.prototype.onData=function(b){this.chunks.push(b)},v.prototype.onEnd=function(b){b===m&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=i.flattenChunks(this.chunks)),this.chunks=[],this.err=b,this.msg=this.strm.msg},n.Deflate=v,n.deflate=S,n.deflateRaw=function(b,f){return(f=f||{}).raw=!0,S(b,f)},n.gzip=function(b,f){return(f=f||{}).gzip=!0,S(b,f)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(t,s,n){var l=t("./zlib/inflate"),i=t("./utils/common"),d=t("./utils/strings"),u=t("./zlib/constants"),g=t("./zlib/messages"),y=t("./zlib/zstream"),m=t("./zlib/gzheader"),x=Object.prototype.toString;function p(v){if(!(this instanceof p))return new p(v);this.options=i.assign({chunkSize:16384,windowBits:0,to:""},v||{});var S=this.options;S.raw&&0<=S.windowBits&&S.windowBits<16&&(S.windowBits=-S.windowBits,S.windowBits===0&&(S.windowBits=-15)),!(0<=S.windowBits&&S.windowBits<16)||v&&v.windowBits||(S.windowBits+=32),15<S.windowBits&&S.windowBits<48&&(15&S.windowBits)==0&&(S.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new y,this.strm.avail_out=0;var b=l.inflateInit2(this.strm,S.windowBits);if(b!==u.Z_OK)throw new Error(g[b]);this.header=new m,l.inflateGetHeader(this.strm,this.header)}function k(v,S){var b=new p(S);if(b.push(v,!0),b.err)throw b.msg||g[b.err];return b.result}p.prototype.push=function(v,S){var b,f,T,M,H,R,A=this.strm,W=this.options.chunkSize,X=this.options.dictionary,se=!1;if(this.ended)return!1;f=S===~~S?S:S===!0?u.Z_FINISH:u.Z_NO_FLUSH,typeof v=="string"?A.input=d.binstring2buf(v):x.call(v)==="[object ArrayBuffer]"?A.input=new Uint8Array(v):A.input=v,A.next_in=0,A.avail_in=A.input.length;do{if(A.avail_out===0&&(A.output=new i.Buf8(W),A.next_out=0,A.avail_out=W),(b=l.inflate(A,u.Z_NO_FLUSH))===u.Z_NEED_DICT&&X&&(R=typeof X=="string"?d.string2buf(X):x.call(X)==="[object ArrayBuffer]"?new Uint8Array(X):X,b=l.inflateSetDictionary(this.strm,R)),b===u.Z_BUF_ERROR&&se===!0&&(b=u.Z_OK,se=!1),b!==u.Z_STREAM_END&&b!==u.Z_OK)return this.onEnd(b),!(this.ended=!0);A.next_out&&(A.avail_out!==0&&b!==u.Z_STREAM_END&&(A.avail_in!==0||f!==u.Z_FINISH&&f!==u.Z_SYNC_FLUSH)||(this.options.to==="string"?(T=d.utf8border(A.output,A.next_out),M=A.next_out-T,H=d.buf2string(A.output,T),A.next_out=M,A.avail_out=W-M,M&&i.arraySet(A.output,A.output,T,M,0),this.onData(H)):this.onData(i.shrinkBuf(A.output,A.next_out)))),A.avail_in===0&&A.avail_out===0&&(se=!0)}while((0<A.avail_in||A.avail_out===0)&&b!==u.Z_STREAM_END);return b===u.Z_STREAM_END&&(f=u.Z_FINISH),f===u.Z_FINISH?(b=l.inflateEnd(this.strm),this.onEnd(b),this.ended=!0,b===u.Z_OK):f!==u.Z_SYNC_FLUSH||(this.onEnd(u.Z_OK),!(A.avail_out=0))},p.prototype.onData=function(v){this.chunks.push(v)},p.prototype.onEnd=function(v){v===u.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=i.flattenChunks(this.chunks)),this.chunks=[],this.err=v,this.msg=this.strm.msg},n.Inflate=p,n.inflate=k,n.inflateRaw=function(v,S){return(S=S||{}).raw=!0,k(v,S)},n.ungzip=k},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(t,s,n){var l=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";n.assign=function(u){for(var g=Array.prototype.slice.call(arguments,1);g.length;){var y=g.shift();if(y){if(typeof y!="object")throw new TypeError(y+"must be non-object");for(var m in y)y.hasOwnProperty(m)&&(u[m]=y[m])}}return u},n.shrinkBuf=function(u,g){return u.length===g?u:u.subarray?u.subarray(0,g):(u.length=g,u)};var i={arraySet:function(u,g,y,m,x){if(g.subarray&&u.subarray)u.set(g.subarray(y,y+m),x);else for(var p=0;p<m;p++)u[x+p]=g[y+p]},flattenChunks:function(u){var g,y,m,x,p,k;for(g=m=0,y=u.length;g<y;g++)m+=u[g].length;for(k=new Uint8Array(m),g=x=0,y=u.length;g<y;g++)p=u[g],k.set(p,x),x+=p.length;return k}},d={arraySet:function(u,g,y,m,x){for(var p=0;p<m;p++)u[x+p]=g[y+p]},flattenChunks:function(u){return[].concat.apply([],u)}};n.setTyped=function(u){u?(n.Buf8=Uint8Array,n.Buf16=Uint16Array,n.Buf32=Int32Array,n.assign(n,i)):(n.Buf8=Array,n.Buf16=Array,n.Buf32=Array,n.assign(n,d))},n.setTyped(l)},{}],42:[function(t,s,n){var l=t("./common"),i=!0,d=!0;try{String.fromCharCode.apply(null,[0])}catch{i=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{d=!1}for(var u=new l.Buf8(256),g=0;g<256;g++)u[g]=252<=g?6:248<=g?5:240<=g?4:224<=g?3:192<=g?2:1;function y(m,x){if(x<65537&&(m.subarray&&d||!m.subarray&&i))return String.fromCharCode.apply(null,l.shrinkBuf(m,x));for(var p="",k=0;k<x;k++)p+=String.fromCharCode(m[k]);return p}u[254]=u[254]=1,n.string2buf=function(m){var x,p,k,v,S,b=m.length,f=0;for(v=0;v<b;v++)(64512&(p=m.charCodeAt(v)))==55296&&v+1<b&&(64512&(k=m.charCodeAt(v+1)))==56320&&(p=65536+(p-55296<<10)+(k-56320),v++),f+=p<128?1:p<2048?2:p<65536?3:4;for(x=new l.Buf8(f),v=S=0;S<f;v++)(64512&(p=m.charCodeAt(v)))==55296&&v+1<b&&(64512&(k=m.charCodeAt(v+1)))==56320&&(p=65536+(p-55296<<10)+(k-56320),v++),p<128?x[S++]=p:(p<2048?x[S++]=192|p>>>6:(p<65536?x[S++]=224|p>>>12:(x[S++]=240|p>>>18,x[S++]=128|p>>>12&63),x[S++]=128|p>>>6&63),x[S++]=128|63&p);return x},n.buf2binstring=function(m){return y(m,m.length)},n.binstring2buf=function(m){for(var x=new l.Buf8(m.length),p=0,k=x.length;p<k;p++)x[p]=m.charCodeAt(p);return x},n.buf2string=function(m,x){var p,k,v,S,b=x||m.length,f=new Array(2*b);for(p=k=0;p<b;)if((v=m[p++])<128)f[k++]=v;else if(4<(S=u[v]))f[k++]=65533,p+=S-1;else{for(v&=S===2?31:S===3?15:7;1<S&&p<b;)v=v<<6|63&m[p++],S--;1<S?f[k++]=65533:v<65536?f[k++]=v:(v-=65536,f[k++]=55296|v>>10&1023,f[k++]=56320|1023&v)}return y(f,k)},n.utf8border=function(m,x){var p;for((x=x||m.length)>m.length&&(x=m.length),p=x-1;0<=p&&(192&m[p])==128;)p--;return p<0||p===0?x:p+u[m[p]]>x?p:x}},{"./common":41}],43:[function(t,s,n){s.exports=function(l,i,d,u){for(var g=65535&l|0,y=l>>>16&65535|0,m=0;d!==0;){for(d-=m=2e3<d?2e3:d;y=y+(g=g+i[u++]|0)|0,--m;);g%=65521,y%=65521}return g|y<<16|0}},{}],44:[function(t,s,n){s.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(t,s,n){var l=(function(){for(var i,d=[],u=0;u<256;u++){i=u;for(var g=0;g<8;g++)i=1&i?3988292384^i>>>1:i>>>1;d[u]=i}return d})();s.exports=function(i,d,u,g){var y=l,m=g+u;i^=-1;for(var x=g;x<m;x++)i=i>>>8^y[255&(i^d[x])];return-1^i}},{}],46:[function(t,s,n){var l,i=t("../utils/common"),d=t("./trees"),u=t("./adler32"),g=t("./crc32"),y=t("./messages"),m=0,x=4,p=0,k=-2,v=-1,S=4,b=2,f=8,T=9,M=286,H=30,R=19,A=2*M+1,W=15,X=3,se=258,G=se+X+1,$=42,O=113,h=1,w=2,Y=3,te=4;function Q(c,N){return c.msg=y[N],N}function I(c){return(c<<1)-(4<c?9:0)}function V(c){for(var N=c.length;0<=--N;)c[N]=0}function L(c){var N=c.state,q=N.pending;q>c.avail_out&&(q=c.avail_out),q!==0&&(i.arraySet(c.output,N.pending_buf,N.pending_out,q,c.next_out),c.next_out+=q,N.pending_out+=q,c.total_out+=q,c.avail_out-=q,N.pending-=q,N.pending===0&&(N.pending_out=0))}function B(c,N){d._tr_flush_block(c,0<=c.block_start?c.block_start:-1,c.strstart-c.block_start,N),c.block_start=c.strstart,L(c.strm)}function re(c,N){c.pending_buf[c.pending++]=N}function Z(c,N){c.pending_buf[c.pending++]=N>>>8&255,c.pending_buf[c.pending++]=255&N}function ne(c,N){var q,_,C=c.max_chain_length,j=c.strstart,P=c.prev_length,J=c.nice_match,D=c.strstart>c.w_size-G?c.strstart-(c.w_size-G):0,le=c.window,he=c.w_mask,ue=c.prev,pe=c.strstart+se,ee=le[j+P-1],U=le[j+P];c.prev_length>=c.good_match&&(C>>=2),J>c.lookahead&&(J=c.lookahead);do if(le[(q=N)+P]===U&&le[q+P-1]===ee&&le[q]===le[j]&&le[++q]===le[j+1]){j+=2,q++;do;while(le[++j]===le[++q]&&le[++j]===le[++q]&&le[++j]===le[++q]&&le[++j]===le[++q]&&le[++j]===le[++q]&&le[++j]===le[++q]&&le[++j]===le[++q]&&le[++j]===le[++q]&&j<pe);if(_=se-(pe-j),j=pe-se,P<_){if(c.match_start=N,J<=(P=_))break;ee=le[j+P-1],U=le[j+P]}}while((N=ue[N&he])>D&&--C!=0);return P<=c.lookahead?P:c.lookahead}function ve(c){var N,q,_,C,j,P,J,D,le,he,ue=c.w_size;do{if(C=c.window_size-c.lookahead-c.strstart,c.strstart>=ue+(ue-G)){for(i.arraySet(c.window,c.window,ue,ue,0),c.match_start-=ue,c.strstart-=ue,c.block_start-=ue,N=q=c.hash_size;_=c.head[--N],c.head[N]=ue<=_?_-ue:0,--q;);for(N=q=ue;_=c.prev[--N],c.prev[N]=ue<=_?_-ue:0,--q;);C+=ue}if(c.strm.avail_in===0)break;if(P=c.strm,J=c.window,D=c.strstart+c.lookahead,le=C,he=void 0,he=P.avail_in,le<he&&(he=le),q=he===0?0:(P.avail_in-=he,i.arraySet(J,P.input,P.next_in,he,D),P.state.wrap===1?P.adler=u(P.adler,J,he,D):P.state.wrap===2&&(P.adler=g(P.adler,J,he,D)),P.next_in+=he,P.total_in+=he,he),c.lookahead+=q,c.lookahead+c.insert>=X)for(j=c.strstart-c.insert,c.ins_h=c.window[j],c.ins_h=(c.ins_h<<c.hash_shift^c.window[j+1])&c.hash_mask;c.insert&&(c.ins_h=(c.ins_h<<c.hash_shift^c.window[j+X-1])&c.hash_mask,c.prev[j&c.w_mask]=c.head[c.ins_h],c.head[c.ins_h]=j,j++,c.insert--,!(c.lookahead+c.insert<X)););}while(c.lookahead<G&&c.strm.avail_in!==0)}function xe(c,N){for(var q,_;;){if(c.lookahead<G){if(ve(c),c.lookahead<G&&N===m)return h;if(c.lookahead===0)break}if(q=0,c.lookahead>=X&&(c.ins_h=(c.ins_h<<c.hash_shift^c.window[c.strstart+X-1])&c.hash_mask,q=c.prev[c.strstart&c.w_mask]=c.head[c.ins_h],c.head[c.ins_h]=c.strstart),q!==0&&c.strstart-q<=c.w_size-G&&(c.match_length=ne(c,q)),c.match_length>=X)if(_=d._tr_tally(c,c.strstart-c.match_start,c.match_length-X),c.lookahead-=c.match_length,c.match_length<=c.max_lazy_match&&c.lookahead>=X){for(c.match_length--;c.strstart++,c.ins_h=(c.ins_h<<c.hash_shift^c.window[c.strstart+X-1])&c.hash_mask,q=c.prev[c.strstart&c.w_mask]=c.head[c.ins_h],c.head[c.ins_h]=c.strstart,--c.match_length!=0;);c.strstart++}else c.strstart+=c.match_length,c.match_length=0,c.ins_h=c.window[c.strstart],c.ins_h=(c.ins_h<<c.hash_shift^c.window[c.strstart+1])&c.hash_mask;else _=d._tr_tally(c,0,c.window[c.strstart]),c.lookahead--,c.strstart++;if(_&&(B(c,!1),c.strm.avail_out===0))return h}return c.insert=c.strstart<X-1?c.strstart:X-1,N===x?(B(c,!0),c.strm.avail_out===0?Y:te):c.last_lit&&(B(c,!1),c.strm.avail_out===0)?h:w}function de(c,N){for(var q,_,C;;){if(c.lookahead<G){if(ve(c),c.lookahead<G&&N===m)return h;if(c.lookahead===0)break}if(q=0,c.lookahead>=X&&(c.ins_h=(c.ins_h<<c.hash_shift^c.window[c.strstart+X-1])&c.hash_mask,q=c.prev[c.strstart&c.w_mask]=c.head[c.ins_h],c.head[c.ins_h]=c.strstart),c.prev_length=c.match_length,c.prev_match=c.match_start,c.match_length=X-1,q!==0&&c.prev_length<c.max_lazy_match&&c.strstart-q<=c.w_size-G&&(c.match_length=ne(c,q),c.match_length<=5&&(c.strategy===1||c.match_length===X&&4096<c.strstart-c.match_start)&&(c.match_length=X-1)),c.prev_length>=X&&c.match_length<=c.prev_length){for(C=c.strstart+c.lookahead-X,_=d._tr_tally(c,c.strstart-1-c.prev_match,c.prev_length-X),c.lookahead-=c.prev_length-1,c.prev_length-=2;++c.strstart<=C&&(c.ins_h=(c.ins_h<<c.hash_shift^c.window[c.strstart+X-1])&c.hash_mask,q=c.prev[c.strstart&c.w_mask]=c.head[c.ins_h],c.head[c.ins_h]=c.strstart),--c.prev_length!=0;);if(c.match_available=0,c.match_length=X-1,c.strstart++,_&&(B(c,!1),c.strm.avail_out===0))return h}else if(c.match_available){if((_=d._tr_tally(c,0,c.window[c.strstart-1]))&&B(c,!1),c.strstart++,c.lookahead--,c.strm.avail_out===0)return h}else c.match_available=1,c.strstart++,c.lookahead--}return c.match_available&&(_=d._tr_tally(c,0,c.window[c.strstart-1]),c.match_available=0),c.insert=c.strstart<X-1?c.strstart:X-1,N===x?(B(c,!0),c.strm.avail_out===0?Y:te):c.last_lit&&(B(c,!1),c.strm.avail_out===0)?h:w}function ke(c,N,q,_,C){this.good_length=c,this.max_lazy=N,this.nice_length=q,this.max_chain=_,this.func=C}function we(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=f,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new i.Buf16(2*A),this.dyn_dtree=new i.Buf16(2*(2*H+1)),this.bl_tree=new i.Buf16(2*(2*R+1)),V(this.dyn_ltree),V(this.dyn_dtree),V(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new i.Buf16(W+1),this.heap=new i.Buf16(2*M+1),V(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new i.Buf16(2*M+1),V(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function ae(c){var N;return c&&c.state?(c.total_in=c.total_out=0,c.data_type=b,(N=c.state).pending=0,N.pending_out=0,N.wrap<0&&(N.wrap=-N.wrap),N.status=N.wrap?$:O,c.adler=N.wrap===2?0:1,N.last_flush=m,d._tr_init(N),p):Q(c,k)}function K(c){var N=ae(c);return N===p&&(function(q){q.window_size=2*q.w_size,V(q.head),q.max_lazy_match=l[q.level].max_lazy,q.good_match=l[q.level].good_length,q.nice_match=l[q.level].nice_length,q.max_chain_length=l[q.level].max_chain,q.strstart=0,q.block_start=0,q.lookahead=0,q.insert=0,q.match_length=q.prev_length=X-1,q.match_available=0,q.ins_h=0})(c.state),N}function oe(c,N,q,_,C,j){if(!c)return k;var P=1;if(N===v&&(N=6),_<0?(P=0,_=-_):15<_&&(P=2,_-=16),C<1||T<C||q!==f||_<8||15<_||N<0||9<N||j<0||S<j)return Q(c,k);_===8&&(_=9);var J=new we;return(c.state=J).strm=c,J.wrap=P,J.gzhead=null,J.w_bits=_,J.w_size=1<<J.w_bits,J.w_mask=J.w_size-1,J.hash_bits=C+7,J.hash_size=1<<J.hash_bits,J.hash_mask=J.hash_size-1,J.hash_shift=~~((J.hash_bits+X-1)/X),J.window=new i.Buf8(2*J.w_size),J.head=new i.Buf16(J.hash_size),J.prev=new i.Buf16(J.w_size),J.lit_bufsize=1<<C+6,J.pending_buf_size=4*J.lit_bufsize,J.pending_buf=new i.Buf8(J.pending_buf_size),J.d_buf=1*J.lit_bufsize,J.l_buf=3*J.lit_bufsize,J.level=N,J.strategy=j,J.method=q,K(c)}l=[new ke(0,0,0,0,function(c,N){var q=65535;for(q>c.pending_buf_size-5&&(q=c.pending_buf_size-5);;){if(c.lookahead<=1){if(ve(c),c.lookahead===0&&N===m)return h;if(c.lookahead===0)break}c.strstart+=c.lookahead,c.lookahead=0;var _=c.block_start+q;if((c.strstart===0||c.strstart>=_)&&(c.lookahead=c.strstart-_,c.strstart=_,B(c,!1),c.strm.avail_out===0)||c.strstart-c.block_start>=c.w_size-G&&(B(c,!1),c.strm.avail_out===0))return h}return c.insert=0,N===x?(B(c,!0),c.strm.avail_out===0?Y:te):(c.strstart>c.block_start&&(B(c,!1),c.strm.avail_out),h)}),new ke(4,4,8,4,xe),new ke(4,5,16,8,xe),new ke(4,6,32,32,xe),new ke(4,4,16,16,de),new ke(8,16,32,32,de),new ke(8,16,128,128,de),new ke(8,32,128,256,de),new ke(32,128,258,1024,de),new ke(32,258,258,4096,de)],n.deflateInit=function(c,N){return oe(c,N,f,15,8,0)},n.deflateInit2=oe,n.deflateReset=K,n.deflateResetKeep=ae,n.deflateSetHeader=function(c,N){return c&&c.state?c.state.wrap!==2?k:(c.state.gzhead=N,p):k},n.deflate=function(c,N){var q,_,C,j;if(!c||!c.state||5<N||N<0)return c?Q(c,k):k;if(_=c.state,!c.output||!c.input&&c.avail_in!==0||_.status===666&&N!==x)return Q(c,c.avail_out===0?-5:k);if(_.strm=c,q=_.last_flush,_.last_flush=N,_.status===$)if(_.wrap===2)c.adler=0,re(_,31),re(_,139),re(_,8),_.gzhead?(re(_,(_.gzhead.text?1:0)+(_.gzhead.hcrc?2:0)+(_.gzhead.extra?4:0)+(_.gzhead.name?8:0)+(_.gzhead.comment?16:0)),re(_,255&_.gzhead.time),re(_,_.gzhead.time>>8&255),re(_,_.gzhead.time>>16&255),re(_,_.gzhead.time>>24&255),re(_,_.level===9?2:2<=_.strategy||_.level<2?4:0),re(_,255&_.gzhead.os),_.gzhead.extra&&_.gzhead.extra.length&&(re(_,255&_.gzhead.extra.length),re(_,_.gzhead.extra.length>>8&255)),_.gzhead.hcrc&&(c.adler=g(c.adler,_.pending_buf,_.pending,0)),_.gzindex=0,_.status=69):(re(_,0),re(_,0),re(_,0),re(_,0),re(_,0),re(_,_.level===9?2:2<=_.strategy||_.level<2?4:0),re(_,3),_.status=O);else{var P=f+(_.w_bits-8<<4)<<8;P|=(2<=_.strategy||_.level<2?0:_.level<6?1:_.level===6?2:3)<<6,_.strstart!==0&&(P|=32),P+=31-P%31,_.status=O,Z(_,P),_.strstart!==0&&(Z(_,c.adler>>>16),Z(_,65535&c.adler)),c.adler=1}if(_.status===69)if(_.gzhead.extra){for(C=_.pending;_.gzindex<(65535&_.gzhead.extra.length)&&(_.pending!==_.pending_buf_size||(_.gzhead.hcrc&&_.pending>C&&(c.adler=g(c.adler,_.pending_buf,_.pending-C,C)),L(c),C=_.pending,_.pending!==_.pending_buf_size));)re(_,255&_.gzhead.extra[_.gzindex]),_.gzindex++;_.gzhead.hcrc&&_.pending>C&&(c.adler=g(c.adler,_.pending_buf,_.pending-C,C)),_.gzindex===_.gzhead.extra.length&&(_.gzindex=0,_.status=73)}else _.status=73;if(_.status===73)if(_.gzhead.name){C=_.pending;do{if(_.pending===_.pending_buf_size&&(_.gzhead.hcrc&&_.pending>C&&(c.adler=g(c.adler,_.pending_buf,_.pending-C,C)),L(c),C=_.pending,_.pending===_.pending_buf_size)){j=1;break}j=_.gzindex<_.gzhead.name.length?255&_.gzhead.name.charCodeAt(_.gzindex++):0,re(_,j)}while(j!==0);_.gzhead.hcrc&&_.pending>C&&(c.adler=g(c.adler,_.pending_buf,_.pending-C,C)),j===0&&(_.gzindex=0,_.status=91)}else _.status=91;if(_.status===91)if(_.gzhead.comment){C=_.pending;do{if(_.pending===_.pending_buf_size&&(_.gzhead.hcrc&&_.pending>C&&(c.adler=g(c.adler,_.pending_buf,_.pending-C,C)),L(c),C=_.pending,_.pending===_.pending_buf_size)){j=1;break}j=_.gzindex<_.gzhead.comment.length?255&_.gzhead.comment.charCodeAt(_.gzindex++):0,re(_,j)}while(j!==0);_.gzhead.hcrc&&_.pending>C&&(c.adler=g(c.adler,_.pending_buf,_.pending-C,C)),j===0&&(_.status=103)}else _.status=103;if(_.status===103&&(_.gzhead.hcrc?(_.pending+2>_.pending_buf_size&&L(c),_.pending+2<=_.pending_buf_size&&(re(_,255&c.adler),re(_,c.adler>>8&255),c.adler=0,_.status=O)):_.status=O),_.pending!==0){if(L(c),c.avail_out===0)return _.last_flush=-1,p}else if(c.avail_in===0&&I(N)<=I(q)&&N!==x)return Q(c,-5);if(_.status===666&&c.avail_in!==0)return Q(c,-5);if(c.avail_in!==0||_.lookahead!==0||N!==m&&_.status!==666){var J=_.strategy===2?(function(D,le){for(var he;;){if(D.lookahead===0&&(ve(D),D.lookahead===0)){if(le===m)return h;break}if(D.match_length=0,he=d._tr_tally(D,0,D.window[D.strstart]),D.lookahead--,D.strstart++,he&&(B(D,!1),D.strm.avail_out===0))return h}return D.insert=0,le===x?(B(D,!0),D.strm.avail_out===0?Y:te):D.last_lit&&(B(D,!1),D.strm.avail_out===0)?h:w})(_,N):_.strategy===3?(function(D,le){for(var he,ue,pe,ee,U=D.window;;){if(D.lookahead<=se){if(ve(D),D.lookahead<=se&&le===m)return h;if(D.lookahead===0)break}if(D.match_length=0,D.lookahead>=X&&0<D.strstart&&(ue=U[pe=D.strstart-1])===U[++pe]&&ue===U[++pe]&&ue===U[++pe]){ee=D.strstart+se;do;while(ue===U[++pe]&&ue===U[++pe]&&ue===U[++pe]&&ue===U[++pe]&&ue===U[++pe]&&ue===U[++pe]&&ue===U[++pe]&&ue===U[++pe]&&pe<ee);D.match_length=se-(ee-pe),D.match_length>D.lookahead&&(D.match_length=D.lookahead)}if(D.match_length>=X?(he=d._tr_tally(D,1,D.match_length-X),D.lookahead-=D.match_length,D.strstart+=D.match_length,D.match_length=0):(he=d._tr_tally(D,0,D.window[D.strstart]),D.lookahead--,D.strstart++),he&&(B(D,!1),D.strm.avail_out===0))return h}return D.insert=0,le===x?(B(D,!0),D.strm.avail_out===0?Y:te):D.last_lit&&(B(D,!1),D.strm.avail_out===0)?h:w})(_,N):l[_.level].func(_,N);if(J!==Y&&J!==te||(_.status=666),J===h||J===Y)return c.avail_out===0&&(_.last_flush=-1),p;if(J===w&&(N===1?d._tr_align(_):N!==5&&(d._tr_stored_block(_,0,0,!1),N===3&&(V(_.head),_.lookahead===0&&(_.strstart=0,_.block_start=0,_.insert=0))),L(c),c.avail_out===0))return _.last_flush=-1,p}return N!==x?p:_.wrap<=0?1:(_.wrap===2?(re(_,255&c.adler),re(_,c.adler>>8&255),re(_,c.adler>>16&255),re(_,c.adler>>24&255),re(_,255&c.total_in),re(_,c.total_in>>8&255),re(_,c.total_in>>16&255),re(_,c.total_in>>24&255)):(Z(_,c.adler>>>16),Z(_,65535&c.adler)),L(c),0<_.wrap&&(_.wrap=-_.wrap),_.pending!==0?p:1)},n.deflateEnd=function(c){var N;return c&&c.state?(N=c.state.status)!==$&&N!==69&&N!==73&&N!==91&&N!==103&&N!==O&&N!==666?Q(c,k):(c.state=null,N===O?Q(c,-3):p):k},n.deflateSetDictionary=function(c,N){var q,_,C,j,P,J,D,le,he=N.length;if(!c||!c.state||(j=(q=c.state).wrap)===2||j===1&&q.status!==$||q.lookahead)return k;for(j===1&&(c.adler=u(c.adler,N,he,0)),q.wrap=0,he>=q.w_size&&(j===0&&(V(q.head),q.strstart=0,q.block_start=0,q.insert=0),le=new i.Buf8(q.w_size),i.arraySet(le,N,he-q.w_size,q.w_size,0),N=le,he=q.w_size),P=c.avail_in,J=c.next_in,D=c.input,c.avail_in=he,c.next_in=0,c.input=N,ve(q);q.lookahead>=X;){for(_=q.strstart,C=q.lookahead-(X-1);q.ins_h=(q.ins_h<<q.hash_shift^q.window[_+X-1])&q.hash_mask,q.prev[_&q.w_mask]=q.head[q.ins_h],q.head[q.ins_h]=_,_++,--C;);q.strstart=_,q.lookahead=X-1,ve(q)}return q.strstart+=q.lookahead,q.block_start=q.strstart,q.insert=q.lookahead,q.lookahead=0,q.match_length=q.prev_length=X-1,q.match_available=0,c.next_in=J,c.input=D,c.avail_in=P,q.wrap=j,p},n.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(t,s,n){s.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(t,s,n){s.exports=function(l,i){var d,u,g,y,m,x,p,k,v,S,b,f,T,M,H,R,A,W,X,se,G,$,O,h,w;d=l.state,u=l.next_in,h=l.input,g=u+(l.avail_in-5),y=l.next_out,w=l.output,m=y-(i-l.avail_out),x=y+(l.avail_out-257),p=d.dmax,k=d.wsize,v=d.whave,S=d.wnext,b=d.window,f=d.hold,T=d.bits,M=d.lencode,H=d.distcode,R=(1<<d.lenbits)-1,A=(1<<d.distbits)-1;e:do{T<15&&(f+=h[u++]<<T,T+=8,f+=h[u++]<<T,T+=8),W=M[f&R];t:for(;;){if(f>>>=X=W>>>24,T-=X,(X=W>>>16&255)===0)w[y++]=65535&W;else{if(!(16&X)){if((64&X)==0){W=M[(65535&W)+(f&(1<<X)-1)];continue t}if(32&X){d.mode=12;break e}l.msg="invalid literal/length code",d.mode=30;break e}se=65535&W,(X&=15)&&(T<X&&(f+=h[u++]<<T,T+=8),se+=f&(1<<X)-1,f>>>=X,T-=X),T<15&&(f+=h[u++]<<T,T+=8,f+=h[u++]<<T,T+=8),W=H[f&A];r:for(;;){if(f>>>=X=W>>>24,T-=X,!(16&(X=W>>>16&255))){if((64&X)==0){W=H[(65535&W)+(f&(1<<X)-1)];continue r}l.msg="invalid distance code",d.mode=30;break e}if(G=65535&W,T<(X&=15)&&(f+=h[u++]<<T,(T+=8)<X&&(f+=h[u++]<<T,T+=8)),p<(G+=f&(1<<X)-1)){l.msg="invalid distance too far back",d.mode=30;break e}if(f>>>=X,T-=X,(X=y-m)<G){if(v<(X=G-X)&&d.sane){l.msg="invalid distance too far back",d.mode=30;break e}if(O=b,($=0)===S){if($+=k-X,X<se){for(se-=X;w[y++]=b[$++],--X;);$=y-G,O=w}}else if(S<X){if($+=k+S-X,(X-=S)<se){for(se-=X;w[y++]=b[$++],--X;);if($=0,S<se){for(se-=X=S;w[y++]=b[$++],--X;);$=y-G,O=w}}}else if($+=S-X,X<se){for(se-=X;w[y++]=b[$++],--X;);$=y-G,O=w}for(;2<se;)w[y++]=O[$++],w[y++]=O[$++],w[y++]=O[$++],se-=3;se&&(w[y++]=O[$++],1<se&&(w[y++]=O[$++]))}else{for($=y-G;w[y++]=w[$++],w[y++]=w[$++],w[y++]=w[$++],2<(se-=3););se&&(w[y++]=w[$++],1<se&&(w[y++]=w[$++]))}break}}break}}while(u<g&&y<x);u-=se=T>>3,f&=(1<<(T-=se<<3))-1,l.next_in=u,l.next_out=y,l.avail_in=u<g?g-u+5:5-(u-g),l.avail_out=y<x?x-y+257:257-(y-x),d.hold=f,d.bits=T}},{}],49:[function(t,s,n){var l=t("../utils/common"),i=t("./adler32"),d=t("./crc32"),u=t("./inffast"),g=t("./inftrees"),y=1,m=2,x=0,p=-2,k=1,v=852,S=592;function b($){return($>>>24&255)+($>>>8&65280)+((65280&$)<<8)+((255&$)<<24)}function f(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new l.Buf16(320),this.work=new l.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function T($){var O;return $&&$.state?(O=$.state,$.total_in=$.total_out=O.total=0,$.msg="",O.wrap&&($.adler=1&O.wrap),O.mode=k,O.last=0,O.havedict=0,O.dmax=32768,O.head=null,O.hold=0,O.bits=0,O.lencode=O.lendyn=new l.Buf32(v),O.distcode=O.distdyn=new l.Buf32(S),O.sane=1,O.back=-1,x):p}function M($){var O;return $&&$.state?((O=$.state).wsize=0,O.whave=0,O.wnext=0,T($)):p}function H($,O){var h,w;return $&&$.state?(w=$.state,O<0?(h=0,O=-O):(h=1+(O>>4),O<48&&(O&=15)),O&&(O<8||15<O)?p:(w.window!==null&&w.wbits!==O&&(w.window=null),w.wrap=h,w.wbits=O,M($))):p}function R($,O){var h,w;return $?(w=new f,($.state=w).window=null,(h=H($,O))!==x&&($.state=null),h):p}var A,W,X=!0;function se($){if(X){var O;for(A=new l.Buf32(512),W=new l.Buf32(32),O=0;O<144;)$.lens[O++]=8;for(;O<256;)$.lens[O++]=9;for(;O<280;)$.lens[O++]=7;for(;O<288;)$.lens[O++]=8;for(g(y,$.lens,0,288,A,0,$.work,{bits:9}),O=0;O<32;)$.lens[O++]=5;g(m,$.lens,0,32,W,0,$.work,{bits:5}),X=!1}$.lencode=A,$.lenbits=9,$.distcode=W,$.distbits=5}function G($,O,h,w){var Y,te=$.state;return te.window===null&&(te.wsize=1<<te.wbits,te.wnext=0,te.whave=0,te.window=new l.Buf8(te.wsize)),w>=te.wsize?(l.arraySet(te.window,O,h-te.wsize,te.wsize,0),te.wnext=0,te.whave=te.wsize):(w<(Y=te.wsize-te.wnext)&&(Y=w),l.arraySet(te.window,O,h-w,Y,te.wnext),(w-=Y)?(l.arraySet(te.window,O,h-w,w,0),te.wnext=w,te.whave=te.wsize):(te.wnext+=Y,te.wnext===te.wsize&&(te.wnext=0),te.whave<te.wsize&&(te.whave+=Y))),0}n.inflateReset=M,n.inflateReset2=H,n.inflateResetKeep=T,n.inflateInit=function($){return R($,15)},n.inflateInit2=R,n.inflate=function($,O){var h,w,Y,te,Q,I,V,L,B,re,Z,ne,ve,xe,de,ke,we,ae,K,oe,c,N,q,_,C=0,j=new l.Buf8(4),P=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!$||!$.state||!$.output||!$.input&&$.avail_in!==0)return p;(h=$.state).mode===12&&(h.mode=13),Q=$.next_out,Y=$.output,V=$.avail_out,te=$.next_in,w=$.input,I=$.avail_in,L=h.hold,B=h.bits,re=I,Z=V,N=x;e:for(;;)switch(h.mode){case k:if(h.wrap===0){h.mode=13;break}for(;B<16;){if(I===0)break e;I--,L+=w[te++]<<B,B+=8}if(2&h.wrap&&L===35615){j[h.check=0]=255&L,j[1]=L>>>8&255,h.check=d(h.check,j,2,0),B=L=0,h.mode=2;break}if(h.flags=0,h.head&&(h.head.done=!1),!(1&h.wrap)||(((255&L)<<8)+(L>>8))%31){$.msg="incorrect header check",h.mode=30;break}if((15&L)!=8){$.msg="unknown compression method",h.mode=30;break}if(B-=4,c=8+(15&(L>>>=4)),h.wbits===0)h.wbits=c;else if(c>h.wbits){$.msg="invalid window size",h.mode=30;break}h.dmax=1<<c,$.adler=h.check=1,h.mode=512&L?10:12,B=L=0;break;case 2:for(;B<16;){if(I===0)break e;I--,L+=w[te++]<<B,B+=8}if(h.flags=L,(255&h.flags)!=8){$.msg="unknown compression method",h.mode=30;break}if(57344&h.flags){$.msg="unknown header flags set",h.mode=30;break}h.head&&(h.head.text=L>>8&1),512&h.flags&&(j[0]=255&L,j[1]=L>>>8&255,h.check=d(h.check,j,2,0)),B=L=0,h.mode=3;case 3:for(;B<32;){if(I===0)break e;I--,L+=w[te++]<<B,B+=8}h.head&&(h.head.time=L),512&h.flags&&(j[0]=255&L,j[1]=L>>>8&255,j[2]=L>>>16&255,j[3]=L>>>24&255,h.check=d(h.check,j,4,0)),B=L=0,h.mode=4;case 4:for(;B<16;){if(I===0)break e;I--,L+=w[te++]<<B,B+=8}h.head&&(h.head.xflags=255&L,h.head.os=L>>8),512&h.flags&&(j[0]=255&L,j[1]=L>>>8&255,h.check=d(h.check,j,2,0)),B=L=0,h.mode=5;case 5:if(1024&h.flags){for(;B<16;){if(I===0)break e;I--,L+=w[te++]<<B,B+=8}h.length=L,h.head&&(h.head.extra_len=L),512&h.flags&&(j[0]=255&L,j[1]=L>>>8&255,h.check=d(h.check,j,2,0)),B=L=0}else h.head&&(h.head.extra=null);h.mode=6;case 6:if(1024&h.flags&&(I<(ne=h.length)&&(ne=I),ne&&(h.head&&(c=h.head.extra_len-h.length,h.head.extra||(h.head.extra=new Array(h.head.extra_len)),l.arraySet(h.head.extra,w,te,ne,c)),512&h.flags&&(h.check=d(h.check,w,ne,te)),I-=ne,te+=ne,h.length-=ne),h.length))break e;h.length=0,h.mode=7;case 7:if(2048&h.flags){if(I===0)break e;for(ne=0;c=w[te+ne++],h.head&&c&&h.length<65536&&(h.head.name+=String.fromCharCode(c)),c&&ne<I;);if(512&h.flags&&(h.check=d(h.check,w,ne,te)),I-=ne,te+=ne,c)break e}else h.head&&(h.head.name=null);h.length=0,h.mode=8;case 8:if(4096&h.flags){if(I===0)break e;for(ne=0;c=w[te+ne++],h.head&&c&&h.length<65536&&(h.head.comment+=String.fromCharCode(c)),c&&ne<I;);if(512&h.flags&&(h.check=d(h.check,w,ne,te)),I-=ne,te+=ne,c)break e}else h.head&&(h.head.comment=null);h.mode=9;case 9:if(512&h.flags){for(;B<16;){if(I===0)break e;I--,L+=w[te++]<<B,B+=8}if(L!==(65535&h.check)){$.msg="header crc mismatch",h.mode=30;break}B=L=0}h.head&&(h.head.hcrc=h.flags>>9&1,h.head.done=!0),$.adler=h.check=0,h.mode=12;break;case 10:for(;B<32;){if(I===0)break e;I--,L+=w[te++]<<B,B+=8}$.adler=h.check=b(L),B=L=0,h.mode=11;case 11:if(h.havedict===0)return $.next_out=Q,$.avail_out=V,$.next_in=te,$.avail_in=I,h.hold=L,h.bits=B,2;$.adler=h.check=1,h.mode=12;case 12:if(O===5||O===6)break e;case 13:if(h.last){L>>>=7&B,B-=7&B,h.mode=27;break}for(;B<3;){if(I===0)break e;I--,L+=w[te++]<<B,B+=8}switch(h.last=1&L,B-=1,3&(L>>>=1)){case 0:h.mode=14;break;case 1:if(se(h),h.mode=20,O!==6)break;L>>>=2,B-=2;break e;case 2:h.mode=17;break;case 3:$.msg="invalid block type",h.mode=30}L>>>=2,B-=2;break;case 14:for(L>>>=7&B,B-=7&B;B<32;){if(I===0)break e;I--,L+=w[te++]<<B,B+=8}if((65535&L)!=(L>>>16^65535)){$.msg="invalid stored block lengths",h.mode=30;break}if(h.length=65535&L,B=L=0,h.mode=15,O===6)break e;case 15:h.mode=16;case 16:if(ne=h.length){if(I<ne&&(ne=I),V<ne&&(ne=V),ne===0)break e;l.arraySet(Y,w,te,ne,Q),I-=ne,te+=ne,V-=ne,Q+=ne,h.length-=ne;break}h.mode=12;break;case 17:for(;B<14;){if(I===0)break e;I--,L+=w[te++]<<B,B+=8}if(h.nlen=257+(31&L),L>>>=5,B-=5,h.ndist=1+(31&L),L>>>=5,B-=5,h.ncode=4+(15&L),L>>>=4,B-=4,286<h.nlen||30<h.ndist){$.msg="too many length or distance symbols",h.mode=30;break}h.have=0,h.mode=18;case 18:for(;h.have<h.ncode;){for(;B<3;){if(I===0)break e;I--,L+=w[te++]<<B,B+=8}h.lens[P[h.have++]]=7&L,L>>>=3,B-=3}for(;h.have<19;)h.lens[P[h.have++]]=0;if(h.lencode=h.lendyn,h.lenbits=7,q={bits:h.lenbits},N=g(0,h.lens,0,19,h.lencode,0,h.work,q),h.lenbits=q.bits,N){$.msg="invalid code lengths set",h.mode=30;break}h.have=0,h.mode=19;case 19:for(;h.have<h.nlen+h.ndist;){for(;ke=(C=h.lencode[L&(1<<h.lenbits)-1])>>>16&255,we=65535&C,!((de=C>>>24)<=B);){if(I===0)break e;I--,L+=w[te++]<<B,B+=8}if(we<16)L>>>=de,B-=de,h.lens[h.have++]=we;else{if(we===16){for(_=de+2;B<_;){if(I===0)break e;I--,L+=w[te++]<<B,B+=8}if(L>>>=de,B-=de,h.have===0){$.msg="invalid bit length repeat",h.mode=30;break}c=h.lens[h.have-1],ne=3+(3&L),L>>>=2,B-=2}else if(we===17){for(_=de+3;B<_;){if(I===0)break e;I--,L+=w[te++]<<B,B+=8}B-=de,c=0,ne=3+(7&(L>>>=de)),L>>>=3,B-=3}else{for(_=de+7;B<_;){if(I===0)break e;I--,L+=w[te++]<<B,B+=8}B-=de,c=0,ne=11+(127&(L>>>=de)),L>>>=7,B-=7}if(h.have+ne>h.nlen+h.ndist){$.msg="invalid bit length repeat",h.mode=30;break}for(;ne--;)h.lens[h.have++]=c}}if(h.mode===30)break;if(h.lens[256]===0){$.msg="invalid code -- missing end-of-block",h.mode=30;break}if(h.lenbits=9,q={bits:h.lenbits},N=g(y,h.lens,0,h.nlen,h.lencode,0,h.work,q),h.lenbits=q.bits,N){$.msg="invalid literal/lengths set",h.mode=30;break}if(h.distbits=6,h.distcode=h.distdyn,q={bits:h.distbits},N=g(m,h.lens,h.nlen,h.ndist,h.distcode,0,h.work,q),h.distbits=q.bits,N){$.msg="invalid distances set",h.mode=30;break}if(h.mode=20,O===6)break e;case 20:h.mode=21;case 21:if(6<=I&&258<=V){$.next_out=Q,$.avail_out=V,$.next_in=te,$.avail_in=I,h.hold=L,h.bits=B,u($,Z),Q=$.next_out,Y=$.output,V=$.avail_out,te=$.next_in,w=$.input,I=$.avail_in,L=h.hold,B=h.bits,h.mode===12&&(h.back=-1);break}for(h.back=0;ke=(C=h.lencode[L&(1<<h.lenbits)-1])>>>16&255,we=65535&C,!((de=C>>>24)<=B);){if(I===0)break e;I--,L+=w[te++]<<B,B+=8}if(ke&&(240&ke)==0){for(ae=de,K=ke,oe=we;ke=(C=h.lencode[oe+((L&(1<<ae+K)-1)>>ae)])>>>16&255,we=65535&C,!(ae+(de=C>>>24)<=B);){if(I===0)break e;I--,L+=w[te++]<<B,B+=8}L>>>=ae,B-=ae,h.back+=ae}if(L>>>=de,B-=de,h.back+=de,h.length=we,ke===0){h.mode=26;break}if(32&ke){h.back=-1,h.mode=12;break}if(64&ke){$.msg="invalid literal/length code",h.mode=30;break}h.extra=15&ke,h.mode=22;case 22:if(h.extra){for(_=h.extra;B<_;){if(I===0)break e;I--,L+=w[te++]<<B,B+=8}h.length+=L&(1<<h.extra)-1,L>>>=h.extra,B-=h.extra,h.back+=h.extra}h.was=h.length,h.mode=23;case 23:for(;ke=(C=h.distcode[L&(1<<h.distbits)-1])>>>16&255,we=65535&C,!((de=C>>>24)<=B);){if(I===0)break e;I--,L+=w[te++]<<B,B+=8}if((240&ke)==0){for(ae=de,K=ke,oe=we;ke=(C=h.distcode[oe+((L&(1<<ae+K)-1)>>ae)])>>>16&255,we=65535&C,!(ae+(de=C>>>24)<=B);){if(I===0)break e;I--,L+=w[te++]<<B,B+=8}L>>>=ae,B-=ae,h.back+=ae}if(L>>>=de,B-=de,h.back+=de,64&ke){$.msg="invalid distance code",h.mode=30;break}h.offset=we,h.extra=15&ke,h.mode=24;case 24:if(h.extra){for(_=h.extra;B<_;){if(I===0)break e;I--,L+=w[te++]<<B,B+=8}h.offset+=L&(1<<h.extra)-1,L>>>=h.extra,B-=h.extra,h.back+=h.extra}if(h.offset>h.dmax){$.msg="invalid distance too far back",h.mode=30;break}h.mode=25;case 25:if(V===0)break e;if(ne=Z-V,h.offset>ne){if((ne=h.offset-ne)>h.whave&&h.sane){$.msg="invalid distance too far back",h.mode=30;break}ve=ne>h.wnext?(ne-=h.wnext,h.wsize-ne):h.wnext-ne,ne>h.length&&(ne=h.length),xe=h.window}else xe=Y,ve=Q-h.offset,ne=h.length;for(V<ne&&(ne=V),V-=ne,h.length-=ne;Y[Q++]=xe[ve++],--ne;);h.length===0&&(h.mode=21);break;case 26:if(V===0)break e;Y[Q++]=h.length,V--,h.mode=21;break;case 27:if(h.wrap){for(;B<32;){if(I===0)break e;I--,L|=w[te++]<<B,B+=8}if(Z-=V,$.total_out+=Z,h.total+=Z,Z&&($.adler=h.check=h.flags?d(h.check,Y,Z,Q-Z):i(h.check,Y,Z,Q-Z)),Z=V,(h.flags?L:b(L))!==h.check){$.msg="incorrect data check",h.mode=30;break}B=L=0}h.mode=28;case 28:if(h.wrap&&h.flags){for(;B<32;){if(I===0)break e;I--,L+=w[te++]<<B,B+=8}if(L!==(4294967295&h.total)){$.msg="incorrect length check",h.mode=30;break}B=L=0}h.mode=29;case 29:N=1;break e;case 30:N=-3;break e;case 31:return-4;case 32:default:return p}return $.next_out=Q,$.avail_out=V,$.next_in=te,$.avail_in=I,h.hold=L,h.bits=B,(h.wsize||Z!==$.avail_out&&h.mode<30&&(h.mode<27||O!==4))&&G($,$.output,$.next_out,Z-$.avail_out)?(h.mode=31,-4):(re-=$.avail_in,Z-=$.avail_out,$.total_in+=re,$.total_out+=Z,h.total+=Z,h.wrap&&Z&&($.adler=h.check=h.flags?d(h.check,Y,Z,$.next_out-Z):i(h.check,Y,Z,$.next_out-Z)),$.data_type=h.bits+(h.last?64:0)+(h.mode===12?128:0)+(h.mode===20||h.mode===15?256:0),(re==0&&Z===0||O===4)&&N===x&&(N=-5),N)},n.inflateEnd=function($){if(!$||!$.state)return p;var O=$.state;return O.window&&(O.window=null),$.state=null,x},n.inflateGetHeader=function($,O){var h;return $&&$.state?(2&(h=$.state).wrap)==0?p:((h.head=O).done=!1,x):p},n.inflateSetDictionary=function($,O){var h,w=O.length;return $&&$.state?(h=$.state).wrap!==0&&h.mode!==11?p:h.mode===11&&i(1,O,w,0)!==h.check?-3:G($,O,w,w)?(h.mode=31,-4):(h.havedict=1,x):p},n.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(t,s,n){var l=t("../utils/common"),i=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],d=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],u=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],g=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];s.exports=function(y,m,x,p,k,v,S,b){var f,T,M,H,R,A,W,X,se,G=b.bits,$=0,O=0,h=0,w=0,Y=0,te=0,Q=0,I=0,V=0,L=0,B=null,re=0,Z=new l.Buf16(16),ne=new l.Buf16(16),ve=null,xe=0;for($=0;$<=15;$++)Z[$]=0;for(O=0;O<p;O++)Z[m[x+O]]++;for(Y=G,w=15;1<=w&&Z[w]===0;w--);if(w<Y&&(Y=w),w===0)return k[v++]=20971520,k[v++]=20971520,b.bits=1,0;for(h=1;h<w&&Z[h]===0;h++);for(Y<h&&(Y=h),$=I=1;$<=15;$++)if(I<<=1,(I-=Z[$])<0)return-1;if(0<I&&(y===0||w!==1))return-1;for(ne[1]=0,$=1;$<15;$++)ne[$+1]=ne[$]+Z[$];for(O=0;O<p;O++)m[x+O]!==0&&(S[ne[m[x+O]]++]=O);if(A=y===0?(B=ve=S,19):y===1?(B=i,re-=257,ve=d,xe-=257,256):(B=u,ve=g,-1),$=h,R=v,Q=O=L=0,M=-1,H=(V=1<<(te=Y))-1,y===1&&852<V||y===2&&592<V)return 1;for(;;){for(W=$-Q,se=S[O]<A?(X=0,S[O]):S[O]>A?(X=ve[xe+S[O]],B[re+S[O]]):(X=96,0),f=1<<$-Q,h=T=1<<te;k[R+(L>>Q)+(T-=f)]=W<<24|X<<16|se|0,T!==0;);for(f=1<<$-1;L&f;)f>>=1;if(f!==0?(L&=f-1,L+=f):L=0,O++,--Z[$]==0){if($===w)break;$=m[x+S[O]]}if(Y<$&&(L&H)!==M){for(Q===0&&(Q=Y),R+=h,I=1<<(te=$-Q);te+Q<w&&!((I-=Z[te+Q])<=0);)te++,I<<=1;if(V+=1<<te,y===1&&852<V||y===2&&592<V)return 1;k[M=L&H]=Y<<24|te<<16|R-v|0}}return L!==0&&(k[R+L]=$-Q<<24|64<<16|0),b.bits=Y,0}},{"../utils/common":41}],51:[function(t,s,n){s.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(t,s,n){var l=t("../utils/common"),i=0,d=1;function u(C){for(var j=C.length;0<=--j;)C[j]=0}var g=0,y=29,m=256,x=m+1+y,p=30,k=19,v=2*x+1,S=15,b=16,f=7,T=256,M=16,H=17,R=18,A=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],W=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],X=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],se=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],G=new Array(2*(x+2));u(G);var $=new Array(2*p);u($);var O=new Array(512);u(O);var h=new Array(256);u(h);var w=new Array(y);u(w);var Y,te,Q,I=new Array(p);function V(C,j,P,J,D){this.static_tree=C,this.extra_bits=j,this.extra_base=P,this.elems=J,this.max_length=D,this.has_stree=C&&C.length}function L(C,j){this.dyn_tree=C,this.max_code=0,this.stat_desc=j}function B(C){return C<256?O[C]:O[256+(C>>>7)]}function re(C,j){C.pending_buf[C.pending++]=255&j,C.pending_buf[C.pending++]=j>>>8&255}function Z(C,j,P){C.bi_valid>b-P?(C.bi_buf|=j<<C.bi_valid&65535,re(C,C.bi_buf),C.bi_buf=j>>b-C.bi_valid,C.bi_valid+=P-b):(C.bi_buf|=j<<C.bi_valid&65535,C.bi_valid+=P)}function ne(C,j,P){Z(C,P[2*j],P[2*j+1])}function ve(C,j){for(var P=0;P|=1&C,C>>>=1,P<<=1,0<--j;);return P>>>1}function xe(C,j,P){var J,D,le=new Array(S+1),he=0;for(J=1;J<=S;J++)le[J]=he=he+P[J-1]<<1;for(D=0;D<=j;D++){var ue=C[2*D+1];ue!==0&&(C[2*D]=ve(le[ue]++,ue))}}function de(C){var j;for(j=0;j<x;j++)C.dyn_ltree[2*j]=0;for(j=0;j<p;j++)C.dyn_dtree[2*j]=0;for(j=0;j<k;j++)C.bl_tree[2*j]=0;C.dyn_ltree[2*T]=1,C.opt_len=C.static_len=0,C.last_lit=C.matches=0}function ke(C){8<C.bi_valid?re(C,C.bi_buf):0<C.bi_valid&&(C.pending_buf[C.pending++]=C.bi_buf),C.bi_buf=0,C.bi_valid=0}function we(C,j,P,J){var D=2*j,le=2*P;return C[D]<C[le]||C[D]===C[le]&&J[j]<=J[P]}function ae(C,j,P){for(var J=C.heap[P],D=P<<1;D<=C.heap_len&&(D<C.heap_len&&we(j,C.heap[D+1],C.heap[D],C.depth)&&D++,!we(j,J,C.heap[D],C.depth));)C.heap[P]=C.heap[D],P=D,D<<=1;C.heap[P]=J}function K(C,j,P){var J,D,le,he,ue=0;if(C.last_lit!==0)for(;J=C.pending_buf[C.d_buf+2*ue]<<8|C.pending_buf[C.d_buf+2*ue+1],D=C.pending_buf[C.l_buf+ue],ue++,J===0?ne(C,D,j):(ne(C,(le=h[D])+m+1,j),(he=A[le])!==0&&Z(C,D-=w[le],he),ne(C,le=B(--J),P),(he=W[le])!==0&&Z(C,J-=I[le],he)),ue<C.last_lit;);ne(C,T,j)}function oe(C,j){var P,J,D,le=j.dyn_tree,he=j.stat_desc.static_tree,ue=j.stat_desc.has_stree,pe=j.stat_desc.elems,ee=-1;for(C.heap_len=0,C.heap_max=v,P=0;P<pe;P++)le[2*P]!==0?(C.heap[++C.heap_len]=ee=P,C.depth[P]=0):le[2*P+1]=0;for(;C.heap_len<2;)le[2*(D=C.heap[++C.heap_len]=ee<2?++ee:0)]=1,C.depth[D]=0,C.opt_len--,ue&&(C.static_len-=he[2*D+1]);for(j.max_code=ee,P=C.heap_len>>1;1<=P;P--)ae(C,le,P);for(D=pe;P=C.heap[1],C.heap[1]=C.heap[C.heap_len--],ae(C,le,1),J=C.heap[1],C.heap[--C.heap_max]=P,C.heap[--C.heap_max]=J,le[2*D]=le[2*P]+le[2*J],C.depth[D]=(C.depth[P]>=C.depth[J]?C.depth[P]:C.depth[J])+1,le[2*P+1]=le[2*J+1]=D,C.heap[1]=D++,ae(C,le,1),2<=C.heap_len;);C.heap[--C.heap_max]=C.heap[1],(function(U,me){var Oe,Be,Ue,Ie,Fe,st,Ve=me.dyn_tree,je=me.max_code,Ze=me.stat_desc.static_tree,lt=me.stat_desc.has_stree,nt=me.stat_desc.extra_bits,Tt=me.stat_desc.extra_base,ht=me.stat_desc.max_length,pt=0;for(Ie=0;Ie<=S;Ie++)U.bl_count[Ie]=0;for(Ve[2*U.heap[U.heap_max]+1]=0,Oe=U.heap_max+1;Oe<v;Oe++)ht<(Ie=Ve[2*Ve[2*(Be=U.heap[Oe])+1]+1]+1)&&(Ie=ht,pt++),Ve[2*Be+1]=Ie,je<Be||(U.bl_count[Ie]++,Fe=0,Tt<=Be&&(Fe=nt[Be-Tt]),st=Ve[2*Be],U.opt_len+=st*(Ie+Fe),lt&&(U.static_len+=st*(Ze[2*Be+1]+Fe)));if(pt!==0){do{for(Ie=ht-1;U.bl_count[Ie]===0;)Ie--;U.bl_count[Ie]--,U.bl_count[Ie+1]+=2,U.bl_count[ht]--,pt-=2}while(0<pt);for(Ie=ht;Ie!==0;Ie--)for(Be=U.bl_count[Ie];Be!==0;)je<(Ue=U.heap[--Oe])||(Ve[2*Ue+1]!==Ie&&(U.opt_len+=(Ie-Ve[2*Ue+1])*Ve[2*Ue],Ve[2*Ue+1]=Ie),Be--)}})(C,j),xe(le,ee,C.bl_count)}function c(C,j,P){var J,D,le=-1,he=j[1],ue=0,pe=7,ee=4;for(he===0&&(pe=138,ee=3),j[2*(P+1)+1]=65535,J=0;J<=P;J++)D=he,he=j[2*(J+1)+1],++ue<pe&&D===he||(ue<ee?C.bl_tree[2*D]+=ue:D!==0?(D!==le&&C.bl_tree[2*D]++,C.bl_tree[2*M]++):ue<=10?C.bl_tree[2*H]++:C.bl_tree[2*R]++,le=D,ee=(ue=0)===he?(pe=138,3):D===he?(pe=6,3):(pe=7,4))}function N(C,j,P){var J,D,le=-1,he=j[1],ue=0,pe=7,ee=4;for(he===0&&(pe=138,ee=3),J=0;J<=P;J++)if(D=he,he=j[2*(J+1)+1],!(++ue<pe&&D===he)){if(ue<ee)for(;ne(C,D,C.bl_tree),--ue!=0;);else D!==0?(D!==le&&(ne(C,D,C.bl_tree),ue--),ne(C,M,C.bl_tree),Z(C,ue-3,2)):ue<=10?(ne(C,H,C.bl_tree),Z(C,ue-3,3)):(ne(C,R,C.bl_tree),Z(C,ue-11,7));le=D,ee=(ue=0)===he?(pe=138,3):D===he?(pe=6,3):(pe=7,4)}}u(I);var q=!1;function _(C,j,P,J){Z(C,(g<<1)+(J?1:0),3),(function(D,le,he,ue){ke(D),re(D,he),re(D,~he),l.arraySet(D.pending_buf,D.window,le,he,D.pending),D.pending+=he})(C,j,P)}n._tr_init=function(C){q||((function(){var j,P,J,D,le,he=new Array(S+1);for(D=J=0;D<y-1;D++)for(w[D]=J,j=0;j<1<<A[D];j++)h[J++]=D;for(h[J-1]=D,D=le=0;D<16;D++)for(I[D]=le,j=0;j<1<<W[D];j++)O[le++]=D;for(le>>=7;D<p;D++)for(I[D]=le<<7,j=0;j<1<<W[D]-7;j++)O[256+le++]=D;for(P=0;P<=S;P++)he[P]=0;for(j=0;j<=143;)G[2*j+1]=8,j++,he[8]++;for(;j<=255;)G[2*j+1]=9,j++,he[9]++;for(;j<=279;)G[2*j+1]=7,j++,he[7]++;for(;j<=287;)G[2*j+1]=8,j++,he[8]++;for(xe(G,x+1,he),j=0;j<p;j++)$[2*j+1]=5,$[2*j]=ve(j,5);Y=new V(G,A,m+1,x,S),te=new V($,W,0,p,S),Q=new V(new Array(0),X,0,k,f)})(),q=!0),C.l_desc=new L(C.dyn_ltree,Y),C.d_desc=new L(C.dyn_dtree,te),C.bl_desc=new L(C.bl_tree,Q),C.bi_buf=0,C.bi_valid=0,de(C)},n._tr_stored_block=_,n._tr_flush_block=function(C,j,P,J){var D,le,he=0;0<C.level?(C.strm.data_type===2&&(C.strm.data_type=(function(ue){var pe,ee=4093624447;for(pe=0;pe<=31;pe++,ee>>>=1)if(1&ee&&ue.dyn_ltree[2*pe]!==0)return i;if(ue.dyn_ltree[18]!==0||ue.dyn_ltree[20]!==0||ue.dyn_ltree[26]!==0)return d;for(pe=32;pe<m;pe++)if(ue.dyn_ltree[2*pe]!==0)return d;return i})(C)),oe(C,C.l_desc),oe(C,C.d_desc),he=(function(ue){var pe;for(c(ue,ue.dyn_ltree,ue.l_desc.max_code),c(ue,ue.dyn_dtree,ue.d_desc.max_code),oe(ue,ue.bl_desc),pe=k-1;3<=pe&&ue.bl_tree[2*se[pe]+1]===0;pe--);return ue.opt_len+=3*(pe+1)+5+5+4,pe})(C),D=C.opt_len+3+7>>>3,(le=C.static_len+3+7>>>3)<=D&&(D=le)):D=le=P+5,P+4<=D&&j!==-1?_(C,j,P,J):C.strategy===4||le===D?(Z(C,2+(J?1:0),3),K(C,G,$)):(Z(C,4+(J?1:0),3),(function(ue,pe,ee,U){var me;for(Z(ue,pe-257,5),Z(ue,ee-1,5),Z(ue,U-4,4),me=0;me<U;me++)Z(ue,ue.bl_tree[2*se[me]+1],3);N(ue,ue.dyn_ltree,pe-1),N(ue,ue.dyn_dtree,ee-1)})(C,C.l_desc.max_code+1,C.d_desc.max_code+1,he+1),K(C,C.dyn_ltree,C.dyn_dtree)),de(C),J&&ke(C)},n._tr_tally=function(C,j,P){return C.pending_buf[C.d_buf+2*C.last_lit]=j>>>8&255,C.pending_buf[C.d_buf+2*C.last_lit+1]=255&j,C.pending_buf[C.l_buf+C.last_lit]=255&P,C.last_lit++,j===0?C.dyn_ltree[2*P]++:(C.matches++,j--,C.dyn_ltree[2*(h[P]+m+1)]++,C.dyn_dtree[2*B(j)]++),C.last_lit===C.lit_bufsize-1},n._tr_align=function(C){Z(C,2,3),ne(C,T,G),(function(j){j.bi_valid===16?(re(j,j.bi_buf),j.bi_buf=0,j.bi_valid=0):8<=j.bi_valid&&(j.pending_buf[j.pending++]=255&j.bi_buf,j.bi_buf>>=8,j.bi_valid-=8)})(C)}},{"../utils/common":41}],53:[function(t,s,n){s.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(t,s,n){(function(l){(function(i,d){if(!i.setImmediate){var u,g,y,m,x=1,p={},k=!1,v=i.document,S=Object.getPrototypeOf&&Object.getPrototypeOf(i);S=S&&S.setTimeout?S:i,u={}.toString.call(i.process)==="[object process]"?function(M){process.nextTick(function(){f(M)})}:(function(){if(i.postMessage&&!i.importScripts){var M=!0,H=i.onmessage;return i.onmessage=function(){M=!1},i.postMessage("","*"),i.onmessage=H,M}})()?(m="setImmediate$"+Math.random()+"$",i.addEventListener?i.addEventListener("message",T,!1):i.attachEvent("onmessage",T),function(M){i.postMessage(m+M,"*")}):i.MessageChannel?((y=new MessageChannel).port1.onmessage=function(M){f(M.data)},function(M){y.port2.postMessage(M)}):v&&"onreadystatechange"in v.createElement("script")?(g=v.documentElement,function(M){var H=v.createElement("script");H.onreadystatechange=function(){f(M),H.onreadystatechange=null,g.removeChild(H),H=null},g.appendChild(H)}):function(M){setTimeout(f,0,M)},S.setImmediate=function(M){typeof M!="function"&&(M=new Function(""+M));for(var H=new Array(arguments.length-1),R=0;R<H.length;R++)H[R]=arguments[R+1];var A={callback:M,args:H};return p[x]=A,u(x),x++},S.clearImmediate=b}function b(M){delete p[M]}function f(M){if(k)setTimeout(f,0,M);else{var H=p[M];if(H){k=!0;try{(function(R){var A=R.callback,W=R.args;switch(W.length){case 0:A();break;case 1:A(W[0]);break;case 2:A(W[0],W[1]);break;case 3:A(W[0],W[1],W[2]);break;default:A.apply(d,W)}})(H)}finally{b(M),k=!1}}}}function T(M){M.source===i&&typeof M.data=="string"&&M.data.indexOf(m)===0&&f(+M.data.slice(m.length))}})(typeof self>"u"?l===void 0?this:l:self)}).call(this,typeof dt<"u"?dt:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[10])(10)})})(ao)),ao.exports}var Ec=Cc();const Tc=_t(Ec),qe={printMode:"print-designer-print-mode",preferredPrintMode:"print-designer-preferred-print-mode",silentPrint:"print-designer-silent-print",exportImageMerged:"print-designer-export-image-merged",localSettings:"print-designer-local-settings",remoteSettings:"print-designer-remote-settings",localPrintOptions:"print-designer-local-print-options",remotePrintOptions:"print-designer-remote-print-options",remoteAuthToken:"print-designer-remote-auth-token",remoteSelectedClientId:"print-designer-remote-selected-client-id"},$c={wsAddress:"ws://localhost:1122/ws",secretKey:""},Ic={wsAddress:"ws://localhost:8080/ws/request",apiBaseUrl:"http://localhost:8080/api/login",username:"",password:""},ja={printer:"",jobName:"",copies:1,intervalMs:0,pageRange:"",pageSet:"",scale:"fit",orientation:"portrait",colorMode:"color",sidesMode:"simplex",paperSize:"",trayBin:""},jt=(r,e)=>{const t=localStorage.getItem(r);if(!t)return e;try{return{...e,...JSON.parse(t)}}catch{return e}},Ht=(r,e)=>{localStorage.setItem(r,JSON.stringify(e))},Ac=r=>r.trim(),Ha=r=>{const e=Ac(r);return e?/^wss?:\/\//i.test(e)?e:`ws://${e.replace(/^\/+/,"")}`:"ws://"},Ua=(r,e,t)=>{if(!t)return r;try{const s=new URL(r);return s.searchParams.set(e,t),s.toString()}catch{const s=r.includes("?")?"&":"?";return`${r}${s}${encodeURIComponent(e)}=${encodeURIComponent(t)}`}};let lo=null;const zc=()=>{const r=localStorage.getItem(qe.preferredPrintMode),e=ie(r||localStorage.getItem(qe.printMode)||"browser"),t=ie(localStorage.getItem(qe.silentPrint)==="true"),s=ie(localStorage.getItem(qe.exportImageMerged)!=="false"),n=yt(jt(qe.localSettings,$c));if(!n.wsAddress){const P=n;if(P.host||P.port||P.path){const J=P.host||"localhost",D=P.port?`:${P.port}`:"",le=P.path||"/ws",he=P.protocol||"ws";n.wsAddress=`${he}://${J}${D}${le}`}}const l=yt(jt(qe.remoteSettings,Ic));if(!l.wsAddress){const P=l;if(P.host||P.wsPort||P.wsPath){const J=P.host||"localhost",D=P.wsPort?`:${P.wsPort}`:"",le=P.wsPath||"/ws/request";l.wsAddress=`${J}${D}${le}`}}const i=ie("disconnected"),d=ie("disconnected"),u=ie(""),g=ie(""),y=yt(jt(qe.localPrintOptions,ja)),m=yt(jt(qe.remotePrintOptions,ja)),x=ie(localStorage.getItem(qe.remoteAuthToken)||""),p=ie(localStorage.getItem(qe.remoteSelectedClientId)||""),k=ie([]),v=ie([]),S=ie([]),b=yt({}),f=ie(null),T=ie(null),M=[],H=[];let R=null,A=null;const W=ie(0),X=ie(0),se=ie(null),G=ie(null),$=ie(!1),O=ie(!1),h=3e3,w=10,Y=fe(()=>{const P=Ha(n.wsAddress);return Ua(P,"key",n.secretKey.trim())}),te=fe(()=>{const P=Ha(l.wsAddress);return Ua(P,"token",x.value.trim())});Ae(e,P=>{if(localStorage.setItem(qe.printMode,P),P!=="browser"){localStorage.setItem(qe.preferredPrintMode,P);return}localStorage.removeItem(qe.preferredPrintMode)}),Ae(t,P=>{localStorage.setItem(qe.silentPrint,String(P))}),Ae(s,P=>{localStorage.setItem(qe.exportImageMerged,String(P))}),Ae(n,P=>{Ht(qe.localSettings,P),i.value="disconnected",u.value=""},{deep:!0}),Ae(l,P=>{Ht(qe.remoteSettings,P),d.value="disconnected",g.value=""},{deep:!0}),Ae(y,P=>{Ht(qe.localPrintOptions,P)},{deep:!0}),Ae(m,P=>{Ht(qe.remotePrintOptions,P)},{deep:!0}),Ae(x,P=>{localStorage.setItem(qe.remoteAuthToken,P)}),Ae(p,P=>{localStorage.setItem(qe.remoteSelectedClientId,P)});const Q=()=>{const P=localStorage.getItem(qe.preferredPrintMode);!P||P==="browser"||e.value==="browser"&&(P==="local"&&i.value==="connected"&&(e.value="local"),P==="remote"&&d.value==="connected"&&(e.value="remote"))},I=()=>{const P=i.value==="connected",J=d.value==="connected";if(e.value==="local"&&!P){e.value="browser";return}if(e.value==="remote"&&!J){e.value="browser";return}!P&&!J&&(e.value="browser")};Ae([i,d],()=>{I(),Q()},{immediate:!0});const V=(P,J)=>{P.slice().forEach(D=>{D.match(J)&&(window.clearTimeout(D.timeoutId),P.splice(P.indexOf(D),1),D.resolve(J))})},L=(P,J)=>{P.slice().forEach(D=>{window.clearTimeout(D.timeoutId),P.splice(P.indexOf(D),1),D.reject(J)})},B=()=>{se.value&&(window.clearTimeout(se.value),se.value=null),W.value=0},re=()=>{G.value&&(window.clearTimeout(G.value),G.value=null),X.value=0},Z=()=>{$.value=!0,B(),f.value&&f.value.close(),f.value=null,i.value="disconnected",u.value=""},ne=()=>{O.value=!0,re(),T.value&&T.value.close(),T.value=null,d.value="disconnected",g.value=""},ve=()=>{if(!$.value&&!se.value){if(W.value>=w){i.value="error",u.value="Local connection failed",W.value=0;return}W.value+=1,i.value="connecting",se.value=window.setTimeout(()=>{se.value=null,ae()},h)}},xe=()=>{if(!O.value&&!G.value){if(X.value>=w){d.value="error",g.value="Remote connection failed",X.value=0;return}X.value+=1,d.value="connecting",G.value=window.setTimeout(()=>{G.value=null,oe()},h)}},de=(P,J,D,le,he=5e3)=>new Promise((ue,pe)=>{const ee=P.value;if(!ee||ee.readyState!==WebSocket.OPEN){pe(new Error("WebSocket not connected"));return}const U=window.setTimeout(()=>{const me=J.findIndex(Oe=>Oe.resolve===ue);me>=0&&J.splice(me,1),pe(new Error("WebSocket timeout"))},he);J.push({match:le,resolve:ue,reject:pe,timeoutId:U}),ee.send(JSON.stringify(D))}),ke=P=>{P.onmessage=J=>{try{const D=JSON.parse(J.data);(D==null?void 0:D.type)==="printer_list"&&(k.value=Array.isArray(D.data)?D.data:[]),(D==null?void 0:D.type)==="printer_caps"&&D.printer&&(b[D.printer]=(D==null?void 0:D.data)||{}),V(M,D)}catch(D){L(M,D)}},P.onclose=()=>{f.value=null,i.value!=="error"&&(i.value="disconnected"),L(M,new Error("WebSocket closed")),ve()},P.onerror=()=>{i.value="error",u.value="Local connection failed",L(M,new Error("WebSocket error")),ve()}},we=P=>{P.onmessage=J=>{try{const D=JSON.parse(J.data);if((D==null?void 0:D.cmd)==="clients_list")if(S.value=Array.isArray(D.clients)?D.clients:[],S.value.length>0){if(!S.value.some(he=>he.client_id===p.value)){const he=S.value.find(ue=>ue.online)||S.value[0];p.value=(he==null?void 0:he.client_id)||""}}else p.value="";(D==null?void 0:D.cmd)==="printers_list"&&(v.value=Array.isArray(D.printers)?D.printers:[]),V(H,D)}catch(D){L(H,D)}},P.onclose=()=>{T.value=null,d.value!=="error"&&(d.value="disconnected"),L(H,new Error("WebSocket closed")),xe()},P.onerror=()=>{d.value="error",g.value="Remote connection failed",L(H,new Error("WebSocket error")),xe()}},ae=async()=>{if(R)return R;if(f.value&&f.value.readyState===WebSocket.OPEN)return i.value="connected",Promise.resolve();$.value=!1,i.value="connecting",u.value="";const P=new WebSocket(Y.value);return f.value=P,ke(P),R=new Promise((J,D)=>{P.addEventListener("open",()=>{i.value="connected",B(),R=null,P.send(JSON.stringify({type:"get_printers"})),J()}),P.addEventListener("error",()=>{i.value="error",u.value="Local connection failed",R=null,ve(),D(new Error("WebSocket error"))})}),R},K=()=>{$.value=!0,B(),f.value&&f.value.close(),f.value=null,i.value="disconnected",u.value=""},oe=async()=>A||(T.value&&T.value.readyState===WebSocket.OPEN?(d.value="connected",Promise.resolve()):(O.value=!1,d.value="connecting",g.value="",A=(async()=>{try{if(!l.apiBaseUrl||!l.username||!l.password){d.value="error",g.value="Missing remote connection fields";return}const P=await fetch(l.apiBaseUrl,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:l.username,password:l.password})});if(!P.ok){const le=await P.text();throw new Error(le||`HTTP ${P.status}`)}const J=await P.json();if(!(J!=null&&J.token))throw new Error("Missing auth token");x.value=J.token;const D=new WebSocket(te.value);T.value=D,we(D),await new Promise((le,he)=>{D.addEventListener("open",()=>{d.value="connected",re(),D.send(JSON.stringify({cmd:"get_clients"})),le()}),D.addEventListener("error",()=>{d.value="error",g.value="Remote connection failed",xe(),he(new Error("WebSocket error"))})})}catch(P){d.value="error",g.value=P.message||"Remote connection failed",xe()}finally{A=null}})(),A)),c=()=>{O.value=!0,re(),T.value&&T.value.close(),T.value=null,d.value="disconnected",g.value=""},N=async()=>{await ae();const P=await de(f,M,{type:"get_printers"},J=>(J==null?void 0:J.type)==="printer_list");return k.value=Array.isArray(P.data)?P.data:[],k.value},q=async P=>{if(!P)return;if(b[P])return b[P];await ae();const J=await de(f,M,{type:"get_printer_caps",printer:P},D=>(D==null?void 0:D.type)==="printer_caps");return b[P]=(J==null?void 0:J.data)||{},b[P]},_=async()=>{await oe();const P=await de(T,H,{cmd:"get_clients"},J=>(J==null?void 0:J.cmd)==="clients_list");if(S.value=Array.isArray(P.clients)?P.clients:[],S.value.length>0){if(!S.value.some(D=>D.client_id===p.value)){const D=S.value.find(le=>le.online)||S.value[0];p.value=(D==null?void 0:D.client_id)||""}}else p.value="";return S.value},C=async P=>{const J=P||p.value;if(!J)return v.value=[],v.value;await oe();const D=await de(T,H,{cmd:"get_printers",client_id:J},le=>(le==null?void 0:le.cmd)==="printers_list");return v.value=Array.isArray(D.printers)?D.printers:[],v.value};return(()=>{const P=!!n.wsAddress,J=!!(l.apiBaseUrl&&l.username&&l.password);P&&ae(),J&&oe()})(),{printMode:e,silentPrint:t,exportImageMerged:s,localSettings:n,remoteSettings:l,localStatus:i,remoteStatus:d,localStatusMessage:u,remoteStatusMessage:g,localRetryCount:W,remoteRetryCount:X,localPrintOptions:y,remotePrintOptions:m,localWsUrl:Y,remoteWsUrl:te,remoteAuthToken:x,localPrinters:k,remotePrinters:v,remoteClients:S,remoteSelectedClientId:p,localPrinterCaps:b,fetchLocalPrinters:N,fetchRemoteClients:_,fetchRemotePrinters:C,fetchLocalPrinterCaps:q,cancelLocalRetry:Z,cancelRemoteRetry:ne,connectLocal:ae,disconnectLocal:K,connectRemote:oe,disconnectRemote:c}},Qt=()=>(lo||(lo=zc()),lo),Fl=()=>{const r=Re(),{printMode:e,localSettings:t,remoteSettings:s,localStatus:n,remoteStatus:l,localPrintOptions:i,remotePrintOptions:d,localWsUrl:u,remoteWsUrl:g,remoteSelectedClientId:y,exportImageMerged:m}=Qt(),x=ae=>{const K=Ee(ae),oe=r.headerHeight>0&&r.showHeaderLine,c=r.footerHeight>0&&r.showFooterLine;if(!oe&&!c)return K;const N=K[0],q=r.canvasSize.height,_=oe?N.elements.filter(P=>P.y+P.height<=r.headerHeight):[],C=c?N.elements.filter(P=>P.y>=q-r.footerHeight):[],j=Ee(K);for(let P=0;P<j.length;P++){if(P===0)continue;const J=j[P];for(const D of _)J.elements.push({...Ee(D),id:He()});for(const D of C)J.elements.push({...Ee(D),id:He()})}return j},p=async(ae={})=>{const K=ae.mutateStore!==!1,oe=ae.setExporting!==!1,c=K?r.selectedElementId:null,N=K?r.showGrid:!1,q=K?r.zoom:1,_=K?Ee(r.pages):null,C=K?r.showHeaderLine:!1,j=K?r.showFooterLine:!1,P=K?r.showCornerMarkers:!1,J=oe?!!r.isExporting:!1,D=document.documentElement.style.overflowX,le=document.body.style.overflowX;return K&&(r.selectElement(null),r.setShowGrid(!1),r.setZoom(1),r.pages=x(r.pages),r.setShowHeaderLine(!1),r.setShowFooterLine(!1),r.showCornerMarkers=!1,oe&&(r.setIsExporting(!0),document.body.classList.add("exporting"))),document.documentElement.style.overflowX="hidden",document.body.style.overflowX="hidden",!K&&oe&&(r.setIsExporting(!0),document.body.classList.add("exporting")),await Xe(),await new Promise(he=>setTimeout(he,500)),()=>{oe&&(document.body.classList.remove("exporting"),r.setIsExporting(J)),document.documentElement.style.overflowX=D,document.body.style.overflowX=le,K&&(r.setShowGrid(N),r.selectElement(c),r.setZoom(q),_&&(r.pages=_),r.setShowHeaderLine(C),r.setShowFooterLine(j),r.showCornerMarkers=P)}},k=ae=>{ae.classList.remove("group","cursor-move","select-none","ring-2","ring-blue-500","ring-red-500","hover:outline","hover:outline-1","hover:outline-blue-300");const K=[];ae.classList.forEach(c=>{(c.startsWith("hover:")||c.startsWith("focus:")||c.startsWith("active:"))&&K.push(c)}),K.forEach(c=>ae.classList.remove(c)),(ae.style.borderColor==="transparent"||ae.style.border.includes("transparent")||ae.style.borderStyle==="dashed"&&(ae.style.borderColor==="transparent"||!ae.style.borderColor&&ae.style.border.includes("transparent")))&&(ae.style.border="none",ae.style.outline="none",ae.style.boxShadow="none"),Array.from(ae.children).forEach(c=>k(c))},v={enabled:!1,text:"",angle:-30,color:"#000000",opacity:.1,size:24,density:160},S=()=>({pages:x(r.pages),canvasSize:{...r.canvasSize},canvasBackground:r.canvasBackground,headerHeight:r.headerHeight,footerHeight:r.footerHeight,showHeaderLine:r.showHeaderLine,showFooterLine:r.showFooterLine,watermark:Ee(r.watermark||v),unit:r.unit||"mm",testData:Ee(r.testData||{})}),b=(ae,K,oe=1e4)=>new Promise((c,N)=>{const q=window.location.origin,_=window.setTimeout(()=>{window.removeEventListener("message",C),N(new Error(`Print renderer timeout: ${K}`))},oe),C=j=>{if(j.origin!==q)return;const P=j.data;!P||P.type!==K||P.token!==ae||(window.clearTimeout(_),window.removeEventListener("message",C),c(P))};window.addEventListener("message",C)}),f=async()=>{var c;const ae=He(),K=document.createElement("iframe");K.setAttribute("data-print-renderer","true"),K.style.cssText="position:fixed;left:0;top:0;width:0;height:0;border:0;visibility:hidden;",K.src=`${window.location.origin}${window.location.pathname}?print=1&printToken=${encodeURIComponent(ae)}`,document.body.appendChild(K);const oe=()=>{K.parentNode&&K.parentNode.removeChild(K)};try{await b(ae,"print-renderer-ready");const N=S();(c=K.contentWindow)==null||c.postMessage({type:"print-renderer-payload",token:ae,payload:N},window.location.origin),await b(ae,"print-renderer-rendered");const q=K.contentDocument,_=K.contentWindow;if(!q||!_)throw new Error("Print renderer not available");return{pages:Array.from(q.querySelectorAll(".print-page")),cleanup:oe,getComputedStyleFn:_.getComputedStyle.bind(_)}}catch(N){throw oe(),N}},T=async ae=>{if(typeof ae=="string")return{content:ae,cleanup:null,getComputedStyleFn:window.getComputedStyle};const K=await f();return{content:K.pages,cleanup:K.cleanup,getComputedStyleFn:K.getComputedStyleFn}},M=async()=>{const ae=await p({mutateStore:!1,setExporting:!1}),K=r.canvasSize.width,oe=r.canvasSize.height;let c=null,N=null,q=null;try{const _=await T(Array.from(document.querySelectorAll(".print-page")));q=_.cleanup;const C=await G(_.content,K,oe,!0,_.getComputedStyleFn);c=C.container,N=C.tempWrapper;const j=document.createElement("div");return j.style.width="100%",j.style.display="flex",j.style.flexDirection="column",j.style.alignItems="center",Array.from(c.children).filter(J=>!["STYLE","LINK","SCRIPT"].includes(J.tagName)).forEach((J,D)=>{const le=J.cloneNode(!0);le.style.position="relative",le.style.left="auto",le.style.top="auto",le.style.width=`${K}px`,le.style.height=`${oe}px`,le.style.margin="0 0 20px 0",le.style.backgroundColor=r.canvasBackground,le.style.transform="none",j.appendChild(le)}),j.outerHTML}finally{N&&N.parentNode&&N.parentNode.removeChild(N),q&&q(),ae()}},H=ae=>{ae.querySelectorAll("svg").forEach(oe=>{const c=oe.parentElement;if(!c)return;const N=getComputedStyle(c),q=parseFloat(N.width),_=parseFloat(N.height),C=document.createElement("canvas");C.width=Number.isFinite(q)?Math.max(1,Math.round(q)):10,C.height=Number.isFinite(_)?Math.max(1,Math.round(_)):10;const j=C.getContext("2d");if(!j)return;const P=new XMLSerializer;oe.setAttribute("width",`${q}px`),oe.setAttribute("height",`${_}px`);const J=P.serializeToString(oe);Zl.fromString(j,J).render();const le=document.createElement("img");le.src=C.toDataURL("image/png"),le.style.width=`${q}px`,le.style.height=`${_}px`,le.style.display="block",oe.before(le),c.removeChild(oe)})},R=(ae,K)=>{Array.from(ae.children).filter(c=>!["STYLE","LINK","SCRIPT"].includes(c.tagName)).forEach((c,N)=>{c.querySelectorAll('[data-print-type="page-number"]').forEach(_=>{const C=_.querySelector(".page-number-text");C&&(C.textContent=`${N+1}/${K}`)})})},A=(ae,K,oe,c,N,q,_)=>{ae.querySelectorAll("[data-print-wrapper]").forEach(j=>{const P=j,J=parseFloat(P.style.top)||0;parseFloat(P.style.height)||P.offsetHeight;const D=q&&J<oe,le=_&&J>=N-c;if(D||le){const he=P.cloneNode(!0);K.appendChild(he)}})},W=ae=>{const K=ae.querySelector("tfoot");if(!K)return;const oe=ae.getAttribute("data-custom-script");if(oe)try{const c=ae.querySelector("tbody"),N=[];c&&Array.from(c.querySelectorAll("tr")).forEach(P=>{const J={};Array.from(P.querySelectorAll("td")).forEach(le=>{const he=le.getAttribute("data-field");he&&(J[he]=le.textContent||"")}),Object.keys(J).length>0&&N.push(J)});const q=[];Array.from(K.querySelectorAll("tr")).forEach(j=>{const P={};Array.from(j.querySelectorAll("td")).forEach(D=>{const le=D.getAttribute("data-field");le&&(P[le]={value:D.getAttribute("data-value")||D.textContent||""})}),q.push(P)}),new Function("data","footerData","columns","type",oe)(N,q,[],"page"),q.length>0&&Array.from(K.querySelectorAll("tr")).forEach((P,J)=>{q[J]&&Array.from(P.querySelectorAll("td")).forEach(le=>{const he=le.getAttribute("data-field");if(he&&q[J][he]!==void 0){let ue=q[J][he];ue&&typeof ue=="object"&&(ue.result!==void 0?ue=ue.result:ue.value!==void 0&&(ue=ue.value)),le.textContent=String(ue)}})});return}catch(c){console.error("Page sum script error:",c)}},X=(ae,K,oe,c,N,q)=>{let _=Array.from(ae.children).filter(C=>!["STYLE","LINK","SCRIPT"].includes(C.tagName));for(let C=0;C<_.length;C++){const j=_[C];j.querySelectorAll("table").forEach(J=>{const D=J.closest("[data-print-wrapper]");if(!D||!(J.getAttribute("data-auto-paginate")==="true"))return;D.style.height="auto",J.style.height="auto";const he=J.querySelector("tbody");he&&(he.style.height="auto");const ue=J.parentElement;ue&&(ue.classList.remove("h-full","overflow-hidden"),ue.style.height="auto",ue.style.overflow="visible");const ee=j.getBoundingClientRect().top+K-c,me=D.getBoundingClientRect().top;if(J.getBoundingClientRect().bottom<=ee){W(J);return}let Be=-1;const Ue=J.querySelector("tbody");if(!Ue)return;const Ie=Array.from(Ue.querySelectorAll("tr")),Fe=J.querySelector("tfoot"),st=J.getAttribute("data-tfoot-repeat")==="true";let Ve=0;Fe&&st&&(Ve=Fe.getBoundingClientRect().height);for(let je=0;je<Ie.length;je++)if(Ie[je].getBoundingClientRect().bottom+Ve>ee+1){if(Be=je,Be===0){const nt=N&&oe>0?oe+10:r.pageSpacingY||0;me<=nt+5&&(Be=1)}break}if(Be!==-1){const je=document.createElement("div");je.className=j.className,je.style.cssText=j.style.cssText,je.innerHTML="",A(j,je,oe,c,K,N,q),C===_.length-1?ae.appendChild(je):ae.insertBefore(je,_[C+1]),_=Array.from(ae.children).filter(at=>!["STYLE","LINK","SCRIPT"].includes(at.tagName));const Ze=D.cloneNode(!0),lt=N&&oe>0?oe+10:r.pageSpacingY||0;Ze.style.removeProperty("top"),Ze.style.setProperty("top",`${lt}px`,"important");const nt=Ie;for(let at=Be;at<nt.length;at++)nt[at].remove();Be===0&&D.remove();const Tt=J.querySelector("tfoot"),ht=J.getAttribute("data-tfoot-repeat")==="true";Tt&&(ht?W(J):Tt.remove());const pt=Ze.querySelector("table");pt.style.height="auto";const er=pt.querySelector("tbody");er&&(er.style.height="auto");const Gl=Array.from(er.querySelectorAll("tr"));for(let at=0;at<Be;at++)Gl[at].remove();je.appendChild(Ze)}else W(J)})}return _=Array.from(ae.children).filter(C=>!["STYLE","LINK","SCRIPT"].includes(C.tagName)),_.forEach((C,j)=>{C.style.top=`${j*K}px`}),_.length},se=(ae,K=window.getComputedStyle)=>{const oe=ae.cloneNode(!0),c=[[ae,oe]];for(;c.length>0;){const[N,q]=c.shift();if(N.nodeType===1){const _=K(N),C=q.style;for(let j=0;j<_.length;j++){const P=_[j];C.setProperty(P,_.getPropertyValue(P),_.getPropertyPriority(P))}}for(let _=0;_<N.children.length;_++)q.children[_]&&c.push([N.children[_],q.children[_]])}return oe},G=async(ae,K,oe,c=!0,N=window.getComputedStyle)=>{const q=document.createElement("div");q.style.position="fixed",q.style.left="0",q.style.top="0",q.style.width=`${K}px`,q.style.height=`${oe}px`,q.style.zIndex="-9999",q.className="print_temp_container",document.body.appendChild(q),document.head.querySelectorAll('style, link[rel="stylesheet"]').forEach(P=>{q.appendChild(P.cloneNode(!0))});let C=[];typeof ae=="string"?(q.innerHTML=ae,C=Array.from(q.children).filter(P=>!["STYLE","LINK","SCRIPT"].includes(P.tagName))):Array.isArray(ae)?C=ae:ae.classList.contains("design-workspace")?C=Array.from(ae.children):C=[ae],C.forEach((P,J)=>{const D=se(P,N);D.style.position="absolute",D.style.left="0",D.style.top=`${J*oe}px`,D.style.width=`${K}px`,D.style.height=`${oe}px`,D.style.transform="none",D.style.backgroundColor=r.canvasBackground,D.querySelectorAll('[data-print-exclude="true"]').forEach(ue=>ue.remove()),D.querySelectorAll(".element-wrapper").forEach(ue=>ue.setAttribute("data-print-wrapper","true")),k(D),D.querySelectorAll("svg").forEach(ue=>{const pe=ue.getBoundingClientRect();if(pe.width===0||pe.height===0){const ee=ue.getAttribute("width"),U=ue.getAttribute("height");ee&&(ue.style.width=ee.includes("px")?ee:`${ee}px`),U&&(ue.style.height=U.includes("px")?U:`${U}px`)}}),q.appendChild(D)}),await new Promise(P=>setTimeout(P,100)),c&&H(q);const j=X(q,oe,r.headerHeight,r.footerHeight,r.showHeaderLine,r.showFooterLine);return R(q,j),q.style.height=`${oe*j}px`,{container:q,tempWrapper:q,pagesCount:j}},$=async(ae,K,oe)=>{const c=Array.from(ae.children).filter(C=>!["STYLE","LINK","SCRIPT"].includes(C.tagName));c.forEach(C=>{C.style.top="0px"});const N=async C=>{const j=await Sc.toCanvas(C,{scale:1.5,width:K,height:oe,useCORS:!0,bgcolor:r.canvasBackground}),P=j.getContext("2d");return P&&(P.mozImageSmoothingEnabled=!1,P.webkitImageSmoothingEnabled=!1,P.msImageSmoothingEnabled=!1,P.imageSmoothingEnabled=!1),j.toDataURL("image/jpeg",.5)},q=3,_=[];for(let C=0;C<c.length;C+=q){const j=c.slice(C,C+q),P=await Promise.all(j.map(J=>N(J)));_.push(...P)}return _},O=async ae=>{const K=await p({mutateStore:!1,setExporting:!1}),oe=r.canvasSize.width,c=r.canvasSize.height,N=uo(oe),q=uo(c);let _=null,C=null;try{const j=await T(ae);C=j.cleanup;const{container:P,tempWrapper:J}=await G(j.content,oe,c,!0,j.getComputedStyleFn);_=J;const D=new ei({orientation:oe>c?"l":"p",unit:"mm",format:[N,q],hotfixes:["px_scaling"]});return(await $(P,oe,c)).forEach((he,ue)=>{ue>0&&D.addPage([N,q]),D.addImage(he,"JPEG",0,0,N,q)}),D}finally{_&&_.parentNode&&_.parentNode.removeChild(_),C&&C(),K()}},h=async(ae,K="print-design.pdf")=>{try{const oe=ae||Array.from(document.querySelectorAll(".print-page"));(await O(oe)).save(K)}catch(oe){console.error("Export PDF failed",oe),alert("Export PDF failed")}},w=async ae=>{try{const oe=(await O(ae)).output("blob"),c=URL.createObjectURL(oe);if(/Edg\//.test(navigator.userAgent)){const _=window.open(c,"_blank","noopener,noreferrer");if(!_){URL.revokeObjectURL(c);return}_.addEventListener("beforeunload",()=>{URL.revokeObjectURL(c)}),_.onload=()=>{try{_.focus(),_.print()}finally{setTimeout(()=>{URL.revokeObjectURL(c)},1e3)}};return}const q=document.createElement("iframe");q.style.position="fixed",q.style.left="0",q.style.top="0",q.style.width="0px",q.style.height="0px",q.style.border="0",q.style.visibility="hidden",q.src=c,document.body.appendChild(q),q.onload=()=>{const _=q.contentWindow;_&&(_.focus(),setTimeout(()=>{_.print()},100)),setTimeout(()=>{document.body.removeChild(q),URL.revokeObjectURL(c)},1e3)}}catch(K){console.error("Print failed",K),alert("Print failed")}},Y=ae=>new Promise((K,oe)=>{const c=new FileReader;c.onloadend=()=>K(c.result),c.onerror=()=>oe(new Error("Failed to read PDF blob")),c.readAsDataURL(ae)}),te=(ae,K,oe)=>{const c={printer:ae.printer,content:K};return oe&&(c.key=oe),(ae.jobName||ae.copies||ae.intervalMs)&&(c.job={...ae.jobName?{name:ae.jobName}:{},...ae.copies?{copies:ae.copies}:{},...ae.intervalMs?{intervalMs:ae.intervalMs}:{}}),(ae.pageRange||ae.pageSet)&&(c.pages={...ae.pageRange?{range:ae.pageRange}:{},...ae.pageSet?{set:ae.pageSet}:{}}),(ae.scale||ae.orientation)&&(c.layout={...ae.scale?{scale:ae.scale}:{},...ae.orientation?{orientation:ae.orientation}:{}}),ae.colorMode&&(c.color={mode:ae.colorMode}),ae.sidesMode&&(c.sides={mode:ae.sidesMode}),ae.paperSize&&(c.paper={size:ae.paperSize}),ae.trayBin&&(c.tray={bin:ae.trayBin}),c},Q=(ae,K,oe)=>new Promise((c,N)=>{let q=!1;const _=new WebSocket(ae),C=window.setTimeout(()=>{q||(q=!0,_.close(),N(new Error("Print request timeout")))},3e4);_.onopen=()=>{_.send(JSON.stringify(K))},_.onmessage=j=>{if(!q)try{const P=JSON.parse(j.data);if(oe==="status"&&(P.status==="success"||P.status),oe==="task_result"&&P.cmd==="task_result"){q=!0,window.clearTimeout(C),_.close(),c();return}}catch(P){q=!0,window.clearTimeout(C),_.close(),N(P instanceof Error?P:new Error("Print failed"))}},_.onerror=()=>{q||(q=!0,window.clearTimeout(C),_.close(),N(new Error("Print connection failed")))}});let I=null,V="",L=null,B=Promise.resolve();const re=()=>{I&&I.readyState===WebSocket.OPEN&&I.close(),I=null,V="",L=null},Z=ae=>I&&I.readyState===WebSocket.OPEN&&V===ae?Promise.resolve(I):L||(V=ae,L=new Promise((K,oe)=>{const c=new WebSocket(ae),N=()=>{c.removeEventListener("open",N),c.removeEventListener("error",q),I=c,L=null,K(c)},q=()=>{c.removeEventListener("open",N),c.removeEventListener("error",q),re(),oe(new Error("Print connection failed"))};c.addEventListener("open",N),c.addEventListener("error",q)}),L),ne=(ae,K,oe)=>(B=B.then(()=>new Promise(async(c,N)=>{let q=!1,_=null;const C=window.setTimeout(()=>{q||(q=!0,re(),N(new Error("Print request timeout")))},3e4),j=()=>{_&&(_.removeEventListener("message",P),_.removeEventListener("error",J),_.removeEventListener("close",D))},P=le=>{if(!q)try{const he=JSON.parse(le.data);(he.status==="success"||he.status==="error")&&(q=!0,window.clearTimeout(C),j(),he.status==="success"?c():N(new Error(he.message||"Print failed")))}catch(he){q=!0,window.clearTimeout(C),j(),N(he instanceof Error?he:new Error("Print failed"))}},J=()=>{q||(q=!0,window.clearTimeout(C),j(),re(),N(new Error("Print connection failed")))},D=()=>{q||(q=!0,window.clearTimeout(C),j(),re(),N(new Error("Print connection closed")))};try{_=await Z(ae),_.addEventListener("message",P),_.addEventListener("error",J),_.addEventListener("close",D),_.send(JSON.stringify(K))}catch(le){q=!0,window.clearTimeout(C),j(),N(le instanceof Error?le:new Error("Print connection failed"))}})),B),ve=async(ae,K)=>{const oe=(K==null?void 0:K.mode)||e.value;if(oe==="browser"){await w(ae);return}if(!(oe==="local"?n.value==="connected":l.value==="connected")){await w(ae);return}const N=(K==null?void 0:K.options)||(oe==="local"?i:d);if(!N.printer){alert("Printer is required");return}try{const q=await we(ae),_=await Y(q);if(oe==="local"){const j=te(N,_,t.secretKey.trim());await ne(u.value,j,"status");return}if(!y.value){alert("Client is required");return}const C=te(N,_);C.cmd="submit_task",C.client_id=y.value,await Q(g.value,C,"task_result")}catch(q){console.error("Print failed",q),alert("Print failed")}},xe=async ae=>{if(ae.length===0)return"";const K=await new Promise((C,j)=>{const P=new Image;P.onload=()=>C(P),P.onerror=j,P.src=ae[0]}),oe=K.width,c=K.height,N=c*ae.length,q=document.createElement("canvas");q.width=oe,q.height=N;const _=q.getContext("2d");if(!_)throw new Error("Could not get canvas context");_.drawImage(K,0,0);for(let C=1;C<ae.length;C++)await new Promise((j,P)=>{const J=new Image;J.onload=()=>{_.drawImage(J,0,C*c),j()},J.onerror=P,J.src=ae[C]});return q.toDataURL("image/jpeg",.8)},de=async(ae,K="print-design")=>{try{const oe=ae||Array.from(document.querySelectorAll(".print-page")),c=await p({mutateStore:!1,setExporting:!1}),N=r.canvasSize.width,q=r.canvasSize.height;let _=null;const C=await T(oe);_=C.cleanup;const{container:j,tempWrapper:P}=await G(C.content,N,q,!0,C.getComputedStyleFn);try{const J=await $(j,N,q);if(J.length===0)return;if(m.value){const D=await xe(J),le=document.createElement("a");le.href=D,le.download=`${K}.jpg`,document.body.appendChild(le),le.click(),document.body.removeChild(le)}else{const D=new Tc;await Promise.all(J.map(async(pe,ee)=>{const me=await(await fetch(pe)).blob();D.file(`${K}-${ee+1}.jpg`,me)}));const le=await D.generateAsync({type:"blob"}),he=URL.createObjectURL(le),ue=document.createElement("a");ue.href=he,ue.download=`${K}.zip`,document.body.appendChild(ue),ue.click(),document.body.removeChild(ue),URL.revokeObjectURL(he)}}finally{P&&P.parentNode&&P.parentNode.removeChild(P),_&&_(),c()}}catch(oe){console.error("Export Images failed",oe),alert("Export Images failed")}},ke=async ae=>{try{const K=ae||Array.from(document.querySelectorAll(".print-page")),oe=await p({mutateStore:!1,setExporting:!1}),c=r.canvasSize.width,N=r.canvasSize.height;let q=null;const _=await T(K);q=_.cleanup;const{container:C,tempWrapper:j}=await G(_.content,c,N,!0,_.getComputedStyleFn);try{const P=await $(C,c,N);if(P.length===0)throw new Error("No images generated");const J=await xe(P);return await(await fetch(J)).blob()}finally{j&&j.parentNode&&j.parentNode.removeChild(j),q&&q(),oe()}}catch(K){throw console.error("Get Image Blob failed",K),K}},we=async ae=>{try{return(await O(ae)).output("blob")}catch(K){throw console.error("Get PDF Blob failed",K),K}};return{getPrintHtml:M,print:ve,exportPdf:h,exportImages:de,getPdfBlob:we,getImageBlob:ke}},Pc={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function Lc(r,e){return z(),F("svg",Pc,[...e[0]||(e[0]=[o("path",{fill:"currentColor",d:"M6.4 19L5 17.6l5.6-5.6L5 6.4L6.4 5l5.6 5.6L17.6 5L19 6.4L13.4 12l5.6 5.6l-1.4 1.4l-5.6-5.6z"},null,-1)])])}const vt=Se({name:"material-symbols-close",render:Lc}),Mc={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function Rc(r,e){return z(),F("svg",Mc,[...e[0]||(e[0]=[o("path",{fill:"currentColor",d:"M14 20v-2h3q.425 0 .713-.288T18 17v-2q0-.95.55-1.725t1.45-1.1v-.35q-.9-.325-1.45-1.1T18 9V7q0-.425-.288-.712T17 6h-3V4h3q1.25 0 2.125.875T20 7v2q0 .425.288.713T21 10h1v4h-1q-.425 0-.712.288T20 15v2q0 1.25-.875 2.125T17 20zm-7 0q-1.25 0-2.125-.875T4 17v-2q0-.425-.288-.712T3 14H2v-4h1q.425 0 .713-.288T4 9V7q0-1.25.875-2.125T7 4h3v2H7q-.425 0-.712.288T6 7v2q0 .95-.55 1.725T4 11.825v.35q.9.325 1.45 1.1T6 15v2q0 .425.288.713T7 18h3v2z"},null,-1)])])}const ut=Se({name:"material-symbols-data-object",render:Rc}),Dc={class:"bg-white rounded-lg shadow-xl w-[60vw] h-[80vh] flex flex-col overflow-hidden animate-fade-in"},Bc={class:"h-[60px] flex items-center justify-between px-4 border-b border-gray-200 shrink-0"},Oc={class:"flex items-center gap-2"},qc={class:"text-lg font-semibold text-gray-800"},Fc={class:"px-2 py-0.5 rounded bg-gray-200 text-gray-600 text-xs font-mono"},Nc={class:"flex-1 overflow-hidden relative"},jc={class:"p-4 border-t border-gray-200 bg-gray-50 flex justify-end rounded-b-lg"},Hc=Pe({__name:"CodeEditorModal",props:{visible:{type:Boolean},title:{},value:{},language:{},readOnly:{type:Boolean}},emits:["update:visible","update:value","close"],setup(r,{emit:e}){const{t}=Ne(),{isDark:s}=So(),n=r,l=e,i=Re(),d=fe(()=>({minimap:{enabled:!0},lineNumbers:"on",glyphMargin:!1,folding:!0,wordWrap:"on",automaticLayout:!0,scrollBeyondLastLine:!1,theme:s.value?"vs-dark":"vs",fontSize:14,fontFamily:'Consolas, "Courier New", monospace',renderLineHighlight:"none",overviewRulerLanes:0,hideCursorInOverviewRuler:!0,contextmenu:!0})),u=m=>{l("update:value",m||"")},g=()=>{l("update:visible",!1),l("close")},y=m=>{n.visible&&m.key==="Escape"&&g()};return Ae(()=>n.visible,m=>{i.setDisableGlobalShortcuts(m)}),We(()=>{window.addEventListener("keydown",y)}),Ge(()=>{window.removeEventListener("keydown",y),n.visible&&i.setDisableGlobalShortcuts(!1)}),(m,x)=>(z(),ze(tt,{to:"body"},[r.visible?(z(),F("div",{key:0,class:"fixed inset-0 z-[99999] flex items-center justify-center bg-black/50",onClick:Ke(g,["self"])},[o("div",Dc,[o("div",Bc,[o("div",Oc,[o("h3",qc,E(r.title),1),o("span",Fc,E(r.language),1)]),o("button",{onClick:g,class:"p-1 hover:bg-gray-100 rounded-full transition-colors text-gray-500"},[ce(a(vt),{class:"w-4 h-4"})])]),o("div",Nc,[ce(a(cl),{value:r.value,language:r.language,options:{...d.value,readOnly:r.readOnly},"onUpdate:value":u,class:"w-full h-full"},null,8,["value","language","options"])]),o("div",jc,[o("button",{onClick:g,class:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 transition-colors text-sm"},E(a(t)("common.close")),1)])])])):be("",!0)]))}}),Et=(r,e)=>{const t=r.__vccOpts||r;for(const[s,n]of e)t[s]=n;return t},Ot=Et(Hc,[["__scopeId","data-v-511b518d"]]),Uc={class:"bg-white rounded-lg shadow-xl w-[90vw] h-[90vh] flex flex-col overflow-hidden"},Vc={class:"relative flex items-center justify-between p-4 border-b border-gray-200"},Wc={class:"text-lg font-semibold text-gray-800"},Gc={class:"absolute left-1/2 -translate-x-1/2 flex items-center gap-2"},Kc=["title"],Yc=["title"],Xc={class:"text-xs text-gray-600 w-9 text-right select-none"},Zc=["innerHTML"],Jc={class:"p-4 border-t border-gray-200 bg-gray-50 flex justify-end gap-3 rounded-b-lg"},Qc=Pe({__name:"PreviewModal",props:{visible:{type:Boolean},htmlContent:{},width:{}},emits:["update:visible"],setup(r,{emit:e}){const t=r,s=e,{t:n}=Ne(),l=Re(),{exportPdf:i,getPdfBlob:d,exportImages:u,getImageBlob:g}=Fl(),y=Zt(),m=ie(null),x=ie(null),p=ie(100),k=ie(!1),v=ie(""),S=ie(""),b=ie("json");Ae(()=>t.visible,Y=>{Y||(p.value=100),l.setDisableGlobalShortcuts(Y)});const f=()=>{s("update:visible",!1)},T=()=>{const Y={pages:Ee(l.pages),canvasSize:Ee(l.canvasSize),guides:Ee(l.guides),zoom:l.zoom,showGrid:l.showGrid,headerHeight:l.headerHeight,footerHeight:l.footerHeight,showHeaderLine:l.showHeaderLine,showFooterLine:l.showFooterLine,showMinimap:l.showMinimap,canvasBackground:l.canvasBackground};v.value=JSON.stringify(Y,null,2),S.value=n("preview.templateJson"),b.value="json",k.value=!0},M=async()=>{try{if(!m.value)return;const Y=Array.from(m.value.querySelectorAll(".print-page")),te=await g(Y),Q=new FileReader;Q.readAsDataURL(te),Q.onloadend=()=>{v.value=Q.result,S.value=n("editor.viewImageBlob"),b.value="text",k.value=!0}}catch(Y){console.error(Y),alert("Failed to generate blob")}},H=async()=>{try{if(!m.value)return;const Y=Array.from(m.value.querySelectorAll(".print-page")),te=await d(Y),Q=new FileReader;Q.readAsDataURL(te),Q.onloadend=()=>{v.value=Q.result,S.value=n("editor.viewPdfBlob"),b.value="text",k.value=!0}}catch(Y){console.error(Y),alert("Failed to generate PDF blob")}},R=()=>{window.dispatchEvent(new CustomEvent("designer:print"))},A=()=>{if(m.value){const Y=Array.from(m.value.querySelectorAll(".print-page"));i(Y,`${X()}.pdf`)}},W=async()=>{if(m.value){const Y=Array.from(m.value.querySelectorAll(".print-page"));await u(Y,X())}},X=()=>{const Y=y.templates.find(re=>re.id===y.currentTemplateId),Q=((Y==null?void 0:Y.name)||"print-design").trim().replace(/[\\/:*?"<>|]/g,"-").replace(/\s+/g," ").trim()||"print-design",I=new Date,V=I.getFullYear(),L=String(I.getMonth()+1).padStart(2,"0"),B=String(I.getDate()).padStart(2,"0");return`${Q}-${V}${L}${B}`},se=()=>{p.value=Math.min(500,p.value+10)},G=()=>{p.value=Math.max(20,p.value-10)},$=Y=>{Y.ctrlKey&&(Y.preventDefault(),Y.deltaY<0?se():G())},O=Y=>{var te,Q;(Y.key==="Control"||Y.key==="Meta")&&(Y.type==="keydown"&&!Y.repeat?(te=x.value)==null||te.addEventListener("wheel",$,{passive:!1}):Y.type==="keyup"&&((Q=x.value)==null||Q.removeEventListener("wheel",$)))},h=()=>{var Y;(Y=x.value)==null||Y.removeEventListener("wheel",$)},w=Y=>{t.visible&&Y.key==="Escape"&&f(),O(Y)};return We(()=>{window.addEventListener("keydown",w),window.addEventListener("keyup",O),window.addEventListener("blur",h)}),Ge(()=>{var Y;window.removeEventListener("keydown",w),window.removeEventListener("keyup",O),window.removeEventListener("blur",h),(Y=x.value)==null||Y.removeEventListener("wheel",$),t.visible&&l.setDisableGlobalShortcuts(!1)}),(Y,te)=>(z(),F(Te,null,[(z(),ze(tt,{to:"body"},[r.visible?(z(),F("div",{key:0,class:"fixed inset-0 z-[99999] flex items-center justify-center bg-black/50",onClick:Ke(f,["self"])},[o("div",Uc,[o("div",Vc,[o("h3",Wc,E(a(n)("preview.title")),1),o("div",Gc,[o("button",{onClick:G,class:"p-1 hover:bg-gray-100 rounded text-gray-600 transition-colors",title:a(n)("preview.zoomOut")},[ce(a(Rl),{class:"w-4 h-4"})],8,Kc),$e(o("input",{type:"range",min:"20",max:"500",step:"10","onUpdate:modelValue":te[0]||(te[0]=Q=>p.value=Q),class:"w-32 h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer [&::-webkit-slider-thumb]:appearance-none [&::-webkit-slider-thumb]:w-4 [&::-webkit-slider-thumb]:h-4 [&::-webkit-slider-thumb]:bg-blue-600 [&::-webkit-slider-thumb]:rounded-full [&::-webkit-slider-thumb]:cursor-pointer [&::-webkit-slider-thumb]:transition-all [&::-webkit-slider-thumb]:hover:scale-110 [&::-moz-range-thumb]:w-4 [&::-moz-range-thumb]:h-4 [&::-moz-range-thumb]:bg-blue-600 [&::-moz-range-thumb]:border-none [&::-moz-range-thumb]:rounded-full [&::-moz-range-thumb]:cursor-pointer [&::-moz-range-thumb]:transition-all [&::-moz-range-thumb]:hover:scale-110"},null,512),[[De,p.value,void 0,{number:!0}]]),o("button",{onClick:se,class:"p-1 hover:bg-gray-100 rounded text-gray-600 transition-colors",title:a(n)("preview.zoomIn")},[ce(a(Ml),{class:"w-4 h-4"})],8,Yc),o("span",Xc,E(p.value)+"%",1)]),o("button",{onClick:f,class:"p-1 hover:bg-gray-100 rounded-full transition-colors text-gray-500"},[ce(a(vt),{class:"w-4 h-4"})])]),o("div",{class:"flex-1 overflow-auto bg-gray-100 p-8 flex justify-center",ref_key:"wrapperRef",ref:x},[o("div",{ref_key:"previewContainer",ref:m,class:"preview-content",style:ye(`width: ${r.width}px; zoom: ${p.value/100}`),innerHTML:r.htmlContent},null,12,Zc)],512),o("div",Jc,[o("button",{onClick:R,class:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 flex items-center gap-2 text-sm transition-colors"},[ce(a(Co),{class:"text-lg"}),Ce(" "+E(a(n)("editor.print")),1)]),o("button",{onClick:A,class:"px-4 py-2 bg-indigo-600 text-white rounded hover:bg-indigo-700 flex items-center gap-2 text-sm transition-colors"},[ce(a(Vt),{class:"text-lg"}),Ce(" "+E(a(n)("editor.exportPdf")),1)]),o("button",{onClick:W,class:"px-4 py-2 bg-purple-600 text-white rounded hover:bg-purple-700 flex items-center gap-2 text-sm transition-colors"},[ce(a(Vt),{class:"text-lg"}),Ce(" "+E(a(n)("editor.exportImage")),1)]),o("button",{onClick:M,class:"px-4 py-2 border border-gray-300 rounded hover:bg-gray-100 text-sm text-gray-700 flex items-center gap-2 transition-colors"},[ce(a(ut),{class:"text-lg"}),Ce(" "+E(a(n)("editor.viewImageBlob")),1)]),o("button",{onClick:H,class:"px-4 py-2 border border-gray-300 rounded hover:bg-gray-100 text-sm text-gray-700 flex items-center gap-2 transition-colors"},[ce(a(ut),{class:"text-lg"}),Ce(" "+E(a(n)("editor.viewPdfBlob")),1)]),o("button",{onClick:T,class:"px-4 py-2 border border-gray-300 rounded hover:bg-gray-100 text-sm text-gray-700 flex items-center gap-2 transition-colors"},[ce(a(ut),{class:"text-lg"}),Ce(" "+E(a(n)("editor.viewJson")),1)]),o("button",{onClick:f,class:"px-4 py-2 border border-gray-300 rounded hover:bg-gray-100 text-sm text-gray-700 flex items-center gap-2 transition-colors"},E(a(n)("common.close")),1)])])])):be("",!0)])),ce(Ot,{visible:k.value,"onUpdate:visible":te[1]||(te[1]=Q=>k.value=Q),title:S.value,value:v.value,language:b.value,"read-only":""},null,8,["visible","title","value","language"])],64))}}),eh=Et(Qc,[["__scopeId","data-v-de785629"]]),th={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function rh(r,e){return z(),F("svg",th,[...e[0]||(e[0]=[o("path",{fill:"currentColor",d:"m9.55 18l-5.7-5.7l1.425-1.425L9.55 15.15l9.175-9.175L20.15 7.4z"},null,-1)])])}const nh=Se({name:"material-symbols-check",render:rh}),oh={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function sh(r,e){return z(),F("svg",oh,[...e[0]||(e[0]=[o("path",{fill:"currentColor",d:"M19.25 16.4L8.4 5.55L12 2l5.65 5.55q1.1 1.05 1.725 2.488T20 13.1q0 .9-.2 1.725t-.55 1.575m.55 6.2l-3.1-3.1q-1.025.725-2.2 1.113T12 21q-3.325 0-5.663-2.312T4 13.1q0-1.275.4-2.45T5.6 8.4L1.4 4.2l1.4-1.4l18.4 18.4z"},null,-1)])])}Se({name:"material-symbols-format-color-reset",render:sh});const ah={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function lh(r,e){return z(),F("svg",ah,[...e[0]||(e[0]=[o("path",{fill:"currentColor",d:"m20.475 23.3l-2.3-2.3h-1.85v-1.85l-2-2V21h-4.65v-4.675H13.5l-2-2H9.675v-1.85l-2-2v3.85H3v-4.65h3.875l-2-2H3V5.8L.7 3.5l1.4-1.4l19.8 19.8zM5 21q-.825 0-1.412-.587T3 19v-2.675h4.675V21zm16-2.9l-1.775-1.775H21zm-3.775-3.775l-.9-.9v-3.75H21v4.65zm-2.9-2.9l-1.75-1.75h1.75zm-3.75-3.75l-.9-.9V3h4.65v4.675zm5.75 0V3H19q.825 0 1.413.588T21 5v2.675zm-8.65-2.9L5.9 3h1.775z"},null,-1)])])}Se({name:"material-symbols-grid-off",render:lh});const ih={key:0,class:"w-full h-[1px] bg-red-500 rotate-45 absolute"},dh={key:1,class:"w-full h-full bg-[url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAIAAADZF8uwAAAAGUlEQVQYV2M4gwZ+5wNisxL//8n04mEeRAAAhNwX869V4DYAAAAASUVORK5CYII=')] opacity-50"},uh={class:"flex gap-2 mb-3"},ch={class:"flex-1 flex flex-col gap-2"},hh={class:"relative h-3 rounded bg-[url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAIAAADZF8uwAAAAGUlEQVQYV2M4gwZ+5wNisxL//8n04mEeRAAAhNwX869V4DYAAAAASUVORK5CYII=')] border border-gray-200"},ph={class:"w-8 h-8 rounded border border-gray-200 overflow-hidden relative"},fh={key:0,class:"absolute inset-0 flex items-center justify-center pointer-events-none"},mh={class:"flex gap-2 mb-3"},gh={class:"flex-1"},vh={class:"w-16 text-right text-xs text-gray-500 flex items-center justify-end"},bh={class:"grid grid-cols-9 gap-1.5 mb-3"},yh=["onClick","title"],wh={class:"flex justify-between border-t pt-2"},xh={key:0},_h={class:"flex gap-2 mb-3"},kh={class:"flex-1 flex flex-col gap-2"},Sh={class:"relative h-3 rounded bg-[url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAIAAADZF8uwAAAAGUlEQVQYV2M4gwZ+5wNisxL//8n04mEeRAAAhNwX869V4DYAAAAASUVORK5CYII=')] border border-gray-200"},Ch={class:"w-8 h-8 rounded border border-gray-200 overflow-hidden relative"},Eh={key:0,class:"absolute inset-0 flex items-center justify-center pointer-events-none"},Th={class:"flex gap-2 mb-3"},$h={class:"flex-1"},Ih={class:"w-16 text-right text-xs text-gray-500 flex items-center justify-end"},Ah={class:"grid grid-cols-9 gap-1.5 mb-3"},zh=["onClick","title"],Ph={class:"flex justify-between border-t pt-2"},Lh={key:0},xt=Pe({__name:"ColorPicker",props:{modelValue:{},disabled:{type:Boolean},defaultColor:{},allowTransparent:{type:Boolean},teleportToBody:{type:Boolean}},emits:["update:modelValue"],setup(r,{emit:e}){const t=r,s=e,{t:n}=Ne(),l=ie(!1),i=ie(null),d=ie(null),u=ie({h:0,s:0,v:0,a:1}),g=ie(null),y=ie(null),m=ie(null),x=fe(()=>t.modelValue?t.modelValue==="transparent"?"transparent":t.modelValue:t.defaultColor||"#000000"),p=fe(()=>t.modelValue==="transparent"),k=fe({get:()=>qa(u.value.h,u.value.s,u.value.v,u.value.a),set:h=>{const w=Mt(h);w&&(u.value=w,R())}}),v=fe(()=>{const{r:h,g:w,b:Y}=Dt(u.value.h,u.value.s,u.value.v);return`rgba(${h}, ${w}, ${Y}, ${parseFloat(u.value.a.toFixed(2))})`}),S=fe(()=>({backgroundColor:`hsl(${u.value.h}, 100%, 50%)`})),b=fe(()=>({top:`${(1-u.value.v)*100}%`,left:`${u.value.s*100}%`})),f=fe(()=>({left:`${u.value.h/360*100}%`})),T=fe(()=>({left:`${u.value.a*100}%`})),M=fe(()=>{const{r:h,g:w,b:Y}=Dt(u.value.h,u.value.s,u.value.v);return{background:`linear-gradient(to right, rgba(${h},${w},${Y},0) 0%, rgba(${h},${w},${Y},1) 100%)`}});Ae(()=>t.modelValue,h=>{if(h){const w=Mt(h);w&&(u.value=w)}},{immediate:!0});const H=(h,w)=>{h.preventDefault();const Y=w==="sv"?g.value:w==="hue"?y.value:m.value;if(!Y)return;const te=(V,L)=>{const B=Y.getBoundingClientRect();let re=(V-B.left)/B.width,Z=(L-B.top)/B.height;re=Math.max(0,Math.min(1,re)),Z=Math.max(0,Math.min(1,Z)),w==="sv"?(u.value.s=re,u.value.v=1-Z,u.value.a===0&&(u.value.a=1)):w==="hue"?(u.value.h=re*360,u.value.a===0&&(u.value.a=1)):w==="alpha"&&(u.value.a=re),R()};te(h.clientX,h.clientY);const Q=V=>te(V.clientX,V.clientY),I=()=>{window.removeEventListener("mousemove",Q),window.removeEventListener("mouseup",I)};window.addEventListener("mousemove",Q),window.addEventListener("mouseup",I)},R=()=>{u.value.a===0&&t.allowTransparent?s("update:modelValue","transparent"):s("update:modelValue",qa(u.value.h,u.value.s,u.value.v,u.value.a))},A=ie({top:"100%",left:"0",marginTop:"8px"}),W=()=>{if(!i.value)return;const h=i.value.getBoundingClientRect(),w=window.innerWidth,Y=window.innerHeight,te=240,Q=350,I={};if(t.teleportToBody){const V=h.left+te<=w-20,L=h.bottom+Q<=Y-10;I.position="fixed",I.left=`${V?h.left:Math.max(8,h.right-te)}px`,I.top=`${L?h.bottom+8:Math.max(8,h.top-Q-8)}px`,A.value=I;return}h.left+te>w-20?(I.left="auto",I.right="0"):(I.left="0",I.right="auto"),h.bottom+Q>Y-10?(I.top="auto",I.bottom="100%",I.marginTop="0",I.marginBottom="8px"):(I.top="100%",I.bottom="auto",I.marginTop="8px",I.marginBottom="0"),A.value=I},X=async()=>{t.disabled||(l.value=!l.value,l.value&&(await Xe(),W()))},se=()=>{l.value=!1},G=h=>{const w=h.target;i.value&&i.value.contains(w)||d.value&&d.value.contains(w)||i.value&&se()};Ae(l,h=>{t.teleportToBody&&(h?(W(),window.addEventListener("scroll",W,!0),window.addEventListener("resize",W)):(window.removeEventListener("scroll",W,!0),window.removeEventListener("resize",W)))});const $=["#000000","#ffffff","#ff0000","#00ff00","#0000ff","#ffff00","#00ffff","#ff00ff","#f44336","#e91e63","#9c27b0","#673ab7","#3f51b5","#2196f3","#03a9f4","#00bcd4","#009688","#4caf50","#8bc34a","#cddc39","#ffeb3b","#ffc107","#ff9800","#ff5722","#795548","#9e9e9e","#607d8b"],O=h=>{const w=Mt(h);w&&(u.value=w,R())};return We(()=>{window.addEventListener("mousedown",G)}),Ge(()=>{window.removeEventListener("mousedown",G)}),(h,w)=>(z(),F("div",{class:"relative flex",ref_key:"containerRef",ref:i,onClick:X},[ul(h.$slots,"trigger",{open:l.value,color:x.value,disabled:r.disabled},()=>[o("div",{class:_e(["w-6 h-6 rounded border border-gray-300 cursor-pointer flex items-center justify-center overflow-hidden transition-all hover:border-blue-500",{"opacity-50 cursor-not-allowed":r.disabled,"ring-2 ring-blue-500 ring-offset-1":l.value}]),style:ye({backgroundColor:p.value?"transparent":x.value})},[r.modelValue?be("",!0):(z(),F("div",ih)),p.value?(z(),F("div",dh)):be("",!0)],6)]),l.value&&r.teleportToBody?(z(),ze(tt,{key:0,to:"body"},[o("div",{ref_key:"dropdownRef",ref:d,class:"fixed z-[99999] bg-white rounded-lg shadow-xl border border-gray-200 p-3 w-[240px]",style:ye(A.value),onClick:w[6]||(w[6]=Ke(()=>{},["stop"]))},[o("div",{ref_key:"svPanelRef",ref:g,class:"w-full h-32 rounded relative cursor-crosshair mb-3",style:ye(S.value),onMousedown:w[0]||(w[0]=Y=>H(Y,"sv"))},[w[14]||(w[14]=o("div",{class:"absolute inset-0 bg-gradient-to-r from-white to-transparent rounded"},null,-1)),w[15]||(w[15]=o("div",{class:"absolute inset-0 bg-gradient-to-t from-black to-transparent rounded"},null,-1)),o("div",{class:"absolute w-3 h-3 border-2 border-white rounded-full shadow-sm -ml-1.5 -mt-1.5 pointer-events-none",style:ye(b.value)},null,4)],36),o("div",uh,[o("div",ch,[o("div",{ref_key:"hueSliderRef",ref:y,class:"h-3 rounded relative cursor-pointer border border-gray-200",style:{background:"linear-gradient(to right, #f00 0%, #ff0 17%, #0f0 33%, #0ff 50%, #00f 67%, #f0f 83%, #f00 100%)"},onMousedown:w[1]||(w[1]=Y=>H(Y,"hue"))},[o("div",{class:"absolute top-1/2 -translate-y-1/2 w-3 h-3 bg-white border border-gray-300 rounded-full shadow-sm -ml-1.5 pointer-events-none",style:ye(f.value)},null,4)],544),o("div",hh,[o("div",{ref_key:"alphaSliderRef",ref:m,class:"absolute inset-0 cursor-pointer rounded",style:ye(M.value),onMousedown:w[2]||(w[2]=Y=>H(Y,"alpha"))},[o("div",{class:"absolute top-1/2 -translate-y-1/2 w-3 h-3 bg-white border border-gray-300 rounded-full shadow-sm -ml-1.5 pointer-events-none",style:ye(T.value)},null,4)],36)])]),o("div",ph,[w[17]||(w[17]=o("div",{class:"absolute inset-0 bg-[url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAIAAADZF8uwAAAAGUlEQVQYV2M4gwZ+5wNisxL//8n04mEeRAAAhNwX869V4DYAAAAASUVORK5CYII=')] opacity-50"},null,-1)),o("div",{class:"absolute inset-0",style:ye({backgroundColor:v.value})},null,4),u.value.a===0?(z(),F("div",fh,[...w[16]||(w[16]=[o("div",{class:"w-full h-[1px] bg-red-500 rotate-45"},null,-1)])])):be("",!0)])]),o("div",mh,[o("div",gh,[$e(o("input",{type:"text","onUpdate:modelValue":w[3]||(w[3]=Y=>k.value=Y),class:"w-full text-xs px-2 py-1 border border-gray-300 rounded focus:border-blue-500 outline-none font-mono uppercase",placeholder:"#000000"},null,512),[[De,k.value]])]),o("div",vh,E(Math.round(u.value.a*100))+"% ",1)]),o("div",bh,[(z(),F(Te,null,Le($,Y=>o("div",{key:Y,class:_e(["w-4 h-4 rounded-sm cursor-pointer border border-transparent hover:scale-110 hover:border-gray-400 hover:z-10 transition-all relative",{"ring-2 ring-blue-500 ring-offset-1 z-10":k.value===Y}]),style:ye({backgroundColor:Y}),onClick:te=>O(Y),title:Y},null,14,yh)),64))]),o("div",wh,[o("button",{onClick:w[4]||(w[4]=Y=>{h.$emit("update:modelValue",void 0),se()}),class:"text-xs text-red-600 hover:text-red-800 hover:bg-red-50 px-2 py-1 rounded transition-colors"},E(a(n)("colorPicker.clear")),1),r.allowTransparent?(z(),F("div",xh,[o("button",{onClick:w[5]||(w[5]=Y=>{h.$emit("update:modelValue","transparent"),se()}),class:"text-xs text-gray-600 hover:text-gray-800 hover:bg-gray-100 px-2 py-1 rounded transition-colors"},E(a(n)("colorPicker.transparent")),1)])):be("",!0)])],4)])):l.value?(z(),F("div",{key:1,ref_key:"dropdownRef",ref:d,class:"absolute z-50 bg-white rounded-lg shadow-xl border border-gray-200 p-3 w-[240px]",style:ye(A.value),onClick:w[13]||(w[13]=Ke(()=>{},["stop"]))},[o("div",{ref_key:"svPanelRef",ref:g,class:"w-full h-32 rounded relative cursor-crosshair mb-3",style:ye(S.value),onMousedown:w[7]||(w[7]=Y=>H(Y,"sv"))},[w[18]||(w[18]=o("div",{class:"absolute inset-0 bg-gradient-to-r from-white to-transparent rounded"},null,-1)),w[19]||(w[19]=o("div",{class:"absolute inset-0 bg-gradient-to-t from-black to-transparent rounded"},null,-1)),o("div",{class:"absolute w-3 h-3 border-2 border-white rounded-full shadow-sm -ml-1.5 -mt-1.5 pointer-events-none",style:ye(b.value)},null,4)],36),o("div",_h,[o("div",kh,[o("div",{ref_key:"hueSliderRef",ref:y,class:"h-3 rounded relative cursor-pointer border border-gray-200",style:{background:"linear-gradient(to right, #f00 0%, #ff0 17%, #0f0 33%, #0ff 50%, #00f 67%, #f0f 83%, #f00 100%)"},onMousedown:w[8]||(w[8]=Y=>H(Y,"hue"))},[o("div",{class:"absolute top-1/2 -translate-y-1/2 w-3 h-3 bg-white border border-gray-300 rounded-full shadow-sm -ml-1.5 pointer-events-none",style:ye(f.value)},null,4)],544),o("div",Sh,[o("div",{ref_key:"alphaSliderRef",ref:m,class:"absolute inset-0 cursor-pointer rounded",style:ye(M.value),onMousedown:w[9]||(w[9]=Y=>H(Y,"alpha"))},[o("div",{class:"absolute top-1/2 -translate-y-1/2 w-3 h-3 bg-white border border-gray-300 rounded-full shadow-sm -ml-1.5 pointer-events-none",style:ye(T.value)},null,4)],36)])]),o("div",Ch,[w[21]||(w[21]=o("div",{class:"absolute inset-0 bg-[url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAIAAADZF8uwAAAAGUlEQVQYV2M4gwZ+5wNisxL//8n04mEeRAAAhNwX869V4DYAAAAASUVORK5CYII=')] opacity-50"},null,-1)),o("div",{class:"absolute inset-0",style:ye({backgroundColor:v.value})},null,4),u.value.a===0?(z(),F("div",Eh,[...w[20]||(w[20]=[o("div",{class:"w-full h-[1px] bg-red-500 rotate-45"},null,-1)])])):be("",!0)])]),o("div",Th,[o("div",$h,[$e(o("input",{type:"text","onUpdate:modelValue":w[10]||(w[10]=Y=>k.value=Y),class:"w-full text-xs px-2 py-1 border border-gray-300 rounded focus:border-blue-500 outline-none font-mono uppercase",placeholder:"#000000"},null,512),[[De,k.value]])]),o("div",Ih,E(Math.round(u.value.a*100))+"% ",1)]),o("div",Ah,[(z(),F(Te,null,Le($,Y=>o("div",{key:Y,class:_e(["w-4 h-4 rounded-sm cursor-pointer border border-transparent hover:scale-110 hover:border-gray-400 hover:z-10 transition-all relative",{"ring-2 ring-blue-500 ring-offset-1 z-10":k.value===Y}]),style:ye({backgroundColor:Y}),onClick:te=>O(Y),title:Y},null,14,zh)),64))]),o("div",Ph,[o("button",{onClick:w[11]||(w[11]=Y=>{h.$emit("update:modelValue",void 0),se()}),class:"text-xs text-red-600 hover:text-red-800 hover:bg-red-50 px-2 py-1 rounded transition-colors"},E(a(n)("colorPicker.clear")),1),r.allowTransparent?(z(),F("div",Lh,[o("button",{onClick:w[12]||(w[12]=Y=>{h.$emit("update:modelValue","transparent"),se()}),class:"text-xs text-gray-600 hover:text-gray-800 hover:bg-gray-100 px-2 py-1 rounded transition-colors"},E(a(n)("colorPicker.transparent")),1)])):be("",!0)])],4)):be("",!0)],512))}}),Mh={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function Rh(r,e){return z(),F("svg",Mh,[...e[0]||(e[0]=[o("path",{fill:"currentColor",d:"M12 20q-.825 0-1.412-.587T10 18t.588-1.412T12 16t1.413.588T14 18t-.587 1.413T12 20m0-6q-.825 0-1.412-.587T10 12t.588-1.412T12 10t1.413.588T14 12t-.587 1.413T12 14m0-6q-.825 0-1.412-.587T10 6t.588-1.412T12 4t1.413.588T14 6t-.587 1.413T12 8"},null,-1)])])}const Nl=Se({name:"material-symbols-more-vert",render:Rh}),Dh={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function Bh(r,e){return z(),F("svg",Dh,[...e[0]||(e[0]=[o("path",{fill:"currentColor",d:"M3 21v-4.25L16.2 3.575q.3-.275.663-.425t.762-.15t.775.15t.65.45L20.425 5q.3.275.438.65T21 6.4q0 .4-.137.763t-.438.662L7.25 21zM17.6 7.8L19 6.4L17.6 5l-1.4 1.4z"},null,-1)])])}const co=Se({name:"material-symbols-edit",render:Bh}),Oh={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function qh(r,e){return z(),F("svg",Oh,[...e[0]||(e[0]=[o("path",{fill:"currentColor",d:"M11 13H5v-2h6V5h2v6h6v2h-6v6h-2z"},null,-1)])])}const Ao=Se({name:"material-symbols-add",render:qh}),Fh={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function Nh(r,e){return z(),F("svg",Fh,[...e[0]||(e[0]=[o("path",{fill:"currentColor",d:"M8 18h8v-2H8zm0-4h8v-2H8zm-2 8q-.825 0-1.412-.587T4 20V4q0-.825.588-1.412T6 2h8l6 6v12q0 .825-.587 1.413T18 22zm7-13h5l-5-5z"},null,-1)])])}const jh=Se({name:"material-symbols-description",render:Nh}),Hh={key:0,class:"fixed inset-0 z-[2000] flex items-center justify-center bg-black/50"},Uh={class:"bg-white rounded-lg shadow-xl w-96 animate-in fade-in zoom-in duration-200 flex flex-col overflow-hidden"},Vh={class:"h-[60px] flex items-center justify-between px-4 border-b border-gray-200 shrink-0"},Wh={class:"text-lg font-semibold text-gray-800"},Gh={class:"p-4"},Kh={class:"mb-4"},Yh=["placeholder"],Xh={class:"flex justify-end gap-2"},Zh=["disabled"],qt=Pe({__name:"InputModal",props:{show:{type:Boolean},initialValue:{},title:{},placeholder:{}},emits:["close","save"],setup(r,{emit:e}){const t=r,s=e,{t:n}=Ne(),l=Re(),i=ie(""),d=ie(null);Ae(()=>t.show,g=>{if(g){i.value=t.initialValue||"",setTimeout(()=>{var y;(y=d.value)==null||y.focus()},100),l.setDisableGlobalShortcuts(!0);return}l.setDisableGlobalShortcuts(!1)});const u=()=>{i.value.trim()&&(s("save",i.value.trim()),s("close"))};return Ge(()=>{t.show&&l.setDisableGlobalShortcuts(!1)}),(g,y)=>(z(),ze(tt,{to:"body"},[r.show?(z(),F("div",Hh,[o("div",Uh,[o("div",Vh,[o("h3",Wh,E(r.title||a(n)("input.title")),1),o("button",{onClick:y[0]||(y[0]=m=>s("close")),class:"p-1 hover:bg-gray-100 rounded-full transition-colors text-gray-500"},[ce(a(vt),{class:"w-4 h-4"})])]),o("div",Gh,[o("div",Kh,[$e(o("input",{ref_key:"inputRef",ref:d,"onUpdate:modelValue":y[1]||(y[1]=m=>i.value=m),type:"text",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:r.placeholder||a(n)("input.placeholder"),onKeydown:[wt(u,["enter"]),y[2]||(y[2]=wt(m=>s("close"),["esc"]))]},null,40,Yh),[[De,i.value]])]),o("div",Xh,[o("button",{onClick:y[3]||(y[3]=m=>s("close")),class:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-md transition-colors"},E(a(n)("common.cancel")),1),o("button",{onClick:u,disabled:!i.value.trim(),class:"px-4 py-2 text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 rounded-md transition-colors disabled:opacity-50 disabled:cursor-not-allowed"},E(a(n)("common.confirm")),9,Zh)])])])])):be("",!0)]))}}),Ft=r=>{const e=r.trim();return e?e.startsWith("@")?e.slice(1).trim():e.startsWith("{#")&&e.endsWith("}")?e.slice(2,-1).trim():e:""},jl=r=>[ge.TEXT,ge.BARCODE,ge.QRCODE,ge.TABLE].includes(r.type),Jh=r=>{if(Array.isArray(r.data)&&r.data.length>0)return Ee(r.data);const e=r.columns||[];if(e.length===0)return[];const t={};return e.forEach(s=>{t[s.field]=""}),[t]},ho=(r,e={})=>{const t={...e};if(!jl(r))return t;const s=r.variable||"",n=Ft(s);return!n||Object.prototype.hasOwnProperty.call(t,n)?t:r.type===ge.TABLE?(t[n]=Jh(r),t):(t[n]=r.content??"",t)},Qh=(r=[],e={})=>{let t={...e};return r.forEach(s=>{s.elements.forEach(n=>{t=ho(n,t)})}),t},ep={class:"flex-1 truncate text-left"},tp={key:0,class:"absolute top-full left-0 mt-2 w-[220px] bg-white rounded-lg shadow-xl border border-gray-200 z-[100] flex flex-col max-h-[500px]"},rp={class:"flex-1 overflow-y-auto py-1"},np={key:0,class:"px-4 py-3 text-sm text-gray-500 text-center"},op=["onClick"],sp={class:"flex items-center gap-2 overflow-hidden flex-1"},ap={class:"w-2 h-2 flex items-center justify-center flex-shrink-0"},lp={key:0,class:"w-1.5 h-1.5 rounded-full bg-blue-500"},ip=["onClick"],dp={class:"border-t border-gray-100 p-1"},up=Pe({__name:"TemplateDropdown",setup(r){const{t:e}=Ne(),t=Zt(),s=Re(),n=ie(!1),l=ie(null),i=ie(null),d=ie({}),u=ie(!1),g=ie("create"),y=ie(""),m=ie(null),x=ie(!1),p=ie(""),k=ie(null),v=ie([]);We(()=>{t.loadTemplates(),!t.currentTemplateId&&t.templates.length>0&&t.loadTemplate(t.templates[0].id),document.addEventListener("click",S),window.addEventListener("designer:new-template",R)}),Ge(()=>{document.removeEventListener("click",S),window.removeEventListener("designer:new-template",R)});const S=h=>{l.value&&!l.value.contains(h.target)&&(n.value=!1,i.value=null);const w=h.target;i.value&&!w.closest(".row-menu-trigger")&&!w.closest(".row-menu-content")&&(i.value=null)},b=fe(()=>{const h=t.templates.find(w=>w.id===t.currentTemplateId);return h?h.name:e("template.select")}),f=()=>{n.value=!n.value,n.value||(i.value=null)},T=h=>{if(t.currentTemplateId){const w=t.templates.find(Y=>Y.id===t.currentTemplateId);w&&t.saveCurrentTemplate(w.name)}t.loadTemplate(h.id),n.value=!1},M=(h,w)=>{if(h.stopPropagation(),i.value===w)i.value=null;else{const te=h.currentTarget.getBoundingClientRect();let I=te.right-128;I<5&&(I=te.left),window.innerHeight-te.bottom<150?d.value={bottom:`${window.innerHeight-te.top+5}px`,left:`${I}px`}:d.value={top:`${te.bottom+5}px`,left:`${I}px`},i.value=w}},H=()=>t.templates.find(h=>h.id===i.value),R=()=>{i.value=null,g.value="create",y.value="",u.value=!0,n.value=!1},A=h=>{i.value=null,g.value="rename",m.value=h.id,y.value=h.name,u.value=!0,n.value=!1},W=h=>{t.copyTemplate(h.id),i.value=null},X=h=>{confirm(e("template.confirmDelete",{name:h.name}))&&(t.deleteTemplate(h.id),!t.currentTemplateId&&t.templates.length>0&&t.loadTemplate(t.templates[0].id)),i.value=null},se=h=>{var Q,I;const w=t.currentTemplateId===h.id,Y=w?s.testData||{}:((Q=h.data)==null?void 0:Q.testData)||{},te=w?s.pages:((I=h.data)==null?void 0:I.pages)||[];return Qh(te,Y)},G=h=>{i.value=null,k.value=h;const w=se(h);v.value=Object.keys(w),p.value=JSON.stringify(w,null,2),x.value=!0,n.value=!1},$=()=>{var te;const h=k.value,w=new Set(v.value||[]);if(k.value=null,v.value=[],!h)return;let Y=null;try{const Q=((te=p.value)==null?void 0:te.trim())||"{}",I=JSON.parse(Q);I&&typeof I=="object"&&!Array.isArray(I)&&(Y=I)}catch{Y=null}if(!Y){alert(e("common.invalidJson"));return}if(w.size>0){const Q=Object.keys(Y);if(Q.length!==w.size||Q.some(V=>!w.has(V))){alert(e("common.testDataKeyChanged"));return}}h.data={...h.data||{},testData:Y},h.updatedAt=Date.now(),t.saveToLocalStorage(),t.currentTemplateId===h.id&&(s.testData=Y)},O=h=>{if(g.value==="create"){if(t.currentTemplateId){const Y=t.templates.find(te=>te.id===t.currentTemplateId);Y&&t.saveCurrentTemplate(Y.name)}Re().resetCanvas(),t.createTemplate(h)}else g.value==="rename"&&m.value&&t.renameTemplate(m.value,h)};return(h,w)=>(z(),F("div",{class:"relative",ref_key:"containerRef",ref:l},[o("button",{onClick:f,class:"flex items-center gap-2 px-3 py-1.5 bg-gray-100 hover:bg-gray-200 rounded-lg text-sm font-medium text-gray-700 transition-colors w-40",title:"Templates"},[ce(a(jh),{class:"w-4 h-4 flex-shrink-0"}),o("span",ep,E(b.value),1),ce(a(Io),{class:"w-4 h-4 flex-shrink-0"})]),n.value?(z(),F("div",tp,[o("div",rp,[a(t).templates.length===0?(z(),F("div",np,E(a(e)("template.noTemplates")),1)):be("",!0),(z(!0),F(Te,null,Le(a(t).templates,Y=>(z(),F("div",{key:Y.id,class:"relative group border-b border-gray-100 last:border-b-0 flex items-center justify-between px-3 py-2 hover:bg-gray-50 cursor-pointer",onClick:te=>T(Y)},[o("div",sp,[o("div",ap,[a(t).currentTemplateId===Y.id?(z(),F("div",lp)):be("",!0)]),o("span",{class:_e(["text-sm text-gray-700 truncate",{"font-medium text-blue-600":a(t).currentTemplateId===Y.id}])},E(Y.name),3)]),o("button",{onClick:te=>M(te,Y.id),class:_e(["row-menu-trigger p-1 hover:bg-gray-200 rounded-full text-gray-400 hover:text-gray-600 opacity-0 group-hover:opacity-100 transition-opacity",{"opacity-100 bg-gray-200":i.value===Y.id}])},[ce(a(Nl),{class:"w-4 h-4"})],10,ip)],8,op))),128))]),o("div",dp,[o("button",{onClick:R,class:"w-full flex items-center justify-center gap-2 px-3 py-2 text-sm text-blue-600 hover:bg-blue-50 rounded transition-colors"},[ce(a(Ao),{class:"w-4 h-4"}),Ce(" "+E(a(e)("template.new")),1)])])])):be("",!0),(z(),ze(tt,{to:"body"},[i.value?(z(),F("div",{key:0,class:"row-menu-content fixed w-32 bg-white rounded shadow-lg border border-gray-100 z-[2001] py-1",style:ye(d.value),onClick:w[4]||(w[4]=Ke(()=>{},["stop"]))},[H()?(z(),F(Te,{key:0},[o("button",{onClick:w[0]||(w[0]=Y=>G(H())),class:"w-full text-left px-3 py-1.5 text-xs text-gray-700 hover:bg-gray-50 flex items-center gap-2"},[ce(a(ut),{class:"w-3.5 h-3.5"}),Ce(" "+E(a(e)("common.testData")),1)]),o("button",{onClick:w[1]||(w[1]=Y=>A(H())),class:"w-full text-left px-3 py-1.5 text-xs text-gray-700 hover:bg-gray-50 flex items-center gap-2"},[ce(a(co),{class:"w-3.5 h-3.5"}),Ce(" "+E(a(e)("common.rename")),1)]),o("button",{onClick:w[2]||(w[2]=Y=>W(H())),class:"w-full text-left px-3 py-1.5 text-xs text-gray-700 hover:bg-gray-50 flex items-center gap-2"},[ce(a(Ct),{class:"w-3.5 h-3.5"}),Ce(" "+E(a(e)("common.copy")),1)]),o("button",{onClick:w[3]||(w[3]=Y=>X(H())),class:"w-full text-left px-3 py-1.5 text-xs text-red-600 hover:bg-red-50 flex items-center gap-2"},[ce(a(St),{class:"w-3.5 h-3.5"}),Ce(" "+E(a(e)("common.delete")),1)])],64)):be("",!0)],4)):be("",!0)])),ce(qt,{show:u.value,"initial-value":y.value,title:g.value==="create"?a(e)("template.new"):a(e)("template.rename"),onClose:w[5]||(w[5]=Y=>u.value=!1),onSave:O},null,8,["show","initial-value","title"]),ce(Ot,{visible:x.value,"onUpdate:visible":w[6]||(w[6]=Y=>x.value=Y),title:a(e)("common.testData"),value:p.value,language:"json","onUpdate:value":w[7]||(w[7]=Y=>p.value=Y),onClose:$},null,8,["visible","title","value"])],512))}}),bt={A3:{width:1123,height:1587},A4:{width:794,height:1123},A5:{width:559,height:794},LETTER:{width:816,height:1056},LEGAL:{width:816,height:1344},"Receipt 58mm":{width:219,height:794},"Receipt 80mm":{width:302,height:794},"241-1 (Full)":{width:911,height:1058},"241-2 (Half)":{width:911,height:529},"241-3 (Third)":{width:911,height:352}},cp={class:"relative"},hp={class:"flex items-center bg-gray-100 rounded-lg p-1"},pp=["title"],fp=["title"],mp={class:"truncate"},gp=["title"],vp={key:0,class:"absolute top-full left-0 mt-2 w-64 bg-white border border-gray-200 shadow-xl rounded-lg p-4 z-[1000]"},bp={class:"text-sm font-semibold text-gray-700 mb-3"},yp={class:"space-y-3"},wp={class:"block text-xs text-gray-500 mb-1"},xp=["value"],_p={value:"CUSTOM"},kp={class:"block text-xs text-gray-500 mb-1"},Sp=["value"],Cp={value:"mm"},Ep={value:"pt"},Tp={value:"px"},$p={class:"grid grid-cols-2 gap-2"},Ip={class:"block text-xs text-gray-500 mb-1"},Ap=["value"],zp={class:"block text-xs text-gray-500 mb-1"},Pp=["value"],Lp={class:"grid grid-cols-2 gap-2"},Mp={class:"block text-xs text-gray-500 mb-1"},Rp=["value"],Dp={class:"block text-xs text-gray-500 mb-1"},Bp=["value"],Op={class:"mt-4 flex items-center justify-between"},qp={class:"text-sm text-gray-700 font-medium"},Fp={class:"mt-3 flex items-center justify-between"},Np={class:"text-sm text-gray-700 font-medium"},jp={class:"mt-3 flex items-center justify-between"},Hp={class:"text-sm text-gray-700 font-medium"},Up={class:"mt-3 flex items-center justify-between"},Vp={class:"text-sm text-gray-700 font-medium"},Wp={key:0,class:"absolute inset-0 flex items-center justify-center"},Gp={class:"border-t border-gray-200 my-4 pt-3"},Kp={class:"text-sm font-semibold text-gray-700 mb-3"},Yp={class:"space-y-3"},Xp={class:"flex items-center justify-between"},Zp={class:"flex items-center gap-2"},Jp={class:"text-xs text-gray-600"},Qp={class:"flex items-center gap-1"},ef=["value"],tf={class:"text-xs text-gray-500"},rf={class:"flex items-center justify-between"},nf={class:"flex items-center gap-2"},of={class:"text-xs text-gray-600"},sf={class:"flex items-center gap-1"},af=["value"],lf={class:"text-xs text-gray-500"},df={class:"border-t border-gray-200 pt-3 mt-3"},uf={class:"bg-white rounded-lg shadow-xl w-[640px] max-w-full max-h-[90vh] flex flex-col overflow-hidden"},cf={class:"h-[60px] flex items-center justify-between px-4 border-b border-gray-200 shrink-0"},hf={class:"text-lg font-semibold text-gray-800"},pf={class:"p-4 overflow-y-auto space-y-4"},ff={class:"text-sm font-semibold text-gray-700 mb-3"},mf={class:"space-y-3"},gf={class:"flex items-center justify-between"},vf={class:"text-sm text-gray-700 font-medium"},bf={class:"block text-xs text-gray-500 mb-1"},yf=["placeholder"],wf={class:"grid grid-cols-2 gap-2"},xf={class:"block text-xs text-gray-500 mb-1"},_f={class:"block text-xs text-gray-500 mb-1"},kf={class:"grid grid-cols-2 gap-2"},Sf={class:"block text-xs text-gray-500 mb-1"},Cf={class:"block text-xs text-gray-500 mb-1"},Ef={class:"block text-xs text-gray-500 mb-1"},Tf={class:"p-4 border-t border-gray-200 bg-gray-50 flex justify-end"},$f=Pe({__name:"PaperSettings",setup(r){const{t:e}=Ne(),t=Re(),s=ie("A4"),n=ie(bt.A4.width),l=ie(bt.A4.height),i=ie(!1),d=ie(!1),u=fe({get:()=>t.canvasBackground,set:R=>t.setCanvasBackground(R)}),g=fe({get:()=>{var R;return((R=t.watermark)==null?void 0:R.text)||""},set:R=>t.setWatermark({text:R})}),y=fe({get:()=>{var R;return((R=t.watermark)==null?void 0:R.enabled)??!1},set:R=>t.setWatermark({enabled:!!R})}),m=fe({get:()=>{var R;return((R=t.watermark)==null?void 0:R.angle)??-30},set:R=>t.setWatermark({angle:Number(R)})}),x=fe({get:()=>{var R;return((R=t.watermark)==null?void 0:R.color)||"#000000"},set:R=>t.setWatermark({color:R})}),p=fe({get:()=>{var R;return Math.round((((R=t.watermark)==null?void 0:R.opacity)??.1)*100)},set:R=>{const A=Math.max(0,Math.min(100,Number(R)));t.setWatermark({opacity:A/100})}}),k=fe({get:()=>{var R;return T(((R=t.watermark)==null?void 0:R.size)??24)},set:R=>t.setWatermark({size:Ye(Number(R),t.unit)})}),v=fe({get:()=>{var R;return T(((R=t.watermark)==null?void 0:R.density)??160)},set:R=>t.setWatermark({density:Ye(Number(R),t.unit)})}),S=fe({get:()=>T(t.pageSpacingX||0),set:R=>t.setPageSpacingX(Ye(Number(R),t.unit))}),b=fe({get:()=>T(t.pageSpacingY||0),set:R=>t.setPageSpacingY(Ye(Number(R),t.unit))}),f=fe(()=>t.unit==="px"?e("common.px"):t.unit==="pt"?e("common.pt"):e("common.mm")),T=R=>{const A=ot(R,t.unit);return t.unit==="px"?Math.round(A):Number(A.toFixed(1))},M=()=>{if(s.value!=="CUSTOM"){const R=bt[s.value];n.value=R.width,l.value=R.height,t.setCanvasSize(R.width,R.height)}},H=()=>{t.setCanvasSize(n.value,l.value),Object.values(bt).some(R=>R.width===n.value&&R.height===l.value)||(s.value="CUSTOM")};return Ae(()=>t.canvasSize,R=>{n.value=R.width,l.value=R.height;const A=Object.entries(bt).find(([W,X])=>X.width===R.width&&X.height===R.height);A?s.value=A[0]:s.value="CUSTOM"},{immediate:!0}),(R,A)=>(z(),F("div",cp,[o("div",hp,[o("button",{onClick:A[0]||(A[0]=W=>i.value=!i.value),class:"p-1 hover:bg-gray-200 rounded transition-colors",title:a(e)("editor.paperSettings")},[ce(a(Eo),{class:"w-4 h-4"})],8,pp),o("button",{onClick:A[1]||(A[1]=W=>i.value=!i.value),class:"flex items-center justify-center text-xs text-gray-700 hover:bg-gray-200 rounded px-1 py-0.5 transition-colors w-16 text-center",title:a(e)("editor.paperSettings")},[o("span",mp,E(s.value==="CUSTOM"?a(e)("editor.custom"):s.value),1)],8,fp),o("button",{onClick:A[2]||(A[2]=W=>i.value=!i.value),class:"p-1 hover:bg-gray-200 rounded transition-colors",title:a(e)("editor.paperSettings")},[ce(a(Io),{class:"w-4 h-4"})],8,gp)]),i.value?(z(),F("div",vp,[o("h3",bp,E(a(e)("editor.paperSettings")),1),o("div",yp,[o("div",null,[o("label",wp,E(a(e)("editor.sizePreset")),1),$e(o("select",{"onUpdate:modelValue":A[3]||(A[3]=W=>s.value=W),onChange:M,class:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded focus:border-blue-500 outline-none"},[(z(!0),F(Te,null,Le(a(bt),(W,X)=>(z(),F("option",{key:X,value:X},E(X)+" ("+E(T(W.width))+E(f.value)+" x "+E(T(W.height))+E(f.value)+") ",9,xp))),128)),o("option",_p,E(a(e)("editor.custom")),1)],544),[[Je,s.value]])]),o("div",null,[o("label",kp,E(a(e)("editor.unit")),1),o("select",{value:a(t).unit,onChange:A[4]||(A[4]=W=>a(t).setUnit(W.target.value)),class:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded focus:border-blue-500 outline-none"},[o("option",Cp,E(a(e)("common.mm")),1),o("option",Ep,E(a(e)("common.pt")),1),o("option",Tp,E(a(e)("common.px")),1)],40,Sp)]),o("div",$p,[o("div",null,[o("label",Ip,E(a(e)("common.width"))+" ("+E(f.value)+")",1),o("input",{type:"number",value:T(n.value),onChange:A[5]||(A[5]=W=>{n.value=a(Ye)(Number(W.target.value),a(t).unit),H()}),class:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:border-blue-500 outline-none"},null,40,Ap)]),o("div",null,[o("label",zp,E(a(e)("common.height"))+" ("+E(f.value)+")",1),o("input",{type:"number",value:T(l.value),onChange:A[6]||(A[6]=W=>{l.value=a(Ye)(Number(W.target.value),a(t).unit),H()}),class:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:border-blue-500 outline-none"},null,40,Pp)])]),o("div",Lp,[o("div",null,[o("label",Mp,E(a(e)("editor.spacingX"))+" ("+E(f.value)+")",1),o("input",{type:"number",value:S.value,onChange:A[7]||(A[7]=W=>{S.value=Number(W.target.value)}),class:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:border-blue-500 outline-none"},null,40,Rp)]),o("div",null,[o("label",Dp,E(a(e)("editor.spacingY"))+" ("+E(f.value)+")",1),o("input",{type:"number",value:b.value,onChange:A[8]||(A[8]=W=>{b.value=Number(W.target.value)}),class:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:border-blue-500 outline-none"},null,40,Bp)])]),o("div",null,[o("button",{onClick:A[9]||(A[9]=W=>d.value=!0),class:"w-full flex items-center justify-center gap-2 px-3 py-2 bg-gray-100 text-gray-700 hover:bg-gray-200 rounded-md transition-colors text-sm font-medium"},E(a(e)("editor.advancedSettings")),1)])]),o("div",Op,[o("span",qp,E(a(e)("editor.showCornerMarkers")),1),o("button",{onClick:A[10]||(A[10]=W=>a(t).setShowCornerMarkers(!a(t).showCornerMarkers)),class:_e(["relative inline-flex h-6 w-11 flex-shrink-0 cursor-pointer rounded-full border-2 border-transparent transition-colors duration-200 ease-in-out focus:outline-none focus:ring-2 focus:ring-blue-600 focus:ring-offset-2",a(t).showCornerMarkers?"bg-blue-600":"bg-gray-200"])},[A[30]||(A[30]=o("span",{class:"sr-only"},"Toggle corner markers",-1)),o("span",{"aria-hidden":"true",class:_e(["pointer-events-none inline-block h-5 w-5 transform rounded-full bg-white shadow ring-0 transition duration-200 ease-in-out",a(t).showCornerMarkers?"translate-x-5":"translate-x-0"])},null,2)],2)]),o("div",Fp,[o("span",Np,E(a(e)("editor.showGrid")),1),o("button",{onClick:A[11]||(A[11]=W=>a(t).setShowGrid(!a(t).showGrid)),class:_e(["relative inline-flex h-6 w-11 flex-shrink-0 cursor-pointer rounded-full border-2 border-transparent transition-colors duration-200 ease-in-out focus:outline-none focus:ring-2 focus:ring-blue-600 focus:ring-offset-2",a(t).showGrid?"bg-blue-600":"bg-gray-200"])},[A[31]||(A[31]=o("span",{class:"sr-only"},"Toggle grid",-1)),o("span",{"aria-hidden":"true",class:_e(["pointer-events-none inline-block h-5 w-5 transform rounded-full bg-white shadow ring-0 transition duration-200 ease-in-out",a(t).showGrid?"translate-x-5":"translate-x-0"])},null,2)],2)]),o("div",jp,[o("span",Hp,E(a(e)("editor.showMinimap")),1),o("button",{onClick:A[12]||(A[12]=W=>a(t).setShowMinimap(!a(t).showMinimap)),class:_e(["relative inline-flex h-6 w-11 flex-shrink-0 cursor-pointer rounded-full border-2 border-transparent transition-colors duration-200 ease-in-out focus:outline-none focus:ring-2 focus:ring-blue-600 focus:ring-offset-2",a(t).showMinimap?"bg-blue-600":"bg-gray-200"])},[A[32]||(A[32]=o("span",{class:"sr-only"},"Toggle minimap",-1)),o("span",{"aria-hidden":"true",class:_e(["pointer-events-none inline-block h-5 w-5 transform rounded-full bg-white shadow ring-0 transition duration-200 ease-in-out",a(t).showMinimap?"translate-x-5":"translate-x-0"])},null,2)],2)]),o("div",Up,[o("span",Vp,E(a(e)("editor.backgroundColor")),1),ce(xt,{modelValue:u.value,"onUpdate:modelValue":A[13]||(A[13]=W=>u.value=W),"allow-transparent":!0,"default-color":"#ffffff",placement:"bottom-end"},{trigger:ct(({color:W,open:X})=>[o("div",{class:_e(["w-8 h-6 rounded border border-gray-300 cursor-pointer relative overflow-hidden hover:border-blue-500 transition-colors",{"ring-2 ring-blue-500 ring-offset-1":X}])},[A[34]||(A[34]=o("div",{class:"absolute inset-0 bg-[url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAIAAADZF8uwAAAAGUlEQVQYV2M4gwZ+5wNisxL//8n04mEeRAAAhNwX869V4DYAAAAASUVORK5CYII=')] opacity-50"},null,-1)),o("div",{class:"absolute inset-0",style:ye({backgroundColor:W==="transparent"?"transparent":W})},null,4),W==="transparent"?(z(),F("div",Wp,[...A[33]||(A[33]=[o("div",{class:"w-full h-[1px] bg-red-500 rotate-45"},null,-1)])])):be("",!0)],2)]),_:1},8,["modelValue"])]),o("div",Gp,[o("h3",Kp,E(a(e)("editor.headerFooter")),1),o("div",Yp,[o("div",Xp,[o("div",Zp,[o("button",{onClick:A[14]||(A[14]=W=>a(t).setShowHeaderLine(!a(t).showHeaderLine)),class:_e(["relative inline-flex h-5 w-9 flex-shrink-0 cursor-pointer rounded-full border-2 border-transparent transition-colors duration-200 ease-in-out focus:outline-none focus:ring-2 focus:ring-blue-600 focus:ring-offset-2",a(t).showHeaderLine?"bg-blue-600":"bg-gray-200"])},[A[35]||(A[35]=o("span",{class:"sr-only"},"Toggle header line",-1)),o("span",{"aria-hidden":"true",class:_e(["pointer-events-none inline-block h-4 w-4 transform rounded-full bg-white shadow ring-0 transition duration-200 ease-in-out",a(t).showHeaderLine?"translate-x-4":"translate-x-0"])},null,2)],2),o("label",Jp,E(a(e)("editor.headerLine")),1)]),o("div",Qp,[o("input",{type:"number",value:T(a(t).headerHeight),onChange:A[15]||(A[15]=W=>a(t).setHeaderHeight(a(Ye)(Number(W.target.value),a(t).unit))),class:"w-16 px-2 py-1 text-sm border border-gray-300 rounded focus:border-blue-500 outline-none text-right",min:"0"},null,40,ef),o("span",tf,E(f.value),1)])]),o("div",rf,[o("div",nf,[o("button",{onClick:A[16]||(A[16]=W=>a(t).setShowFooterLine(!a(t).showFooterLine)),class:_e(["relative inline-flex h-5 w-9 flex-shrink-0 cursor-pointer rounded-full border-2 border-transparent transition-colors duration-200 ease-in-out focus:outline-none focus:ring-2 focus:ring-blue-600 focus:ring-offset-2",a(t).showFooterLine?"bg-blue-600":"bg-gray-200"])},[A[36]||(A[36]=o("span",{class:"sr-only"},"Toggle footer line",-1)),o("span",{"aria-hidden":"true",class:_e(["pointer-events-none inline-block h-4 w-4 transform rounded-full bg-white shadow ring-0 transition duration-200 ease-in-out",a(t).showFooterLine?"translate-x-4":"translate-x-0"])},null,2)],2),o("label",of,E(a(e)("editor.footerLine")),1)]),o("div",sf,[o("input",{type:"number",value:T(a(t).footerHeight),onChange:A[17]||(A[17]=W=>a(t).setFooterHeight(a(Ye)(Number(W.target.value),a(t).unit))),class:"w-16 px-2 py-1 text-sm border border-gray-300 rounded focus:border-blue-500 outline-none text-right",min:"0"},null,40,af),o("span",lf,E(f.value),1)])])])]),o("div",df,[o("button",{onClick:A[18]||(A[18]=W=>{a(t).addPage(),i.value=!1}),class:"w-full flex items-center justify-center gap-2 px-3 py-2 bg-blue-50 text-blue-700 hover:bg-blue-100 rounded-md transition-colors text-sm font-medium"},[ce(a(Ao),{class:"w-4 h-4"}),o("span",null,E(a(e)("editor.addNewPage")),1)])]),o("div",{class:"fixed inset-0 z-[-1]",onClick:A[19]||(A[19]=W=>i.value=!1)})])):be("",!0),(z(),ze(tt,{to:"body"},[d.value?(z(),F("div",{key:0,class:"fixed inset-0 z-[2000] flex items-center justify-center bg-black/50",onClick:A[29]||(A[29]=Ke(W=>d.value=!1,["self"]))},[o("div",uf,[o("div",cf,[o("h3",hf,E(a(e)("editor.advancedSettings")),1),o("button",{onClick:A[20]||(A[20]=W=>d.value=!1),class:"p-1 hover:bg-gray-100 rounded-full transition-colors text-gray-500"},[ce(a(vt),{class:"w-4 h-4"})])]),o("div",pf,[o("div",null,[o("h3",ff,E(a(e)("editor.watermark")),1),o("div",mf,[o("div",gf,[o("span",vf,E(a(e)("editor.watermarkEnable")),1),o("button",{onClick:A[21]||(A[21]=W=>y.value=!y.value),class:_e(["relative inline-flex h-6 w-11 flex-shrink-0 cursor-pointer rounded-full border-2 border-transparent transition-colors duration-200 ease-in-out focus:outline-none focus:ring-2 focus:ring-blue-600 focus:ring-offset-2",y.value?"bg-blue-600":"bg-gray-200"])},[A[37]||(A[37]=o("span",{class:"sr-only"},"Toggle watermark",-1)),o("span",{"aria-hidden":"true",class:_e(["pointer-events-none inline-block h-5 w-5 transform rounded-full bg-white shadow ring-0 transition duration-200 ease-in-out",y.value?"translate-x-5":"translate-x-0"])},null,2)],2)]),o("div",null,[o("label",bf,E(a(e)("editor.watermarkText")),1),$e(o("input",{"onUpdate:modelValue":A[22]||(A[22]=W=>g.value=W),type:"text",class:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded focus:border-blue-500 outline-none",placeholder:a(e)("editor.watermarkTextPlaceholder")},null,8,yf),[[De,g.value]])]),o("div",wf,[o("div",null,[o("label",xf,E(a(e)("editor.watermarkAngle")),1),$e(o("input",{"onUpdate:modelValue":A[23]||(A[23]=W=>m.value=W),type:"number",class:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:border-blue-500 outline-none"},null,512),[[De,m.value,void 0,{number:!0}]])]),o("div",null,[o("label",_f,E(a(e)("editor.watermarkOpacity")),1),$e(o("input",{"onUpdate:modelValue":A[24]||(A[24]=W=>p.value=W),type:"number",min:"0",max:"100",class:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:border-blue-500 outline-none"},null,512),[[De,p.value,void 0,{number:!0}]])])]),o("div",kf,[o("div",null,[o("label",Sf,E(a(e)("editor.watermarkSize"))+" ("+E(f.value)+")",1),$e(o("input",{"onUpdate:modelValue":A[25]||(A[25]=W=>k.value=W),type:"number",min:"1",class:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:border-blue-500 outline-none"},null,512),[[De,k.value,void 0,{number:!0}]])]),o("div",null,[o("label",Cf,E(a(e)("editor.watermarkDensity"))+" ("+E(f.value)+")",1),$e(o("input",{"onUpdate:modelValue":A[26]||(A[26]=W=>v.value=W),type:"number",min:"20",class:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:border-blue-500 outline-none"},null,512),[[De,v.value,void 0,{number:!0}]])])]),o("div",null,[o("label",Ef,E(a(e)("editor.watermarkColor")),1),ce(xt,{modelValue:x.value,"onUpdate:modelValue":A[27]||(A[27]=W=>x.value=W),"default-color":"#000000",placement:"bottom-end"},{trigger:ct(({color:W,open:X})=>[o("div",{class:_e(["w-8 h-6 rounded border border-gray-300 cursor-pointer relative overflow-hidden hover:border-blue-500 transition-colors",{"ring-2 ring-blue-500 ring-offset-1":X}])},[o("div",{class:"absolute inset-0",style:ye({backgroundColor:W})},null,4)],2)]),_:1},8,["modelValue"])])])])]),o("div",Tf,[o("button",{onClick:A[28]||(A[28]=W=>d.value=!1),class:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 transition-colors text-sm"},E(a(e)("common.close")),1)])])])):be("",!0)]))]))}}),If=()=>typeof navigator>"u"?!1:/Mac|iPod|iPhone|iPad/.test(navigator.platform),Me=r=>{const e=If();return r.map(t=>{switch(t.toLowerCase()){case"ctrl":case"control":return e?"⌘":"Ctrl";case"alt":return e?"⌥":"Alt";case"shift":return e?"⇧":"Shift";case"enter":return e?"⏎":"Enter";case"backspace":return e?"⌫":"Backspace";case"delete":return e?"⌦":"Del";case"esc":case"escape":return"Esc";default:return t.toUpperCase()}}).join(" + ")},Af={class:"bg-white rounded-lg shadow-xl w-[700px] max-w-full max-h-[90vh] flex flex-col overflow-hidden"},zf={class:"h-[56px] flex items-center justify-between px-4 border-b border-gray-200"},Pf={class:"text-lg font-semibold text-gray-800"},Lf={class:"flex-1 overflow-y-auto p-6 space-y-5 text-sm text-gray-700"},Mf={class:"space-y-3"},Rf={class:"font-medium text-gray-900"},Df={key:0,class:"grid grid-cols-2 gap-4"},Bf={class:"flex flex-col gap-1 col-span-2"},Of={class:"text-xs text-gray-500"},qf=["disabled"],Ff={value:""},Nf=["value","disabled"],jf={class:"grid grid-cols-2 gap-4"},Hf={class:"flex flex-col gap-1"},Uf={class:"text-xs text-gray-500"},Vf=["disabled"],Wf={value:""},Gf=["value"],Kf={class:"flex flex-col gap-1"},Yf={class:"text-xs text-gray-500"},Xf=["placeholder"],Zf={key:1,class:"text-xs text-red-600"},Jf={key:2,class:"text-xs text-gray-500"},Qf={key:3,class:"text-xs text-gray-500"},em={key:4,class:"text-xs text-gray-500"},tm={class:"grid grid-cols-3 gap-4"},rm={class:"flex flex-col gap-1"},nm={class:"text-xs text-gray-500"},om={class:"flex flex-col gap-1"},sm={class:"text-xs text-gray-500"},am={class:"flex flex-col gap-1"},lm={class:"text-xs text-gray-500"},im=["placeholder"],dm={class:"grid grid-cols-3 gap-4"},um={class:"flex flex-col gap-1"},cm={class:"text-xs text-gray-500"},hm={value:""},pm={value:"odd"},fm={value:"even"},mm={class:"flex flex-col gap-1"},gm={class:"text-xs text-gray-500"},vm={value:"noscale"},bm={value:"shrink"},ym={value:"fit"},wm={class:"flex flex-col gap-1"},xm={class:"text-xs text-gray-500"},_m={value:"portrait"},km={value:"landscape"},Sm={class:"space-y-3"},Cm={class:"font-medium text-gray-900"},Em={class:"grid grid-cols-2 gap-4"},Tm={class:"flex flex-col gap-1"},$m={class:"text-xs text-gray-500"},Im=["disabled"],Am={value:"color"},zm={value:"monochrome"},Pm={class:"flex flex-col gap-1"},Lm={class:"text-xs text-gray-500"},Mm=["disabled"],Rm={value:"simplex"},Dm={value:"duplex"},Bm={value:"duplexshort"},Om={value:"duplexlong"},qm={class:"grid grid-cols-2 gap-4"},Fm={class:"flex flex-col gap-1"},Nm={class:"text-xs text-gray-500"},jm=["value"],Hm=["placeholder"],Um={class:"flex flex-col gap-1"},Vm={class:"text-xs text-gray-500"},Wm=["placeholder"],Gm={class:"p-4 border-t border-gray-200 bg-gray-50 flex justify-end gap-3 rounded-b-lg"},Km=Pe({__name:"PrintDialog",props:{show:{type:Boolean},mode:{},options:{}},emits:["update:show","confirm"],setup(r,{emit:e}){const t=r,s=e,{t:n}=Ne(),l=Re(),{localPrinters:i,remotePrinters:d,remoteClients:u,remoteSelectedClientId:g,localPrinterCaps:y,fetchLocalPrinters:m,fetchRemoteClients:x,fetchRemotePrinters:p,fetchLocalPrinterCaps:k}=Qt(),v=ie(!1),S=ie(!1),b=ie(""),f=ie(""),T=yt({printer:"",jobName:"",copies:1,intervalMs:0,pageRange:"",pageSet:"",scale:"fit",orientation:"portrait",colorMode:"color",sidesMode:"simplex",paperSize:"",trayBin:""});Ae(()=>t.show,Q=>{Q&&(Object.assign(T,JSON.parse(JSON.stringify(t.options))),f.value=g.value||"",$(),l.setDisableGlobalShortcuts(!0))}),Ae(()=>t.show,Q=>{Q||l.setDisableGlobalShortcuts(!1)}),Ae(()=>t.mode,()=>{t.show&&$()});const M=fe(()=>(t.mode==="remote"?d.value:i.value)||[]),H=fe(()=>u.value||[]),R=fe(()=>{if(!(t.mode!=="local"||!T.printer))return y[T.printer]}),A=fe(()=>{var V;if(t.mode!=="local")return[];const Q=R.value,I=(V=Q==null?void 0:Q.printerPaperNames)!=null&&V.length?Q.printerPaperNames:(Q==null?void 0:Q.paperSizes)||[];return Array.from(new Set(I)).filter(Boolean)}),W=fe(()=>M.value.map(Q=>{if(t.mode==="local"){const V=Q;return{key:V.name,label:V.name}}const I=Q;return{key:I.printer_name,label:I.printer_name}})),X=fe(()=>{var Q;return t.mode!=="local"?!0:((Q=R.value)==null?void 0:Q.colorSupported)!==!1}),se=fe(()=>{var Q;return t.mode!=="local"?!0:((Q=R.value)==null?void 0:Q.duplexSupported)!==!1}),G=fe(()=>{if(t.mode==="remote")return(d.value||[]).find(Q=>Q.printer_name===T.printer)}),$=async()=>{v.value=!0,b.value="";try{if(t.mode==="remote"?(await x(),(!f.value||!H.value.some(Q=>Q.client_id===f.value))&&(f.value=g.value||""),f.value?await p(f.value):d.value=[]):t.mode==="local"&&await m(),!T.printer&&M.value.length>0){const Q=t.mode==="local"&&M.value.find(I=>I.isDefault)||M.value[0];T.printer=t.mode==="local"?Q.name:Q.printer_name}t.mode==="local"&&T.printer&&await O(T.printer)}catch(Q){b.value=Q.message||n("printDialog.printerLoadFailed")}finally{v.value=!1}},O=async Q=>{if(!(!Q||t.mode!=="local")){S.value=!0;try{await k(Q)}finally{S.value=!1}}};Ae(f,async(Q,I)=>{if(!(!t.show||t.mode!=="remote"||Q===I)){g.value=Q,T.printer="",v.value=!0,b.value="";try{Q?await p(Q):d.value=[]}catch(V){b.value=V.message||n("printDialog.printerLoadFailed")}finally{v.value=!1}}}),Ae(()=>T.printer,async(Q,I)=>{if(!(!t.show||Q===I)){if(t.mode==="local")await O(Q),A.value.length&&!T.paperSize&&(T.paperSize=A.value[0]);else if(t.mode==="remote"){const V=(d.value||[]).find(L=>L.printer_name===Q);V!=null&&V.paper_spec&&!T.paperSize&&(T.paperSize=V.paper_spec)}}}),Ae(R,Q=>{Q&&(Q.colorSupported===!1&&T.colorMode==="color"&&(T.colorMode="monochrome"),Q.duplexSupported===!1&&T.sidesMode.startsWith("duplex")&&(T.sidesMode="simplex"))});const h=()=>{s("update:show",!1)},w=Q=>{t.show&&Q.key==="Escape"&&(Q.preventDefault(),h())},Y=()=>{s("confirm",JSON.parse(JSON.stringify(T)))},te=fe(()=>t.mode==="local"?n("printDialog.titleLocal"):t.mode==="remote"?n("printDialog.titleRemote"):n("printDialog.title"));return We(()=>{window.addEventListener("keydown",w)}),Ge(()=>{window.removeEventListener("keydown",w),t.show&&l.setDisableGlobalShortcuts(!1)}),(Q,I)=>(z(),ze(tt,{to:"body"},[r.show?(z(),F("div",{key:0,class:"fixed inset-0 z-[99999] flex items-center justify-center bg-black/50",onClick:Ke(h,["self"])},[o("div",Af,[o("div",zf,[o("h3",Pf,E(te.value),1),o("button",{onClick:h,class:"p-1 hover:bg-gray-100 rounded-full transition-colors text-gray-500"},[ce(a(vt),{class:"w-4 h-4"})])]),o("div",Lf,[o("div",Mf,[o("div",Rf,E(a(n)("printDialog.sectionBasic")),1),t.mode==="remote"?(z(),F("div",Df,[o("label",Bf,[o("span",Of,E(a(n)("printDialog.remoteClient")),1),$e(o("select",{"onUpdate:modelValue":I[0]||(I[0]=V=>f.value=V),class:"w-full px-3 py-2 border rounded bg-white focus:ring-2 focus:ring-blue-600 focus:border-blue-600",disabled:v.value},[o("option",Ff,E(a(n)("printDialog.remoteClientPlaceholder")),1),(z(!0),F(Te,null,Le(H.value,V=>(z(),F("option",{key:V.client_id,value:V.client_id,disabled:V.online===!1},E(V.client_name||V.client_id)+E(V.online===!1?" (offline)":""),9,Nf))),128))],8,qf),[[Je,f.value]])])])):be("",!0),o("div",jf,[o("label",Hf,[o("span",Uf,E(a(n)("printDialog.printer")),1),$e(o("select",{"onUpdate:modelValue":I[1]||(I[1]=V=>T.printer=V),class:"w-full px-3 py-2 border rounded bg-white focus:ring-2 focus:ring-blue-600 focus:border-blue-600",disabled:v.value||S.value||t.mode==="remote"&&!f.value},[o("option",Wf,E(a(n)("printDialog.printerSelect")),1),(z(!0),F(Te,null,Le(W.value,V=>(z(),F("option",{key:V.key,value:V.key},E(V.label),9,Gf))),128))],8,Vf),[[Je,T.printer]])]),o("label",Kf,[o("span",Yf,E(a(n)("printDialog.jobName")),1),$e(o("input",{"onUpdate:modelValue":I[2]||(I[2]=V=>T.jobName=V),type:"text",class:"w-full px-3 py-2 border rounded focus:ring-2 focus:ring-blue-600 focus:border-blue-600",placeholder:a(n)("printDialog.jobNamePlaceholder")},null,8,Xf),[[De,T.jobName]])])]),b.value?(z(),F("div",Zf,E(b.value),1)):t.mode==="remote"&&H.value.length===0?(z(),F("div",Jf,E(a(n)("printDialog.remoteClientEmpty")),1)):M.value.length===0?(z(),F("div",Qf,E(a(n)("printDialog.printerEmpty")),1)):be("",!0),t.mode==="remote"&&G.value?(z(),F("div",em,E(a(n)("printDialog.remotePrinterInfo",{type:G.value.printer_type||"-",paper:G.value.paper_spec||"-",format:G.value.supported_format||"-"})),1)):be("",!0),o("div",tm,[o("label",rm,[o("span",nm,E(a(n)("printDialog.copies")),1),$e(o("input",{"onUpdate:modelValue":I[3]||(I[3]=V=>T.copies=V),type:"number",min:"1",class:"w-full px-3 py-2 border rounded focus:ring-2 focus:ring-blue-600 focus:border-blue-600"},null,512),[[De,T.copies,void 0,{number:!0}]])]),o("label",om,[o("span",sm,E(a(n)("printDialog.intervalMs")),1),$e(o("input",{"onUpdate:modelValue":I[4]||(I[4]=V=>T.intervalMs=V),type:"number",min:"0",class:"w-full px-3 py-2 border rounded focus:ring-2 focus:ring-blue-600 focus:border-blue-600"},null,512),[[De,T.intervalMs,void 0,{number:!0}]])]),o("label",am,[o("span",lm,E(a(n)("printDialog.pageRange")),1),$e(o("input",{"onUpdate:modelValue":I[5]||(I[5]=V=>T.pageRange=V),type:"text",class:"w-full px-3 py-2 border rounded focus:ring-2 focus:ring-blue-600 focus:border-blue-600",placeholder:a(n)("printDialog.pageRangePlaceholder")},null,8,im),[[De,T.pageRange]])])]),o("div",dm,[o("label",um,[o("span",cm,E(a(n)("printDialog.pageSet")),1),$e(o("select",{"onUpdate:modelValue":I[6]||(I[6]=V=>T.pageSet=V),class:"w-full px-3 py-2 border rounded bg-white focus:ring-2 focus:ring-blue-600 focus:border-blue-600"},[o("option",hm,E(a(n)("printDialog.pageSetAll")),1),o("option",pm,E(a(n)("printDialog.pageSetOdd")),1),o("option",fm,E(a(n)("printDialog.pageSetEven")),1)],512),[[Je,T.pageSet]])]),o("label",mm,[o("span",gm,E(a(n)("printDialog.scale")),1),$e(o("select",{"onUpdate:modelValue":I[7]||(I[7]=V=>T.scale=V),class:"w-full px-3 py-2 border rounded bg-white focus:ring-2 focus:ring-blue-600 focus:border-blue-600"},[o("option",vm,E(a(n)("printDialog.scaleNo")),1),o("option",bm,E(a(n)("printDialog.scaleShrink")),1),o("option",ym,E(a(n)("printDialog.scaleFit")),1)],512),[[Je,T.scale]])]),o("label",wm,[o("span",xm,E(a(n)("printDialog.orientation")),1),$e(o("select",{"onUpdate:modelValue":I[8]||(I[8]=V=>T.orientation=V),class:"w-full px-3 py-2 border rounded bg-white focus:ring-2 focus:ring-blue-600 focus:border-blue-600"},[o("option",_m,E(a(n)("printDialog.portrait")),1),o("option",km,E(a(n)("printDialog.landscape")),1)],512),[[Je,T.orientation]])])])]),o("div",Sm,[o("div",Cm,E(a(n)("printDialog.sectionAdvanced")),1),o("div",Em,[o("label",Tm,[o("span",$m,E(a(n)("printDialog.colorMode")),1),$e(o("select",{"onUpdate:modelValue":I[9]||(I[9]=V=>T.colorMode=V),class:"w-full px-3 py-2 border rounded bg-white focus:ring-2 focus:ring-blue-600 focus:border-blue-600",disabled:!X.value},[o("option",Am,E(a(n)("printDialog.color")),1),o("option",zm,E(a(n)("printDialog.monochrome")),1)],8,Im),[[Je,T.colorMode]])]),o("label",Pm,[o("span",Lm,E(a(n)("printDialog.sidesMode")),1),$e(o("select",{"onUpdate:modelValue":I[10]||(I[10]=V=>T.sidesMode=V),class:"w-full px-3 py-2 border rounded bg-white focus:ring-2 focus:ring-blue-600 focus:border-blue-600",disabled:!se.value},[o("option",Rm,E(a(n)("printDialog.simplex")),1),o("option",Dm,E(a(n)("printDialog.duplex")),1),o("option",Bm,E(a(n)("printDialog.duplexShort")),1),o("option",Om,E(a(n)("printDialog.duplexLong")),1)],8,Mm),[[Je,T.sidesMode]])])]),o("div",qm,[o("label",Fm,[o("span",Nm,E(a(n)("printDialog.paperSize")),1),A.value.length?$e((z(),F("select",{key:0,"onUpdate:modelValue":I[11]||(I[11]=V=>T.paperSize=V),class:"w-full px-3 py-2 border rounded bg-white focus:ring-2 focus:ring-blue-600 focus:border-blue-600"},[(z(!0),F(Te,null,Le(A.value,V=>(z(),F("option",{key:V,value:V},E(V),9,jm))),128))],512)),[[Je,T.paperSize]]):$e((z(),F("input",{key:1,"onUpdate:modelValue":I[12]||(I[12]=V=>T.paperSize=V),type:"text",class:"w-full px-3 py-2 border rounded focus:ring-2 focus:ring-blue-600 focus:border-blue-600",placeholder:a(n)("printDialog.paperSizePlaceholder")},null,8,Hm)),[[De,T.paperSize]])]),o("label",Um,[o("span",Vm,E(a(n)("printDialog.trayBin")),1),$e(o("input",{"onUpdate:modelValue":I[13]||(I[13]=V=>T.trayBin=V),type:"text",class:"w-full px-3 py-2 border rounded focus:ring-2 focus:ring-blue-600 focus:border-blue-600",placeholder:a(n)("printDialog.trayBinPlaceholder")},null,8,Wm),[[De,T.trayBin]])])])])]),o("div",Gm,[o("button",{onClick:h,class:"px-4 py-2 border border-gray-300 rounded hover:bg-gray-100 text-sm text-gray-700"},E(a(n)("common.close")),1),o("button",{onClick:Y,class:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 transition-colors text-sm"},E(a(n)("printDialog.confirm")),1)])])])):be("",!0)]))}}),Ym={class:"flex items-center gap-4"},Xm={class:"flex items-center gap-2 bg-gray-100 rounded-lg p-1 px-2"},Zm=["disabled","title"],Jm=["value"],Qm={class:"flex items-center gap-1"},eg=["disabled"],tg=["disabled"],rg=["disabled"],ng=["disabled","title"],og=["disabled","title"],sg=["disabled","title"],ag=["disabled","title"],lg=["disabled","title"],ig=["disabled","title"],dg={class:"w-1 h-3.5 rounded-[1px] border border-gray-300 relative overflow-hidden bg-white"},ug={key:0,class:"absolute inset-0 bg-[url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAIAAADZF8uwAAAAGUlEQVQYV2M4gwZ+5wNisxL//8n04mEeRAAAhNwX869V4DYAAAAASUVORK5CYII=')] opacity-50 bg-repeat bg-[length:6px_6px]"},cg={key:1,class:"absolute inset-0 flex items-center justify-center"},hg=["disabled","title"],pg={class:"flex items-center gap-1 bg-gray-100 rounded-lg p-1"},fg=["disabled","title"],mg=["disabled","title"],gg=["disabled","title"],vg=["disabled","title"],bg=["disabled","title"],yg=["disabled","title"],wg=["disabled","title"],xg={class:"flex items-center gap-1 bg-gray-100 rounded-lg p-1"},_g=["disabled","title"],kg=["disabled","title"],Sg=["disabled","title"],Cg=["disabled","title"],Eg=["disabled","title"],Tg=["disabled","title"],$g={class:"relative"},Ig={class:"flex items-center bg-gray-100 rounded-lg p-1"},Ag=["title"],zg=["title"],Pg=["title"],Lg={key:0,class:"absolute top-full left-0 mt-2 w-64 bg-white border border-gray-200 shadow-xl rounded-lg p-4 z-[1000]"},Mg={class:"text-sm font-semibold text-gray-700 mb-3"},Rg={class:"space-y-3"},Dg={class:"block text-xs text-gray-500 mb-1"},Bg={class:"text-right text-xs text-gray-600 mt-1"},Og={class:"relative"},qg={class:"flex items-center shadow-sm"},Fg=["disabled"],Ng={key:0,class:"absolute top-full right-0 mt-2 w-max min-w-[160px] bg-white border border-gray-200 shadow-xl rounded-lg p-1 z-[1000] flex flex-col gap-1"},jg=Pe({__name:"HeaderToolbar",emits:["toggleHelp","toggleSettings"],setup(r,{emit:e}){const t=e,{t:s}=Ne(),n=Re(),l=Zt(),{printMode:i,silentPrint:d,localPrintOptions:u,remotePrintOptions:g}=Qt(),y=fe(()=>i.value||"browser"),m=ie(!1),x=ie(""),p=ie(""),k=ie("json"),v=()=>{const ee={pages:Ee(n.pages),canvasSize:Ee(n.canvasSize),guides:Ee(n.guides),zoom:n.zoom,showGrid:n.showGrid,headerHeight:n.headerHeight,footerHeight:n.footerHeight,showHeaderLine:n.showHeaderLine,showFooterLine:n.showFooterLine,showMinimap:n.showMinimap,canvasBackground:n.canvasBackground};x.value=JSON.stringify(ee,null,2),p.value=s("preview.templateJson"),k.value="json",m.value=!0},S=ie(!1),b=ie(""),f=ie("save"),{getPrintHtml:T,print:M,exportPdf:H,getPdfBlob:R,exportImages:A,getImageBlob:W}=Fl(),X=async()=>{try{const ee=Array.from(document.querySelectorAll(".print-page")),U=await W(ee),me=new FileReader;me.readAsDataURL(U),me.onloadend=()=>{x.value=me.result,p.value=s("editor.viewImageBlob"),k.value="text",m.value=!0}}catch(ee){console.error(ee),alert("Failed to generate blob")}},se=async()=>{try{const ee=Array.from(document.querySelectorAll(".print-page")),U=await R(ee),me=new FileReader;me.readAsDataURL(U),me.onloadend=()=>{x.value=me.result,p.value=s("editor.viewPdfBlob"),k.value="text",m.value=!0}}catch(ee){console.error(ee),alert("Failed to generate PDF blob")}},G=ie(!1),$=ie(""),O=ie(!1),h=ie(!1),w=ie(null),Y=fe(()=>i.value==="remote"?g:u),te=ie(!1),Q=ie(Math.round(n.zoom*100)),I=fe({get:()=>n.selectedElement&&n.selectedElement.style.fontFamily||"",set:ee=>{n.updateSelectedElementsStyle({fontFamily:ee})}}),V=fe({get:()=>n.selectedElement&&n.selectedElement.style.fontSize||12,set:ee=>{n.updateSelectedElementsStyle({fontSize:ee})}}),L=fe(()=>{var ee,U;return((ee=n.selectedElement)==null?void 0:ee.style.fontWeight)==="700"||((U=n.selectedElement)==null?void 0:U.style.fontWeight)==="bold"}),B=fe(()=>{var ee;return((ee=n.selectedElement)==null?void 0:ee.style.fontStyle)==="italic"}),re=fe(()=>{var ee;return((ee=n.selectedElement)==null?void 0:ee.style.textDecoration)==="underline"}),Z=fe(()=>{var ee;return((ee=n.selectedElement)==null?void 0:ee.style.writingMode)==="vertical-rl"}),ne=fe({get:()=>{if(n.selectedElement)return n.selectedElement.style.color},set:ee=>{n.updateSelectedElementsStyle({color:ee})}}),ve=fe({get:()=>{if(n.selectedElement)return n.selectedElement.style.backgroundColor},set:ee=>{n.updateSelectedElementsStyle({backgroundColor:ee})}}),xe=fe(()=>{var ee;return n.selectedElementIds.length===0?!1:((ee=n.selectedElement)==null?void 0:ee.locked)||!1}),de=fe(()=>{var ee;return!n.selectedElementId||xe.value||((ee=n.selectedElement)==null?void 0:ee.type)===ge.IMAGE}),ke=()=>{n.updateSelectedElementsStyle({fontWeight:L.value?"400":"700"})},we=()=>{n.updateSelectedElementsStyle({fontStyle:B.value?"normal":"italic"})},ae=()=>{n.updateSelectedElementsStyle({textDecoration:re.value?"none":"underline"})},K=()=>{n.updateSelectedElementsStyle({writingMode:Z.value?"horizontal-tb":"vertical-rl"})},oe=()=>{n.updateSelectedElementsStyle({rotate:0})},c=fe(()=>[{label:s("editor.fonts.default"),value:""},{label:s("editor.fonts.arial"),value:"Arial, sans-serif"},{label:s("editor.fonts.timesNewRoman"),value:'"Times New Roman", serif'},{label:s("editor.fonts.courierNew"),value:'"Courier New", monospace'},{label:s("editor.fonts.simSun"),value:"SimSun, serif"},{label:s("editor.fonts.simHei"),value:"SimHei, sans-serif"}]),N=()=>{const ee=Math.round(n.zoom*100),U=Math.min(ee+10,500);n.setZoom(U/100),Q.value=U},q=()=>{const ee=Math.round(n.zoom*100),U=Math.max(ee-10,20);n.setZoom(U/100),Q.value=U};Ae(()=>n.zoom,ee=>{Q.value=Math.round(ee*100)});const _=()=>{const ee=Math.max(20,Math.min(500,Q.value));Q.value=ee,n.setZoom(ee/100)},C=async()=>{try{$.value=await T(),G.value=!0}catch(ee){console.error(ee),alert("Preview generation failed")}},j=async()=>{const ee=Array.from(document.querySelectorAll(".print-page"));if(i.value!=="browser"&&!d.value){w.value=ee,h.value=!0;return}await M(ee,{mode:y.value})},P=async ee=>{i.value==="local"&&Object.assign(u,ee),i.value==="remote"&&Object.assign(g,ee);const U=w.value||Array.from(document.querySelectorAll(".print-page"));w.value=null,h.value=!1,await M(U,{mode:y.value,options:ee})},J=async()=>{const ee=pe();await H(void 0,`${ee}.pdf`)},D=async()=>{const ee=pe();await A(void 0,ee)},le=()=>{if(l.currentTemplateId){const ee=l.templates.find(U=>U.id===l.currentTemplateId);if(ee){l.saveCurrentTemplate(ee.name);return}}f.value="save",b.value="",S.value=!0},he=()=>{f.value="saveAs";const ee=l.templates.find(U=>U.id===l.currentTemplateId);b.value=ee?`${ee.name} Copy`:"",S.value=!0},ue=ee=>{f.value==="saveAs"?l.createTemplate(ee):l.saveCurrentTemplate(ee),S.value=!1},pe=()=>{const ee=l.templates.find(Fe=>Fe.id===l.currentTemplateId),me=((ee==null?void 0:ee.name)||"print-design").trim().replace(/[\\/:*?"<>|]/g,"-").replace(/\s+/g," ").trim()||"print-design",Oe=new Date,Be=Oe.getFullYear(),Ue=String(Oe.getMonth()+1).padStart(2,"0"),Ie=String(Oe.getDate()).padStart(2,"0");return`${me}-${Be}${Ue}${Ie}`};return We(()=>{window.addEventListener("designer:preview",C),window.addEventListener("designer:save",le),window.addEventListener("designer:save-as",he),window.addEventListener("designer:print",j),window.addEventListener("designer:export-pdf",J),window.addEventListener("designer:view-json",v),window.addEventListener("designer:view-blob",X)}),Ge(()=>{window.removeEventListener("designer:preview",C),window.removeEventListener("designer:save",le),window.removeEventListener("designer:save-as",he),window.removeEventListener("designer:print",j),window.removeEventListener("designer:export-pdf",J),window.removeEventListener("designer:view-json",v),window.removeEventListener("designer:view-blob",X)}),(ee,U)=>(z(),F(Te,null,[o("div",Ym,[ce(up),ce(qt,{show:S.value,title:f.value==="saveAs"?a(s)("editor.saveAsTemplate"):a(s)("editor.saveTemplate"),"initial-value":b.value,onClose:U[0]||(U[0]=me=>S.value=!1),onSave:ue},null,8,["show","title","initial-value"]),o("div",Xm,[$e(o("select",{"onUpdate:modelValue":U[1]||(U[1]=me=>I.value=me),disabled:de.value,class:"w-32 text-sm bg-transparent border-none outline-none focus:ring-0 cursor-pointer disabled:cursor-not-allowed disabled:opacity-50",title:a(s)("editor.fontFamily")},[(z(!0),F(Te,null,Le(c.value,me=>(z(),F("option",{key:me.value,value:me.value},E(me.label),9,Jm))),128))],8,Zm),[[Je,I.value]]),U[39]||(U[39]=o("div",{class:"w-px h-4 bg-gray-300"},null,-1)),o("div",Qm,[o("button",{onClick:U[2]||(U[2]=me=>V.value--),disabled:de.value,class:"w-6 h-6 flex items-center justify-center hover:bg-gray-200 rounded text-sm font-medium disabled:opacity-50 disabled:cursor-not-allowed"},"-",8,eg),$e(o("input",{type:"number","onUpdate:modelValue":U[3]||(U[3]=me=>V.value=me),disabled:de.value,class:"w-12 text-center text-sm bg-transparent border-none outline-none focus:ring-0 p-0 disabled:opacity-50 disabled:cursor-not-allowed [appearance:textfield] [-moz-appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none",min:"1",max:"200"},null,8,tg),[[De,V.value]]),o("button",{onClick:U[4]||(U[4]=me=>V.value++),disabled:de.value,class:"w-6 h-6 flex items-center justify-center hover:bg-gray-200 rounded text-sm font-medium disabled:opacity-50 disabled:cursor-not-allowed"},"+",8,rg)]),U[40]||(U[40]=o("div",{class:"w-px h-4 bg-gray-300"},null,-1)),o("button",{onClick:ke,disabled:de.value,class:_e(["p-1 hover:bg-gray-200 rounded transition-colors disabled:opacity-50 disabled:cursor-not-allowed",{"bg-gray-300 text-blue-700":L.value}]),title:a(s)("editor.bold")},[ce(a(Vu),{class:"w-4 h-4"})],10,ng),o("button",{onClick:we,disabled:de.value,class:_e(["p-1 hover:bg-gray-200 rounded transition-colors disabled:opacity-50 disabled:cursor-not-allowed",{"bg-gray-300 text-blue-700":B.value}]),title:a(s)("editor.italic")},[ce(a(Ku),{class:"w-4 h-4"})],10,og),o("button",{onClick:ae,disabled:de.value,class:_e(["p-1 hover:bg-gray-200 rounded transition-colors disabled:opacity-50 disabled:cursor-not-allowed",{"bg-gray-300 text-blue-700":re.value}]),title:a(s)("editor.underline")},[ce(a(Zu),{class:"w-4 h-4"})],10,sg),o("button",{onClick:K,disabled:de.value,class:_e(["p-1 hover:bg-gray-200 rounded transition-colors disabled:opacity-50 disabled:cursor-not-allowed",{"bg-gray-300 text-blue-700":Z.value}]),title:a(s)("editor.verticalText")},[ce(a(ec),{class:"w-4 h-4"})],10,ag),ce(xt,{modelValue:ne.value,"onUpdate:modelValue":U[5]||(U[5]=me=>ne.value=me),disabled:de.value,"default-color":"#000000"},{trigger:ct(({color:me})=>[o("button",{type:"button",class:"flex items-center gap-1 p-1 hover:bg-gray-200 rounded transition-colors disabled:opacity-50 disabled:cursor-not-allowed",disabled:de.value,title:a(s)("editor.textColor")},[ce(a(ic),{class:"w-4 h-4"}),o("div",{class:"w-1 h-3.5 rounded-[1px] border border-gray-300",style:ye({backgroundColor:me})},null,4)],8,lg)]),_:1},8,["modelValue","disabled"]),ce(xt,{modelValue:ve.value,"onUpdate:modelValue":U[6]||(U[6]=me=>ve.value=me),disabled:de.value,"allow-transparent":!0,"default-color":"transparent"},{trigger:ct(({color:me})=>[o("button",{type:"button",class:"flex items-center gap-1 p-1 hover:bg-gray-200 rounded transition-colors disabled:opacity-50 disabled:cursor-not-allowed",disabled:de.value,title:a(s)("editor.backgroundColor")},[ce(a(cc),{class:"w-4 h-4"}),o("div",dg,[me==="transparent"?(z(),F("div",ug)):be("",!0),o("div",{class:"absolute inset-0",style:ye({backgroundColor:me==="transparent"?"transparent":me})},null,4),me==="transparent"?(z(),F("div",cg,[...U[38]||(U[38]=[o("div",{class:"w-full h-[1px] bg-red-500 rotate-90 transform scale-150"},null,-1)])])):be("",!0)])],8,ig)]),_:1},8,["modelValue","disabled"]),U[41]||(U[41]=o("div",{class:"w-px h-4 bg-gray-300"},null,-1)),o("button",{onClick:oe,disabled:xe.value||!a(n).selectedElementId,class:"p-1 hover:bg-gray-200 rounded transition-colors disabled:opacity-50 disabled:cursor-not-allowed",title:a(s)("editor.resetRotation")},[ce(a(nc),{class:"w-4 h-4"})],8,hg)]),U[47]||(U[47]=o("div",{class:"h-6 w-px bg-gray-300"},null,-1)),o("div",pg,[o("button",{onClick:U[7]||(U[7]=me=>a(n).alignSelectedElements("left")),disabled:!a(n).selectedElementId||xe.value,class:"p-1 hover:bg-gray-200 rounded disabled:opacity-30 disabled:cursor-not-allowed",title:a(s)("editor.alignLeft")},[ce(a(Tu),{class:"w-4 h-4"})],8,fg),o("button",{onClick:U[8]||(U[8]=me=>a(n).alignSelectedElements("center")),disabled:!a(n).selectedElementId||xe.value,class:"p-1 hover:bg-gray-200 rounded disabled:opacity-30 disabled:cursor-not-allowed",title:a(s)("editor.alignCenter")},[ce(a(Au),{class:"w-4 h-4"})],8,mg),o("button",{onClick:U[9]||(U[9]=me=>a(n).alignSelectedElements("right")),disabled:!a(n).selectedElementId||xe.value,class:"p-1 hover:bg-gray-200 rounded disabled:opacity-30 disabled:cursor-not-allowed",title:a(s)("editor.alignRight")},[ce(a(Lu),{class:"w-4 h-4"})],8,gg),U[43]||(U[43]=o("div",{class:"w-px h-4 bg-gray-300 mx-1"},null,-1)),o("button",{onClick:U[10]||(U[10]=me=>a(n).alignSelectedElements("top")),disabled:!a(n).selectedElementId||xe.value,class:"p-1 hover:bg-gray-200 rounded disabled:opacity-30 disabled:cursor-not-allowed",title:a(s)("editor.alignTop")},[ce(a(Du),{class:"w-4 h-4"})],8,vg),o("button",{onClick:U[11]||(U[11]=me=>a(n).alignSelectedElements("middle")),disabled:!a(n).selectedElementId||xe.value,class:"p-1 hover:bg-gray-200 rounded disabled:opacity-30 disabled:cursor-not-allowed",title:a(s)("editor.alignMiddle")},[ce(a(qu),{class:"w-4 h-4"})],8,bg),o("button",{onClick:U[12]||(U[12]=me=>a(n).alignSelectedElements("bottom")),disabled:!a(n).selectedElementId||xe.value,class:"p-1 hover:bg-gray-200 rounded disabled:opacity-30 disabled:cursor-not-allowed",title:a(s)("editor.alignBottom")},[ce(a(ju),{class:"w-4 h-4"})],8,yg),a(n).selectedElementIds.length>1?(z(),F(Te,{key:0},[U[42]||(U[42]=o("div",{class:"w-px h-4 bg-gray-300 mx-1"},null,-1)),o("button",{onClick:U[13]||(U[13]=me=>a(n).groupSelectedElements()),disabled:xe.value,class:"p-1 hover:bg-gray-200 rounded disabled:opacity-30 disabled:cursor-not-allowed",title:a(s)("editor.group")},[ce(a(gc),{class:"w-4 h-4"})],8,wg)],64)):be("",!0)]),U[48]||(U[48]=o("div",{class:"h-6 w-px bg-gray-300"},null,-1)),o("div",xg,[o("button",{onClick:U[14]||(U[14]=me=>a(n).undo()),disabled:a(n).historyPast.length===0,class:"p-1 hover:bg-gray-200 rounded disabled:opacity-30 disabled:cursor-not-allowed",title:a(s)("common.undo")+" ("+a(Me)(["Ctrl","Z"])+")"},[ce(a(Bl),{class:"w-4 h-4"})],8,_g),o("button",{onClick:U[15]||(U[15]=me=>a(n).redo()),disabled:a(n).historyFuture.length===0,class:"p-1 hover:bg-gray-200 rounded disabled:opacity-30 disabled:cursor-not-allowed",title:a(s)("common.redo")+" ("+a(Me)(["Ctrl","Y"])+")"},[ce(a(Ol),{class:"w-4 h-4"})],8,kg),U[44]||(U[44]=o("div",{class:"w-px h-4 bg-gray-300 mx-1"},null,-1)),o("button",{onClick:U[16]||(U[16]=me=>a(n).copy()),disabled:!a(n).selectedElementId||xe.value,class:"p-1 hover:bg-gray-200 rounded disabled:opacity-30 disabled:cursor-not-allowed",title:a(s)("common.copy")+" ("+a(Me)(["Ctrl","C"])+")"},[ce(a(Ct),{class:"w-4 h-4"})],8,Sg),o("button",{onClick:U[17]||(U[17]=me=>a(n).paste()),disabled:a(n).clipboard.length===0,class:"p-1 hover:bg-gray-200 rounded disabled:opacity-30 disabled:cursor-not-allowed",title:a(s)("common.paste")+" ("+a(Me)(["Ctrl","V"])+")"},[ce(a($o),{class:"w-4 h-4"})],8,Cg),U[45]||(U[45]=o("div",{class:"w-px h-4 bg-gray-300 mx-1"},null,-1)),o("button",{onClick:U[18]||(U[18]=me=>a(n).toggleLock()),disabled:!a(n).selectedElementId,class:"p-1 hover:bg-gray-200 rounded disabled:opacity-30 disabled:cursor-not-allowed",title:(xe.value?a(s)("editor.unlock"):a(s)("editor.lock"))+" ("+a(Me)(["Ctrl","L"])+")"},[xe.value?(z(),ze(a(ql),{key:0,class:"w-4 h-4 text-red-500"})):(z(),ze(a(Jt),{key:1,class:"w-4 h-4"}))],8,Eg),o("button",{onClick:U[19]||(U[19]=me=>a(n).removeSelectedElements()),disabled:!a(n).selectedElementId||xe.value,class:"p-1 hover:bg-gray-200 rounded disabled:opacity-30 disabled:cursor-not-allowed",title:a(s)("common.delete")+" ("+a(Me)(["Del"])+")"},[ce(a(St),{class:"w-4 h-4"})],8,Tg)]),U[49]||(U[49]=o("div",{class:"h-6 w-px bg-gray-300"},null,-1)),ce($f),o("div",$g,[o("div",Ig,[o("button",{onClick:q,class:"p-1 hover:bg-gray-200 rounded",title:a(s)("editor.zoomOut")},[ce(a(Rl),{class:"w-4 h-4"})],8,Ag),o("button",{onClick:U[20]||(U[20]=me=>te.value=!te.value),class:"text-xs w-12 text-center hover:bg-gray-200 rounded px-1 py-0.5",title:a(s)("editor.zoomSettings")},E(Math.round(a(n).zoom*100))+"% ",9,zg),o("button",{onClick:N,class:"p-1 hover:bg-gray-200 rounded",title:a(s)("editor.zoomIn")},[ce(a(Ml),{class:"w-4 h-4"})],8,Pg)]),te.value?(z(),F("div",Lg,[o("h3",Mg,E(a(s)("editor.zoomLevel")),1),o("div",Rg,[o("div",null,[o("label",Dg,E(a(s)("editor.zoomLevel"))+" (20% - 500%)",1),$e(o("input",{type:"range",min:"20",max:"500",step:"10","onUpdate:modelValue":U[21]||(U[21]=me=>Q.value=me),onInput:_,class:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer [&::-webkit-slider-thumb]:appearance-none [&::-webkit-slider-thumb]:w-4 [&::-webkit-slider-thumb]:h-4 [&::-webkit-slider-thumb]:bg-blue-600 [&::-webkit-slider-thumb]:rounded-full [&::-webkit-slider-thumb]:cursor-pointer [&::-webkit-slider-thumb]:transition-all [&::-webkit-slider-thumb]:hover:scale-110 [&::-moz-range-thumb]:w-4 [&::-moz-range-thumb]:h-4 [&::-moz-range-thumb]:bg-blue-600 [&::-moz-range-thumb]:border-none [&::-moz-range-thumb]:rounded-full [&::-moz-range-thumb]:cursor-pointer [&::-moz-range-thumb]:transition-all [&::-moz-range-thumb]:hover:scale-110"},null,544),[[De,Q.value,void 0,{number:!0}]]),o("div",Bg,E(Q.value)+"%",1)])]),o("div",{class:"fixed inset-0 z-[-1]",onClick:U[22]||(U[22]=me=>te.value=!1)})])):be("",!0)]),U[50]||(U[50]=o("div",{class:"h-6 w-px bg-gray-300"},null,-1)),o("div",Og,[o("div",qg,[o("button",{onClick:le,disabled:a(l).isSaving,class:"flex items-center gap-2 px-3 py-1.5 bg-blue-600 text-white rounded-l-md hover:bg-blue-700 transition-colors text-sm border-r border-blue-500 disabled:opacity-50 disabled:cursor-not-allowed"},[a(l).isSaving?(z(),ze(a(mu),{key:0,class:"w-4 h-4 animate-spin"})):(z(),ze(a(To),{key:1,class:"w-4 h-4"})),o("span",null,E(a(s)("common.save")),1)],8,Fg),o("button",{onClick:U[23]||(U[23]=me=>O.value=!O.value),class:"px-2 py-1.5 bg-blue-600 text-white rounded-r-md hover:bg-blue-700 transition-colors text-sm flex items-center"},[ce(a(Io),{class:"w-5 h-5"})])]),O.value?(z(),F("div",Ng,[o("button",{onClick:U[24]||(U[24]=me=>{he(),O.value=!1}),class:"w-full flex items-center gap-2 px-3 py-2 text-gray-700 hover:bg-gray-50 rounded text-sm text-left transition-colors whitespace-nowrap"},[ce(a(Dl),{class:"w-4 h-4 text-gray-500"}),o("span",null,E(a(s)("editor.saveAsTemplate")),1)]),o("button",{onClick:U[25]||(U[25]=me=>{C(),O.value=!1}),class:"w-full flex items-center gap-2 px-3 py-2 text-gray-700 hover:bg-gray-50 rounded text-sm text-left transition-colors whitespace-nowrap"},[ce(a(Xd),{class:"w-4 h-4 text-gray-500"}),o("span",null,E(a(s)("editor.preview")),1)]),o("button",{onClick:U[26]||(U[26]=me=>{j(),O.value=!1}),class:"w-full flex items-center gap-2 px-3 py-2 text-gray-700 hover:bg-gray-50 rounded text-sm text-left transition-colors whitespace-nowrap"},[ce(a(Co),{class:"w-4 h-4 text-gray-500"}),o("span",null,E(a(s)("editor.print")),1)]),o("button",{onClick:U[27]||(U[27]=me=>{J(),O.value=!1}),class:"w-full flex items-center gap-2 px-3 py-2 text-gray-700 hover:bg-gray-50 rounded text-sm text-left transition-colors whitespace-nowrap"},[ce(a(Vt),{class:"w-4 h-4 text-gray-500"}),o("span",null,E(a(s)("editor.exportPdf")),1)]),o("button",{onClick:U[28]||(U[28]=me=>{D(),O.value=!1}),class:"w-full flex items-center gap-2 px-3 py-2 text-gray-700 hover:bg-gray-50 rounded text-sm text-left transition-colors whitespace-nowrap"},[ce(a(Vt),{class:"w-4 h-4 text-gray-500"}),o("span",null,E(a(s)("editor.exportImage")),1)]),o("button",{onClick:U[29]||(U[29]=me=>{X(),O.value=!1}),class:"w-full flex items-center gap-2 px-3 py-2 text-gray-700 hover:bg-gray-50 rounded text-sm text-left transition-colors whitespace-nowrap"},[ce(a(ut),{class:"w-4 h-4 text-gray-500"}),o("span",null,E(a(s)("editor.viewImageBlob")),1)]),o("button",{onClick:U[30]||(U[30]=me=>{se(),O.value=!1}),class:"w-full flex items-center gap-2 px-3 py-2 text-gray-700 hover:bg-gray-50 rounded text-sm text-left transition-colors whitespace-nowrap"},[ce(a(ut),{class:"w-4 h-4 text-gray-500"}),o("span",null,E(a(s)("editor.viewPdfBlob")),1)]),o("button",{onClick:U[31]||(U[31]=me=>{v(),O.value=!1}),class:"w-full flex items-center gap-2 px-3 py-2 text-gray-700 hover:bg-gray-50 rounded text-sm text-left transition-colors whitespace-nowrap"},[ce(a(ut),{class:"w-4 h-4 text-gray-500"}),o("span",null,E(a(s)("editor.viewJson")),1)]),U[46]||(U[46]=o("div",{class:"h-px bg-gray-200 my-0.5"},null,-1)),o("button",{onClick:U[32]||(U[32]=me=>{t("toggleHelp"),O.value=!1}),class:"w-full flex items-center gap-2 px-3 py-2 text-gray-700 hover:bg-gray-50 rounded text-sm text-left transition-colors whitespace-nowrap"},[ce(a(Su),{class:"w-4 h-4 text-gray-500"}),o("span",null,E(a(s)("editor.help")),1)]),o("button",{onClick:U[33]||(U[33]=me=>{t("toggleSettings"),O.value=!1}),class:"w-full flex items-center gap-2 px-3 py-2 text-gray-700 hover:bg-gray-50 rounded text-sm text-left transition-colors whitespace-nowrap"},[ce(a(Eo),{class:"w-4 h-4 text-gray-500"}),o("span",null,E(a(s)("editor.settings")),1)])])):be("",!0),O.value?(z(),F("div",{key:1,class:"fixed inset-0 z-[999]",onClick:U[34]||(U[34]=me=>O.value=!1)})):be("",!0)])]),ce(eh,{visible:G.value,"onUpdate:visible":U[35]||(U[35]=me=>G.value=me),"html-content":$.value,width:a(n).canvasSize.width},null,8,["visible","html-content","width"]),ce(Km,{show:h.value,"onUpdate:show":U[36]||(U[36]=me=>h.value=me),mode:y.value,options:Y.value,onConfirm:P},null,8,["show","mode","options"]),ce(Ot,{visible:m.value,"onUpdate:visible":U[37]||(U[37]=me=>m.value=me),title:p.value,value:x.value,language:k.value,"read-only":""},null,8,["visible","title","value","language"])],64))}}),Hl="/Vue-Print-Designer/assets/logo-D22CyW4G.png";var Hg=Jl();const Ug={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function Vg(r,e){return z(),F("svg",Ug,[...e[0]||(e[0]=[o("path",{fill:"currentColor",d:"M4 19q-.825 0-1.412-.587T2 17V7q0-.825.588-1.412T4 5h16q.825 0 1.413.588T22 7v10q0 .825-.587 1.413T20 19zm4-3h8v-2H8zm-3-3h2v-2H5zm3 0h2v-2H8zm3 0h2v-2h-2zm3 0h2v-2h-2zm3 0h2v-2h-2zM5 10h2V8H5zm3 0h2V8H8zm3 0h2V8h-2zm3 0h2V8h-2zm3 0h2V8h-2z"},null,-1)])])}const Wg=Se({name:"material-symbols-keyboard",render:Vg}),Gg={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function Kg(r,e){return z(),F("svg",Gg,[...e[0]||(e[0]=[o("path",{fill:"currentColor",d:"M11 17h2v-6h-2zm1-8q.425 0 .713-.288T13 8t-.288-.712T12 7t-.712.288T11 8t.288.713T12 9m0 13q-2.075 0-3.9-.788t-3.175-2.137T2.788 15.9T2 12t.788-3.9t2.137-3.175T8.1 2.788T12 2t3.9.788t3.175 2.137T21.213 8.1T22 12t-.788 3.9t-2.137 3.175t-3.175 2.138T12 22"},null,-1)])])}const Yg=Se({name:"material-symbols-info",render:Kg}),Xg="vue-print-designer",Zg="0.9.2",Jg={"@guolao/vue-monaco-editor":"^1.6.0",canvg:"^4.0.3","dom-to-image-more":"^3.7.2",jszip:"^3.10.1",jsbarcode:"^3.12.3",jspdf:"^2.5.2",lodash:"^4.17.21",pinia:"^2.3.0",qrcode:"^1.5.4",uuid:"^11.0.3",vue:"^3.5.13","vue-i18n":"^11.2.8"},io={name:Xg,version:Zg,dependencies:Jg},Qg={class:"bg-white rounded-lg shadow-xl w-[700px] max-w-full h-[500px] flex overflow-hidden"},e0={class:"w-48 bg-gray-50 border-r border-gray-200 flex flex-col"},t0={class:"h-[60px] flex items-center px-4 border-b border-gray-200"},r0={class:"text-lg font-semibold text-gray-800"},n0={class:"flex-1 py-2"},o0={class:"flex-1 flex flex-col min-w-0"},s0={class:"h-[60px] flex items-center justify-between px-4 border-b border-gray-200"},a0={class:"text-lg font-semibold text-gray-800"},l0={class:"flex-1 overflow-y-auto p-6"},i0={key:0,class:"space-y-6"},d0={class:"grid grid-cols-1 gap-6 text-sm"},u0={class:"font-medium text-gray-900 mb-3 border-b pb-1"},c0={class:"space-y-2 text-gray-600"},h0={class:"flex justify-between items-center"},p0={class:"bg-gray-100 px-2 py-0.5 rounded border text-xs"},f0={class:"flex justify-between items-center"},m0={class:"bg-gray-100 px-2 py-0.5 rounded border text-xs"},g0={class:"flex justify-between items-center"},v0={class:"bg-gray-100 px-2 py-0.5 rounded border text-xs"},b0={class:"flex justify-between items-center"},y0={class:"bg-gray-100 px-2 py-0.5 rounded border text-xs"},w0={class:"flex justify-between items-center"},x0={class:"bg-gray-100 px-2 py-0.5 rounded border text-xs"},_0={class:"flex justify-between items-center"},k0={class:"bg-gray-100 px-2 py-0.5 rounded border text-xs"},S0={class:"flex justify-between items-center"},C0={class:"bg-gray-100 px-2 py-0.5 rounded border text-xs"},E0={class:"flex justify-between items-center"},T0={class:"bg-gray-100 px-2 py-0.5 rounded border text-xs"},$0={class:"flex justify-between items-center"},I0={class:"bg-gray-100 px-2 py-0.5 rounded border text-xs"},A0={class:"flex justify-between items-center"},z0={class:"bg-gray-100 px-2 py-0.5 rounded border text-xs"},P0={class:"flex justify-between items-center"},L0={class:"bg-gray-100 px-2 py-0.5 rounded border text-xs"},M0={class:"flex justify-between items-center"},R0={class:"bg-gray-100 px-2 py-0.5 rounded border text-xs"},D0={class:"flex justify-between items-center"},B0={class:"bg-gray-100 px-2 py-0.5 rounded border text-xs"},O0={class:"font-medium text-gray-900 mb-3 border-b pb-1"},q0={class:"space-y-2 text-gray-600"},F0={class:"flex justify-between items-center"},N0={class:"bg-gray-100 px-2 py-0.5 rounded border text-xs"},j0={class:"flex justify-between items-center"},H0={class:"bg-gray-100 px-2 py-0.5 rounded border text-xs"},U0={class:"flex justify-between items-center"},V0={class:"bg-gray-100 px-2 py-0.5 rounded border text-xs"},W0={class:"flex justify-between items-center"},G0={class:"bg-gray-100 px-2 py-0.5 rounded border text-xs"},K0={class:"flex justify-between items-center"},Y0={class:"bg-gray-100 px-2 py-0.5 rounded border text-xs"},X0={class:"flex justify-between items-center"},Z0={class:"bg-gray-100 px-2 py-0.5 rounded border text-xs"},J0={class:"flex justify-between items-center"},Q0={class:"bg-gray-100 px-2 py-0.5 rounded border text-xs"},ev={class:"flex justify-between items-center"},tv={class:"bg-gray-100 px-2 py-0.5 rounded border text-xs"},rv={class:"flex justify-between items-center"},nv={class:"bg-gray-100 px-2 py-0.5 rounded border text-xs"},ov={class:"flex justify-between items-center"},sv={class:"bg-gray-100 px-2 py-0.5 rounded border text-xs"},av={class:"font-medium text-gray-900 mb-3 border-b pb-1"},lv={class:"space-y-2 text-gray-600"},iv={class:"flex justify-between items-center"},dv={class:"bg-gray-100 px-2 py-0.5 rounded border text-xs"},uv={class:"flex justify-between items-center"},cv={class:"bg-gray-100 px-2 py-0.5 rounded border text-xs"},hv={class:"flex justify-between items-center"},pv={class:"bg-gray-100 px-2 py-0.5 rounded border text-xs"},fv={class:"flex justify-between items-center"},mv={class:"bg-gray-100 px-2 py-0.5 rounded border text-xs"},gv={key:1,class:"space-y-6"},vv={class:"text-center mb-8"},bv={class:"text-xl font-bold text-gray-800"},yv={class:"mt-4 flex justify-center"},wv=["title"],xv={class:"text-gray-600"},_v={class:"font-medium text-gray-900 mb-3 border-b pb-1"},kv={class:"bg-gray-50 rounded-lg border border-gray-200 overflow-hidden"},Sv={class:"w-full text-sm text-left"},Cv={class:"bg-gray-100 text-gray-700 font-medium"},Ev={class:"px-4 py-2 border-b"},Tv={class:"px-4 py-2 border-b"},$v={class:"divide-y divide-gray-200"},Iv={class:"px-4 py-2 text-gray-700 font-mono"},Av={class:"px-4 py-2 text-gray-500"},zv={class:"p-4 border-t border-gray-200 bg-gray-50 flex justify-end rounded-br-lg"},Pv=Pe({__name:"HelpModal",props:{show:{type:Boolean}},emits:["update:show"],setup(r,{emit:e}){const t=r,s=e,{t:n}=Ne(),l=Re(),i=ie("shortcuts"),d=()=>{s("update:show",!1)},u=x=>{t.show&&x.key==="Escape"&&(x.preventDefault(),d())};We(()=>{window.addEventListener("keydown",u)}),Ae(()=>t.show,x=>{l.setDisableGlobalShortcuts(x)}),Ge(()=>{window.removeEventListener("keydown",u),t.show&&l.setDisableGlobalShortcuts(!1)});const g=Object.entries(io.dependencies).map(([x,p])=>({name:x,version:p})),y=io.version,m=Hg.startCase(io.name);return(x,p)=>(z(),ze(tt,{to:"body"},[r.show?(z(),F("div",{key:0,class:"fixed inset-0 z-[99999] flex items-center justify-center bg-black/50",onClick:Ke(d,["self"])},[o("div",Qg,[o("div",e0,[o("div",t0,[o("h3",r0,E(a(n)("help.title")),1)]),o("div",n0,[o("button",{onClick:p[0]||(p[0]=k=>i.value="shortcuts"),class:_e(["w-full text-left px-4 py-3 flex items-center gap-3 transition-colors text-sm",i.value==="shortcuts"?"bg-white text-blue-600 border-l-4 border-blue-600 font-medium":"text-gray-600 hover:bg-gray-100 border-l-4 border-transparent"])},[ce(a(Wg),{class:"w-5 h-5"}),Ce(" "+E(a(n)("shortcuts.title")),1)],2),o("button",{onClick:p[1]||(p[1]=k=>i.value="about"),class:_e(["w-full text-left px-4 py-3 flex items-center gap-3 transition-colors text-sm",i.value==="about"?"bg-white text-blue-600 border-l-4 border-blue-600 font-medium":"text-gray-600 hover:bg-gray-100 border-l-4 border-transparent"])},[ce(a(Yg),{class:"w-5 h-5"}),Ce(" "+E(a(n)("help.about")),1)],2)])]),o("div",o0,[o("div",s0,[o("h3",a0,E(i.value==="shortcuts"?a(n)("shortcuts.keyboardShortcuts"):a(n)("help.aboutProject",{name:a(m)})),1),o("button",{onClick:d,class:"p-1 hover:bg-gray-100 rounded-full transition-colors text-gray-500"},[ce(a(vt),{class:"w-4 h-4"})])]),o("div",l0,[i.value==="shortcuts"?(z(),F("div",i0,[o("div",d0,[o("div",null,[o("h4",u0,E(a(n)("shortcuts.general")),1),o("ul",c0,[o("li",h0,[o("span",null,E(a(n)("common.save")),1),p[2]||(p[2]=Ce()),o("kbd",p0,E(a(Me)(["Ctrl","S"])),1)]),o("li",f0,[o("span",null,E(a(n)("shortcuts.saveAsTemplate")),1),p[3]||(p[3]=Ce()),o("kbd",m0,E(a(Me)(["Ctrl","Shift","S"])),1)]),o("li",g0,[o("span",null,E(a(n)("editor.print")),1),p[4]||(p[4]=Ce()),o("kbd",v0,E(a(Me)(["Ctrl","P"])),1)]),o("li",b0,[o("span",null,E(a(n)("editor.exportPdf")),1),p[5]||(p[5]=Ce()),o("kbd",y0,E(a(Me)(["Ctrl","Shift","E"])),1)]),o("li",w0,[o("span",null,E(a(n)("editor.preview")),1),p[6]||(p[6]=Ce()),o("kbd",x0,E(a(Me)(["Ctrl","Shift","P"])),1)]),o("li",_0,[o("span",null,E(a(n)("editor.viewJson")),1),p[7]||(p[7]=Ce()),o("kbd",k0,E(a(Me)(["Ctrl","Shift","J"])),1)]),o("li",S0,[o("span",null,E(a(n)("shortcuts.newTemplate")),1),p[8]||(p[8]=Ce()),o("kbd",C0,E(a(Me)(["Ctrl","Alt","N"])),1)]),o("li",E0,[o("span",null,E(a(n)("shortcuts.openSettings")),1),p[9]||(p[9]=Ce()),o("kbd",T0,E(a(Me)(["Ctrl",","])),1)]),o("li",$0,[o("span",null,E(a(n)("common.undo")),1),p[10]||(p[10]=Ce()),o("kbd",I0,E(a(Me)(["Ctrl","Z"])),1)]),o("li",A0,[o("span",null,E(a(n)("common.redo")),1),p[11]||(p[11]=Ce()),o("kbd",z0,E(a(Me)(["Ctrl","Y"])),1)]),o("li",P0,[o("span",null,E(a(n)("shortcuts.openHelp")),1),p[12]||(p[12]=Ce()),o("kbd",L0,E(a(Me)(["Ctrl","H"])),1)]),o("li",M0,[o("span",null,E(a(n)("shortcuts.zoom")),1),p[13]||(p[13]=Ce()),o("kbd",R0,E(a(Me)(["Ctrl","Wheel"])),1)]),o("li",D0,[o("span",null,E(a(n)("shortcuts.closeModal")),1),p[14]||(p[14]=Ce()),o("kbd",B0,E(a(Me)(["Esc"])),1)])])]),o("div",null,[o("h4",O0,E(a(n)("shortcuts.editing")),1),o("ul",q0,[o("li",F0,[o("span",null,E(a(n)("common.copy")),1),p[15]||(p[15]=Ce()),o("kbd",N0,E(a(Me)(["Ctrl","C"])),1)]),o("li",j0,[o("span",null,E(a(n)("common.cut")),1),p[16]||(p[16]=Ce()),o("kbd",H0,E(a(Me)(["Ctrl","X"])),1)]),o("li",U0,[o("span",null,E(a(n)("common.paste")),1),p[17]||(p[17]=Ce()),o("kbd",V0,E(a(Me)(["Ctrl","V"])),1)]),o("li",W0,[o("span",null,E(a(n)("common.delete")),1),p[18]||(p[18]=Ce()),o("kbd",G0,E(a(Me)(["Delete"])),1)]),o("li",K0,[o("span",null,E(a(n)("shortcuts.selectAll")),1),p[19]||(p[19]=Ce()),o("kbd",Y0,E(a(Me)(["Ctrl","A"])),1)]),o("li",X0,[o("span",null,E(a(n)("shortcuts.multiSelect")),1),p[20]||(p[20]=Ce()),o("kbd",Z0,E(a(Me)(["Ctrl","Click"])),1)]),o("li",J0,[o("span",null,E(a(n)("common.lock"))+"/"+E(a(n)("common.unlock")),1),p[21]||(p[21]=Ce()),o("kbd",Q0,E(a(Me)(["Ctrl","L"])),1)]),o("li",ev,[o("span",null,E(a(n)("shortcuts.customEditSave")),1),p[22]||(p[22]=Ce()),o("kbd",tv,E(a(Me)(["Ctrl","S"])),1)]),o("li",rv,[o("span",null,E(a(n)("shortcuts.customEditSaveAs")),1),p[23]||(p[23]=Ce()),o("kbd",nv,E(a(Me)(["Ctrl","Shift","S"])),1)]),o("li",ov,[o("span",null,E(a(n)("shortcuts.customEditExit")),1),p[24]||(p[24]=Ce()),o("kbd",sv,E(a(Me)(["Ctrl","Q"])),1)])])]),o("div",null,[o("h4",av,E(a(n)("shortcuts.manipulation")),1),o("ul",lv,[o("li",iv,[o("span",null,E(a(n)("shortcuts.move")),1),p[25]||(p[25]=Ce()),o("kbd",dv,E(a(n)("shortcuts.arrow")),1)]),o("li",uv,[o("span",null,E(a(n)("shortcuts.fastMove")),1),p[26]||(p[26]=Ce()),o("kbd",cv,E(a(Me)(["Shift",a(n)("shortcuts.arrow")])),1)]),o("li",hv,[o("span",null,E(a(n)("shortcuts.snapRotate")),1),p[27]||(p[27]=Ce()),o("kbd",pv,E(a(Me)(["Shift",a(n)("shortcuts.drag")])),1)]),o("li",fv,[o("span",null,E(a(n)("shortcuts.resize")),1),p[28]||(p[28]=Ce()),o("kbd",mv,E(a(Me)(["Shift",a(n)("shortcuts.resize")])),1)])])])])])):be("",!0),i.value==="about"?(z(),F("div",gv,[o("div",vv,[p[32]||(p[32]=o("img",{src:Hl,alt:"Vue Print Designer",class:"w-12 h-12 mx-auto mb-2"},null,-1)),o("h2",bv,E(a(m)),1),o("div",yv,[o("a",{href:"https://github.com/0ldFive/Vue-Print-Designer",target:"_blank",rel:"noopener noreferrer",class:"group inline-flex items-center gap-2 rounded-full border border-gray-200 bg-gray-50 px-2.5 py-1 text-[11px] text-gray-700 shadow-sm transition-colors hover:border-blue-200 hover:bg-blue-50 hover:text-blue-700",title:a(n)("help.github")},[p[29]||(p[29]=o("span",{class:"inline-flex h-5 w-5 items-center justify-center rounded-full bg-white text-gray-700 shadow-sm transition-colors group-hover:text-blue-700"},[o("svg",{viewBox:"0 0 16 16","aria-hidden":"true",class:"w-3.5 h-3.5"},[o("path",{fill:"currentColor",d:"M8 0C3.58 0 0 3.73 0 8.35c0 3.7 2.29 6.83 5.47 7.94.4.08.55-.18.55-.4 0-.2-.01-.86-.01-1.56-2.01.38-2.53-.5-2.69-.96-.09-.24-.48-.96-.82-1.16-.28-.16-.68-.56-.01-.57.63-.01 1.08.6 1.23.85.72 1.25 1.87.9 2.33.69.07-.54.28-.9.51-1.11-1.78-.21-3.64-.92-3.64-4.08 0-.9.31-1.64.82-2.22-.08-.21-.36-1.06.08-2.2 0 0 .67-.22 2.2.85.64-.18 1.32-.27 2-.27s1.36.09 2 .27c1.53-1.07 2.2-.85 2.2-.85.44 1.14.16 1.99.08 2.2.51.58.82 1.32.82 2.22 0 3.17-1.87 3.87-3.65 4.08.29.26.54.77.54 1.56 0 1.12-.01 2.03-.01 2.32 0 .22.15.48.55.4C13.71 15.18 16 12.04 16 8.35 16 3.73 12.42 0 8 0z"})])],-1)),p[30]||(p[30]=o("span",{class:"text-gray-500 group-hover:text-blue-600"},"0ldFive/Vue-Print-Designer",-1)),p[31]||(p[31]=o("span",{class:"text-gray-400"},"|",-1)),o("span",xv,E(a(n)("help.version"))+" "+E(a(y)),1)],8,wv)])]),o("div",null,[o("h4",_v,E(a(n)("help.dependencies")),1),o("div",kv,[o("table",Sv,[o("thead",Cv,[o("tr",null,[o("th",Ev,E(a(n)("help.package")),1),o("th",Tv,E(a(n)("help.version")),1)])]),o("tbody",$v,[(z(!0),F(Te,null,Le(a(g),k=>(z(),F("tr",{key:k.name,class:"hover:bg-gray-50"},[o("td",Iv,E(k.name),1),o("td",Av,E(k.version),1)]))),128))])])])])])):be("",!0)]),o("div",zv,[o("button",{onClick:d,class:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 transition-colors text-sm"},E(a(n)("common.close")),1)])])])])):be("",!0)]))}}),Lv={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function Mv(r,e){return z(),F("svg",Lv,[...e[0]||(e[0]=[o("path",{fill:"currentColor",d:"m11.9 22l4.55-12h2.1l4.55 12H21l-1.075-3.05h-4.85L14 22zM4 19l-1.4-1.4l5.05-5.05q-.875-.875-1.588-2T4.75 8h2.1q.5.975 1 1.7t1.2 1.45q.825-.825 1.713-2.313T12.1 6H1V4h7V2h2v2h7v2h-2.9q-.525 1.8-1.575 3.7t-2.075 2.9l2.4 2.45l-.75 2.05l-3.05-3.125zm11.7-1.8h3.6l-1.8-5.1z"},null,-1)])])}const Rv=Se({name:"material-symbols-translate",render:Mv}),Dv={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function Bv(r,e){return z(),F("svg",Dv,[...e[0]||(e[0]=[o("path",{fill:"currentColor",d:"M6.5 20q-2.275 0-3.887-1.575T1 14.575q0-1.95 1.175-3.475T5.25 9.15q.625-2.3 2.5-3.725T12 4q2.925 0 4.963 2.038T19 11q1.725.2 2.863 1.488T23 15.5q0 1.875-1.312 3.188T18.5 20z"},null,-1)])])}const Ov=Se({name:"material-symbols-cloud",render:Bv}),qv={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function Fv(r,e){return z(),F("svg",qv,[...e[0]||(e[0]=[o("path",{fill:"currentColor",d:"M11 17H7q-2.075 0-3.537-1.463T2 12t1.463-3.537T7 7h4v2H7q-1.25 0-2.125.875T4 12t.875 2.125T7 15h4zm-3-4v-2h8v2zm5 4v-2h4q1.25 0 2.125-.875T20 12t-.875-2.125T17 9h-4V7h4q2.075 0 3.538 1.463T22 12t-1.463 3.538T17 17z"},null,-1)])])}const Va=Se({name:"material-symbols-link",render:Fv}),Nv={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function jv(r,e){return z(),F("svg",Nv,[...e[0]||(e[0]=[o("path",{fill:"currentColor",d:"m19.25 16.45l-1.5-1.55q1-.275 1.625-1.063T20 12q0-1.25-.875-2.125T17 9h-4V7h4q2.075 0 3.538 1.463T22 12q0 1.425-.737 2.625T19.25 16.45M15.85 13l-2-2H16v2zm3.95 9.6L1.4 4.2l1.4-1.4l18.4 18.4zM11 17H7q-2.075 0-3.537-1.463T2 12q0-1.725 1.05-3.075t2.7-1.775L7.6 9H7q-1.25 0-2.125.875T4 12t.875 2.125T7 15h4zm-3-4v-2h1.625l1.975 2z"},null,-1)])])}const Wa=Se({name:"material-symbols-link-off",render:jv}),Hv={class:"bg-white rounded-lg shadow-xl w-[700px] max-w-full h-[500px] flex overflow-hidden"},Uv={class:"w-48 bg-gray-50 border-r border-gray-200 flex flex-col"},Vv={class:"h-[60px] flex items-center px-4 border-b border-gray-200"},Wv={class:"text-lg font-semibold text-gray-800"},Gv={class:"flex-1 py-2"},Kv={class:"flex-1 flex flex-col min-w-0 relative"},Yv={class:"h-[60px] flex items-center justify-between px-4 border-b border-gray-200"},Xv={class:"text-lg font-semibold text-gray-800"},Zv={class:"flex-1 overflow-y-auto p-6"},Jv={key:0,class:"space-y-4 text-sm text-gray-700"},Qv={class:"mb-2 font-medium text-gray-900"},eb={class:"flex items-center gap-3"},tb={class:"text-xs text-gray-500 mt-2"},rb={class:"border-t border-gray-200 pt-4"},nb={class:"mb-2 font-medium text-gray-900"},ob={class:"flex flex-wrap gap-2"},sb=["onClick"],ab={class:"text-xs text-gray-500 mt-2"},lb={class:"border-t border-gray-200 pt-4"},ib={class:"flex items-center justify-between"},db={class:"font-medium text-gray-900"},ub={class:"sr-only"},cb={class:"text-xs text-gray-500 mt-2"},hb={class:"border-t border-gray-200 pt-4"},pb={class:"flex items-center justify-between"},fb={class:"font-medium text-gray-900"},mb={class:"sr-only"},gb={class:"text-xs text-gray-500 mt-2"},vb={class:"border-t border-gray-200 pt-4 space-y-3"},bb={class:"mb-2 font-medium text-gray-900"},yb={class:"flex items-center gap-3"},wb=["disabled"],xb=["disabled"],_b={class:"text-xs text-gray-500 mt-2"},kb={class:"flex items-center justify-between"},Sb={class:"font-medium text-gray-900"},Cb={class:"sr-only"},Eb={class:"text-xs text-gray-500"},Tb={key:1,class:"space-y-4 text-sm text-gray-700"},$b={class:"mb-2 font-medium text-gray-900"},Ib={class:"flex items-center gap-3"},Ab={class:"text-xs text-gray-500 mt-2"},zb={key:2,class:"space-y-4 text-sm text-gray-700"},Pb={class:"space-y-2"},Lb={class:"font-medium text-gray-900"},Mb={class:"text-xs text-gray-500"},Rb={class:"grid grid-cols-2 gap-4"},Db={class:"flex flex-col gap-1 col-span-2"},Bb={class:"text-xs text-gray-500"},Ob=["placeholder"],qb={class:"flex flex-col gap-1 col-span-2"},Fb={class:"text-xs text-gray-500"},Nb={class:"rounded bg-gray-100 px-3 py-2 text-xs text-gray-600 break-all"},jb={class:"font-medium text-gray-700"},Hb={class:"w-full pt-2"},Ub=["disabled"],Vb={key:0,class:"mt-2 flex items-center justify-between text-xs text-gray-500"},Wb={key:3,class:"space-y-4 text-sm text-gray-700"},Gb={class:"space-y-2"},Kb={class:"font-medium text-gray-900"},Yb={class:"text-xs text-gray-500"},Xb={class:"grid grid-cols-2 gap-4"},Zb={class:"flex flex-col gap-1 col-span-2"},Jb={class:"text-xs text-gray-500"},Qb=["placeholder"],e1={class:"flex flex-col gap-1"},t1={class:"text-xs text-gray-500"},r1={class:"flex flex-col gap-1"},n1={class:"text-xs text-gray-500"},o1={class:"space-y-2 pt-2 border-t border-gray-200"},s1={class:"font-medium text-gray-900"},a1={class:"text-xs text-gray-500"},l1={class:"grid grid-cols-2 gap-4"},i1={class:"flex flex-col gap-1 col-span-2"},d1={class:"text-xs text-gray-500"},u1=["placeholder"],c1={class:"flex flex-col gap-1 col-span-2"},h1={class:"text-xs text-gray-500"},p1=["disabled"],f1={value:""},m1=["value","disabled"],g1={class:"rounded bg-gray-100 px-3 py-2 text-xs text-gray-600 break-all"},v1={class:"font-medium text-gray-700"},b1={class:"text-xs text-gray-500"},y1={class:"w-full pt-2"},w1=["disabled"],x1={key:0,class:"mt-2 flex items-center justify-between text-xs text-gray-500"},_1={class:"p-4 border-t border-gray-200 bg-gray-50 flex justify-end rounded-br-lg"},k1=Pe({__name:"SettingsModal",props:{show:{type:Boolean}},emits:["update:show"],setup(r,{emit:e}){const t=r,s=e,{t:n,locale:l}=Ne(),{theme:i,setTheme:d}=So(),{autoSave:u}=Il(),g=Re(),{printMode:y,silentPrint:m,exportImageMerged:x,localSettings:p,remoteSettings:k,localStatus:v,remoteStatus:S,localRetryCount:b,remoteRetryCount:f,remoteClients:T,remoteSelectedClientId:M,localWsUrl:H,remoteWsUrl:R,cancelLocalRetry:A,cancelRemoteRetry:W,connectLocal:X,disconnectLocal:se,connectRemote:G,disconnectRemote:$,fetchRemoteClients:O}=Qt(),h=ie("basic"),w=ie(l.value),Y=ie(localStorage.getItem("print-designer-brand-key")||"default"),te=ie(localStorage.getItem("print-designer-brand-custom-hex")||"#3b82f6"),Q=fe(()=>v.value||"disconnected"),I=fe(()=>S.value||"disconnected"),V=fe(()=>b.value||0),L=fe(()=>f.value||0),B=fe(()=>T.value||[]),re=fe(()=>Q.value==="connected"),Z=fe(()=>I.value==="connected"),ne=fe(()=>Q.value==="connecting"),ve=fe(()=>I.value==="connecting"),xe=fe(()=>!!p.wsAddress),de=fe(()=>!!(k.apiBaseUrl&&k.username&&k.password)),ke=fe(()=>re.value?n("settings.status.connected"):n("settings.status.disconnected")),we=fe(()=>Z.value?n("settings.status.connected"):n("settings.status.disconnected")),ae=pe=>pe==="connected"?"bg-blue-600 hover:bg-blue-700 text-white border border-blue-600":"bg-transparent text-blue-600 border border-blue-600 hover:bg-blue-50",K=(pe,ee=0,U=255)=>Math.min(Math.max(pe,ee),U),oe=(pe,ee,U)=>{const me=Oe=>K(Math.round(Oe)).toString(16).padStart(2,"0");return`#${me(pe)}${me(ee)}${me(U)}`},c=(pe,ee,U)=>({r:pe.r+(ee.r-pe.r)*U,g:pe.g+(ee.g-pe.g)*U,b:pe.b+(ee.b-pe.b)*U}),N=pe=>{const ee=Mt(pe);if(!ee)return null;const U=Dt(ee.h,ee.s,ee.v),me={r:255,g:255,b:255},Oe={r:0,g:0,b:0},Be=c(U,me,.92),Ue=c(U,me,.84),Ie=c(U,me,.68),Fe=c(U,me,.5),st=c(U,me,.32),Ve=c(U,me,.16),je=c(U,Oe,.12),Ze=c(U,Oe,.24),lt=c(U,Oe,.36),nt=c(U,Oe,.5);return{"--brand-50":oe(Be.r,Be.g,Be.b),"--brand-100":oe(Ue.r,Ue.g,Ue.b),"--brand-200":oe(Ie.r,Ie.g,Ie.b),"--brand-300":oe(Fe.r,Fe.g,Fe.b),"--brand-400":oe(st.r,st.g,st.b),"--brand-500":oe(Ve.r,Ve.g,Ve.b),"--brand-600":oe(U.r,U.g,U.b),"--brand-700":oe(je.r,je.g,je.b),"--brand-800":oe(Ze.r,Ze.g,Ze.b),"--brand-900":oe(lt.r,lt.g,lt.b),"--brand-950":oe(nt.r,nt.g,nt.b)}},q=fe(()=>N(te.value)||{}),_=fe(()=>[{key:"default",labelKey:"settings.themePresetDefault",colors:{"--brand-50":"#eff6ff","--brand-100":"#dbeafe","--brand-200":"#bfdbfe","--brand-300":"#93c5fd","--brand-400":"#60a5fa","--brand-500":"#3b82f6","--brand-600":"#2563eb","--brand-700":"#1d4ed8","--brand-800":"#1e40af","--brand-900":"#1e3a8a","--brand-950":"#172554"}},{key:"emerald",labelKey:"settings.themePresetEmerald",colors:{"--brand-50":"#ecfdf5","--brand-100":"#d1fae5","--brand-200":"#a7f3d0","--brand-300":"#6ee7b7","--brand-400":"#34d399","--brand-500":"#10b981","--brand-600":"#059669","--brand-700":"#047857","--brand-800":"#065f46","--brand-900":"#064e3b","--brand-950":"#022c22"}},{key:"amber",labelKey:"settings.themePresetAmber",colors:{"--brand-50":"#fffbeb","--brand-100":"#fef3c7","--brand-200":"#fde68a","--brand-300":"#fcd34d","--brand-400":"#fbbf24","--brand-500":"#f59e0b","--brand-600":"#d97706","--brand-700":"#b45309","--brand-800":"#92400e","--brand-900":"#78350f","--brand-950":"#451a03"}},{key:"rose",labelKey:"settings.themePresetRose",colors:{"--brand-50":"#fff1f2","--brand-100":"#ffe4e6","--brand-200":"#fecdd3","--brand-300":"#fda4af","--brand-400":"#fb7185","--brand-500":"#f43f5e","--brand-600":"#e11d48","--brand-700":"#be123c","--brand-800":"#9f1239","--brand-900":"#881337","--brand-950":"#4c0519"}},{key:"custom",labelKey:"settings.themePresetCustom",colors:q.value}]),C=pe=>{const ee=document.documentElement;Object.entries(pe).forEach(([U,me])=>{ee.style.setProperty(U,me)}),window.dispatchEvent(new CustomEvent("brand-theme-updated"))},j=pe=>{localStorage.setItem("print-designer-brand-vars",JSON.stringify(pe))},P=pe=>{const ee=_.value.find(U=>U.key===pe)||_.value[0];ee.colors&&(C(ee.colors),j(ee.colors),localStorage.setItem("print-designer-brand-key",ee.key))};(()=>{const pe=localStorage.getItem("print-designer-brand-vars");if(pe)try{const ee=JSON.parse(pe);ee&&typeof ee=="object"&&C(ee)}catch{}})();const D=async()=>{if(!ne.value){if(re.value){se();return}await X()}},le=async()=>{if(!ve.value){if(Z.value){$();return}await G()}};Ae(w,pe=>{l.value=pe,localStorage.setItem("print-designer-language",pe)}),Ae(i,pe=>{d(pe)}),Ae(()=>t.show,pe=>{g.setDisableGlobalShortcuts(pe)}),Ae(te,pe=>{pe&&(localStorage.setItem("print-designer-brand-custom-hex",pe),Y.value==="custom"&&P("custom"))}),Ae(Y,pe=>{P(pe)},{immediate:!0}),Ae([h,S],([pe,ee])=>{pe!=="remote"||ee!=="connected"||O()});const he=()=>{s("update:show",!1)},ue=pe=>{t.show&&pe.key==="Escape"&&(pe.preventDefault(),he())};return We(()=>{window.addEventListener("keydown",ue)}),Ge(()=>{window.removeEventListener("keydown",ue),t.show&&g.setDisableGlobalShortcuts(!1)}),(pe,ee)=>(z(),ze(tt,{to:"body"},[r.show?(z(),F("div",{key:0,class:"fixed inset-0 z-[99999] flex items-center justify-center bg-black/50",onClick:Ke(he,["self"])},[o("div",Hv,[o("div",Uv,[o("div",Vv,[o("h3",Wv,E(a(n)("settings.title")),1)]),o("div",Gv,[o("button",{onClick:ee[0]||(ee[0]=U=>h.value="basic"),class:_e(["w-full text-left px-4 py-3 flex items-center gap-3 transition-colors text-sm",h.value==="basic"?"bg-white text-blue-600 border-l-4 border-blue-600 font-medium":"text-gray-600 hover:bg-gray-100 border-l-4 border-transparent"])},[ce(a(Eo),{class:"w-5 h-5"}),Ce(" "+E(a(n)("settings.basic")),1)],2),o("button",{onClick:ee[1]||(ee[1]=U=>h.value="language"),class:_e(["w-full text-left px-4 py-3 flex items-center gap-3 transition-colors text-sm",h.value==="language"?"bg-white text-blue-600 border-l-4 border-blue-600 font-medium":"text-gray-600 hover:bg-gray-100 border-l-4 border-transparent"])},[ce(a(Rv),{class:"w-5 h-5"}),Ce(" "+E(a(n)("settings.language")),1)],2),o("button",{onClick:ee[2]||(ee[2]=U=>h.value="local"),class:_e(["w-full text-left px-4 py-3 flex items-center gap-3 transition-colors text-sm",h.value==="local"?"bg-white text-blue-600 border-l-4 border-blue-600 font-medium":"text-gray-600 hover:bg-gray-100 border-l-4 border-transparent"])},[ce(a(Co),{class:"w-5 h-5"}),Ce(" "+E(a(n)("settings.localConnection")),1)],2),o("button",{onClick:ee[3]||(ee[3]=U=>h.value="remote"),class:_e(["w-full text-left px-4 py-3 flex items-center gap-3 transition-colors text-sm",h.value==="remote"?"bg-white text-blue-600 border-l-4 border-blue-600 font-medium":"text-gray-600 hover:bg-gray-100 border-l-4 border-transparent"])},[ce(a(Ov),{class:"w-5 h-5"}),Ce(" "+E(a(n)("settings.remoteConnection")),1)],2)])]),o("div",Kv,[o("div",Yv,[o("h3",Xv,E(h.value==="basic"?a(n)("settings.basic"):h.value==="language"?a(n)("settings.language"):h.value==="local"?a(n)("settings.localConnection"):a(n)("settings.remoteConnection")),1),o("button",{onClick:he,class:"p-1 hover:bg-gray-100 rounded-full transition-colors text-gray-500"},[ce(a(vt),{class:"w-4 h-4"})])]),o("div",Zv,[h.value==="basic"?(z(),F("div",Jv,[o("div",null,[o("div",Qv,E(a(n)("settings.theme")),1),o("div",eb,[o("label",{class:_e(["flex items-center gap-2 px-3 py-2 border rounded cursor-pointer",a(i)==="system"?"border-blue-600 text-blue-700":"border-gray-300"])},[$e(o("input",{type:"radio",value:"system","onUpdate:modelValue":ee[4]||(ee[4]=U=>ft(i)?i.value=U:null)},null,512),[[it,a(i)]]),o("span",null,E(a(n)("settings.themeSystem")),1)],2),o("label",{class:_e(["flex items-center gap-2 px-3 py-2 border rounded cursor-pointer",a(i)==="light"?"border-blue-600 text-blue-700":"border-gray-300"])},[$e(o("input",{type:"radio",value:"light","onUpdate:modelValue":ee[5]||(ee[5]=U=>ft(i)?i.value=U:null)},null,512),[[it,a(i)]]),o("span",null,E(a(n)("settings.themeLight")),1)],2),o("label",{class:_e(["flex items-center gap-2 px-3 py-2 border rounded cursor-pointer",a(i)==="dark"?"border-blue-600 text-blue-700":"border-gray-300"])},[$e(o("input",{type:"radio",value:"dark","onUpdate:modelValue":ee[6]||(ee[6]=U=>ft(i)?i.value=U:null)},null,512),[[it,a(i)]]),o("span",null,E(a(n)("settings.themeDark")),1)],2)]),o("p",tb,E(a(n)("settings.themeDesc")),1)]),o("div",rb,[o("div",nb,E(a(n)("settings.themeColor")),1),o("div",ob,[(z(!0),F(Te,null,Le(_.value.filter(U=>U.key!=="custom"),U=>(z(),F("button",{key:U.key,type:"button",class:_e(["flex items-center gap-2 px-3 py-2 border rounded text-xs transition-colors",Y.value===U.key?"border-blue-600 text-blue-700":"border-gray-300 text-gray-700 hover:bg-gray-50"]),onClick:me=>Y.value=U.key},[o("span",{class:"inline-block w-3.5 h-3.5 rounded-full",style:ye({backgroundColor:U.colors["--brand-600"]})},null,4),o("span",null,E(a(n)(U.labelKey)),1)],10,sb))),128)),ce(xt,{"model-value":te.value,"onUpdate:modelValue":ee[8]||(ee[8]=U=>{U&&(te.value=U,Y.value="custom")}),"default-color":te.value,"teleport-to-body":!0},{trigger:ct(({color:U,open:me})=>[o("button",{type:"button",class:_e(["flex items-center gap-2 px-3 py-2 border rounded text-xs transition-colors",Y.value==="custom"?"border-blue-600 text-blue-700":"border-gray-300 text-gray-700 hover:bg-gray-50"]),onClick:ee[7]||(ee[7]=Oe=>Y.value="custom")},[o("span",{class:_e(["inline-block w-3.5 h-3.5 rounded-full border border-gray-200",{"ring-2 ring-blue-500 ring-offset-1":me}]),style:ye({backgroundColor:U||te.value})},null,6),o("span",null,E(a(n)("settings.themePresetCustom")),1)],2)]),_:1},8,["model-value","default-color"])]),o("p",ab,E(a(n)("settings.themeColorDesc")),1)]),o("div",lb,[o("div",ib,[o("div",db,E(a(n)("settings.autoSave")),1),o("button",{onClick:ee[9]||(ee[9]=U=>u.value=!a(u)),class:_e(["relative inline-flex h-6 w-11 flex-shrink-0 cursor-pointer rounded-full border-2 border-transparent transition-colors duration-200 ease-in-out focus:outline-none focus:ring-2 focus:ring-blue-600 focus:ring-offset-2",a(u)?"bg-blue-600":"bg-gray-200"])},[o("span",ub,E(a(n)("settings.autoSave")),1),o("span",{"aria-hidden":"true",class:_e(["pointer-events-none inline-block h-5 w-5 transform rounded-full bg-white shadow ring-0 transition duration-200 ease-in-out",a(u)?"translate-x-5":"translate-x-0"])},null,2)],2)]),o("p",cb,E(a(n)("settings.autoSaveDesc")),1)]),o("div",hb,[o("div",pb,[o("div",fb,E(a(n)("settings.exportImageMerged")),1),o("button",{onClick:ee[10]||(ee[10]=U=>x.value=!a(x)),class:_e(["relative inline-flex h-6 w-11 flex-shrink-0 cursor-pointer rounded-full border-2 border-transparent transition-colors duration-200 ease-in-out focus:outline-none focus:ring-2 focus:ring-blue-600 focus:ring-offset-2",a(x)?"bg-blue-600":"bg-gray-200"])},[o("span",mb,E(a(n)("settings.exportImageMerged")),1),o("span",{"aria-hidden":"true",class:_e(["pointer-events-none inline-block h-5 w-5 transform rounded-full bg-white shadow ring-0 transition duration-200 ease-in-out",a(x)?"translate-x-5":"translate-x-0"])},null,2)],2)]),o("p",gb,E(a(n)("settings.exportImageMergedDesc")),1)]),o("div",vb,[o("div",null,[o("div",bb,E(a(n)("settings.printMode")),1),o("div",yb,[o("label",{class:_e(["flex items-center gap-2 px-3 py-2 border rounded cursor-pointer",a(y)==="browser"?"border-blue-600 text-blue-700":"border-gray-300"])},[$e(o("input",{type:"radio",value:"browser","onUpdate:modelValue":ee[11]||(ee[11]=U=>ft(y)?y.value=U:null)},null,512),[[it,a(y)]]),o("span",null,E(a(n)("settings.printModeBrowser")),1)],2),o("label",{class:_e(["flex items-center gap-2 px-3 py-2 border rounded cursor-pointer",a(y)==="local"?"border-blue-600 text-blue-700":"border-gray-300"])},[$e(o("input",{type:"radio",value:"local","onUpdate:modelValue":ee[12]||(ee[12]=U=>ft(y)?y.value=U:null),disabled:!re.value},null,8,wb),[[it,a(y)]]),o("span",null,E(a(n)("settings.printModeLocal")),1)],2),o("label",{class:_e(["flex items-center gap-2 px-3 py-2 border rounded cursor-pointer",a(y)==="remote"?"border-blue-600 text-blue-700":"border-gray-300"])},[$e(o("input",{type:"radio",value:"remote","onUpdate:modelValue":ee[13]||(ee[13]=U=>ft(y)?y.value=U:null),disabled:!Z.value},null,8,xb),[[it,a(y)]]),o("span",null,E(a(n)("settings.printModeRemote")),1)],2)]),o("p",_b,E(a(n)("settings.printModeDesc")),1)]),o("div",kb,[o("div",Sb,E(a(n)("settings.silentPrint")),1),o("button",{onClick:ee[14]||(ee[14]=U=>m.value=!a(m)),class:_e(["relative inline-flex h-6 w-11 flex-shrink-0 cursor-pointer rounded-full border-2 border-transparent transition-colors duration-200 ease-in-out focus:outline-none focus:ring-2 focus:ring-blue-600 focus:ring-offset-2",a(m)?"bg-blue-600":"bg-gray-200"])},[o("span",Cb,E(a(n)("settings.silentPrint")),1),o("span",{"aria-hidden":"true",class:_e(["pointer-events-none inline-block h-5 w-5 transform rounded-full bg-white shadow ring-0 transition duration-200 ease-in-out",a(m)?"translate-x-5":"translate-x-0"])},null,2)],2)]),o("p",Eb,E(a(n)("settings.silentPrintDesc")),1)])])):be("",!0),h.value==="language"?(z(),F("div",Tb,[o("div",$b,E(a(n)("settings.selectLanguage")),1),o("div",Ib,[o("label",{class:_e(["flex items-center gap-2 px-3 py-2 border rounded cursor-pointer",w.value==="zh"?"border-blue-600 text-blue-700":"border-gray-300"])},[$e(o("input",{type:"radio",value:"zh","onUpdate:modelValue":ee[15]||(ee[15]=U=>w.value=U)},null,512),[[it,w.value]]),o("span",null,E(a(n)("settings.zhLabel")),1)],2),o("label",{class:_e(["flex items-center gap-2 px-3 py-2 border rounded cursor-pointer",w.value==="en"?"border-blue-600 text-blue-700":"border-gray-300"])},[$e(o("input",{type:"radio",value:"en","onUpdate:modelValue":ee[16]||(ee[16]=U=>w.value=U)},null,512),[[it,w.value]]),o("span",null,E(a(n)("settings.enLabel")),1)],2)]),o("p",Ab,E(a(n)("settings.languageDesc")),1)])):be("",!0),h.value==="local"?(z(),F("div",zb,[o("div",Pb,[o("div",Lb,E(a(n)("settings.localClientTitle")),1),o("p",Mb,E(a(n)("settings.localClientDesc")),1)]),o("div",Rb,[o("label",Db,[o("span",Bb,E(a(n)("settings.wsAddress")),1),$e(o("input",{"onUpdate:modelValue":ee[17]||(ee[17]=U=>a(p).wsAddress=U),type:"text",class:"w-full px-3 py-2 border rounded focus:ring-2 focus:ring-blue-600 focus:border-blue-600",placeholder:a(n)("settings.localWsAddressPlaceholder")},null,8,Ob),[[De,a(p).wsAddress]])]),o("label",qb,[o("span",Fb,E(a(n)("settings.secretKey")),1),$e(o("input",{"onUpdate:modelValue":ee[18]||(ee[18]=U=>a(p).secretKey=U),type:"text",class:"w-full px-3 py-2 border rounded focus:ring-2 focus:ring-blue-600 focus:border-blue-600"},null,512),[[De,a(p).secretKey]])])]),o("div",Nb,[o("span",jb,E(a(n)("settings.connectionUrl"))+": ",1),o("span",null,E(a(H)),1)]),o("div",Hb,[o("button",{onClick:D,disabled:ne.value||V.value>0||!re.value&&!xe.value,class:_e(["w-full inline-flex items-center justify-center gap-2 px-3 h-9 rounded transition-colors text-sm shadow-sm disabled:opacity-50 disabled:pointer-events-none disabled:cursor-not-allowed",ae(Q.value)])},[re.value?(z(),ze(a(Va),{key:0,class:"w-4 h-4"})):(z(),ze(a(Wa),{key:1,class:"w-4 h-4"})),o("span",null,E(ke.value),1)],10,Ub),V.value>0&&!re.value?(z(),F("div",Vb,[o("span",null,E(a(n)("settings.retrying",{count:V.value,max:10})),1),o("button",{onClick:ee[19]||(ee[19]=(...U)=>a(A)&&a(A)(...U)),class:"text-blue-600 hover:text-blue-700"},E(a(n)("settings.cancelRetry")),1)])):be("",!0)])])):be("",!0),h.value==="remote"?(z(),F("div",Wb,[o("div",Gb,[o("div",Kb,E(a(n)("settings.remoteLoginTitle")),1),o("p",Yb,E(a(n)("settings.remoteLoginDesc")),1)]),o("div",Xb,[o("label",Zb,[o("span",Jb,E(a(n)("settings.apiBaseUrl")),1),$e(o("input",{"onUpdate:modelValue":ee[20]||(ee[20]=U=>a(k).apiBaseUrl=U),type:"text",class:"w-full px-3 py-2 border rounded focus:ring-2 focus:ring-blue-600 focus:border-blue-600",placeholder:a(n)("settings.apiBasePlaceholder")},null,8,Qb),[[De,a(k).apiBaseUrl]])]),o("label",e1,[o("span",t1,E(a(n)("settings.username")),1),$e(o("input",{"onUpdate:modelValue":ee[21]||(ee[21]=U=>a(k).username=U),type:"text",class:"w-full px-3 py-2 border rounded focus:ring-2 focus:ring-blue-600 focus:border-blue-600"},null,512),[[De,a(k).username]])]),o("label",r1,[o("span",n1,E(a(n)("settings.password")),1),$e(o("input",{"onUpdate:modelValue":ee[22]||(ee[22]=U=>a(k).password=U),type:"password",class:"w-full px-3 py-2 border rounded focus:ring-2 focus:ring-blue-600 focus:border-blue-600"},null,512),[[De,a(k).password]])])]),o("div",o1,[o("div",s1,E(a(n)("settings.remoteWsTitle")),1),o("p",a1,E(a(n)("settings.remoteWsDesc")),1)]),o("div",l1,[o("label",i1,[o("span",d1,E(a(n)("settings.wsAddress")),1),$e(o("input",{"onUpdate:modelValue":ee[23]||(ee[23]=U=>a(k).wsAddress=U),type:"text",class:"w-full px-3 py-2 border rounded focus:ring-2 focus:ring-blue-600 focus:border-blue-600",placeholder:a(n)("settings.wsAddressPlaceholder")},null,8,u1),[[De,a(k).wsAddress]])]),o("label",c1,[o("span",h1,E(a(n)("settings.remoteClient")),1),$e(o("select",{"onUpdate:modelValue":ee[24]||(ee[24]=U=>ft(M)?M.value=U:null),class:"w-full px-3 py-2 border rounded bg-white focus:ring-2 focus:ring-blue-600 focus:border-blue-600",disabled:I.value!=="connected"||B.value.length===0},[o("option",f1,E(a(n)("settings.remoteClientPlaceholder")),1),(z(!0),F(Te,null,Le(B.value,U=>(z(),F("option",{key:U.client_id,value:U.client_id,disabled:U.online===!1},E(U.client_name||U.client_id)+E(U.online===!1?" (offline)":""),9,m1))),128))],8,p1),[[Je,a(M)]])])]),o("div",g1,[o("span",v1,E(a(n)("settings.connectionUrl"))+": ",1),o("span",null,E(a(R)),1)]),o("p",b1,E(a(n)("settings.remoteAuthHint")),1),o("div",y1,[o("button",{onClick:le,disabled:ve.value||L.value>0||!Z.value&&!de.value,class:_e(["w-full inline-flex items-center justify-center gap-2 px-3 h-9 rounded transition-colors text-sm shadow-sm disabled:opacity-50 disabled:pointer-events-none disabled:cursor-not-allowed",ae(I.value)])},[Z.value?(z(),ze(a(Va),{key:0,class:"w-4 h-4"})):(z(),ze(a(Wa),{key:1,class:"w-4 h-4"})),o("span",null,E(we.value),1)],10,w1),L.value>0&&!Z.value?(z(),F("div",x1,[o("span",null,E(a(n)("settings.retrying",{count:L.value,max:10})),1),o("button",{onClick:ee[25]||(ee[25]=(...U)=>a(W)&&a(W)(...U)),class:"text-blue-600 hover:text-blue-700"},E(a(n)("settings.cancelRetry")),1)])):be("",!0)])])):be("",!0)]),o("div",_1,[o("button",{onClick:he,class:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 transition-colors text-sm"},E(a(n)("common.close")),1)])])])])):be("",!0)]))}}),S1={class:"h-14 bg-white border-b border-gray-200 flex items-center justify-between px-4 z-[2000] relative shadow-sm"},C1={class:"flex items-center gap-2"},E1=["src"],T1={key:1,class:"font-semibold text-gray-700"},$1=Pe({__name:"Header",setup(r){const{t:e}=Ne(),t=Re(),s=fe(()=>{var d;return((d=t.branding)==null?void 0:d.showLogo)!==!1}),n=fe(()=>{var d;return((d=t.branding)==null?void 0:d.showTitle)!==!1}),l=fe(()=>{var d;return((d=t.branding)==null?void 0:d.logoUrl)||Hl}),i=fe(()=>{var d;return((d=t.branding)==null?void 0:d.title)||e("common.appTitle")});return(d,u)=>(z(),F("header",S1,[o("div",C1,[s.value?(z(),F("img",{key:0,src:l.value,alt:"Logo",class:"w-8 h-8 object-contain"},null,8,E1)):be("",!0),n.value?(z(),F("h1",T1,E(i.value),1)):be("",!0)]),ce(jg,{onToggleHelp:u[0]||(u[0]=g=>a(t).setShowHelp(!0)),onToggleSettings:u[1]||(u[1]=g=>a(t).setShowSettings(!0))}),ce(Pv,{show:a(t).showHelp,"onUpdate:show":u[2]||(u[2]=g=>a(t).setShowHelp(g))},null,8,["show"]),ce(k1,{show:a(t).showSettings,"onUpdate:show":u[3]||(u[3]=g=>a(t).setShowSettings(g))},null,8,["show"])]))}}),I1={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function A1(r,e){return z(),F("svg",I1,[...e[0]||(e[0]=[o("path",{fill:"currentColor",d:"M7 20V7H2V4h13v3h-5v13zm9 0v-8h-3V9h9v3h-3v8z"},null,-1)])])}const Ga=Se({name:"material-symbols-text-fields",render:A1}),z1={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function P1(r,e){return z(),F("svg",z1,[...e[0]||(e[0]=[o("path",{fill:"currentColor",d:"m6 20l1-4H3l.5-2h4l1-4h-4L5 8h4l1-4h2l-1 4h4l1-4h2l-1 4h4l-.5 2h-4l-1 4h4l-.5 2h-4l-1 4h-2l1-4H9l-1 4zm3.5-6h4l1-4h-4z"},null,-1)])])}const Ka=Se({name:"material-symbols-numbers",render:P1}),L1={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function M1(r,e){return z(),F("svg",L1,[...e[0]||(e[0]=[o("path",{fill:"currentColor",d:"M3 8V5q0-.825.588-1.412T5 3h14q.825 0 1.413.588T21 5v3zm2 13q-.825 0-1.412-.587T3 19v-9h4.5v11zm11.5 0V10H21v9q0 .825-.587 1.413T19 21zm-7 0V10h5v11z"},null,-1)])])}const Ya=Se({name:"material-symbols-table-chart",render:M1}),R1={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function D1(r,e){return z(),F("svg",R1,[...e[0]||(e[0]=[o("path",{fill:"currentColor",d:"M1 19V5h2v14zm3 0V5h2v14zm3 0V5h1v14zm3 0V5h2v14zm3 0V5h3v14zm4 0V5h1v14zm3 0V5h3v14z"},null,-1)])])}const Xa=Se({name:"material-symbols-barcode",render:D1}),B1={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function O1(r,e){return z(),F("svg",B1,[...e[0]||(e[0]=[o("path",{fill:"currentColor",d:"M3 11V3h8v8zm2-2h4V5H5zM3 21v-8h8v8zm2-2h4v-4H5zm8-8V3h8v8zm2-2h4V5h-4zm4 12v-2h2v2zm-6-6v-2h2v2zm2 2v-2h2v2zm-2 2v-2h2v2zm2 2v-2h2v2zm2-2v-2h2v2zm0-4v-2h2v2zm2 2v-2h2v2z"},null,-1)])])}const Za=Se({name:"material-symbols-qr-code",render:O1}),q1={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function F1(r,e){return z(),F("svg",q1,[...e[0]||(e[0]=[o("path",{fill:"currentColor",d:"M4 13v-2h16v2z"},null,-1)])])}const Ja=Se({name:"material-symbols-horizontal-rule",render:F1}),N1={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function j1(r,e){return z(),F("svg",N1,[...e[0]||(e[0]=[o("path",{fill:"currentColor",d:"M5 21q-.825 0-1.412-.587T3 19V5q0-.825.588-1.412T5 3h14q.825 0 1.413.588T21 5v14q0 .825-.587 1.413T19 21zm0-2h14V5H5z"},null,-1)])])}const Qa=Se({name:"material-symbols-check-box-outline-blank",render:j1}),H1={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function U1(r,e){return z(),F("svg",H1,[...e[0]||(e[0]=[o("path",{fill:"currentColor",d:"M12 22q-2.075 0-3.9-.788t-3.175-2.137T2.788 15.9T2 12t.788-3.9t2.137-3.175T8.1 2.788T12 2t3.9.788t3.175 2.137T21.213 8.1T22 12t-.788 3.9t-2.137 3.175t-3.175 2.138T12 22m0-2q3.35 0 5.675-2.325T20 12t-2.325-5.675T12 4T6.325 6.325T4 12t2.325 5.675T12 20"},null,-1)])])}const el=Se({name:"material-symbols-radio-button-unchecked",render:U1}),V1={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function W1(r,e){return z(),F("svg",V1,[...e[0]||(e[0]=[o("path",{fill:"currentColor",d:"m5.825 21l1.625-7.025L2 9.25l7.2-.625L12 2l2.8 6.625l7.2.625l-5.45 4.725L18.175 21L12 17.275z"},null,-1)])])}const G1=Se({name:"material-symbols-star",render:W1}),K1={class:"w-64 bg-white border-r border-gray-200 flex flex-col h-full z-40"},Y1={class:"p-4 border-b border-gray-200 bg-gray-50"},X1={class:"font-semibold text-gray-700"},Z1={class:"text-xs text-gray-500 mt-1"},J1={class:"flex border-b border-gray-200 bg-white"},Q1={key:0,class:"absolute bottom-0 left-0 w-full h-0.5 bg-blue-600"},ey={key:0,class:"absolute bottom-0 left-0 w-full h-0.5 bg-blue-600"},ty={class:"flex-1 overflow-y-auto"},ry={class:"text-xs font-semibold text-gray-500 uppercase tracking-wider mb-3 px-1"},ny={class:"grid grid-cols-2 gap-3"},oy=["onDragstart"],sy={class:"text-sm font-medium text-gray-700"},ay={key:0,class:"p-6 text-center"},ly={class:"text-sm text-gray-500"},iy={key:1,class:"p-4 grid grid-cols-2 gap-3"},dy=["onDragstart"],uy=["title"],cy=["onClick","title"],hy=["onClick"],py=["onClick"],fy=["onClick"],my=["onClick"],gy=["onClick"],vy=Pe({__name:"Sidebar",setup(r){const{t:e}=Ne(),t=Re(),s=ie("standard"),n=fe(()=>t.customElements),l=ie(null),i=ie({}),d=ie(!1),u=ie(null),g=ie(""),y=ie(!1),m=ie(""),x=ie(null),p=ie([]),k=[{title:"sidebar.general",items:[{type:ge.TEXT,label:"sidebar.text",icon:Ga},{type:ge.IMAGE,label:"sidebar.image",icon:Fa},{type:ge.PAGE_NUMBER,label:"sidebar.pagination",icon:Ka}]},{title:"sidebar.dataCodes",items:[{type:ge.TABLE,label:"sidebar.table",icon:Ya},{type:ge.BARCODE,label:"sidebar.barcode",icon:Xa},{type:ge.QRCODE,label:"sidebar.qrcode",icon:Za}]},{title:"sidebar.shapes",items:[{type:ge.LINE,label:"sidebar.line",icon:Ja},{type:ge.RECT,label:"sidebar.rect",icon:Qa},{type:ge.CIRCLE,label:"sidebar.circle",icon:el}]}],v=($,O)=>{$.dataTransfer&&($.dataTransfer.setData("application/json",JSON.stringify({type:O})),$.dataTransfer.effectAllowed="copy")},S=($,O)=>{$.dataTransfer&&($.dataTransfer.setData("application/json",JSON.stringify({type:O.element.type,payload:O.element})),$.dataTransfer.effectAllowed="copy")},b=$=>{switch($){case ge.TEXT:return Ga;case ge.IMAGE:return Fa;case ge.TABLE:return Ya;case ge.PAGE_NUMBER:return Ka;case ge.BARCODE:return Xa;case ge.QRCODE:return Za;case ge.LINE:return Ja;case ge.RECT:return Qa;case ge.CIRCLE:return el;default:return G1}},f=($,O)=>{if($.stopPropagation(),l.value===O)l.value=null;else{const w=$.currentTarget.getBoundingClientRect();let Y=w.right-128;Y<5&&(Y=w.left),window.innerHeight-w.bottom<210?i.value={bottom:`${window.innerHeight-w.top+5}px`,left:`${Y}px`}:i.value={top:`${w.bottom+5}px`,left:`${Y}px`},l.value=O}},T=()=>{l.value=null},M=$=>{l.value=null,u.value=$.id,g.value=$.name,d.value=!0},H=$=>{u.value&&$&&t.renameCustomElement(u.value,$)},R=$=>{l.value=null,t.addCustomElement(`${$.name} Copy`,$.element)},A=$=>{l.value=null,confirm(e("sidebar.confirmDelete",{name:$.name}))&&t.removeCustomElement($.id)},W=$=>{if(l.value=null,t.editingCustomElementId!==$.id){if(t.editingCustomElementId&&t.editingCustomElementId!==$.id){const O=t.customElements.find(w=>w.id===t.editingCustomElementId),h=O?O.name:"";if(!confirm(e("sidebar.confirmSwitchEdit",{name:h})))return;t.cancelCustomElementEdit()}t.startCustomElementEdit($.id)}},X=$=>jl($.element),se=$=>{l.value=null,x.value=$;const O=$.testData||{},h=ho($.element,O);p.value=Object.keys(h),m.value=JSON.stringify(h,null,2),y.value=!0},G=()=>{var te;const $=x.value,O=new Set(p.value||[]);if(x.value=null,p.value=[],!$)return;let h=null;try{const Q=((te=m.value)==null?void 0:te.trim())||"{}",I=JSON.parse(Q);I&&typeof I=="object"&&!Array.isArray(I)&&(h=I)}catch{h=null}if(!h){alert(e("common.invalidJson"));return}if(O.size>0){const Q=Object.keys(h);if(Q.length!==O.size||Q.some(V=>!O.has(V))){alert(e("common.testDataKeyChanged"));return}}const w=ho($.element,$.testData||{}),Y={};Object.keys(w).forEach(Q=>{(O.size===0||O.has(Q))&&(Y[Q]=Object.prototype.hasOwnProperty.call(h,Q)?h[Q]:w[Q])}),$.testData=Y,t.saveCustomElements()};return We(()=>{document.addEventListener("click",T)}),Ge(()=>{document.removeEventListener("click",T)}),($,O)=>(z(),F("aside",K1,[o("div",Y1,[o("h2",X1,E(a(e)("sidebar.elements")),1),o("p",Z1,E(a(e)("sidebar.dragToCanvas")),1)]),o("div",J1,[o("button",{onClick:O[0]||(O[0]=h=>s.value="standard"),class:_e(["flex-1 py-3 text-sm font-medium transition-colors relative",s.value==="standard"?"text-blue-600":"text-gray-500 hover:text-gray-700 hover:bg-gray-50"])},[Ce(E(a(e)("sidebar.standard"))+" ",1),s.value==="standard"?(z(),F("div",Q1)):be("",!0)],2),o("button",{onClick:O[1]||(O[1]=h=>s.value="custom"),class:_e(["flex-1 py-3 text-sm font-medium transition-colors relative",s.value==="custom"?"text-blue-600":"text-gray-500 hover:text-gray-700 hover:bg-gray-50"])},[Ce(E(a(e)("sidebar.custom"))+" ",1),s.value==="custom"?(z(),F("div",ey)):be("",!0)],2)]),o("div",ty,[s.value==="standard"?(z(),F(Te,{key:0},Le(k,h=>o("div",{key:h.title,class:"p-4 border-b border-gray-100 last:border-0"},[o("h3",ry,E(a(e)(h.title)),1),o("div",ny,[(z(!0),F(Te,null,Le(h.items,w=>(z(),F("div",{key:w.type,class:"flex flex-col items-center justify-center p-4 border border-gray-200 rounded-lg theme-hover-border theme-hover-bg cursor-move transition-all",draggable:"true",onDragstart:Y=>v(Y,w.type)},[(z(),ze(Rt(w.icon),{class:"w-8 h-8 text-gray-600 mb-2"})),o("span",sy,E(a(e)(w.label)),1)],40,oy))),128))])])),64)):be("",!0),s.value==="custom"?(z(),F(Te,{key:1},[n.value.length===0?(z(),F("div",ay,[o("p",ly,E(a(e)("sidebar.noCustomElements")),1)])):(z(),F("div",iy,[(z(!0),F(Te,null,Le(n.value,h=>(z(),F("div",{key:h.id,class:"group relative flex flex-col items-center justify-center p-4 border border-gray-200 rounded-lg theme-hover-border theme-hover-bg cursor-move transition-all",draggable:"true",onDragstart:w=>S(w,h)},[(z(),ze(Rt(b(h.element.type)),{class:"w-8 h-8 text-gray-600 mb-2"})),o("span",{class:"text-sm font-medium text-gray-700 truncate w-full text-center",title:h.name},E(h.name),9,uy),o("button",{onClick:w=>f(w,h.id),class:_e(["absolute top-1 right-1 p-1 text-gray-400 hover:text-gray-600 rounded-full hover:bg-gray-100 opacity-0 group-hover:opacity-100 transition-opacity",{"opacity-100 bg-gray-100 text-gray-600":l.value===h.id}]),title:a(e)("sidebar.moreOptions")},[ce(a(Nl),{class:"w-4 h-4"})],10,cy)],40,dy))),128))]))],64)):be("",!0)]),(z(),ze(tt,{to:"body"},[l.value?(z(),F("div",{key:0,class:"fixed w-32 bg-white rounded shadow-lg border border-gray-100 z-[2001] py-1",style:ye(i.value),onClick:O[2]||(O[2]=Ke(()=>{},["stop"]))},[(z(!0),F(Te,null,Le(n.value,h=>(z(),F(Te,{key:h.id},[h.id===l.value?(z(),F(Te,{key:0},[o("button",{onClick:w=>W(h),class:"w-full text-left px-3 py-1.5 text-xs text-gray-700 hover:bg-gray-50 flex items-center gap-2"},[ce(a(co),{class:"w-3.5 h-3.5"}),Ce(" "+E(a(e)("sidebar.editElement")),1)],8,hy),X(h)?(z(),F("button",{key:0,onClick:w=>se(h),class:"w-full text-left px-3 py-1.5 text-xs text-gray-700 hover:bg-gray-50 flex items-center gap-2"},[ce(a(ut),{class:"w-3.5 h-3.5"}),Ce(" "+E(a(e)("common.testData")),1)],8,py)):be("",!0),o("button",{onClick:w=>M(h),class:"w-full text-left px-3 py-1.5 text-xs text-gray-700 hover:bg-gray-50 flex items-center gap-2"},[ce(a(co),{class:"w-3.5 h-3.5"}),Ce(" "+E(a(e)("sidebar.rename")),1)],8,fy),o("button",{onClick:w=>R(h),class:"w-full text-left px-3 py-1.5 text-xs text-gray-700 hover:bg-gray-50 flex items-center gap-2"},[ce(a(Ct),{class:"w-3.5 h-3.5"}),Ce(" "+E(a(e)("sidebar.copy")),1)],8,my),o("button",{onClick:w=>A(h),class:"w-full text-left px-3 py-1.5 text-xs text-red-600 hover:bg-red-50 flex items-center gap-2"},[ce(a(St),{class:"w-3.5 h-3.5"}),Ce(" "+E(a(e)("sidebar.delete")),1)],8,gy)],64)):be("",!0)],64))),128))],4)):be("",!0)])),ce(qt,{show:d.value,"initial-value":g.value,title:a(e)("sidebar.renameModalTitle"),placeholder:a(e)("sidebar.enterNamePlaceholder"),onClose:O[3]||(O[3]=h=>d.value=!1),onSave:H},null,8,["show","initial-value","title","placeholder"]),ce(Ot,{visible:y.value,"onUpdate:visible":O[4]||(O[4]=h=>y.value=h),title:a(e)("common.testData"),value:m.value,language:"json","onUpdate:value":O[5]||(O[5]=h=>m.value=h),onClose:G},null,8,["visible","title","value"])]))}}),by={sections:[{title:"properties.section.content",tab:"properties",fields:[{label:"properties.label.content",type:"textarea",target:"element",key:"content",placeholder:"properties.label.textContentPlaceholder"},{label:"properties.label.variable",type:"text",target:"element",key:"variable",placeholder:"@variable"}]},{title:"properties.section.typography",tab:"style",fields:[{label:"properties.label.writingMode",type:"select",target:"style",key:"writingMode",options:[{label:"properties.option.horizontal",value:"horizontal-tb"},{label:"properties.option.vertical",value:"vertical-rl"}]},{label:"properties.label.fontSize",type:"number",target:"style",key:"fontSize",min:8,max:96,step:1},{label:"properties.label.color",type:"color",target:"style",key:"color"},{label:"properties.label.textAlign",type:"select",target:"style",key:"textAlign",options:[{label:"properties.option.default",value:""},{label:"properties.option.left",value:"left"},{label:"properties.option.center",value:"center"},{label:"properties.option.right",value:"right"}]},{label:"properties.label.fontFamily",type:"select",target:"style",key:"fontFamily",options:[{label:"properties.option.default",value:""},{label:"properties.option.arial",value:"Arial, sans-serif"},{label:"properties.option.timesNewRoman",value:'"Times New Roman", serif'},{label:"properties.option.courierNew",value:'"Courier New", monospace'},{label:"properties.option.simSun",value:"SimSun, serif"},{label:"properties.option.simHei",value:"SimHei, sans-serif"}]},{label:"properties.label.fontWeight",type:"select",target:"style",key:"fontWeight",options:[{label:"properties.option.default",value:""},{label:"properties.option.normal",value:"400"},{label:"properties.option.medium",value:"500"},{label:"properties.option.bold",value:"700"}]}]},{title:"properties.section.border",tab:"style",fields:[{label:"properties.label.borderStyle",type:"select",target:"style",key:"borderStyle",options:[{label:"properties.option.none",value:"none"},{label:"properties.option.solid",value:"solid"},{label:"properties.option.dashed",value:"dashed"},{label:"properties.option.dotted",value:"dotted"}]},{label:"properties.label.borderWidth",type:"number",target:"style",key:"borderWidth",min:0,max:20,step:1},{label:"properties.label.borderColor",type:"color",target:"style",key:"borderColor"}]}]},tl=Pe({__name:"TextElement",props:{element:{}},setup(r){const e=r,t=Re(),s=fe(()=>{const n=e.element.variable||"";if(t.isExporting&&n){const l=Ft(n);if(l&&Object.prototype.hasOwnProperty.call(t.testData,l)){const i=t.testData[l];if(i!=null)return String(i)}}return e.element.variable||e.element.content||"Double click to edit"});return(n,l)=>(z(),F("div",{class:"w-full h-full overflow-hidden",style:ye({fontSize:`${r.element.style.fontSize}px`,fontFamily:r.element.style.fontFamily,fontWeight:r.element.style.fontWeight,fontStyle:r.element.style.fontStyle,textAlign:r.element.style.textAlign,textDecoration:r.element.style.textDecoration,color:r.element.style.color,padding:`${r.element.style.padding}px`,writingMode:r.element.style.writingMode||"horizontal-tb"})},E(s.value),5))}}),yy={class:"w-full h-full overflow-hidden bg-gray-50 flex items-center justify-center"},wy=["src"],xy={key:1,class:"text-gray-400 text-xs"},_y={sections:[{title:"properties.section.imageSource",tab:"properties",fields:[{label:"properties.label.imageSource",type:"image",target:"element",key:"content"}]},{title:"properties.section.border",tab:"style",fields:[{label:"properties.label.borderStyle",type:"select",target:"style",key:"borderStyle",options:[{label:"properties.option.none",value:"none"},{label:"properties.option.solid",value:"solid"},{label:"properties.option.dashed",value:"dashed"},{label:"properties.option.dotted",value:"dotted"}]},{label:"properties.label.borderWidth",type:"number",target:"style",key:"borderWidth",min:0,max:20,step:1},{label:"properties.label.borderColor",type:"color",target:"style",key:"borderColor"}]}]},ky=Pe({__name:"ImageElement",props:{element:{}},setup(r){return(e,t)=>(z(),F("div",yy,[r.element.content?(z(),F("img",{key:0,src:r.element.content,class:"w-full h-full object-contain pointer-events-none",alt:"Element"},null,8,wy)):(z(),F("span",xy,"No Image"))]))}}),Sy=["data-tfoot-repeat","data-auto-paginate","data-custom-script"],Cy=["onDblclick"],Ey=["onMousedown"],Ty=["rowspan","colspan","data-field","onMousedown","onMouseover"],$y={key:0},Iy=["colspan"],Ay={key:1,class:"h-full border-none bg-transparent"},zy=["colspan"],Py={key:0},Ly=["rowspan","colspan","data-field","data-value","onMousedown","onMouseover","onDblclick"],My={class:"text-sm font-semibold text-gray-700"},Ry={class:"flex flex-col gap-1"},Dy={class:"text-xs text-gray-500"},By=["placeholder"],Oy={class:"flex flex-col gap-1"},qy={class:"text-xs text-gray-500"},Fy=["placeholder"],Ny={class:"flex flex-col gap-1"},jy={class:"text-xs text-gray-500"},Hy=["placeholder"],Uy={class:"flex flex-col gap-1"},Vy={class:"text-xs text-gray-500"},Wy=["placeholder"],Gy={class:"flex justify-end gap-2 mt-1"},Ky={sections:[{title:"properties.section.dataBehavior",tab:"properties",fields:[{label:"properties.label.autoPaginate",type:"switch",target:"element",key:"autoPaginate"},{label:"properties.label.repeatFooter",type:"switch",target:"element",key:"tfootRepeat"},{label:"properties.label.showFooter",type:"switch",target:"element",key:"showFooter"},{label:"properties.label.variable",type:"text",target:"element",key:"variable",placeholder:"@variable"},{label:"properties.label.columns",type:"code",language:"json",target:"element",key:"columns",placeholder:"properties.label.columnsPlaceholder"},{label:"properties.label.data",type:"code",language:"json",target:"element",key:"data",placeholder:"properties.label.dataPlaceholder"},{label:"properties.label.footerData",type:"code",language:"json",target:"element",key:"footerData",placeholder:"properties.label.footerDataPlaceholder"},{label:"properties.label.customScript",type:"code",language:"javascript",target:"element",key:"customScript",placeholder:"properties.label.customScriptPlaceholder"}]},{title:"properties.section.layoutDimensions",tab:"style",fields:[{label:"properties.label.headerHeight",type:"number",target:"style",key:"headerHeight",min:20,max:200,step:1},{label:"properties.label.rowHeight",type:"number",target:"style",key:"rowHeight",min:20,max:200,step:1},{label:"properties.label.footerHeight",type:"number",target:"style",key:"footerHeight",min:20,max:200,step:1}]},{title:"properties.section.appearance",tab:"style",fields:[{label:"properties.label.backgroundColor",type:"color",target:"style",key:"backgroundColor"},{label:"properties.label.textColor",type:"color",target:"style",key:"color"}]},{title:"properties.section.headerStyle",tab:"style",fields:[{label:"properties.label.background",type:"color",target:"style",key:"headerBackgroundColor"},{label:"properties.label.textColor",type:"color",target:"style",key:"headerColor"},{label:"properties.label.fontSize",type:"number",target:"style",key:"headerFontSize",min:8,max:72,step:1}]},{title:"properties.section.footerStyle",tab:"style",fields:[{label:"properties.label.background",type:"color",target:"style",key:"footerBackgroundColor"},{label:"properties.label.textColor",type:"color",target:"style",key:"footerColor"},{label:"properties.label.fontSize",type:"number",target:"style",key:"footerFontSize",min:8,max:72,step:1}]},{title:"properties.section.border",tab:"style",fields:[{label:"properties.label.borderStyle",type:"select",target:"style",key:"borderStyle",options:[{label:"properties.option.none",value:"none"},{label:"properties.option.solid",value:"solid"},{label:"properties.option.dashed",value:"dashed"},{label:"properties.option.dotted",value:"dotted"}]},{label:"properties.label.borderWidth",type:"number",target:"style",key:"borderWidth",min:0,max:20,step:1},{label:"properties.label.borderColor",type:"color",target:"style",key:"borderColor"}]}]},Yy=Pe({__name:"TableElement",props:{element:{}},setup(r){const e=r,{t}=Ne(),s=Re();function n(I,V,L="body"){var B;return s.tableSelection&&s.tableSelection.elementId!==e.element.id?!1:((B=s.tableSelection)==null?void 0:B.cells.some(re=>re.rowIndex===I&&re.colField===V&&(re.section||"body")===L))??!1}const l=ie(null),i=ie(null),d=ie({header:"",field:"",value:"",variable:""}),u=ie({top:0,left:0}),g=ie(null),y=async(I,V)=>{if(s.selectedElementId!==e.element.id||e.element.locked)return;const L=b.value.columns[V];if(L){if(l.value=V,i.value=null,d.value={header:L.header,field:L.field,value:"",variable:""},u.value={top:I.clientY+10,left:I.clientX+10},await Xe(),g.value){const B=g.value.getBoundingClientRect(),re=window.innerWidth,Z=window.innerHeight;u.value.left+B.width>re&&(u.value.left=re-B.width-20),u.value.top+B.height>Z&&(u.value.top=Z-B.height-20)}setTimeout(()=>{window.addEventListener("click",x)},100)}},m=async(I,V,L)=>{if(s.selectedElementId!==e.element.id||e.element.locked)return;const B=b.value.footerData[V];if(!B)return;const re=B[L];let Z="",ne="";if(re&&typeof re=="object"&&(Z=re.value||"",ne=re.field||""),i.value={rowIndex:V,colField:L},l.value=null,d.value={header:"",field:L,value:Z,variable:ne},u.value={top:I.clientY+10,left:I.clientX+10},await Xe(),g.value){const ve=g.value.getBoundingClientRect(),xe=window.innerWidth,de=window.innerHeight;u.value.left+ve.width>xe&&(u.value.left=xe-ve.width-20),u.value.top+ve.height>de&&(u.value.top=de-ve.height-20)}setTimeout(()=>{window.addEventListener("click",x)},100)},x=I=>{g.value&&!g.value.contains(I.target)&&p()},p=()=>{l.value=null,i.value=null,window.removeEventListener("click",x)},k=()=>{if(l.value!==null){const I=e.element.columns?[...e.element.columns]:[];if(I.length===0&&b.value.columns.length>0){const V=JSON.parse(JSON.stringify(b.value.columns));V[l.value]&&(V[l.value].header=d.value.header,V[l.value].field=d.value.field,s.updateElement(e.element.id,{columns:V})),p();return}l.value<I.length&&(I[l.value]={...I[l.value],header:d.value.header,field:d.value.field},s.updateElement(e.element.id,{columns:I}))}else if(i.value){const{rowIndex:I,colField:V}=i.value,L=e.element.footerData?JSON.parse(JSON.stringify(e.element.footerData)):[];if(!L[I])return;const B=L[I],re=B[V];re&&typeof re=="object"?(re.value=d.value.value,re.field=d.value.variable):B[V]={value:d.value.value,field:d.value.variable},s.updateElement(e.element.id,{footerData:L})}p()},v=ie(!1),S=ie(null),b=fe(()=>{const I=e.element.columns||[];let V=e.element.data||[],L=e.element.footerData||[];if(s.isExporting&&e.element.variable){const Z=Ft(e.element.variable),ne=s.testData||{},ve=Z?ne[Z]:void 0;Array.isArray(ve)&&(V=Ee(ve))}if(e.element.customScript)try{const ne=new Function("data","footerData","columns","type",e.element.customScript)(Ee(V),Ee(L),Ee(I),"global");if(ne&&(ne.data&&(V=ne.data),ne.footerData&&(L=ne.footerData),ne.columns))return{...ne,columns:ne.columns}}catch(Z){console.error("Custom script error",Z)}const B=Ee(L),re=I.map(Z=>Z.field);return B.forEach(Z=>{Object.keys(Z).forEach(ne=>{const ve=Z[ne];if(ve&&typeof ve=="object"&&ve.field&&re.includes(ve.field)){const xe=ve.field,de=V.reduce((ke,we)=>{const ae=parseFloat(we[xe]);return ke+(isNaN(ae)?0:ae)},0);ve.result=de}})}),{columns:I,data:V,footerData:B}}),f=fe(()=>({color:e.element.style.color||"#000000",fontFamily:e.element.style.fontFamily,borderColor:e.element.style.borderColor||"#000",borderWidth:(e.element.style.borderWidth||1)+"px",borderStyle:e.element.style.borderStyle||"solid"})),T=(I,V)=>{if(!I)return"";const L=I[V];if(L&&typeof L=="object"){const B=L.value||"",re=L.printValue!==void 0?L.printValue:L.result!==void 0?L.result:"";return B+re}return L},M=(I,V)=>{if(!I)return"";const L=I[V];if(L&&typeof L=="object"){const B=L.value||"",re=L.result!==void 0?L.result:L.printValue!==void 0?L.printValue:"";return B+re}return L},H=(I,V)=>{const L=I[V];return L&&typeof L=="object"&&"rowSpan"in L?L.rowSpan:1},R=(I,V)=>{const L=I[V];return L&&typeof L=="object"&&"colSpan"in L?L.colSpan:1},A=(I,V)=>{const L=I[V];return!(L&&typeof L=="object"&&(L.rowSpan===0||L.colSpan===0))},W=(I,V)=>{const L=I[V];return L&&typeof L=="object"&&L.style?L.style:{}},X=ie({}),se=ie(null),G=ie(0),$=ie(0),O=(I,V)=>{if(e.element.locked)return;I.preventDefault(),I.stopPropagation(),se.value=V,G.value=I.clientX;const L=b.value.columns[V];$.value=L.width||100,window.addEventListener("mousemove",h),window.addEventListener("mouseup",w)},h=I=>{if(se.value===null)return;const V=I.clientX-G.value,L=Math.max(20,$.value+V),B=b.value.columns[se.value];X.value[B.field]=L},w=()=>{if(se.value!==null){const I=b.value.columns[se.value],V=X.value[I.field];if(V){const L=[...e.element.columns||[]];L[se.value]&&(L[se.value]={...L[se.value],width:V},s.updateElement(e.element.id,{columns:L}))}}se.value=null,X.value={},window.removeEventListener("mousemove",h),window.removeEventListener("mouseup",w)},Y=(I,V,L,B="body")=>{s.selectedElementId===e.element.id&&(I.stopPropagation(),v.value=!0,S.value={rowIndex:V,colField:L,section:B},s.setTableSelection(e.element.id,{rowIndex:V,colField:L,section:B},!1))},te=(I,V,L="body")=>{if(!v.value||!S.value||S.value.section!==L)return;const B=S.value.rowIndex,re=I,Z=b.value.columns.findIndex(ae=>ae.field===S.value.colField),ne=b.value.columns.findIndex(ae=>ae.field===V);if(Z===-1||ne===-1)return;const ve=Math.min(B,re),xe=Math.max(B,re),de=Math.min(Z,ne),ke=Math.max(Z,ne),we=[];for(let ae=ve;ae<=xe;ae++)for(let K=de;K<=ke;K++)we.push({rowIndex:ae,colField:b.value.columns[K].field,section:L});s.setTableSelectionCells(e.element.id,we)},Q=()=>{v.value=!1,S.value=null};return We(()=>{window.addEventListener("mouseup",Q)}),Ge(()=>{window.removeEventListener("mouseup",Q)}),(I,V)=>(z(),F("div",{class:"w-full h-full overflow-hidden",style:ye({backgroundColor:r.element.style.backgroundColor||"transparent"})},[o("table",{class:_e(["w-full border-collapse",{"h-full":!a(s).isExporting}]),"data-tfoot-repeat":r.element.tfootRepeat,"data-auto-paginate":r.element.autoPaginate,"data-custom-script":r.element.customScript},[o("thead",null,[o("tr",null,[(z(!0),F(Te,null,Le(b.value.columns,(L,B)=>(z(),F("th",{key:L.field,class:"p-1 text-left font-bold text-sm relative group select-none",style:ye({...f.value,width:`${X.value[L.field]||L.width}px`,height:r.element.style.headerHeight?`${r.element.style.headerHeight}px`:void 0,backgroundColor:r.element.style.headerBackgroundColor||"#f3f4f6",color:r.element.style.headerColor||"#000000",fontSize:r.element.style.headerFontSize?`${r.element.style.headerFontSize}px`:void 0,cursor:a(s).selectedElementId===r.element.id?"pointer":"default"}),onDblclick:re=>y(re,B)},[Ce(E(L.header)+" ",1),a(s).selectedElementId===r.element.id&&B<b.value.columns.length-1&&!r.element.locked?(z(),F("div",{key:0,class:_e(["absolute -right-1 top-0 bottom-0 w-2 cursor-col-resize hover:bg-blue-400 opacity-0 hover:opacity-100 z-10 transition-opacity",{"bg-blue-400 opacity-100":se.value===B}]),onMousedown:re=>O(re,B),onClick:V[0]||(V[0]=Ke(()=>{},["stop"]))},null,42,Ey)):be("",!0)],44,Cy))),128))])]),o("tbody",null,[(z(!0),F(Te,null,Le(a(s).isExporting?b.value.data:b.value.data.slice(0,5),(L,B)=>(z(),F("tr",{key:B},[(z(!0),F(Te,null,Le(b.value.columns,re=>(z(),F(Te,{key:re.field},[A(L,re.field)?(z(),F("td",{key:0,class:_e(["p-1 text-sm select-none",{"bg-blue-100 ring-1 ring-blue-400":n(B,re.field)}]),style:ye({...f.value,...W(L,re.field),height:r.element.style.rowHeight?`${r.element.style.rowHeight}px`:void 0}),rowspan:H(L,re.field),colspan:R(L,re.field),"data-field":re.field,onMousedown:Z=>Y(Z,B,re.field),onMouseover:Z=>te(B,re.field)},E(M(L,re.field)),47,Ty)):be("",!0)],64))),128))]))),128)),!a(s).isExporting&&b.value.data.length>5?(z(),F("tr",$y,[o("td",{colspan:b.value.columns.length,class:"p-1 text-center text-gray-500 select-none",style:ye({...f.value,height:r.element.style.rowHeight?`${r.element.style.rowHeight}px`:void 0})}," ... ",12,Iy)])):be("",!0),a(s).isExporting?be("",!0):(z(),F("tr",Ay,[o("td",{colspan:b.value.columns.length||1,class:"border-none p-0"},null,8,zy)]))]),r.element.showFooter?(z(),F("tfoot",Py,[(z(!0),F(Te,null,Le(b.value.footerData,(L,B)=>(z(),F("tr",{key:B},[(z(!0),F(Te,null,Le(b.value.columns,re=>(z(),F(Te,{key:re.field},[A(L,re.field)?(z(),F("td",{key:0,class:_e(["p-1 text-sm font-bold select-none",{"!bg-blue-100 ring-1 ring-blue-400":n(B,re.field,"footer")}]),style:ye({...f.value,...W(L,re.field),height:r.element.style.footerHeight?`${r.element.style.footerHeight}px`:void 0,backgroundColor:r.element.style.footerBackgroundColor||"#f9fafb",color:r.element.style.footerColor||"#000000",fontSize:r.element.style.footerFontSize?`${r.element.style.footerFontSize}px`:void 0,cursor:a(s).selectedElementId===r.element.id?"pointer":"default"}),rowspan:H(L,re.field),colspan:R(L,re.field),"data-field":re.field,"data-value":T(L,re.field),onMousedown:Z=>Y(Z,B,re.field,"footer"),onMouseover:Z=>te(B,re.field,"footer"),onDblclick:Z=>m(Z,B,re.field)},E(M(L,re.field)),47,Ly)):be("",!0)],64))),128))]))),128))])):be("",!0)],10,Sy),(z(),ze(tt,{to:"body"},[l.value!==null||i.value?(z(),F("div",{key:0,ref_key:"editFormRef",ref:g,class:"fixed z-[9999] bg-white shadow-xl border border-gray-200 rounded-lg p-4 w-64 flex flex-col gap-3",style:ye({top:`${u.value.top}px`,left:`${u.value.left}px`}),onClick:V[5]||(V[5]=Ke(()=>{},["stop"]))},[o("h4",My,E(i.value?a(t)("properties.label.editCell"):a(t)("properties.label.editColumn")),1),l.value!==null?(z(),F(Te,{key:0},[o("div",Ry,[o("label",Dy,E(a(t)("properties.label.headerText")),1),$e(o("input",{"onUpdate:modelValue":V[1]||(V[1]=L=>d.value.header=L),class:"border border-gray-300 rounded px-2 py-1 text-sm focus:border-blue-500 focus:outline-none",placeholder:a(t)("properties.label.headerNamePlaceholder"),onKeydown:wt(k,["enter"]),autoFocus:""},null,40,By),[[De,d.value.header]])]),o("div",Oy,[o("label",qy,E(a(t)("properties.label.fieldKey")),1),$e(o("input",{"onUpdate:modelValue":V[2]||(V[2]=L=>d.value.field=L),class:"border border-gray-300 rounded px-2 py-1 text-sm focus:border-blue-500 focus:outline-none",placeholder:a(t)("properties.label.fieldKey"),onKeydown:wt(k,["enter"])},null,40,Fy),[[De,d.value.field]])])],64)):be("",!0),i.value?(z(),F(Te,{key:1},[o("div",Ny,[o("label",jy,E(a(t)("properties.label.content")),1),$e(o("input",{"onUpdate:modelValue":V[3]||(V[3]=L=>d.value.value=L),class:"border border-gray-300 rounded px-2 py-1 text-sm focus:border-blue-500 focus:outline-none",placeholder:a(t)("properties.label.displayTextPlaceholder"),onKeydown:wt(k,["enter"]),autoFocus:""},null,40,Hy),[[De,d.value.value]])]),o("div",Uy,[o("label",Vy,E(a(t)("properties.label.variableField")),1),$e(o("input",{"onUpdate:modelValue":V[4]||(V[4]=L=>d.value.variable=L),class:"border border-gray-300 rounded px-2 py-1 text-sm focus:border-blue-500 focus:outline-none",placeholder:a(t)("properties.label.dataFieldPlaceholder"),onKeydown:wt(k,["enter"])},null,40,Wy),[[De,d.value.variable]])])],64)):be("",!0),o("div",Gy,[o("button",{onClick:p,class:"px-3 py-1 text-xs text-gray-600 hover:bg-gray-100 rounded"},E(a(t)("common.cancel")),1),o("button",{onClick:k,class:"px-3 py-1 text-xs bg-blue-600 text-white hover:bg-blue-700 rounded"},E(a(t)("common.save")),1)])],4)):be("",!0)]))],4))}}),Xy={class:"page-number-text"},Zy={sections:[{title:"properties.section.labelContent",tab:"properties",fields:[{label:"properties.label.labelText",type:"text",target:"element",key:"labelText",placeholder:"properties.label.labelTextPlaceholder"},{label:"properties.label.labelPosition",type:"select",target:"element",key:"labelPosition",options:[{label:"properties.option.before",value:"before"},{label:"properties.option.after",value:"after"}]},{label:"properties.label.pageFormat",type:"select",target:"element",key:"format",options:[{label:"properties.option.numberOnly",value:"1"},{label:"properties.option.page1",value:"Page 1"},{label:"properties.option.oneTotal",value:"1/Total"}]}]},{title:"properties.section.paginationTypography",tab:"style",fields:[{label:"properties.label.fontSize",type:"number",target:"style",key:"fontSize",min:8,max:96,step:1},{label:"properties.label.color",type:"color",target:"style",key:"color"},{label:"properties.label.textAlign",type:"select",target:"style",key:"textAlign",options:[{label:"properties.option.default",value:""},{label:"properties.option.left",value:"left"},{label:"properties.option.center",value:"center"},{label:"properties.option.right",value:"right"}]},{label:"properties.label.fontFamily",type:"select",target:"style",key:"fontFamily",options:[{label:"properties.option.default",value:""},{label:"properties.option.arial",value:"Arial, sans-serif"},{label:"properties.option.timesNewRoman",value:'"Times New Roman", serif'},{label:"properties.option.courierNew",value:'"Courier New", monospace'},{label:"properties.option.simSun",value:"SimSun, serif"},{label:"properties.option.simHei",value:"SimHei, sans-serif"}]},{label:"properties.label.fontWeight",type:"select",target:"style",key:"fontWeight",options:[{label:"properties.option.default",value:""},{label:"properties.option.normal",value:"400"},{label:"properties.option.medium",value:"500"},{label:"properties.option.bold",value:"700"}]}]},{title:"properties.section.labelStyle",tab:"style",fields:[{label:"properties.label.labelFontSize",type:"number",target:"element",key:"labelFontSize",min:8,max:96,step:1},{label:"properties.label.labelColor",type:"color",target:"element",key:"labelColor"},{label:"properties.label.labelFontFamily",type:"select",target:"element",key:"labelFontFamily",options:[{label:"properties.option.default",value:""},{label:"properties.option.arial",value:"Arial, sans-serif"},{label:"properties.option.timesNewRoman",value:'"Times New Roman", serif'},{label:"properties.option.courierNew",value:'"Courier New", monospace'},{label:"properties.option.simSun",value:"SimSun, serif"},{label:"properties.option.simHei",value:"SimHei, sans-serif"}]},{label:"properties.label.labelFontWeight",type:"select",target:"element",key:"labelFontWeight",options:[{label:"properties.option.default",value:""},{label:"properties.option.normal",value:"400"},{label:"properties.option.medium",value:"500"},{label:"properties.option.bold",value:"700"}]},{label:"properties.label.labelBackgroundColor",type:"color",target:"element",key:"labelBackgroundColor"},{label:"properties.label.labelBorderStyle",type:"select",target:"element",key:"labelBorderStyle",options:[{label:"properties.option.none",value:""},{label:"properties.option.solid",value:"solid"},{label:"properties.option.dashed",value:"dashed"},{label:"properties.option.dotted",value:"dotted"}]},{label:"properties.label.labelBorderWidth",type:"number",target:"element",key:"labelBorderWidth",min:0,max:20,step:1},{label:"properties.label.labelBorderColor",type:"color",target:"element",key:"labelBorderColor"}]},{title:"properties.section.frameBorder",tab:"style",fields:[{label:"properties.label.borderStyle",type:"select",target:"style",key:"borderStyle",options:[{label:"properties.option.none",value:"none"},{label:"properties.option.solid",value:"solid"},{label:"properties.option.dashed",value:"dashed"},{label:"properties.option.dotted",value:"dotted"}]},{label:"properties.label.borderWidth",type:"number",target:"style",key:"borderWidth",min:0,max:20,step:1},{label:"properties.label.borderColor",type:"color",target:"style",key:"borderColor"}]}]},Jy=Pe({__name:"PageNumberElement",props:{element:{},pageIndex:{},totalPages:{}},setup(r){const e=r,{t}=Ne(),s=fe(()=>{const n=e.pageIndex+1,l=e.totalPages||1;switch(e.element.format||"1/Total"){case"1":return`${n}`;case"Page 1":return t("properties.option.page1").replace("1",n.toString());case"1/Total":return`${n}/${l}`;default:return`${n}/${l}`}});return(n,l)=>(z(),F("div",{class:"w-full h-full overflow-hidden","data-print-type":"page-number",style:ye({fontSize:`${r.element.style.fontSize}px`,fontFamily:r.element.style.fontFamily,fontWeight:r.element.style.fontWeight,fontStyle:r.element.style.fontStyle,textAlign:r.element.style.textAlign,color:r.element.style.color,padding:`${r.element.style.padding||0}px`})},[r.element.labelText&&r.element.labelPosition!=="after"?(z(),F("span",{key:0,style:ye({fontSize:r.element.labelFontSize?`${r.element.labelFontSize}px`:void 0,fontFamily:r.element.labelFontFamily||void 0,fontWeight:r.element.labelFontWeight||void 0,color:r.element.labelColor||void 0,backgroundColor:r.element.labelBackgroundColor||"transparent",borderStyle:r.element.labelBorderStyle||"none",borderWidth:`${r.element.labelBorderWidth||0}px`,borderColor:r.element.labelBorderColor||"transparent",marginRight:"4px",padding:"0 4px"})},E(r.element.labelText),5)):be("",!0),o("span",Xy,E(s.value),1),r.element.labelText&&r.element.labelPosition==="after"?(z(),F("span",{key:1,style:ye({fontSize:r.element.labelFontSize?`${r.element.labelFontSize}px`:void 0,fontFamily:r.element.labelFontFamily||void 0,fontWeight:r.element.labelFontWeight||void 0,color:r.element.labelColor||void 0,backgroundColor:r.element.labelBackgroundColor||"transparent",borderStyle:r.element.labelBorderStyle||"none",borderWidth:`${r.element.labelBorderWidth||0}px`,borderColor:r.element.labelBorderColor||"transparent",marginLeft:"4px",padding:"0 4px"})},E(r.element.labelText),5)):be("",!0)],4))}});var Qy=ti();const Ul=_t(Qy),e2={class:"w-full h-full flex items-center justify-center overflow-hidden"},t2={sections:[{title:"properties.section.content",tab:"properties",fields:[{label:"properties.label.content",type:"text",target:"element",key:"content",placeholder:"properties.label.barcodeContentPlaceholder"},{label:"properties.label.variable",type:"text",target:"element",key:"variable",placeholder:"@variable"}]},{title:"properties.section.barcodeSettings",tab:"style",fields:[{label:"properties.label.format",type:"select",target:"style",key:"barcodeFormat",options:[{label:"properties.option.code128",value:"CODE128"},{label:"properties.option.ean13",value:"EAN13"},{label:"properties.option.upc",value:"UPC"},{label:"properties.option.code39",value:"CODE39"},{label:"properties.option.itf14",value:"ITF14"},{label:"properties.option.msi",value:"MSI"},{label:"properties.option.pharmacode",value:"pharmacode"}]},{label:"properties.label.showText",type:"select",target:"style",key:"showText",options:[{label:"properties.option.yes",value:!0},{label:"properties.option.no",value:!1}]},{label:"properties.label.color",type:"color",target:"style",key:"color"},{label:"properties.label.lineWidth",type:"number",target:"style",key:"barcodeWidth",placeholder:"2"},{label:"properties.label.barcodeHeight",type:"number",target:"style",key:"barcodeHeight",placeholder:"40"},{label:"properties.label.margin",type:"number",target:"style",key:"margin",placeholder:"0"},{label:"properties.label.fontSize",type:"number",target:"style",key:"fontSize",placeholder:"20"},{label:"properties.label.textPosition",type:"select",target:"style",key:"textPosition",options:[{label:"properties.option.bottom",value:"bottom"},{label:"properties.option.top",value:"top"}]},{label:"properties.label.textAlign",type:"select",target:"style",key:"textAlign",options:[{label:"properties.option.left",value:"left"},{label:"properties.option.center",value:"center"},{label:"properties.option.right",value:"right"}]}]}]},r2=Pe({__name:"BarcodeElement",props:{element:{}},setup(r){const e=r,t=Re(),s=ie(null),n=fe(()=>{const i=e.element.variable||"";if(t.isExporting&&i){const d=Ft(i);if(d&&Object.prototype.hasOwnProperty.call(t.testData,d)){const u=t.testData[d];if(u!=null)return String(u)}}return e.element.variable||e.element.content||"12345678"}),l=()=>{if(s.value)try{const i=n.value,d=e.element.style;Ul(s.value,i,{format:d.barcodeFormat||"CODE128",lineColor:d.color||"#000000",width:Number(d.barcodeWidth)||2,height:Number(d.barcodeHeight)||40,displayValue:d.showText!==!1&&d.showText!=="false",fontOptions:d.fontOptions||"",font:d.font||"monospace",textAlign:d.textAlign||"center",textPosition:d.textPosition||"bottom",textMargin:Number(d.textMargin)||2,fontSize:Number(d.fontSize)||20,background:"transparent",margin:Number(d.margin)||0})}catch(i){console.error("Barcode render error",i)}};return We(()=>{Xe(l)}),Ae(()=>[e.element.content,e.element.variable,e.element.style,t.isExporting,t.testData],()=>{Xe(l)},{deep:!0}),(i,d)=>(z(),F("div",e2,[o("img",{ref_key:"barcodeRef",ref:s,class:"w-full h-full object-contain pointer-events-none"},null,512)]))}});var n2=ri();const Vl=_t(n2),o2={class:"w-full h-full flex items-center justify-center overflow-hidden"},s2=["src"],a2={sections:[{title:"properties.section.content",tab:"properties",fields:[{label:"properties.label.content",type:"text",target:"element",key:"content",placeholder:"properties.label.qrContentPlaceholder"},{label:"properties.label.variable",type:"text",target:"element",key:"variable",placeholder:"@variable"}]},{title:"properties.section.qrSettings",tab:"style",fields:[{label:"properties.label.errorCorrection",type:"select",target:"style",key:"qrErrorCorrection",options:[{label:"properties.option.eccLow",value:"L"},{label:"properties.option.eccMedium",value:"M"},{label:"properties.option.eccQuartile",value:"Q"},{label:"properties.option.eccHigh",value:"H"}]},{label:"properties.label.color",type:"color",target:"style",key:"color"}]}]},l2=Pe({__name:"QRCodeElement",props:{element:{}},setup(r){const e=r,t=Re(),s=ie(""),n=fe(()=>{const i=e.element.variable||"";if(t.isExporting&&i){const d=Ft(i);if(d&&Object.prototype.hasOwnProperty.call(t.testData,d)){const u=t.testData[d];if(u!=null)return String(u)}}return e.element.variable||e.element.content||"https://example.com"}),l=async()=>{try{const i=n.value;s.value=await Vl.toDataURL(i,{margin:0,color:{dark:e.element.style.color||"#000000",light:"#00000000"},errorCorrectionLevel:e.element.style.qrErrorCorrection||"M"})}catch(i){console.error("QR render error",i)}};return We(()=>Xe(l)),Ae(()=>[e.element.content,e.element.variable,e.element.style,t.isExporting,t.testData],()=>Xe(l),{deep:!0}),(i,d)=>(z(),F("div",o2,[s.value?(z(),F("img",{key:0,src:s.value,class:"w-full h-full object-contain pointer-events-none",draggable:"false"},null,8,s2)):be("",!0)]))}}),i2={class:"w-full h-full flex items-center justify-center"},d2={sections:[{title:"properties.section.lineStyle",tab:"style",fields:[{label:"properties.label.color",type:"color",target:"style",key:"borderColor",defaultValue:"#000000"},{label:"properties.label.thickness",type:"number",target:"style",key:"borderWidth",min:1,max:100,step:1,defaultValue:1},{label:"properties.label.borderStyle",type:"select",target:"style",key:"borderStyle",defaultValue:"solid",options:[{label:"properties.option.solid",value:"solid"},{label:"properties.option.dashed",value:"dashed"},{label:"properties.option.dotted",value:"dotted"}]}]}]},u2=Pe({__name:"LineElement",props:{element:{}},setup(r){return(e,t)=>(z(),F("div",i2,[o("div",{class:"w-full",style:ye({borderTopWidth:`${r.element.style.borderWidth||1}px`,borderTopStyle:r.element.style.borderStyle||"solid",borderTopColor:r.element.style.borderColor||"#000000"})},null,4)]))}}),c2={sections:[{title:"properties.section.appearance",tab:"style",fields:[{label:"properties.label.background",type:"color",target:"style",key:"backgroundColor",defaultValue:"transparent"},{label:"properties.label.borderColor",type:"color",target:"style",key:"borderColor",defaultValue:"#000000"},{label:"properties.label.borderWidth",type:"number",target:"style",key:"borderWidth",min:0,max:100,defaultValue:1},{label:"properties.label.borderStyle",type:"select",target:"style",key:"borderStyle",defaultValue:"solid",options:[{label:"properties.option.none",value:"none"},{label:"properties.option.solid",value:"solid"},{label:"properties.option.dashed",value:"dashed"},{label:"properties.option.dotted",value:"dotted"}]},{label:"properties.label.cornerRadius",type:"number",target:"style",key:"borderRadius",min:0,max:1e3}]}]},h2=Pe({__name:"RectElement",props:{element:{}},setup(r){return(e,t)=>(z(),F("div",{class:"w-full h-full",style:ye({backgroundColor:r.element.style.backgroundColor||"transparent",borderWidth:`${r.element.style.borderWidth||1}px`,borderStyle:r.element.style.borderStyle||"solid",borderColor:r.element.style.borderColor||"#000000",borderRadius:`${r.element.style.borderRadius||0}px`})},null,4))}}),p2={sections:[{title:"properties.section.appearance",tab:"style",fields:[{label:"properties.label.background",type:"color",target:"style",key:"backgroundColor",defaultValue:"transparent"},{label:"properties.label.borderColor",type:"color",target:"style",key:"borderColor",defaultValue:"#000000"},{label:"properties.label.borderWidth",type:"number",target:"style",key:"borderWidth",min:0,max:100,defaultValue:1},{label:"properties.label.borderStyle",type:"select",target:"style",key:"borderStyle",defaultValue:"solid",options:[{label:"properties.option.none",value:"none"},{label:"properties.option.solid",value:"solid"},{label:"properties.option.dashed",value:"dashed"},{label:"properties.option.dotted",value:"dotted"}]}]}]},f2=Pe({__name:"CircleElement",props:{element:{}},setup(r){return(e,t)=>(z(),F("div",{class:"w-full h-full rounded-full",style:ye({backgroundColor:r.element.style.backgroundColor||"transparent",borderWidth:`${r.element.style.borderWidth||1}px`,borderStyle:r.element.style.borderStyle||"solid",borderColor:r.element.style.borderColor||"#000000"})},null,4))}}),m2={key:0,class:"flex items-center justify-between"},g2={class:"text-sm text-gray-700 font-medium"},v2=["disabled"],b2={class:"sr-only"},y2={key:1},w2={class:"block text-xs text-gray-500 mb-1"},x2=["value","disabled","placeholder"],_2=["type","value","disabled","placeholder","min","max","step"],$t=Pe({__name:"PropertyInput",props:{label:{},value:{type:[String,Number,Boolean]},type:{},placeholder:{},min:{},max:{},step:{},disabled:{type:Boolean}},emits:["update:value"],setup(r,{emit:e}){const t=e,s=n=>{const l=n.target;t("update:value",l.value)};return(n,l)=>r.type==="switch"?(z(),F("div",m2,[o("label",g2,E(r.label),1),o("button",{type:"button",disabled:r.disabled,onClick:l[0]||(l[0]=i=>n.$emit("update:value",!r.value)),class:_e(["relative inline-flex h-6 w-11 flex-shrink-0 cursor-pointer rounded-full border-2 border-transparent transition-colors duration-200 ease-in-out focus:outline-none focus:ring-2 focus:ring-blue-600 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed",r.value?"bg-blue-600":"bg-gray-200"])},[o("span",b2,"Toggle "+E(r.label),1),o("span",{"aria-hidden":"true",class:_e(["pointer-events-none inline-block h-5 w-5 transform rounded-full bg-white shadow ring-0 transition duration-200 ease-in-out",r.value?"translate-x-5":"translate-x-0"])},null,2)],10,v2)])):(z(),F("div",y2,[o("label",w2,E(r.label),1),r.type==="textarea"?(z(),F("textarea",{key:0,value:r.value===void 0||r.value===null?"":String(r.value),disabled:r.disabled,placeholder:r.placeholder,onInput:s,class:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:border-blue-500 outline-none h-24 resize-y disabled:bg-gray-100 disabled:text-gray-500"},null,40,x2)):(z(),F("input",{key:1,type:r.type||"text",value:r.value===void 0||r.value===null?"":String(r.value),disabled:r.disabled,placeholder:r.placeholder,min:r.min,max:r.max,step:r.step,onInput:s,class:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:border-blue-500 outline-none disabled:bg-gray-100 disabled:text-gray-500"},null,40,_2))]))}}),k2={class:"block text-xs text-gray-500 mb-1"},S2=["value","disabled"],C2=["value"],E2=Pe({__name:"PropertySelect",props:{label:{},value:{type:[String,Number,Boolean]},options:{},disabled:{type:Boolean}},emits:["update:value"],setup(r,{emit:e}){const t=r,s=e,n=l=>{const d=l.target.value,u=t.options.find(g=>String(g.value)===d);s("update:value",u?u.value:d)};return(l,i)=>(z(),F("div",null,[o("label",k2,E(r.label),1),o("select",{value:r.value,disabled:r.disabled,onChange:n,class:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:border-blue-500 outline-none disabled:bg-gray-100 disabled:text-gray-500"},[(z(!0),F(Te,null,Le(r.options,d=>(z(),F("option",{key:String(d.value),value:d.value},E(d.label),9,C2))),128))],40,S2)]))}}),T2={class:"flex items-center justify-between"},$2={class:"text-xs text-gray-500"},I2={class:"flex items-center gap-2"},A2={key:0,class:"absolute inset-0 flex items-center justify-center"},rl=Pe({__name:"PropertyColor",props:{label:{},value:{},disabled:{type:Boolean}},emits:["update:value"],setup(r,{emit:e}){const t=e;return(s,n)=>(z(),F("div",T2,[o("label",$2,E(r.label),1),o("div",I2,[ce(xt,{"model-value":r.value,"onUpdate:modelValue":n[0]||(n[0]=l=>t("update:value",l)),disabled:r.disabled,"allow-transparent":!0},{trigger:ct(({color:l,open:i})=>[o("div",{class:_e(["w-8 h-6 rounded border border-gray-300 cursor-pointer relative overflow-hidden hover:border-blue-500 transition-colors",{"ring-2 ring-blue-500 ring-offset-1":i,"opacity-50 cursor-not-allowed":r.disabled}])},[n[2]||(n[2]=o("div",{class:"absolute inset-0 bg-[url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAIAAADZF8uwAAAAGUlEQVQYV2M4gwZ+5wNisxL//8n04mEeRAAAhNwX869V4DYAAAAASUVORK5CYII=')] opacity-50"},null,-1)),o("div",{class:"absolute inset-0",style:ye({backgroundColor:l==="transparent"?"transparent":l})},null,4),l==="transparent"?(z(),F("div",A2,[...n[1]||(n[1]=[o("div",{class:"w-full h-[1px] bg-red-500 rotate-45"},null,-1)])])):be("",!0)],2)]),_:1},8,["model-value","disabled"])])]))}}),z2={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function P2(r,e){return z(),F("svg",z2,[...e[0]||(e[0]=[o("path",{fill:"currentColor",d:"M3 21v-8h2v4.6L17.6 5H13V3h8v8h-2V6.4L6.4 19H11v2z"},null,-1)])])}const L2=Se({name:"material-symbols-open-in-full",render:P2}),M2={class:"flex flex-col gap-1"},R2={class:"flex justify-between items-center"},D2={class:"text-xs text-gray-500 font-medium"},B2={class:"flex items-center gap-2"},O2={class:"text-[10px] text-gray-400 uppercase"},q2=Pe({__name:"PropertyCode",props:{label:{},value:{},language:{},disabled:{type:Boolean},height:{}},emits:["update:value"],setup(r,{emit:e}){const t=e;Re();const{isDark:s}=So(),n=ie(!1),l=fe(()=>({minimap:{enabled:!1},lineNumbers:"on",glyphMargin:!1,folding:!0,wordWrap:"on",automaticLayout:!0,scrollBeyondLastLine:!1,theme:s.value?"vs-dark":"vs",fontSize:12,fontFamily:'Consolas, "Courier New", monospace',renderLineHighlight:"none",overviewRulerLanes:0,hideCursorInOverviewRuler:!0,contextmenu:!1})),i=y=>{t("update:value",y||"")},d=()=>{n.value=!n.value},u=()=>{n.value=!1},g=y=>{t("update:value",y)};return(y,m)=>(z(),F("div",M2,[o("div",R2,[o("label",D2,E(r.label),1),o("div",B2,[o("span",O2,E(r.language),1),o("button",{onClick:d,class:"text-gray-400 hover:text-blue-600 transition-colors p-0.5 rounded hover:bg-gray-100",title:"Expand Editor"},[ce(a(L2),{class:"w-3.5 h-3.5"})])])]),o("div",{class:"border border-gray-300 rounded overflow-hidden focus-within:border-blue-500 focus-within:ring-1 focus-within:ring-blue-500 resize-y relative group",style:ye({height:`${r.height||200}px`,minHeight:"100px",maxHeight:"600px"})},[ce(a(cl),{value:r.value,language:r.language,options:{...l.value,readOnly:r.disabled},"onUpdate:value":i,class:"w-full h-full"},null,8,["value","language","options"]),m[1]||(m[1]=o("div",{class:"absolute bottom-0 right-0 w-3 h-3 cursor-ns-resize pointer-events-none bg-gradient-to-tl from-gray-300 to-transparent opacity-50 group-hover:opacity-100"},null,-1))],4),ce(Ot,{visible:n.value,"onUpdate:visible":m[0]||(m[0]=x=>n.value=x),title:r.label,value:r.value,language:r.language,"read-only":r.disabled,"onUpdate:value":g,onClose:u},null,8,["visible","title","value","language","read-only"])]))}}),F2=Et(q2,[["__scopeId","data-v-44208768"]]),N2={class:"block text-xs text-gray-500 mb-1"},j2={class:"space-y-2"},H2=["value","disabled","placeholder"],U2={class:"flex flex-col gap-1"},V2=["disabled"],W2={class:"text-[10px] text-gray-400 text-center"},G2={key:0,class:"text-xs text-red-500 mt-1"},K2=Pe({__name:"PropertyImage",props:{label:{},value:{},disabled:{type:Boolean},placeholder:{}},emits:["update:value"],setup(r,{emit:e}){const t=r,s=e,{t:n}=Ne(),l=ie(null),i=ie(""),d=()=>{var y;t.disabled||(y=l.value)==null||y.click()},u=y=>{var k;const m=y.target,x=(k=m.files)==null?void 0:k[0];if(!x)return;if(i.value="",x.size>2*1024*1024){i.value=n("properties.image.sizeError"),m.value="";return}const p=new FileReader;p.onload=v=>{var b;const S=(b=v.target)==null?void 0:b.result;s("update:value",S)},p.onerror=()=>{i.value=n("properties.image.readError")},p.readAsDataURL(x),m.value=""},g=y=>{const m=y.target;s("update:value",m.value)};return(y,m)=>(z(),F("div",null,[o("label",N2,E(r.label),1),o("div",j2,[o("input",{type:"text",value:r.value||"",disabled:r.disabled,placeholder:r.placeholder||a(n)("properties.image.urlPlaceholder"),onInput:g,class:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:border-blue-500 outline-none disabled:bg-gray-100 disabled:text-gray-500"},null,40,H2),o("div",U2,[o("button",{type:"button",onClick:d,disabled:r.disabled,class:"w-full py-1.5 px-3 bg-white text-gray-700 text-sm border border-gray-300 rounded hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2"},[m[0]||(m[0]=o("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12"})],-1)),Ce(" "+E(a(n)("properties.image.uploadBtn")),1)],8,V2),o("span",W2,E(a(n)("properties.image.uploadTip")),1)]),i.value?(z(),F("p",G2,E(i.value),1)):be("",!0),o("input",{ref_key:"fileInput",ref:l,type:"file",accept:"image/*",class:"hidden",onChange:u},null,544)])]))}}),Y2={class:"p-4 border-b border-gray-200 bg-gray-50 flex items-center justify-between"},X2={class:"font-semibold text-gray-700"},Z2={class:"text-xs text-gray-500 mt-1"},J2={key:0,class:"flex items-center text-red-500 gap-1 text-xs font-medium bg-red-50 px-2 py-1 rounded border border-red-100"},Q2={key:0,class:"p-6 text-center"},ew={class:"mb-4"},tw={class:"text-lg font-semibold text-gray-900"},rw={class:"text-sm text-gray-500 mt-2"},nw={class:"font-medium"},ow={key:1,class:"flex flex-col h-full overflow-hidden"},sw={class:"flex border-b border-gray-200 bg-white"},aw=["onClick"],lw={key:0,class:"absolute bottom-0 left-0 w-full h-0.5 bg-blue-600"},iw={class:"p-4 space-y-6 overflow-y-auto flex-1 custom-scrollbar"},dw={key:0,class:"space-y-3"},uw={class:"text-xs font-bold text-gray-500 uppercase tracking-wider"},cw={class:"grid grid-cols-2 gap-3"},hw={key:1,class:"space-y-3 pt-2 border-t border-gray-100"},pw={class:"text-xs font-bold text-gray-500 uppercase tracking-wider"},fw={class:"grid grid-cols-2 gap-3"},mw=["disabled"],gw=["disabled"],vw={class:"text-xs font-bold text-gray-500 uppercase tracking-wider"},bw={class:"space-y-3"},yw={key:0},ww=["onClick","disabled"],xw={key:6},_w={class:"block text-xs text-gray-500 mb-1 font-medium"},kw=["placeholder","disabled","value","onChange"],Sw={key:2,class:"space-y-3 pt-2 border-t border-gray-100"},Cw={class:"text-xs font-bold text-gray-500 uppercase tracking-wider"},Ew={key:3,class:"space-y-4"},Tw={class:"p-4 bg-gray-50 rounded border border-gray-200"},$w={class:"text-sm font-medium text-gray-700 mb-3"},Iw={class:"space-y-3"},Aw={class:"text-xs text-gray-500 mb-1.5 font-medium"},zw={class:"flex items-center gap-2 bg-white border border-gray-200 rounded px-2 py-1.5 hover:border-blue-400 transition-colors"},Pw=["title"],Lw=["title"],Mw={class:"text-xs text-gray-500 flex items-center justify-between border-t border-gray-100 pt-2"},Rw={class:"font-medium"},Dw={class:"px-2 py-0.5 bg-gray-100 rounded text-gray-600"},Bw=["disabled"],Ow={key:2,class:"p-6 text-center"},qw={class:"mb-4"},Fw={class:"text-lg font-semibold text-gray-900"},Nw={class:"text-sm text-gray-500 mt-2"},jw=Pe({__name:"PropertiesPanel",setup(r){const{t:e}=Ne(),t=Re(),s=fe(()=>t.selectedElement),n=fe(()=>t.selectedElementIds.length>1),l=fe(()=>{var Z;return((Z=s.value)==null?void 0:Z.locked)||!1}),i=ie(!1),d=ie(""),u=fe(()=>s.value?[ge.LINE,ge.RECT,ge.CIRCLE].includes(s.value.type):!1),g=fe(()=>t.tableSelection?t.tableSelection.cells.length>1:!1),y=fe(()=>{if(!t.tableSelection||t.tableSelection.cells.length!==1)return!1;const Z=t.tableSelection.cells[0],ne=t.selectedElement;if(!ne||ne.type!==ge.TABLE)return!1;const xe=(Z.section||"body")==="footer"?ne.footerData:ne.data;if(!xe)return!1;const de=xe[Z.rowIndex];if(!de)return!1;const ke=de[Z.colField];return ke&&typeof ke=="object"?(ke.rowSpan||1)>1||(ke.colSpan||1)>1:!1}),m=ie("properties"),x=ie(!1),p=fe(()=>t.unit||"mm"),k=fe(()=>t.unit||"mm"),v=new Set(["fontSize","borderWidth","barcodeWidth","barcodeHeight","margin","borderRadius","headerHeight","rowHeight","footerHeight","labelFontSize","labelBorderWidth"]),S=Z=>Z.type!=="number"||!Z.key?!1:v.has(Z.key),b=Z=>{const ne=e(Z.label);return S(Z)?`${ne} (${k.value})`:ne},f=Z=>{const ne=Q(Z);return S(Z)&&typeof ne=="number"?ot(ne,p.value):ne},T=(Z,ne)=>S(Z)?Ye(Number(ne),p.value):ne,M=Z=>{if(!(Z.min===void 0||Z.min===null))return S(Z)?ot(Z.min,p.value):Z.min},H=Z=>{if(!(Z.max===void 0||Z.max===null))return S(Z)?ot(Z.max,p.value):Z.max},R=Z=>{if(!(Z.step===void 0||Z.step===null))return S(Z)?ot(Z.step,p.value):Z.step},A=()=>{s.value&&(navigator.clipboard.writeText(s.value.id),x.value=!0,setTimeout(()=>{x.value=!1},2e3))},W=()=>{s.value&&(d.value=s.value.type,i.value=!0)},X=Z=>{s.value&&Z&&t.addCustomElement(Z,s.value)},se=(Z,ne)=>{s.value&&t.updateElement(s.value.id,{[Z]:ne})},G=(Z,ne)=>{s.value&&t.updateElement(s.value.id,{style:{...s.value.style,[Z]:ne}})},$=(Z,ne)=>{try{const ve=ne.target.value;se(Z,JSON.parse(ve))}catch{window.alert("Invalid JSON")}},O=Z=>{const ne=Q(Z);return Z.language==="json"&&typeof ne=="object"?JSON.stringify(ne,null,2):ne||""},h=(Z,ne)=>{if(Z.language==="json")try{const ve=JSON.parse(ne);se(Z.key,ve)}catch{}else se(Z.key,ne)},w=Z=>{switch(Z){case ge.TEXT:return by;case ge.IMAGE:return _y;case ge.TABLE:return Ky;case ge.PAGE_NUMBER:return Zy;case ge.BARCODE:return t2;case ge.QRCODE:return a2;case ge.LINE:return d2;case ge.RECT:return c2;case ge.CIRCLE:return p2;default:return null}},Y=fe(()=>s.value?w(s.value.type):null),te=fe(()=>Y.value?Y.value.sections.filter(Z=>(Z.tab||"properties")===m.value):[]),Q=Z=>s.value?(Z.target==="style"?s.value.style:s.value)[Z.key]??Z.defaultValue:Z.defaultValue,I=(Z,ne)=>{s.value&&(Z.target==="style"&&Z.key?G(Z.key,ne):Z.target==="element"&&Z.key&&se(Z.key,ne))},V=Z=>{!s.value||!Z.actionName||(Z.actionName==="paginateTable"?t.paginateTable(s.value.id):Z.actionName==="removeBorder"&&t.updateElement(s.value.id,{style:{...s.value.style,borderStyle:void 0,borderWidth:void 0,borderColor:void 0,border:"none"}}))},L=()=>{n.value?t.removeSelectedElements():s.value&&t.removeElement(s.value.id)},B=Z=>{Z.relatedTarget&&Z.currentTarget.contains(Z.relatedTarget)||t.setDisableGlobalShortcuts(!0)},re=Z=>{Z.relatedTarget&&Z.currentTarget.contains(Z.relatedTarget)||t.setDisableGlobalShortcuts(!1)};return(Z,ne)=>(z(),F(Te,null,[o("aside",{class:"w-[380px] bg-white border-l border-gray-200 flex flex-col h-full z-40 overflow-hidden",onFocusin:B,onFocusout:re},[o("div",Y2,[o("div",null,[o("h2",X2,E(a(e)("properties.title")),1),o("p",Z2,E(a(e)("properties.subtitle")),1)]),l.value?(z(),F("div",J2,[ce(a(Jt),{class:"w-3 h-3"}),o("span",null,E(a(e)("properties.locked")),1)])):be("",!0)]),n.value?(z(),F("div",Q2,[o("div",ew,[o("h3",tw,E(a(e)("properties.multiSelectMode")),1),o("p",rw,[o("span",nw,E(a(t).selectedElementIds.length),1),Ce(" "+E(a(e)("properties.selectedElements",{n:""}).replace("{n}","")),1)])]),o("button",{onClick:L,class:"w-full py-2 bg-red-50 text-red-600 rounded border border-red-200 hover:bg-red-100 transition-colors text-sm font-medium"},E(a(e)("properties.deleteSelected")),1)])):s.value?(z(),F("div",ow,[o("div",sw,[(z(),F(Te,null,Le(["properties","style","advanced"],ve=>o("button",{key:ve,onClick:xe=>m.value=ve,class:_e(["flex-1 py-3 text-sm font-medium transition-colors relative",m.value===ve?"text-blue-600":"text-gray-500 hover:text-gray-700 hover:bg-gray-50"])},[Ce(E(a(e)(`properties.tab.${ve}`))+" ",1),m.value===ve?(z(),F("div",lw)):be("",!0)],10,aw)),64))]),o("div",iw,[m.value==="properties"?(z(),F("div",dw,[o("h3",uw,E(a(e)("properties.section.positionSize")),1),o("div",cw,[ce($t,{label:`${a(e)("properties.label.x")} (${k.value})`,type:"number",disabled:l.value,value:a(ot)(s.value.x,p.value),"onUpdate:value":ne[0]||(ne[0]=ve=>se("x",a(Ye)(Number(ve),p.value)))},null,8,["label","disabled","value"]),ce($t,{label:`${a(e)("properties.label.y")} (${k.value})`,type:"number",disabled:l.value,value:a(ot)(s.value.y,p.value),"onUpdate:value":ne[1]||(ne[1]=ve=>se("y",a(Ye)(Number(ve),p.value)))},null,8,["label","disabled","value"]),ce($t,{label:`${a(e)("properties.label.width")} (${k.value})`,type:"number",disabled:l.value,value:a(ot)(s.value.width,p.value),"onUpdate:value":ne[2]||(ne[2]=ve=>se("width",a(Ye)(Number(ve),p.value)))},null,8,["label","disabled","value"]),ce($t,{label:`${a(e)("properties.label.height")} (${k.value})`,type:"number",disabled:l.value,value:a(ot)(s.value.height,p.value),"onUpdate:value":ne[3]||(ne[3]=ve=>se("height",a(Ye)(Number(ve),p.value)))},null,8,["label","disabled","value"])])])):be("",!0),m.value==="properties"&&s.value.type==="table"&&a(t).tableSelection?(z(),F("div",hw,[o("h3",pw,E(a(e)("properties.section.cellOperations")),1),o("div",fw,[o("button",{onClick:ne[4]||(ne[4]=ve=>a(t).mergeSelectedCells()),disabled:!g.value||l.value,class:"w-full py-2 bg-blue-50 text-blue-600 rounded border border-blue-200 hover:bg-blue-100 transition-colors text-xs font-medium disabled:opacity-50 disabled:cursor-not-allowed disabled:bg-gray-50 disabled:text-gray-400 disabled:border-gray-200"},E(a(e)("properties.action.mergeCells")),9,mw),o("button",{onClick:ne[5]||(ne[5]=ve=>a(t).splitSelectedCells()),disabled:!y.value||l.value,class:"w-full py-2 bg-white text-gray-600 rounded border border-gray-200 hover:bg-gray-50 transition-colors text-xs font-medium disabled:opacity-50 disabled:cursor-not-allowed"},E(a(e)("properties.action.splitCells")),9,gw)])])):be("",!0),(z(!0),F(Te,null,Le(te.value,(ve,xe)=>(z(),F("div",{key:xe,class:"space-y-3 pt-2 first:pt-0 border-t first:border-0 border-gray-100"},[o("h3",vw,E(a(e)(ve.title)),1),o("div",bw,[(z(!0),F(Te,null,Le(ve.fields,(de,ke)=>(z(),F(Te,{key:ke},[de.type==="action"?(z(),F("div",yw,[o("button",{onClick:we=>V(de),disabled:l.value,class:"w-full py-2 bg-blue-600 text-white rounded hover:bg-blue-700 transition-colors text-sm font-medium shadow-sm disabled:opacity-50 disabled:cursor-not-allowed disabled:bg-gray-400"},E(a(e)(de.label)),9,ww)])):de.type==="text"||de.type==="number"||de.type==="switch"?(z(),ze($t,{key:1,label:b(de),type:de.type,min:M(de),max:H(de),step:R(de),disabled:l.value,placeholder:de.placeholder?de.placeholder.startsWith("properties.")?a(e)(de.placeholder):de.placeholder:"",value:f(de),"onUpdate:value":we=>I(de,T(de,we))},null,8,["label","type","min","max","step","disabled","placeholder","value","onUpdate:value"])):de.type==="select"?(z(),ze(E2,{key:2,label:a(e)(de.label),options:(de.options||[]).map(we=>({...we,label:a(e)(we.label)})),disabled:l.value,value:Q(de),"onUpdate:value":we=>I(de,we)},null,8,["label","options","disabled","value","onUpdate:value"])):de.type==="color"?(z(),ze(rl,{key:3,label:a(e)(de.label),disabled:l.value,value:Q(de),"onUpdate:value":we=>I(de,we)},null,8,["label","disabled","value","onUpdate:value"])):de.type==="image"?(z(),ze(K2,{key:4,label:a(e)(de.label),disabled:l.value,placeholder:de.placeholder?de.placeholder.startsWith("properties.")?a(e)(de.placeholder):de.placeholder:void 0,value:Q(de),"onUpdate:value":we=>I(de,we)},null,8,["label","disabled","placeholder","value","onUpdate:value"])):de.type==="code"?(z(),ze(F2,{key:5,label:a(e)(de.label),language:de.language||"javascript",disabled:l.value,value:O(de),"onUpdate:value":we=>h(de,we)},null,8,["label","language","disabled","value","onUpdate:value"])):de.type==="textarea"?(z(),F("div",xw,[o("label",_w,E(a(e)(de.label)),1),o("textarea",{placeholder:de.placeholder?de.placeholder.startsWith("properties.")?a(e)(de.placeholder):de.placeholder:"",disabled:l.value,value:["data","columns","footerData"].includes(de.key)?JSON.stringify(s.value[de.key],null,2):Q(de),onChange:we=>["data","columns","footerData"].includes(de.key)?$(de.key,we):I(de,we.target.value),class:"w-full px-3 py-2 text-sm border border-gray-300 rounded focus:border-blue-500 outline-none h-24 resize-y font-mono disabled:bg-gray-100 disabled:text-gray-500"},null,40,kw)])):be("",!0)],64))),128))])]))),128)),m.value==="style"&&!u.value?(z(),F("div",Sw,[o("h3",Cw,E(a(e)("properties.section.appearance")),1),ce(rl,{label:a(e)("properties.label.backgroundColor"),disabled:l.value,value:s.value.style.backgroundColor||"#ffffff","onUpdate:value":ne[6]||(ne[6]=ve=>G("backgroundColor",ve))},null,8,["label","disabled","value"])])):be("",!0),m.value==="advanced"?(z(),F("div",Ew,[o("div",Tw,[o("h4",$w,E(a(e)("properties.section.elementInfo")),1),o("div",Iw,[o("div",null,[o("p",Aw,E(a(e)("properties.label.id")),1),o("div",zw,[o("span",{class:"font-mono text-xs text-gray-600 flex-1 truncate select-all",title:s.value.id},E(s.value.id),9,Pw),o("button",{onClick:A,class:"text-gray-400 hover:text-blue-600 transition-colors p-1 rounded hover:bg-gray-100 flex-shrink-0",title:x.value?a(e)("properties.action.copied"):a(e)("properties.action.copyId")},[x.value?(z(),ze(a(nh),{key:0,class:"w-3.5 h-3.5 text-green-500"})):(z(),ze(a(Ct),{key:1,class:"w-3.5 h-3.5"}))],8,Lw)])]),o("div",Mw,[o("span",Rw,E(a(e)("properties.label.type")),1),o("span",Dw,E(a(e)("elements."+s.value.type)),1)])])]),o("button",{onClick:W,class:"w-full py-2 bg-white text-blue-600 rounded border border-blue-200 hover:bg-blue-50 transition-colors text-sm font-medium flex items-center justify-center gap-2 mb-2 disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:bg-white"},[ce(a(To),{class:"w-4 h-4"}),Ce(" "+E(a(e)("properties.action.saveCustom")),1)]),o("button",{onClick:L,disabled:l.value,class:"w-full py-2 bg-white text-red-600 rounded border border-red-200 hover:bg-red-50 transition-colors text-sm font-medium flex items-center justify-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:bg-white"},[ce(a(St),{class:"w-4 h-4"}),Ce(" "+E(a(e)("properties.action.deleteElement")),1)],8,Bw)])):be("",!0)])])):(z(),F("div",Ow,[o("div",qw,[o("h3",Fw,E(a(e)("properties.empty.noSelection")),1),o("p",Nw,E(a(e)("properties.empty.selectInstruction")),1)])]))],32),ce(qt,{show:i.value,"initial-value":d.value,title:a(e)("properties.action.saveCustomModal"),placeholder:a(e)("sidebar.enterNamePlaceholder"),onClose:ne[7]||(ne[7]=ve=>i.value=!1),onSave:X},null,8,["show","initial-value","title","placeholder"])],64))}}),Hw=Et(jw,[["__scopeId","data-v-35d350fc"]]),Uw={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function Vw(r,e){return z(),F("svg",Uw,[...e[0]||(e[0]=[o("path",{fill:"currentColor",d:"M13.05 22v-2.05q.85-.125 1.663-.45t1.537-.85l1.4 1.45q-1.05.8-2.2 1.287t-2.4.613m-2 0q-3.45-.45-5.725-2.988T3.05 13.05q0-1.875.713-3.512t1.925-2.85t2.85-1.925t3.512-.713h.15L10.65 2.5l1.4-1.45l4 4l-4 4l-1.4-1.4l1.6-1.6h-.2q-2.925 0-4.962 2.038T5.05 13.05q0 2.6 1.7 4.563t4.3 2.337zm8.05-3.35l-1.45-1.4q.525-.725.85-1.537t.45-1.663H21q-.125 1.25-.612 2.4t-1.288 2.2m1.9-6.6h-2.05q-.125-.85-.45-1.662t-.85-1.538l1.45-1.4q.8.975 1.275 2.15T21 12.05"},null,-1)])])}const Ww=Se({name:"material-symbols-rotate-right",render:Vw}),Gw={key:0,"data-print-exclude":"true",class:"absolute -top-3 -right-3 bg-red-500 rounded-full p-1 shadow-md z-50"},Kw=["title"],nl=Pe({__name:"ElementWrapper",props:{element:{},isSelected:{type:Boolean},zoom:{},pageIndex:{},readOnly:{type:Boolean}},setup(r){const e=r,{t}=Ne(),s=Re(),n=ie(null),l=fe(()=>{const M=!e.isSelected&&s.selectedElementIds.includes(e.element.id),H=!e.readOnly&&(e.isSelected||M),R={left:`${e.element.x}px`,top:`${e.element.y}px`,width:`${e.element.width}px`,height:`${e.element.height}px`,zIndex:e.element.style.zIndex||1,transform:`rotate(${e.element.style.rotate||0}deg)`,...e.element.style},A=[ge.TABLE,ge.LINE,ge.RECT,ge.CIRCLE];return A.includes(e.element.type)&&(delete R.backgroundColor,delete R.border,delete R.borderWidth,delete R.borderStyle,delete R.borderColor,delete R.borderRadius),H?R.border=e.element.locked?"2px solid #ef4444":"2px solid var(--brand-500)":!A.includes(e.element.type)&&e.element.style.borderStyle&&e.element.style.borderStyle!=="none"?(R.borderStyle=e.element.style.borderStyle,R.borderWidth=`${e.element.style.borderWidth||1}px`,R.borderColor=e.element.style.borderColor||"#000",delete R.border):!A.includes(e.element.type)&&e.element.style.border?R.border=e.element.style.border:R.border="1px dashed transparent",R});let i=0,d=0,u=0,g=0,y=!1,m=!1;const x=M=>{e.readOnly||M.button!==0||M.target.closest(".resize-handle")||M.target.closest(".rotate-handle")||(M.ctrlKey||M.metaKey?s.selectElement(e.element.id,!0):s.selectedElementIds.includes(e.element.id)||s.selectElement(e.element.id,!1),e.element.locked)||(y=!0,s.setDragging(!0),m=!1,i=M.clientX,d=M.clientY,u=e.element.x,g=e.element.y,window.addEventListener("mousemove",p),window.addEventListener("mouseup",k))},p=M=>{if(!y)return;const H=(M.clientX-i)/e.zoom,R=(M.clientY-d)/e.zoom;(Math.abs(H)>2||Math.abs(R)>2)&&(m||(s.snapshot(),m=!0),s.selectedElementIds.length>1&&s.selectedElementIds.includes(e.element.id)?s.moveSelectedElements(e.element.id,u+H,g+R,!1,!1):s.moveElementWithSnap(e.element.id,u+H,g+R,!1,!1))},k=M=>{if(y&&m){const R=document.elementsFromPoint(M.clientX,M.clientY).find(A=>A.classList.contains("print-page"));if(R){const A=R.id,W=parseInt(A.replace("page-",""),10);if(!isNaN(W)&&W!==e.pageIndex){const X=document.getElementById(`page-${e.pageIndex}`);if(X){const se=X.getBoundingClientRect(),G=R.getBoundingClientRect(),$=(se.left-G.left)/e.zoom,O=(se.top-G.top)/e.zoom;(s.selectedElementIds.length>1&&s.selectedElementIds.includes(e.element.id)?[...s.selectedElementIds]:[e.element.id]).forEach(w=>{const te=s.pages[e.pageIndex].elements.find(Q=>Q.id===w);te&&s.moveElementToPage(w,W,te.x+$,te.y+O)})}}else s.selectedElementIds.length>1&&s.selectedElementIds.includes(e.element.id)?s.moveSelectedElements(e.element.id,e.element.x,e.element.y,!1,!0):s.moveElementWithSnap(e.element.id,e.element.x,e.element.y,!1,!0)}}y&&!m&&(M.ctrlKey||M.metaKey||s.selectElement(e.element.id,!1)),y=!1,s.setDragging(!1),window.removeEventListener("mousemove",p),window.removeEventListener("mouseup",k),s.setHighlightedGuide(null),s.setHighlightedEdge(null)},v=ie(!1),S=ie(!1),b=ie(0),f=M=>{if(M.stopPropagation(),M.preventDefault(),!n.value)return;v.value=!0,S.value=!1,m=!1,b.value=e.element.style.rotate||0;const H=n.value.getBoundingClientRect(),R=H.left+H.width/2,A=H.top+H.height/2,W=Math.atan2(M.clientY-A,M.clientX-R),X=e.element.style.rotate||0,se=$=>{const h=(Math.atan2($.clientY-A,$.clientX-R)-W)*(180/Math.PI);let w=X+h;if(w=w%360,w<0&&(w+=360),S.value=!1,$.shiftKey)w=Math.round(w/45)*45,S.value=!0;else if(!$.ctrlKey){const te=[0,90,180,270,360];for(const Q of te)if(Math.abs(w-Q)<=5){w=Q===360?0:Q,S.value=!0;break}}w=Math.round(w),w===360&&(w=0),b.value=w,m||(s.snapshot(),m=!0),s.updateElement(e.element.id,{style:{...e.element.style,rotate:w}},!1)},G=()=>{v.value=!1,window.removeEventListener("mousemove",se),window.removeEventListener("mouseup",G)};window.addEventListener("mousemove",se),window.addEventListener("mouseup",G)},T=M=>{M.stopPropagation(),M.preventDefault();const H=M.clientX,R=M.clientY,A=e.element.width,W=e.element.height;m=!1;const X=G=>{const $=(G.clientX-H)/e.zoom,O=(G.clientY-R)/e.zoom;m||(s.snapshot(),m=!0);let h=A+$,w=W+O;if(G.shiftKey){const Y=A/W;Math.abs(h/A-1)>Math.abs(w/W-1)?w=h/Y:h=w*Y}s.updateElement(e.element.id,{width:Math.max(10,h),height:Math.max(10,w)},!1)},se=()=>{window.removeEventListener("mousemove",X),window.removeEventListener("mouseup",se)};window.addEventListener("mousemove",X),window.addEventListener("mouseup",se)};return(M,H)=>(z(),F("div",{ref_key:"elementRef",ref:n,class:_e(["element-wrapper absolute select-none",[r.readOnly?"cursor-not-allowed":"group theme-outline-hover",!r.readOnly&&r.element.locked?"cursor-not-allowed":"",!r.readOnly&&!r.element.locked?"cursor-move":""]]),style:ye(l.value),onMousedown:x},[ul(M.$slots,"default"),!r.readOnly&&r.element.locked&&r.isSelected?(z(),F("div",Gw,[ce(a(Jt),{class:"w-3 h-3 text-white"})])):be("",!0),!r.readOnly&&r.isSelected&&a(s).selectedElementIds.length<=1&&!r.element.locked?(z(),F(Te,{key:1},[o("div",{"data-print-exclude":"true",class:"resize-handle absolute bottom-0 right-0 w-3 h-3 bg-blue-600 cursor-se-resize z-50",onMousedown:T},null,32),o("div",{"data-print-exclude":"true",class:"rotate-handle absolute -top-4 -right-5 w-5 h-5 flex items-center justify-center cursor-grab z-50 theme-text theme-text-hover",title:a(t)("common.rotate"),onMousedown:f},[ce(a(Ww),{class:"w-3 h-3"}),v.value?(z(),F("div",{key:0,class:_e(["absolute top-6 left-1/2 transform -translate-x-1/2 text-xs px-2 py-1 rounded whitespace-nowrap z-50 pointer-events-none font-sans font-normal not-italic leading-none tracking-normal normal-case",S.value?"theme-bg-strong text-white":"theme-bg-soft text-white"])},E(b.value)+"° ",3)):be("",!0)],40,Kw)],64)):be("",!0)],38))}}),Yw={class:"absolute top-0 -right-12 flex flex-col gap-2 z-10"},Xw=["title"],Zw=["title","onClick"],Jw=["title","onClick"],Qw=["title","onClick"],ex=["id","onDrop","onMousedown","onContextmenu"],tx={key:0,"data-print-exclude":"true",class:"absolute inset-0 pointer-events-none opacity-50",style:{"background-image":"linear-gradient(#e5e7eb 1px, transparent 1px), linear-gradient(90deg, #e5e7eb 1px, transparent 1px)","background-size":"20px 20px"}},rx=["onMousedown"],nx=["onMousedown"],ox={key:5,"data-print-exclude":"true",class:"marker absolute inset-0 pointer-events-none z-50 opacity-50"},Wl=Pe({__name:"Canvas",setup(r){const e=Re(),{t}=Ne(),s=fe(()=>e.pages),n=fe(()=>e.zoom),l=fe(()=>e.pageSpacingY||0),i=fe(()=>e.pageSpacingX||0),d=fe(()=>e.pageSpacingX||0),u=fe(()=>e.pageSpacingY||0),g=fe(()=>e.pageSpacingY||0),y=ie(!1),m=ie(null),x=ie(null),p=(I,V)=>{I.preventDefault(),I.stopPropagation(),y.value=!0,m.value=V;const L=I.target;x.value=L.closest(".print-page"),window.addEventListener("mousemove",k),window.addEventListener("mouseup",v)},k=I=>{if(!y.value||!x.value)return;const V=x.value.getBoundingClientRect(),L=(I.clientY-V.top)/e.zoom,B=Math.max(0,Math.min(e.canvasSize.height,L));m.value==="header"?e.setHeaderHeight(Math.round(B)):m.value==="footer"&&e.setFooterHeight(Math.round(e.canvasSize.height-B))},v=()=>{y.value=!1,m.value=null,x.value=null,window.removeEventListener("mousemove",k),window.removeEventListener("mouseup",v)};Ge(()=>{window.removeEventListener("mousemove",k),window.removeEventListener("mouseup",v)});const S=fe(()=>{const I={width:`${e.canvasSize.width}px`,height:`${e.canvasSize.height}px`,backgroundColor:e.canvasBackground};return f.value?{...I,...f.value}:I}),b=I=>I.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;"),f=fe(()=>{const I=e.watermark;if(!I||!I.enabled||!I.text)return null;const V=b(I.text),L=Number.isFinite(I.angle)?I.angle:-30,B=Math.max(6,I.size||24),re=Math.max(40,I.density||160),Z=I.color||"#000000",ne=Math.min(1,Math.max(0,I.opacity??.1)),ve=`<?xml version="1.0" encoding="UTF-8"?><svg xmlns="http://www.w3.org/2000/svg" width="${re}" height="${re}"><text x="50%" y="50%" dominant-baseline="middle" text-anchor="middle" fill="${Z}" fill-opacity="${ne}" font-size="${B}" transform="rotate(${L} ${re/2} ${re/2})">${V}</text></svg>`;return{backgroundImage:`url("data:image/svg+xml,${encodeURIComponent(ve)}")`,backgroundRepeat:"repeat",backgroundSize:`${re}px ${re}px`}}),T=fe(()=>!e.isDragging||!e.selectedElementId?-1:e.pages.findIndex(I=>I.elements.some(V=>V.id===e.selectedElementId))),M=ie(!1),H=ie({x:0,y:0}),R=ie({x:0,y:0}),A=ie(null),W=ie(!1),X=fe(()=>{if(!M.value)return{display:"none"};const I=Math.min(H.value.x,R.value.x),V=Math.min(H.value.y,R.value.y),L=Math.abs(R.value.x-H.value.x),B=Math.abs(R.value.y-H.value.y);return{position:"absolute",left:`${I}px`,top:`${V}px`,width:`${L}px`,height:`${B}px`,border:"1px solid var(--brand-500)",backgroundColor:"var(--brand-500-alpha-10)",pointerEvents:"none",zIndex:1e3}}),se=I=>{switch(I){case ge.TEXT:return tl;case ge.IMAGE:return ky;case ge.TABLE:return Yy;case ge.PAGE_NUMBER:return Jy;case ge.BARCODE:return r2;case ge.QRCODE:return l2;case ge.LINE:return u2;case ge.RECT:return h2;case ge.CIRCLE:return f2;default:return tl}},G=(I,V)=>{var we;I.preventDefault();const L=(we=I.dataTransfer)==null?void 0:we.getData("application/json");if(!L)return;const{type:B,payload:re}=JSON.parse(L),Z=I.currentTarget.getBoundingClientRect(),ne=(I.clientX-Z.left)/e.zoom,ve=(I.clientY-Z.top)/e.zoom;if(re){e.addElement({...re,x:ne,y:ve,locked:!1},V);return}const xe={[ge.PAGE_NUMBER]:52,[ge.BARCODE]:200,[ge.QRCODE]:100,[ge.LINE]:200,[ge.RECT]:100,[ge.CIRCLE]:100},de={[ge.PAGE_NUMBER]:20,[ge.BARCODE]:80,[ge.QRCODE]:100,[ge.TABLE]:150,[ge.LINE]:20,[ge.RECT]:100,[ge.CIRCLE]:100},ke={type:B,x:ne,y:ve,width:xe[B]||200,height:de[B]||100,variable:"",style:{fontSize:14,color:"#000000",...B===ge.RECT||B===ge.CIRCLE||B===ge.PAGE_NUMBER?{backgroundColor:"transparent"}:{},...B===ge.TABLE?{headerBackgroundColor:"#f3f4f6",headerColor:"#000000",footerBackgroundColor:"#f9fafb",footerColor:"#000000"}:{}},content:B===ge.TEXT?t("canvas.newText"):B===ge.BARCODE?"12345678":B===ge.QRCODE?"https://example.com":"",format:B===ge.PAGE_NUMBER?"1/Total":void 0,columns:B===ge.TABLE?[{field:"id",header:t("canvas.defaultTableHeaders.id"),width:50},{field:"name",header:t("canvas.defaultTableHeaders.name"),width:100},{field:"qty",header:t("canvas.defaultTableHeaders.qty"),width:60},{field:"price",header:t("canvas.defaultTableHeaders.price"),width:80},{field:"total",header:t("canvas.defaultTableHeaders.total"),width:80}]:void 0,data:B===ge.TABLE?Array.from({length:30},(ae,K)=>({id:K+1,name:`${t("canvas.defaultTableData.item")} ${K+1}`,qty:K%5+1,price:100+K*10,total:(K%5+1)*(100+K*10)})):void 0,showFooter:B===ge.TABLE?!0:void 0,tfootRepeat:B===ge.TABLE?!0:void 0,autoPaginate:B===ge.TABLE?!0:void 0,footerData:B===ge.TABLE?[{id:{value:t("canvas.defaultTableData.pageSum")},qty:{value:"",field:"{#pageQty}"},total:{value:"",field:"{#pageSum}"}},{id:{value:t("canvas.defaultTableData.total")},qty:{value:"",field:"{#totalQty}"},total:{value:"",field:"{#totalSum}"}},{id:{value:t("canvas.defaultTableData.inWords")},total:{value:"",field:"{#totalCap}"}}]:void 0,customScript:B===ge.TABLE?`// RMB Uppercase Conversion
try {
  function digitUppercase(n) {
      var fraction = ['角', '分'];
      var digit = [
          '零', '壹', '贰', '叁', '肆',
          '伍', '陆', '柒', '捌', '玖'
      ];
      var unit = [
          ['元', '万', '亿'],
          ['', '拾', '佰', '仟']
      ];
      var head = n < 0 ? '欠' : '';
      n = Math.abs(n);
      var s = '';
      for (var i = 0; i < fraction.length; i++) {
          s += (digit[Math.floor(n * 10 * Math.pow(10, i)) % 10] + fraction[i]).replace(/零./, '');
      }
      s = s || '整';
      n = Math.floor(n);
      for (var i = 0; i < unit[0].length && n > 0; i++) {
          var p = '';
          for (var j = 0; j < unit[1].length && n > 0; j++) {
              p = digit[n % 10] + unit[1][j] + p;
              n = Math.floor(n / 10);
          }
          s = p.replace(/(零.)*零$/, '').replace(/^$/, '零') + unit[0][i] + s;
      }
      return head + s.replace(/(零.)*零元/, '元')
          .replace(/(零.)+/g, '零')
          .replace(/^整$/, '零元整');
  }

  // 1. Calculate Total (works for both Global and Page data)
  let totalAmount = 0;
  let totalQty = 0;
  if (data && Array.isArray(data)) {
    data.forEach(row => {
      // Ensure numeric values
      const val = Number(row.total) || 0;
      const qty = Number(row.qty) || 0;
      totalAmount += val;
      totalQty += qty;
    });
  }

  // 2. Update Footer Data
  if (footerData && Array.isArray(footerData)) {
    footerData.forEach(row => {
      Object.keys(row).forEach(key => {
        const val = row[key];
        const processValue = (v) => {
           if (typeof v !== 'string') return v;
           
           // Global replacements (Grand Total)
           if (typeof type === 'undefined' || type !== 'page') {
               if (v.includes('{#totalSum}')) return v.replace('{#totalSum}', totalAmount.toFixed(2));
               if (v.includes('{#totalQty}')) return v.replace('{#totalQty}', String(totalQty));
               if (v.includes('{#totalCap}')) return v.replace('{#totalCap}', digitUppercase(totalAmount));
               
               // For {#pageSum}, we want to show the Grand Total in the Designer (visual feedback),
               // but pass the original {#pageSum} token to the Print logic (via data-value).
               if (v.includes('{#pageSum}')) {
                   const displayVal = v.replace('{#pageSum}', totalAmount.toFixed(2));
                   // printValue keeps {#pageSum} but resolves other globals
                   const printVal = v.replace('{#totalSum}', totalAmount.toFixed(2))
                                   .replace('{#totalQty}', String(totalQty))
                                   .replace('{#totalCap}', digitUppercase(totalAmount)); 
                   
                   return { value: displayVal, printValue: printVal };
               }

               // For {#pageQty}
               if (v.includes('{#pageQty}')) {
                   const displayVal = v.replace('{#pageQty}', String(totalQty));
                   // printValue keeps {#pageQty} but resolves other globals
                   const printVal = v.replace('{#totalSum}', totalAmount.toFixed(2))
                                   .replace('{#totalQty}', String(totalQty))
                                   .replace('{#totalCap}', digitUppercase(totalAmount)); 
                   
                   return { value: displayVal, printValue: printVal };
               }
           }
           
           // Page replacements (Page Sum)
           if (typeof type !== 'undefined' && type === 'page') {
               if (v.includes('{#pageSum}')) return v.replace('{#pageSum}', totalAmount.toFixed(2));
               if (v.includes('{#pageQty}')) return v.replace('{#pageQty}', String(totalQty));
           }
           return v;
        };

        // Handle object values
        if (val && typeof val === 'object') {
           // If it has a 'field' property, check if it contains a variable
           if (val.field && typeof val.field === 'string') {
               const processed = processValue(val.field);
               // If processed is different from field (meaning a replacement happened)
               // OR if processValue returned an object (for {#pageSum})
               if (processed !== val.field || typeof processed === 'object') {
                   if (typeof processed === 'object') {
                       val.result = processed.value; // Store in result, keep val.value as text
                       val.printValue = processed.printValue;
                   } else {
                       val.result = processed;
                   }
               }
           }
           // Also check 'value' if it was set manually and looks like a variable
           else if (val.value && typeof val.value === 'string') {
               // Only process if value looks like a variable, otherwise it's just text
               if (val.value.includes('{#')) {
                  const processed = processValue(val.value);
                  if (typeof processed === 'object') {
                       val.result = processed.value;
                       val.printValue = processed.printValue;
                   } else {
                       val.result = processed;
                   }
               }
           }
        }
      });
    });
  }

  return { data, footerData };
} catch (e) {
  console.error('Script Execution Error:', e);
  return { data, footerData };
}`:void 0};e.addElement(ke,V)},$=I=>{I.preventDefault()},O=I=>{!I.ctrlKey&&!I.metaKey&&!W.value&&e.selectElement(null)},h=(I,V)=>{if(I.button!==0||I.ctrlKey||I.metaKey||I.target.closest(".element-wrapper"))return;I.preventDefault(),M.value=!0,A.value=V;const re=I.currentTarget.getBoundingClientRect();H.value={x:(I.clientX-re.left)/n.value,y:(I.clientY-re.top)/n.value},R.value={...H.value},window.addEventListener("mousemove",w),window.addEventListener("mouseup",Y)},w=I=>{if(!M.value||A.value===null)return;const V=document.getElementById(`page-${A.value}`);if(!V)return;const L=V.getBoundingClientRect();R.value={x:(I.clientX-L.left)/n.value,y:(I.clientY-L.top)/n.value}},Y=()=>{if(!M.value)return;const I=Math.min(H.value.x,R.value.x),V=Math.min(H.value.y,R.value.y),L=Math.abs(R.value.x-H.value.x),B=Math.abs(R.value.y-H.value.y),re=[];if(A.value!==null){const Z=s.value[A.value];if(Z)for(const ne of Z.elements){const ve=ne.x+ne.width,xe=ne.y+ne.height,de=I+L,ke=V+B;ne.x<de&&ve>I&&ne.y<ke&&xe>V&&re.push(ne.id)}}e.setSelection(re),M.value=!1,A.value=null,W.value=!0,setTimeout(()=>{W.value=!1},50),window.removeEventListener("mousemove",w),window.removeEventListener("mouseup",Y)},te=(I,V)=>{var de;const B=I.currentTarget.getBoundingClientRect(),re=(I.clientX-B.left)/n.value,Z=(I.clientY-B.top)/n.value,ne=s.value[V];if(!ne)return;let ve=null,xe=-1/0;for(let ke=0;ke<ne.elements.length;ke++){const we=ne.elements[ke];if(re>=we.x&&re<=we.x+we.width&&Z>=we.y&&Z<=we.y+we.height){const K=((de=we.style)==null?void 0:de.zIndex)??1;K>=xe&&(xe=K,ve=we.id)}}ve&&e.selectElement(ve,!1)},Q=()=>s.value.length===0?[]:s.value[0].elements.filter(V=>e.showHeaderLine&&V.y<e.headerHeight||e.showFooterLine&&V.y>=e.canvasSize.height-e.footerHeight);return(I,V)=>(z(),F("div",{class:"flex flex-col",style:ye({transform:`scale(${n.value})`,transformOrigin:"top left",width:"fit-content",rowGap:`${l.value}px`})},[(z(!0),F(Te,null,Le(s.value,(L,B)=>(z(),F("div",{key:L.id,class:"relative group"},[o("div",Yw,[o("button",{class:"w-8 h-8 flex items-center justify-center bg-white border border-gray-200 rounded shadow hover:bg-blue-50 hover:text-blue-600 text-gray-600 transition-colors",title:a(t)("canvas.addPage"),onClick:V[0]||(V[0]=re=>a(e).addPage())},[ce(a(Ao))],8,Xw),o("button",{class:"w-8 h-8 flex items-center justify-center bg-white border border-gray-200 rounded shadow hover:bg-blue-50 hover:text-blue-600 text-gray-600 transition-colors",title:a(t)("canvas.copyPage"),onClick:re=>a(e).copyPage(B)},[ce(a(Ct))],8,Zw),a(e).copiedPage?(z(),F("button",{key:0,class:"w-8 h-8 flex items-center justify-center bg-white border border-gray-200 rounded shadow hover:bg-blue-50 hover:text-blue-600 text-gray-600 transition-colors",title:a(t)("canvas.pastePage"),onClick:re=>a(e).pastePage(B)},[ce(a($o))],8,Jw)):be("",!0),B>0?(z(),F("button",{key:1,class:"w-8 h-8 flex items-center justify-center bg-white border border-gray-200 rounded shadow hover:bg-red-50 hover:text-red-600 text-gray-600 transition-colors",title:a(t)("canvas.deletePage"),onClick:re=>a(e).removePage(B)},[ce(a(St))],8,Qw)):be("",!0)]),o("div",{id:`page-${B}`,class:"print-page shadow-lg relative overflow-hidden transition-all",style:ye([S.value,{overflow:T.value===B?"visible":"hidden",zIndex:T.value===B?50:1}]),onDrop:re=>G(re,B),onDragover:$,onMousedown:re=>h(re,B),onContextmenu:re=>te(re,B),onClick:Ke(O,["self"])},[a(e).showGrid?(z(),F("div",tx)):be("",!0),M.value&&A.value===B?(z(),F("div",{key:1,"data-print-exclude":"true",style:ye(X.value)},null,4)):be("",!0),a(e).showHeaderLine?(z(),F("div",{key:2,"data-print-exclude":"true",class:_e(["absolute left-0 w-full z-20 group flex flex-col justify-center items-center",B===0?"cursor-row-resize":"cursor-default"]),style:ye({top:`${a(e).headerHeight}px`,height:"12px",marginTop:"-6px"}),onMousedown:re=>B===0&&p(re,"header")},[o("div",{class:"w-full h-px",style:ye({backgroundImage:B===0?"linear-gradient(to right, #f87171 60%, transparent 40%)":"linear-gradient(to right, #d1d5db 60%, transparent 40%)",backgroundSize:"20px 1px",backgroundRepeat:"repeat-x"})},null,4),o("div",{class:_e(["absolute right-0 -top-4 text-xs bg-white/80 px-1 pointer-events-none",B===0?"text-red-400":"text-gray-400"])},E(a(t)("canvas.headerLabel")),3)],46,rx)):be("",!0),a(e).showFooterLine?(z(),F("div",{key:3,"data-print-exclude":"true",class:_e(["absolute left-0 w-full z-20 group flex flex-col justify-center items-center",B===0?"cursor-row-resize":"cursor-default"]),style:ye({bottom:`${a(e).footerHeight}px`,height:"12px",marginBottom:"-6px"}),onMousedown:re=>B===0&&p(re,"footer")},[o("div",{class:"w-full h-px",style:ye({backgroundImage:B===0?"linear-gradient(to right, #f87171 60%, transparent 40%)":"linear-gradient(to right, #d1d5db 60%, transparent 40%)",backgroundSize:"20px 1px",backgroundRepeat:"repeat-x"})},null,4),o("div",{class:_e(["absolute right-0 -bottom-4 text-xs bg-white/80 px-1 pointer-events-none",B===0?"text-red-400":"text-gray-400"])},E(a(t)("canvas.footerLabel")),3)],46,nx)):be("",!0),B>0&&s.value.length>0?(z(!0),F(Te,{key:4},Le(Q(),re=>(z(),ze(nl,{key:`global-${re.id}`,element:re,"is-selected":a(e).selectedElementId===re.id||a(e).selectedElementIds.includes(re.id),zoom:n.value,"page-index":0,"read-only":!0},{default:ct(()=>[(z(),ze(Rt(se(re.type)),{element:re,"page-index":B,"total-pages":s.value.length},null,8,["element","page-index","total-pages"]))]),_:2},1032,["element","is-selected","zoom"]))),128)):be("",!0),(z(!0),F(Te,null,Le(L.elements,re=>(z(),ze(nl,{key:re.id,element:re,"is-selected":a(e).selectedElementId===re.id||a(e).selectedElementIds.includes(re.id),zoom:n.value,"page-index":B},{default:ct(()=>[(z(),ze(Rt(se(re.type)),{element:re,"page-index":B,"total-pages":s.value.length},null,8,["element","page-index","total-pages"]))]),_:2},1032,["element","is-selected","zoom","page-index"]))),128)),a(e).showCornerMarkers?(z(),F("div",ox,[o("div",{class:"absolute w-3 h-3 border-t-2 border-l-2 border-gray-300",style:ye({top:`${u.value}px`,left:`${i.value}px`})},null,4),o("div",{class:"absolute w-3 h-3 border-t-2 border-r-2 border-gray-300",style:ye({top:`${u.value}px`,right:`${d.value}px`})},null,4),o("div",{class:"absolute w-3 h-3 border-b-2 border-l-2 border-gray-300",style:ye({bottom:`${g.value}px`,left:`${i.value}px`})},null,4),o("div",{class:"absolute w-3 h-3 border-b-2 border-r-2 border-gray-300",style:ye({bottom:`${g.value}px`,right:`${d.value}px`})},null,4)])):be("",!0)],44,ex)]))),128))],4))}}),ol=Pe({__name:"Ruler",props:{type:{},zoom:{},scroll:{},offset:{},thick:{},indicators:{},unit:{}},emits:["guide-drag-start"],setup(r,{emit:e}){const t=r,s=ie(null),n=t.thick||20;let l=null;const i=()=>{const y=s.value;if(!y)return;const m=y.getContext("2d");if(!m)return;const x=y.width,p=y.height,{zoom:k,scroll:v,offset:S,type:b,indicators:f}=t,T=document.documentElement.classList.contains("dark");if(m.clearRect(0,0,x,p),m.fillStyle=T?"#1f2937":"#F9FAFB",m.fillRect(0,0,x,p),f&&f.length>0)for(const h of f){const w=S+h.position*k-v;m.fillStyle=h.color,b==="horizontal"?m.fillRect(w-2,0,4,n):m.fillRect(0,w-2,n,4)}m.strokeStyle=T?"#6b7280":"#9CA3AF",m.fillStyle=T?"#9ca3af":"#6B7280",m.lineWidth=1,m.font="10px sans-serif",m.beginPath();const M=t.unit==="mm"?Pl:t.unit==="pt"?Ll:1,A=50/(M*k),W=[1,2,5,10,20,50,100,200,500,1e3];let X=W[W.length-1];for(const h of W)if(h>=A-.001){X=h;break}const se=b==="horizontal"?x:p,G=(-S+v)/(k*M),$=(se-S+v)/(k*M),O=Math.floor(G/X)*X;for(let h=O;h<=$;h+=X){const w=S+h*M*k-v,Y=Number(h.toFixed(1)).toString();b==="horizontal"?(m.moveTo(w,0),m.lineTo(w,n),m.fillText(Y,w+2,10)):(m.moveTo(0,w),m.lineTo(n,w),m.save(),m.translate(10,w+2),m.rotate(-Math.PI/2),m.fillText(Y,0,0),m.restore());const te=X/5;for(let Q=1;Q<5;Q++){const I=h+te*Q,V=S+I*M*k-v;b==="horizontal"?(m.moveTo(V,n-5),m.lineTo(V,n)):(m.moveTo(n-5,V),m.lineTo(n,V))}}m.stroke()},d=new ResizeObserver(y=>{for(const m of y){const x=s.value;if(x){const{width:p,height:k}=m.contentRect;x.width=p,x.height=k,i()}}});We(()=>{s.value&&(d.observe(s.value.parentElement),i()),l=new MutationObserver(()=>{i()}),l.observe(document.documentElement,{attributes:!0,attributeFilter:["class"]})}),Ge(()=>{l==null||l.disconnect(),l=null}),Ae(()=>[t.zoom,t.scroll,t.offset,t.indicators,t.unit],i,{deep:!0});const u=e,g=y=>{u("guide-drag-start",y)};return(y,m)=>(z(),F("div",{class:"w-full h-full overflow-hidden bg-gray-50 relative",onMousedown:g},[o("canvas",{ref_key:"canvasRef",ref:s,class:"block"},null,512)],32))}}),sx={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function ax(r,e){return z(),F("svg",sx,[...e[0]||(e[0]=[o("path",{fill:"currentColor",d:"m19 21l-7-7l-2.35 2.35q.2.375.275.8T10 18q0 1.65-1.175 2.825T6 22t-2.825-1.175T2 18t1.175-2.825T6 14q.425 0 .85.075t.8.275L10 12L7.65 9.65q-.375.2-.8.275T6 10q-1.65 0-2.825-1.175T2 6t1.175-2.825T6 2t2.825 1.175T10 6q0 .425-.075.85t-.275.8L22 20v1zm-4-10l-2-2l6-6h3v1zM6 8q.825 0 1.413-.587T8 6t-.587-1.412T6 4t-1.412.588T4 6t.588 1.413T6 8m6 4.5q.2 0 .35-.15t.15-.35t-.15-.35t-.35-.15t-.35.15t-.15.35t.15.35t.35.15M6 20q.825 0 1.413-.587T8 18t-.587-1.412T6 16t-1.412.588T4 18t.588 1.413T6 20"},null,-1)])])}const lx=Se({name:"material-symbols-content-cut",render:ax}),ix={class:"bg-white border border-gray-200 shadow-xl rounded-md min-w-[160px] py-1"},dx=["disabled"],ux=["disabled"],cx=["disabled"],hx=["disabled"],px=["disabled"],fx=Pe({__name:"Shortcuts",setup(r){const{t:e}=Ne(),t=Re(),s=ie(!1),n=ie(0),l=ie(0),i=ie(0),d=ie(0),u=ie(null),g=ie(!1),y=ie(0),m=ie(0),x=f=>{y.value=f.clientX,m.value=f.clientY},p=(f,T)=>{const M=document.querySelectorAll(".print-page");if(M.length===0)return;let H=null,R=1/0,A=0;for(let W=0;W<M.length;W++){const X=M[W],se=X.getBoundingClientRect();if(f>=se.left&&f<=se.right&&T>=se.top&&T<=se.bottom)return{pageIndex:W,x:(f-se.left)/t.zoom,y:(T-se.top)/t.zoom};const G=Math.max(se.left-f,0,f-se.right),$=Math.max(se.top-T,0,T-se.bottom),O=Math.sqrt(G*G+$*$);O<R&&(R=O,H=X,A=W)}if(H){const W=H.getBoundingClientRect();let X=(f-W.left)/t.zoom,se=(T-W.top)/t.zoom;return X=Math.max(0,Math.min(t.canvasSize.width,X)),se=Math.max(0,Math.min(t.canvasSize.height,se)),{pageIndex:A,x:X,y:se}}},k=f=>{if(t.disableGlobalShortcuts)return;if((f.ctrlKey||f.metaKey)&&f.altKey&&f.key.toLowerCase()==="n"){f.preventDefault(),f.stopPropagation(),window.dispatchEvent(new CustomEvent("designer:new-template"));return}if((f.ctrlKey||f.metaKey)&&f.key===","){f.preventDefault(),f.stopPropagation(),t.setShowSettings(!0);return}const T=f.target;if(T&&T.closest('input, textarea, select, [contenteditable="true"]'))return;if(["ArrowLeft","ArrowRight","ArrowUp","ArrowDown"].includes(f.key)){const R=f.shiftKey?10:1;if(t.selectedGuideId){const A=t.guides.find(W=>W.id===t.selectedGuideId);if(A){f.preventDefault();const W=A.position;let X=W;if(A.type==="vertical")if(f.key==="ArrowLeft")X-=R;else if(f.key==="ArrowRight")X+=R;else return;else if(f.key==="ArrowUp")X-=R;else if(f.key==="ArrowDown")X+=R;else return;(W>0&&X<0||W<0&&X>0||X===0)&&(X=0),t.updateGuide(A.id,X),t.setHighlightedGuide(A.id)}}else if(t.selectedElementIds.length>0){f.preventDefault();const A=f.key==="ArrowLeft"?-R:f.key==="ArrowRight"?R:0,W=f.key==="ArrowUp"?-R:f.key==="ArrowDown"?R:0;t.nudgeSelectedElements(A,W)}return}if((f.ctrlKey||f.metaKey)&&f.key.toLowerCase()==="a"){if(f.preventDefault(),t.pages[t.currentPageIndex]){const R=t.pages[t.currentPageIndex].elements.map(A=>A.id);t.setSelection(R)}return}if(f.key==="Delete"){t.selectedElementIds.length>1?(f.preventDefault(),t.removeSelectedElements()):t.selectedElementId?(f.preventDefault(),t.removeElement(t.selectedElementId)):t.selectedGuideId&&(f.preventDefault(),t.removeGuide(t.selectedGuideId));return}if((f.ctrlKey||f.metaKey)&&f.key.toLowerCase()==="c"){t.selectedElementId&&(f.preventDefault(),t.copy());return}if((f.ctrlKey||f.metaKey)&&f.key.toLowerCase()==="x"){t.selectedElementId&&(f.preventDefault(),t.cut());return}if((f.ctrlKey||f.metaKey)&&f.key.toLowerCase()==="v"){t.clipboard.length>0&&(f.preventDefault(),t.paste(p(y.value,m.value)));return}if((f.ctrlKey||f.metaKey)&&f.key.toLowerCase()==="h"){f.preventDefault(),t.setShowHelp(!0);return}if(t.showHelp&&f.key==="Escape"){f.preventDefault(),t.setShowHelp(!1);return}if((f.ctrlKey||f.metaKey)&&f.key.toLowerCase()==="z"&&!f.shiftKey){f.preventDefault(),t.undo();return}if((f.ctrlKey||f.metaKey)&&(f.key.toLowerCase()==="y"||f.key.toLowerCase()==="z"&&f.shiftKey)){f.preventDefault(),t.redo();return}if((f.ctrlKey||f.metaKey)&&f.key.toLowerCase()==="l"){f.preventDefault(),t.toggleLock();return}if((f.ctrlKey||f.metaKey)&&f.shiftKey&&f.key.toLowerCase()==="p"){f.preventDefault(),window.dispatchEvent(new CustomEvent("designer:preview"));return}const M=f.ctrlKey||f.metaKey,H=f.key.toLowerCase();if(!(t.editingCustomElementId&&M&&(H==="s"||H==="q"))){if(M&&f.shiftKey&&H==="s"){f.preventDefault(),window.dispatchEvent(new CustomEvent("designer:save-as"));return}if(M&&H==="s"){f.preventDefault(),window.dispatchEvent(new CustomEvent("designer:save"));return}if((f.ctrlKey||f.metaKey)&&f.key.toLowerCase()==="p"&&!f.shiftKey){f.preventDefault(),window.dispatchEvent(new CustomEvent("designer:print"));return}if((f.ctrlKey||f.metaKey)&&f.shiftKey&&f.key.toLowerCase()==="e"){f.preventDefault(),window.dispatchEvent(new CustomEvent("designer:export-pdf"));return}if((f.ctrlKey||f.metaKey)&&f.shiftKey&&f.key.toLowerCase()==="j"){f.preventDefault(),window.dispatchEvent(new CustomEvent("designer:view-json"));return}}},v=f=>{["ArrowLeft","ArrowRight","ArrowUp","ArrowDown"].includes(f.key)&&(t.setHighlightedGuide(null),t.setHighlightedEdge(null))},S=async f=>{const T=f.target,M=document.querySelector(".overflow-auto");if(!M||!M.contains(T))return;if(f.preventDefault(),s.value=!0,n.value=f.clientX,l.value=f.clientY,i.value=f.clientX,d.value=f.clientY,await Xe(),u.value){const A=u.value.getBoundingClientRect(),W=window.innerWidth,X=window.innerHeight;f.clientX+A.width>W&&(n.value=W-A.width-5),f.clientY+A.height>X&&(l.value=X-A.height-5)}const H=document.querySelectorAll(".print-page");let R=!1;H.forEach(A=>{const W=A.getBoundingClientRect();f.clientX>=W.left&&f.clientX<=W.right&&f.clientY>=W.top&&f.clientY<=W.bottom&&(R=!0)}),g.value=R,window.addEventListener("click",b)},b=()=>{s.value=!1,window.removeEventListener("click",b)};return We(()=>{window.addEventListener("keydown",k,{capture:!0}),window.addEventListener("contextmenu",S),window.addEventListener("keyup",v),window.addEventListener("mousemove",x)}),Ge(()=>{window.removeEventListener("keydown",k,{capture:!0}),window.removeEventListener("contextmenu",S),window.removeEventListener("click",b),window.removeEventListener("keyup",v),window.removeEventListener("mousemove",x)}),(f,T)=>{var M,H,R,A,W;return s.value?(z(),F("div",{key:0,ref_key:"menuRef",ref:u,class:"fixed z-[9999]",style:ye({left:`${n.value}px`,top:`${l.value}px`})},[o("div",ix,[o("button",{class:"w-full text-left px-3 py-2 text-sm hover:bg-gray-100 disabled:opacity-50 flex items-center gap-2",disabled:a(t).selectedElementIds.length===0&&!a(t).selectedGuideId||((M=a(t).selectedElement)==null?void 0:M.locked),onClick:T[0]||(T[0]=()=>{a(t).selectedElementIds.length>1?a(t).removeSelectedElements():a(t).selectedElementId?a(t).removeElement(a(t).selectedElementId):a(t).selectedGuideId&&a(t).removeGuide(a(t).selectedGuideId),s.value=!1})},[ce(a(St),{class:"w-4 h-4"}),o("span",null,E(a(e)("common.delete"))+E(a(t).selectedElementIds.length>1?` (${a(t).selectedElementIds.length})`:""),1)],8,dx),o("button",{class:"w-full text-left px-3 py-2 text-sm hover:bg-gray-100 disabled:opacity-50 flex items-center gap-2",disabled:!a(t).selectedElementId||((H=a(t).selectedElement)==null?void 0:H.locked),onClick:T[1]||(T[1]=()=>{a(t).cut(),s.value=!1})},[ce(a(lx),{class:"w-4 h-4"}),o("span",null,E(a(e)("common.cut")),1)],8,ux),o("button",{class:"w-full text-left px-3 py-2 text-sm hover:bg-gray-100 disabled:opacity-50 flex items-center gap-2",disabled:!a(t).selectedElementId||((R=a(t).selectedElement)==null?void 0:R.locked),onClick:T[2]||(T[2]=()=>{a(t).copy(),s.value=!1})},[ce(a(Ct),{class:"w-4 h-4"}),o("span",null,E(a(e)("common.copy")),1)],8,cx),o("button",{class:"w-full text-left px-3 py-2 text-sm hover:bg-gray-100 disabled:opacity-50 flex items-center gap-2",disabled:a(t).clipboard.length===0,onClick:T[3]||(T[3]=()=>{a(t).paste(p(i.value,d.value)),s.value=!1})},[ce(a($o),{class:"w-4 h-4"}),o("span",null,E(a(e)("common.paste")),1)],8,hx),o("button",{class:"w-full text-left px-3 py-2 text-sm hover:bg-gray-100 disabled:opacity-50 flex items-center gap-2",disabled:a(t).selectedElementIds.length===0,onClick:T[4]||(T[4]=()=>{a(t).toggleLock(),s.value=!1})},[(z(),ze(Rt((A=a(t).selectedElement)!=null&&A.locked?a(ql):a(Jt)),{class:"w-4 h-4"})),o("span",null,E((W=a(t).selectedElement)!=null&&W.locked?a(e)("common.unlock"):a(e)("common.lock")),1)],8,px),T[7]||(T[7]=o("div",{class:"border-t border-gray-200 my-1"},null,-1)),o("button",{class:"w-full text-left px-3 py-2 text-sm hover:bg-gray-100 flex items-center gap-2",onClick:T[5]||(T[5]=X=>{a(t).undo(),s.value=!1})},[ce(a(Bl),{class:"w-4 h-4"}),o("span",null,E(a(e)("common.undo")),1)]),o("button",{class:"w-full text-left px-3 py-2 text-sm hover:bg-gray-100 flex items-center gap-2",onClick:T[6]||(T[6]=X=>{a(t).redo(),s.value=!1})},[ce(a(Ol),{class:"w-4 h-4"}),o("span",null,E(a(e)("common.redo")),1)])])],4)):be("",!0)}}}),mx={class:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 text-sm leading-none text-gray-300 z-10"},gx={key:2,class:"w-full h-full bg-gray-200 flex items-center justify-center overflow-hidden"},vx=["src"],bx={key:3,class:"w-full h-full bg-gray-100 flex items-center justify-center overflow-hidden"},yx=["src"],wx={key:4,class:"w-full h-full bg-gray-100 flex items-center justify-center overflow-hidden"},xx=["src"],_x={key:2,class:"w-full h-full bg-gray-200 flex items-center justify-center overflow-hidden"},kx=["src"],Sx={key:3,class:"w-full h-full bg-gray-100 flex items-center justify-center overflow-hidden"},Cx=["src"],Ex={key:4,class:"w-full h-full bg-gray-100 flex items-center justify-center overflow-hidden"},Tx=["src"],sl=180,al=120,ll=300,$x=32,Ix=Pe({__name:"Minimap",props:{scrollWidth:{},scrollHeight:{},viewportWidth:{},viewportHeight:{},scrollLeft:{},scrollTop:{},pages:{},pageWidth:{},pageHeight:{},zoom:{},contentOffsetX:{},contentOffsetY:{},canvasBackground:{},showHeaderLine:{type:Boolean},showFooterLine:{type:Boolean},headerHeight:{},footerHeight:{},watermark:{}},emits:["update:scroll"],setup(r,{emit:e}){const t=r,s=e,n=fe(()=>{if(t.scrollWidth<=0||t.scrollHeight<=0)return .1;let G=sl/t.scrollWidth;return t.scrollHeight*G>ll&&(G=ll/t.scrollHeight),t.scrollWidth*G<al&&(G=al/t.scrollWidth),G}),l=fe(()=>t.scrollHeight*n.value),i=fe(()=>({left:`${t.scrollLeft*n.value}px`,top:`${t.scrollTop*n.value}px`,width:`${t.viewportWidth*n.value}px`,height:`${t.viewportHeight*n.value}px`})),d=G=>G.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;"),u=fe(()=>{const G=t.watermark;if(!G||!G.enabled||!G.text)return null;const $=d(G.text),O=Number.isFinite(G.angle)?G.angle:-30,h=Math.max(6,G.size||24),w=Math.max(40,G.density||160),Y=G.color||"#000000",te=Math.min(1,Math.max(0,G.opacity??.1)),Q=`<?xml version="1.0" encoding="UTF-8"?><svg xmlns="http://www.w3.org/2000/svg" width="${w}" height="${w}"><text x="50%" y="50%" dominant-baseline="middle" text-anchor="middle" fill="${Y}" fill-opacity="${te}" font-size="${h}" transform="rotate(${O} ${w/2} ${w/2})">${$}</text></svg>`;return{backgroundImage:`url("data:image/svg+xml,${encodeURIComponent(Q)}")`,backgroundRepeat:"repeat",backgroundSize:`${w}px ${w}px`}}),g=G=>{const $={left:`${t.contentOffsetX*n.value}px`,top:`${(t.contentOffsetY+G*(t.pageHeight+$x)*t.zoom)*n.value}px`,width:`${t.pageWidth*t.zoom*n.value}px`,height:`${t.pageHeight*t.zoom*n.value}px`,backgroundColor:t.canvasBackground||"#ffffff"};return u.value?{...$,...u.value}:$},y=()=>{if(!t.pages||t.pages.length===0)return[];const G=t.pages[0];return G!=null&&G.elements?G.elements.filter($=>t.showHeaderLine&&$.y<t.headerHeight||t.showFooterLine&&$.y>=t.pageHeight-t.footerHeight):[]},m=G=>{const $=Math.max(1,G.width*t.zoom*n.value),O=Math.max(1,G.height*t.zoom*n.value);return{width:$,height:O}},x=G=>{var w,Y,te,Q,I,V,L,B,re,Z,ne,ve;const{width:$,height:O}=m(G),h={left:`${G.x*t.zoom*n.value}px`,top:`${G.y*t.zoom*n.value}px`,width:`${$}px`,height:`${O}px`,fontSize:`${(((w=G.style)==null?void 0:w.fontSize)||12)*t.zoom*n.value}px`,zIndex:((Y=G.style)==null?void 0:Y.zIndex)||1,transform:`rotate(${((te=G.style)==null?void 0:te.rotate)||0}deg)`};if(G.type===ge.LINE){const xe=((Q=G.style)==null?void 0:Q.borderColor)||"#111827",de=Math.max(1,(((I=G.style)==null?void 0:I.borderWidth)||1)*t.zoom*n.value);return{...h,height:`${de}px`,backgroundColor:xe,top:`${G.y*t.zoom*n.value+(O-de)/2}px`}}if(G.type===ge.RECT||G.type===ge.CIRCLE){const xe=((V=G.style)==null?void 0:V.borderColor)||"#111827",de=Math.max(1,(((L=G.style)==null?void 0:L.borderWidth)||1)*t.zoom*n.value);return{...h,backgroundColor:((B=G.style)==null?void 0:B.backgroundColor)||"transparent",borderColor:xe,borderWidth:`${de}px`,borderStyle:((re=G.style)==null?void 0:re.borderStyle)||"solid",borderRadius:G.type===ge.CIRCLE?"9999px":`${((Z=G.style)==null?void 0:Z.borderRadius)||0}px`}}return G.type===ge.BARCODE||G.type===ge.QRCODE?{...h,backgroundColor:"rgba(17, 24, 39, 0.15)",border:"1px solid rgba(17, 24, 39, 0.3)"}:G.type===ge.PAGE_NUMBER?{...h,color:((ne=G.style)==null?void 0:ne.color)||"#111827",backgroundColor:((ve=G.style)==null?void 0:ve.backgroundColor)||"transparent"}:{...h,backgroundColor:G.type===ge.IMAGE?"#e5e7eb":void 0}},p=(G,$)=>{var Y;const O=$+1,h=((Y=t.pages)==null?void 0:Y.length)||1,w=G.format||"1/Total";return w==="1"?`${O}`:w==="Page 1"?`Page ${O}`:`${O}/${h}`},k=G=>{const $=G.style?JSON.stringify(G.style):"";return`${G.id}:${G.type}:${G.variable||""}:${G.content||""}:${$}`},v=ie({}),S=ie({});let b=0;const f=G=>G.type===ge.BARCODE?G.variable||G.content||"12345678":G.type===ge.QRCODE?G.variable||G.content||"https://example.com":G.variable||G.content||"",T=G=>{try{const $=document.createElement("canvas"),O=G.style||{};return Ul($,f(G),{format:O.barcodeFormat||"CODE128",lineColor:O.color||"#000000",width:Number(O.barcodeWidth)||2,height:Number(O.barcodeHeight)||40,displayValue:O.showText!==!1&&O.showText!=="false",fontOptions:O.fontOptions||"",font:O.font||"monospace",textAlign:O.textAlign||"center",textPosition:O.textPosition||"bottom",textMargin:Number(O.textMargin)||2,fontSize:Number(O.fontSize)||20,background:"transparent",margin:Number(O.margin)||0}),$.toDataURL("image/png")}catch{return""}},M=async G=>{var $,O;try{return await Vl.toDataURL(f(G),{margin:0,color:{dark:(($=G.style)==null?void 0:$.color)||"#000000",light:"#00000000"},errorCorrectionLevel:((O=G.style)==null?void 0:O.qrErrorCorrection)||"M"})}catch{return""}},H=async()=>{const G=++b,$={},O={},h=t.pages||[];for(const w of h){const Y=(w==null?void 0:w.elements)||[];for(const te of Y){const Q=k(te);if(te.type===ge.BARCODE){const I=T(te);I&&($[Q]=I)}else if(te.type===ge.QRCODE){const I=await M(te);I&&(O[Q]=I)}}}G===b&&(v.value=$,S.value=O)},R=G=>v.value[k(G)]||"",A=G=>S.value[k(G)]||"";Ae(()=>t.pages,()=>{H()},{deep:!0,immediate:!0});const W=ie(!1),X=ie(null);Ae(()=>t.scrollTop,()=>{if(!X.value)return;const G=t.scrollTop*n.value,$=t.viewportHeight*n.value,O=X.value.clientHeight,h=X.value.scrollTop;G<h?X.value.scrollTop=G:G+$>h+O&&(X.value.scrollTop=G+$-O)});const se=G=>{G.preventDefault();const $=G.currentTarget,O=$.getBoundingClientRect(),h=G.clientX-O.left,w=G.clientY-O.top,Y=t.scrollLeft*n.value,te=t.scrollTop*n.value,Q=t.viewportWidth*n.value,I=t.viewportHeight*n.value;let V=0,L=0;if(h>=Y&&h<=Y+Q&&w>=te&&w<=te+I)V=h-Y,L=w-te;else{const Z=h/n.value-t.viewportWidth/2,ne=w/n.value-t.viewportHeight/2;s("update:scroll",{left:Z,top:ne}),V=Q/2,L=I/2}W.value=!0;const B=Z=>{const ne=$.getBoundingClientRect(),ve=Z.clientX-ne.left,xe=Z.clientY-ne.top,de=ve-V,ke=xe-L;s("update:scroll",{left:de/n.value,top:ke/n.value})},re=()=>{W.value=!1,window.removeEventListener("mousemove",B),window.removeEventListener("mouseup",re)};window.addEventListener("mousemove",B),window.addEventListener("mouseup",re)};return(G,$)=>(z(),F("div",{ref_key:"scrollContainer",ref:X,class:"bg-white border border-gray-200 shadow-lg rounded max-h-[300px] overflow-y-auto overflow-x-hidden box-content no-scrollbar",style:ye({width:`${t.scrollWidth*n.value}px`,maxWidth:`${sl}px`})},[o("div",{class:"relative select-none box-content overflow-hidden",style:ye({width:`${t.scrollWidth*n.value}px`,height:`${l.value}px`}),onMousedown:se},[$[0]||($[0]=o("div",{class:"absolute inset-0 bg-gray-100"},null,-1)),(z(!0),F(Te,null,Le(r.pages,(O,h)=>(z(),F("div",{key:h,class:"absolute shadow-sm border border-gray-300 overflow-hidden",style:ye(g(h))},[o("div",mx,E(h+1),1),(z(!0),F(Te,null,Le(O.elements,w=>{var Y,te;return z(),F("div",{key:w.id,class:"absolute",style:ye(x(w))},[w.type===a(ge).TEXT?(z(),F("div",{key:0,class:"w-full h-full overflow-hidden whitespace-nowrap",style:ye({color:w.style.color||"#000000",fontFamily:w.style.fontFamily,fontWeight:w.style.fontWeight,fontStyle:w.style.fontStyle,textAlign:w.style.textAlign,lineHeight:1})},E(w.variable||w.content),5)):w.type===a(ge).PAGE_NUMBER?(z(),F("div",{key:1,class:"w-full h-full overflow-hidden whitespace-nowrap",style:ye({color:w.style.color||"#000000",fontFamily:w.style.fontFamily,fontWeight:w.style.fontWeight,fontStyle:w.style.fontStyle,textAlign:w.style.textAlign,lineHeight:1})},E(p(w,h)),5)):w.type===a(ge).IMAGE?(z(),F("div",gx,[w.content?(z(),F("img",{key:0,src:w.content,class:"w-full h-full object-cover"},null,8,vx)):be("",!0)])):w.type===a(ge).BARCODE?(z(),F("div",bx,[R(w)?(z(),F("img",{key:0,src:R(w),class:"w-full h-full object-contain"},null,8,yx)):be("",!0)])):w.type===a(ge).QRCODE?(z(),F("div",wx,[A(w)?(z(),F("img",{key:0,src:A(w),class:"w-full h-full object-contain"},null,8,xx)):be("",!0)])):w.type===a(ge).TABLE?(z(),F("div",{key:5,class:"w-full h-full border border-gray-300 bg-white grid",style:ye({gridTemplateColumns:`repeat(${((Y=w.columns)==null?void 0:Y.length)||2}, 1fr)`})},[(z(!0),F(Te,null,Le(Math.min(6,(((te=w.columns)==null?void 0:te.length)||2)*2),Q=>(z(),F("div",{key:Q,class:"border-[0.5px] border-gray-100"}))),128))],4)):be("",!0)],4)}),128)),h>0?(z(!0),F(Te,{key:0},Le(y(),w=>{var Y,te;return z(),F("div",{key:`global-${h}-${w.id}`,class:"absolute",style:ye(x(w))},[w.type===a(ge).TEXT?(z(),F("div",{key:0,class:"w-full h-full overflow-hidden whitespace-nowrap",style:ye({color:w.style.color||"#000000",fontFamily:w.style.fontFamily,fontWeight:w.style.fontWeight,fontStyle:w.style.fontStyle,textAlign:w.style.textAlign,lineHeight:1})},E(w.variable||w.content),5)):w.type===a(ge).PAGE_NUMBER?(z(),F("div",{key:1,class:"w-full h-full overflow-hidden whitespace-nowrap",style:ye({color:w.style.color||"#000000",fontFamily:w.style.fontFamily,fontWeight:w.style.fontWeight,fontStyle:w.style.fontStyle,textAlign:w.style.textAlign,lineHeight:1})},E(p(w,h)),5)):w.type===a(ge).IMAGE?(z(),F("div",_x,[w.content?(z(),F("img",{key:0,src:w.content,class:"w-full h-full object-cover"},null,8,kx)):be("",!0)])):w.type===a(ge).BARCODE?(z(),F("div",Sx,[R(w)?(z(),F("img",{key:0,src:R(w),class:"w-full h-full object-contain"},null,8,Cx)):be("",!0)])):w.type===a(ge).QRCODE?(z(),F("div",Ex,[A(w)?(z(),F("img",{key:0,src:A(w),class:"w-full h-full object-contain"},null,8,Tx)):be("",!0)])):w.type===a(ge).TABLE?(z(),F("div",{key:5,class:"w-full h-full border border-gray-300 bg-white grid",style:ye({gridTemplateColumns:`repeat(${((Y=w.columns)==null?void 0:Y.length)||2}, 1fr)`})},[(z(!0),F(Te,null,Le(Math.min(6,(((te=w.columns)==null?void 0:te.length)||2)*2),Q=>(z(),F("div",{key:Q,class:"border-[0.5px] border-gray-100"}))),128))],4)):be("",!0)],4)}),128)):be("",!0)],4))),128)),o("div",{class:"absolute border-2 border-blue-500 bg-blue-500/10 cursor-move z-[1000]",style:ye(i.value)},null,4)],36)],4))}}),Ax=Et(Ix,[["__scopeId","data-v-8d64f846"]]),zx={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function Px(r,e){return z(),F("svg",zx,[...e[0]||(e[0]=[o("path",{fill:"currentColor",d:"M5 21q-.825 0-1.412-.587T3 19V5q0-.825.588-1.412T5 3h7v2H5v14h7v2zm11-4l-1.375-1.45l2.55-2.55H9v-2h8.175l-2.55-2.55L16 7l5 5z"},null,-1)])])}const Lx=Se({name:"material-symbols-logout",render:Px}),Mx={class:"h-screen w-screen flex flex-col bg-gray-100 overflow-hidden"},Rx={class:"flex-1 flex overflow-hidden"},Dx={class:"flex-1 overflow-hidden relative flex flex-col"},Bx={key:0,class:"flex items-center justify-between px-4 py-2 bg-blue-50 border-b border-blue-200 text-blue-900 dark:bg-blue-950 dark:border-blue-800 dark:text-blue-100"},Ox={class:"text-sm font-medium"},qx={class:"flex items-center gap-2"},Fx={class:"relative w-full h-full flex flex-col overflow-hidden"},Nx={class:"flex-none h-5 bg-gray-50 border-b border-gray-300 flex z-20"},jx={class:"flex-1 relative overflow-hidden"},Hx={class:"flex-1 flex overflow-hidden relative"},Ux={class:"w-5 flex-none bg-gray-50 border-r border-gray-300 h-full relative z-20 overflow-hidden"},Vx=["onMousedown"],Wx={class:"absolute left-2 -top-4 theme-bg text-white text-[10px] px-1 rounded opacity-0 group-hover:opacity-100 pointer-events-none whitespace-nowrap"},Gx=["onMousedown"],Kx={class:"absolute top-2 -left-4 theme-bg text-white text-[10px] px-1 rounded opacity-0 group-hover:opacity-100 pointer-events-none whitespace-nowrap"},Yx={key:2,class:"absolute pointer-events-none"},Xx={key:1,class:"absolute bottom-4 right-4 z-50"},Zx=Pe({__name:"PrintDesigner",setup(r){const e=Re(),t=Zt(),{autoSave:s}=Il(),{t:n}=Ne(),l=ie(null),i=ie(null),d=ie(null),u=ie(!1),g=ie(0),y=()=>{g.value+=1},m=(K,oe)=>{const c=getComputedStyle(document.documentElement).getPropertyValue(K).trim(),N=Mt(c);return N?Vd(N.h,N.s,N.v,oe):`rgba(59, 130, 246, ${oe})`},x=fe(()=>e.editingCustomElement),p=fe(()=>x.value?`${x.value.name} Copy`:"");We(()=>{Xe(()=>{Y()}),window.addEventListener("resize",Y),window.addEventListener("keydown",ve),window.addEventListener("keydown",T),window.addEventListener("keyup",ve),window.addEventListener("blur",xe),window.addEventListener("brand-theme-updated",y),Ae([()=>e.pages.length,()=>e.canvasSize.width,()=>e.canvasSize.height,()=>e.zoom,()=>e.showMinimap],()=>{Xe(Y)}),Ae([()=>e.pages,()=>e.canvasSize,()=>e.guides,()=>e.headerHeight,()=>e.footerHeight,()=>e.showHeaderLine,()=>e.showFooterLine,()=>e.canvasBackground,()=>e.pageSpacingX,()=>e.pageSpacingY,()=>e.watermark,()=>e.showMinimap],()=>{k()},{deep:!0})});const k=qd(()=>{if(!e.editingCustomElementId&&s.value&&t.currentTemplateId&&!t.isSaving){const K=t.templates.find(oe=>oe.id===t.currentTemplateId);K&&t.saveCurrentTemplate(K.name)}},1e3),v=()=>{if(!e.commitCustomElementEdit()){alert(n("sidebar.editSaveFailed"));return}e.cancelCustomElementEdit()},S=K=>{const oe=K.trim();if(!oe)return;if(!e.saveCustomElementEditAs(oe)){alert(n("sidebar.editSaveFailed"));return}e.cancelCustomElementEdit()},b=()=>{confirm(n("sidebar.confirmExitEdit"))&&(e.cancelCustomElementEdit(),requestAnimationFrame(()=>{var K,oe;(oe=(K=l.value)==null?void 0:K.focus)==null||oe.call(K)}))},f=K=>{var N;const oe=K;if(!oe)return!1;if(oe.isContentEditable)return!0;const c=(N=oe.tagName)==null?void 0:N.toLowerCase();return c==="input"||c==="textarea"||c==="select"},T=K=>{if(e.disableGlobalShortcuts||!e.editingCustomElementId||u.value||f(K.target)||!(K.ctrlKey||K.metaKey))return;const c=K.key.toLowerCase();if(c==="s"&&K.shiftKey){K.preventDefault(),K.stopPropagation(),u.value=!0;return}if(c==="s"){K.preventDefault(),K.stopPropagation(),v();return}c==="q"&&(K.preventDefault(),K.stopPropagation(),b())},M=ie(0),H=ie(0),R=ie(0),A=ie(0),W=K=>{const oe=K.target;M.value=oe.scrollLeft,H.value=oe.scrollTop},X=ie(0),se=ie(0),G=ie(0),$=ie(0),O=fe(()=>e.unit||"mm"),h=K=>{const oe=ot(K,e.unit||"mm");return e.unit==="px"?Math.round(oe):Number(oe.toFixed(1))},w=fe(()=>{const K=e.pages.length,oe=e.canvasSize.height,c=e.canvasSize.width,N=e.pageSpacingY||0,q=K>0?K*oe+(K-1)*N:0;return{width:`${c*e.zoom}px`,height:`${q*e.zoom}px`}}),Y=()=>{if(l.value&&d.value){const K=l.value.clientWidth,oe=l.value.clientHeight;G.value=K,$.value=oe;const c=parseFloat(w.value.width),N=parseFloat(w.value.height),q=64,_=64;X.value=Math.max(K,c+q),se.value=Math.max(oe,N+_),c+q<=K&&(X.value=K),N+_<=oe&&(se.value=oe);const C=l.value.getBoundingClientRect(),j=d.value.getBoundingClientRect();M.value=l.value.scrollLeft,H.value=l.value.scrollTop,R.value=j.left-C.left+l.value.scrollLeft,A.value=j.top-C.top+l.value.scrollTop}};Ge(()=>{var K;k.cancel(),window.removeEventListener("resize",Y),window.removeEventListener("mousemove",re),window.removeEventListener("mouseup",Z),window.removeEventListener("keydown",ve),window.removeEventListener("keydown",T),window.removeEventListener("keyup",ve),window.removeEventListener("blur",xe),window.removeEventListener("brand-theme-updated",y),(K=l.value)==null||K.removeEventListener("wheel",ne)});const te=ie(!1),Q=ie(null),I=ie("horizontal"),V=ie(0),L=(K,oe,c=null)=>{te.value=!0,Q.value=c,I.value=oe,B(K),window.addEventListener("mousemove",re),window.addEventListener("mouseup",Z)},B=K=>{if(!l.value)return;const oe=l.value.getBoundingClientRect(),c=e.zoom;if(I.value==="horizontal"){const N=K.clientY-oe.top+l.value.scrollTop;V.value=(N-A.value)/c}else{const N=K.clientX-oe.left+l.value.scrollLeft;V.value=(N-R.value)/c}},re=K=>{te.value&&(K.preventDefault(),B(K),Q.value&&e.updateGuide(Q.value,V.value))},Z=K=>{if(!te.value)return;const oe=l.value.getBoundingClientRect();let c=!1;I.value==="horizontal"?K.clientY<oe.top&&(c=!0):K.clientX<oe.left&&(c=!0),c?Q.value&&e.removeGuide(Q.value):Q.value?e.updateGuide(Q.value,V.value):e.addGuide({type:I.value,position:V.value}),te.value=!1,Q.value=null,window.removeEventListener("mousemove",re),window.removeEventListener("mouseup",Z)},ne=K=>{K.ctrlKey&&(K.preventDefault(),K.deltaY<0?e.setZoom(Math.min(5,e.zoom+.1)):e.setZoom(Math.max(.2,e.zoom-.1)))},ve=K=>{var oe,c;e.disableGlobalShortcuts||(K.key==="Control"||K.key==="Meta")&&(K.type==="keydown"&&!K.repeat?(oe=l.value)==null||oe.addEventListener("wheel",ne,{passive:!1}):K.type==="keyup"&&((c=l.value)==null||c.removeEventListener("wheel",ne)))},xe=()=>{var K;(K=l.value)==null||K.removeEventListener("wheel",ne)},de=K=>{l.value&&l.value.scrollTo({left:K.left,top:K.top,behavior:"auto"})},ke=K=>{var he;const oe=((he=K.style)==null?void 0:he.rotate)||0;if(oe===0)return{minX:K.x,maxX:K.x+K.width,minY:K.y,maxY:K.y+K.height};const c=K.x+K.width/2,N=K.y+K.height/2,q=oe*Math.PI/180,_=Math.cos(q),C=Math.sin(q),j=[{x:K.x,y:K.y},{x:K.x+K.width,y:K.y},{x:K.x,y:K.y+K.height},{x:K.x+K.width,y:K.y+K.height}];let P=1/0,J=-1/0,D=1/0,le=-1/0;for(const ue of j){const pe=c+(ue.x-c)*_-(ue.y-N)*C,ee=N+(ue.x-c)*C+(ue.y-N)*_;pe<P&&(P=pe),pe>J&&(J=pe),ee<D&&(D=ee),ee>le&&(le=ee)}return{minX:P,maxX:J,minY:D,maxY:le}},we=fe(()=>{if(!e.isDragging||e.selectedElementIds.length===0)return null;const K=[];for(const j of e.selectedElementIds)for(const P of e.pages){const J=P.elements.find(D=>D.id===j);J&&K.push(J)}if(K.length===0)return null;let oe=1/0,c=-1/0,N=1/0,q=-1/0;for(const j of K){const P=ke(j);P.minX<oe&&(oe=P.minX),P.maxX>c&&(c=P.maxX),P.minY<N&&(N=P.minY),P.maxY>q&&(q=P.maxY)}const _=(oe+c)/2,C=(N+q)/2;return{minX:oe,maxX:c,minY:N,maxY:q,centerX:_,centerY:C}}),ae=fe(()=>{if(!we.value)return{h:[],v:[]};g.value;const K=m("--brand-500",.5),{minX:oe,maxX:c,minY:N,maxY:q}=we.value;return{h:[{position:oe,color:K},{position:c,color:K}],v:[{position:N,color:K},{position:q,color:K}]}});return(K,oe)=>{var c;return z(),F("div",Mx,[ce($1),o("div",Rx,[ce(vy),o("main",Dx,[a(e).editingCustomElementId?(z(),F("div",Bx,[o("div",Ox,E(a(n)("sidebar.editingElement",{name:((c=x.value)==null?void 0:c.name)||""})),1),o("div",qx,[o("button",{onClick:v,class:"px-3 py-1.5 text-xs font-medium bg-blue-600 text-white rounded hover:bg-blue-700 dark:bg-blue-500 dark:hover:bg-blue-400 inline-flex items-center gap-1.5"},[ce(a(To),{class:"w-4 h-4"}),Ce(" "+E(a(n)("sidebar.saveEdit")),1)]),o("button",{onClick:oe[0]||(oe[0]=N=>u.value=!0),class:"px-3 py-1.5 text-xs font-medium bg-blue-200 text-blue-900 rounded hover:bg-blue-300 dark:bg-blue-700 dark:hover:bg-blue-600 dark:text-white inline-flex items-center gap-1.5"},[ce(a(Dl),{class:"w-4 h-4"}),Ce(" "+E(a(n)("sidebar.saveAs")),1)]),o("button",{onClick:b,class:"px-3 py-1.5 text-xs font-medium bg-slate-200 text-slate-900 rounded hover:bg-slate-300 dark:bg-slate-700 dark:hover:bg-slate-600 dark:text-slate-100 inline-flex items-center gap-1.5"},[ce(a(Lx),{class:"w-4 h-4"}),Ce(" "+E(a(n)("sidebar.exitEdit")),1)])])])):be("",!0),ce(fx),o("div",Fx,[o("div",Nx,[oe[5]||(oe[5]=o("div",{class:"w-5 flex-none bg-gray-100 border-r border-gray-300"},null,-1)),o("div",jx,[ce(ol,{type:"horizontal",zoom:a(e).zoom,scroll:M.value,offset:R.value,thick:20,unit:a(e).unit||"mm",indicators:ae.value.h,onGuideDragStart:oe[1]||(oe[1]=N=>L(N,"horizontal"))},null,8,["zoom","scroll","offset","unit","indicators"])])]),o("div",Hx,[o("div",Ux,[ce(ol,{type:"vertical",zoom:a(e).zoom,scroll:H.value,offset:A.value,thick:20,unit:a(e).unit||"mm",indicators:ae.value.v,onGuideDragStart:oe[2]||(oe[2]=N=>L(N,"vertical"))},null,8,["zoom","scroll","offset","unit","indicators"])]),o("div",{ref_key:"scrollContainer",ref:l,tabindex:"-1",class:"flex-1 overflow-auto p-8 flex relative canvas-scroll bg-gray-100 focus:outline-none",onScroll:W,onClick:oe[3]||(oe[3]=N=>{(N.target===l.value||N.target===N.currentTarget)&&a(e).selectGuide(null)})},[o("div",{ref_key:"canvasWrapper",ref:d,style:ye(w.value),class:"mx-auto relative"},[ce(Wl,{ref_key:"canvasContainer",ref:i,class:"absolute top-0 left-0"},null,512)],4),o("div",{class:"absolute top-0 left-0 pointer-events-none z-50",style:ye({width:`${X.value}px`,height:`${se.value}px`})},[we.value?(z(),F(Te,{key:0},[o("div",{class:"absolute w-full border-t border-blue-500 border-dashed",style:ye({top:`${A.value+we.value.minY*a(e).zoom}px`,left:0})},[o("div",{class:"absolute -top-6 bg-blue-500 text-white text-xs px-1.5 py-0.5 rounded shadow-sm",style:ye({left:`${M.value+10}px`})},E(h(we.value.minY))+" "+E(O.value),5)],4),o("div",{class:"absolute w-full border-t border-dashed theme-border",style:ye({top:`${A.value+we.value.maxY*a(e).zoom}px`,left:0})},[o("div",{class:"absolute -top-6 theme-bg text-white text-xs px-1.5 py-0.5 rounded shadow-sm",style:ye({left:`${M.value+10}px`})},E(h(we.value.maxY))+" "+E(O.value),5)],4),o("div",{class:"absolute h-full border-l border-dashed theme-border",style:ye({left:`${R.value+we.value.minX*a(e).zoom}px`,top:0})},[o("div",{class:"absolute -left-2 transform -translate-x-full theme-bg text-white text-xs px-1.5 py-0.5 rounded shadow-sm whitespace-nowrap",style:ye({top:`${H.value+10}px`})},E(h(we.value.minX))+" "+E(O.value),5)],4),o("div",{class:"absolute h-full border-l border-dashed theme-border",style:ye({left:`${R.value+we.value.maxX*a(e).zoom}px`,top:0})},[o("div",{class:"absolute -left-2 transform -translate-x-full theme-bg text-white text-xs px-1.5 py-0.5 rounded shadow-sm whitespace-nowrap",style:ye({top:`${H.value+10}px`})},E(h(we.value.maxX))+" "+E(O.value),5)],4)],64)):be("",!0),(z(!0),F(Te,null,Le(a(e).guides,N=>(z(),F(Te,{key:N.id},[N.type==="horizontal"?(z(),F("div",{key:0,class:"absolute left-0 w-full h-3 -mt-1.5 cursor-row-resize pointer-events-auto group flex flex-col justify-center",style:ye({top:`${A.value+N.position*a(e).zoom}px`}),onMousedown:Ke(q=>{a(e).selectGuide(N.id),L(q,"horizontal",N.id)},["stop"])},[o("div",{class:_e(["w-full",a(e).highlightedGuideId===N.id?"border-t-2 theme-border-strong":"border-t theme-border","theme-border-hover"])},null,2),o("div",Wx,E(h(N.position))+E(O.value),1)],44,Vx)):(z(),F("div",{key:1,class:"absolute top-0 h-full w-3 -ml-1.5 cursor-col-resize pointer-events-auto group flex flex-row justify-center",style:ye({left:`${R.value+N.position*a(e).zoom}px`}),onMousedown:Ke(q=>{a(e).selectGuide(N.id),L(q,"vertical",N.id)},["stop"])},[o("div",{class:_e(["h-full",a(e).highlightedGuideId===N.id?"border-l-2 theme-border-strong":"border-l theme-border","theme-border-hover"])},null,2),o("div",Kx,E(h(N.position))+E(O.value),1)],44,Gx))],64))),128)),te.value&&!Q.value?(z(),F("div",{key:1,class:_e(["absolute border-dashed pointer-events-none theme-border",I.value==="horizontal"?"left-0 w-full border-t":"top-0 h-full border-l"]),style:ye({top:I.value==="horizontal"?`${A.value+V.value*a(e).zoom}px`:void 0,left:I.value==="vertical"?`${R.value+V.value*a(e).zoom}px`:void 0})},[o("div",{class:_e(["absolute theme-bg text-white text-[10px] px-1 rounded",I.value==="horizontal"?"left-2 -top-4":"top-2 -left-4"])},E(h(V.value))+E(O.value),3)],6)):be("",!0),a(e).highlightedEdge?(z(),F("div",Yx,[a(e).highlightedEdge==="top"?(z(),F("div",{key:0,class:"absolute left-0 w-full border-t theme-border",style:ye({top:`${A.value}px`})},null,4)):a(e).highlightedEdge==="bottom"?(z(),F("div",{key:1,class:"absolute left-0 w-full border-t theme-border",style:ye({top:`${A.value+a(e).canvasSize.height*a(e).zoom}px`})},null,4)):a(e).highlightedEdge==="left"?(z(),F("div",{key:2,class:"absolute top-0 h-full border-l theme-border",style:ye({left:`${R.value}px`})},null,4)):a(e).highlightedEdge==="right"?(z(),F("div",{key:3,class:"absolute top-0 h-full border-l theme-border",style:ye({left:`${R.value+a(e).canvasSize.width*a(e).zoom}px`})},null,4)):be("",!0)])):be("",!0)],4)],544)])]),a(e).showMinimap?(z(),F("div",Xx,[ce(Ax,{"scroll-width":X.value,"scroll-height":se.value,"viewport-width":G.value,"viewport-height":$.value,"scroll-left":M.value,"scroll-top":H.value,pages:a(e).pages,"page-width":a(e).canvasSize.width,"page-height":a(e).canvasSize.height,zoom:a(e).zoom,"content-offset-x":R.value,"content-offset-y":A.value,"canvas-background":a(e).canvasBackground,"show-header-line":a(e).showHeaderLine,"show-footer-line":a(e).showFooterLine,"header-height":a(e).headerHeight,"footer-height":a(e).footerHeight,watermark:a(e).watermark||null,"onUpdate:scroll":de},null,8,["scroll-width","scroll-height","viewport-width","viewport-height","scroll-left","scroll-top","pages","page-width","page-height","zoom","content-offset-x","content-offset-y","canvas-background","show-header-line","show-footer-line","header-height","footer-height","watermark"])])):be("",!0)]),ce(Hw)]),ce(qt,{show:u.value,"initial-value":p.value,title:a(n)("sidebar.saveAsCustomElement"),placeholder:a(n)("sidebar.enterNamePlaceholder"),onClose:oe[4]||(oe[4]=N=>u.value=!1),onSave:S},null,8,["show","initial-value","title","placeholder"])])}}}),Jx={class:"print-renderer"},Qx=Pe({__name:"PrintRenderer",setup(r){const e=Re(),t=new URLSearchParams(window.location.search).get("printToken")||"",s=window.location.origin,n=g=>{window.parent&&window.parent.postMessage({type:g,token:t},s)},l=async(g=2e3)=>{const y=document.fonts;!y||!y.ready||await Promise.race([y.ready,new Promise(m=>setTimeout(m,g))])},i=async(g=2e3)=>{const m=Array.from(document.images||[]).filter(x=>!x.complete);m.length!==0&&await Promise.race([Promise.all(m.map(x=>new Promise(p=>{const k=()=>{x.removeEventListener("load",k),x.removeEventListener("error",k),p()};x.addEventListener("load",k,{once:!0}),x.addEventListener("error",k,{once:!0})}))),new Promise(x=>setTimeout(x,g))])},d=async g=>{e.$patch({pages:Ee(g.pages||[]),canvasSize:g.canvasSize||e.canvasSize,canvasBackground:g.canvasBackground||e.canvasBackground,headerHeight:g.headerHeight??e.headerHeight,footerHeight:g.footerHeight??e.footerHeight,showHeaderLine:g.showHeaderLine??!1,showFooterLine:g.showFooterLine??!1,showGrid:!1,showCornerMarkers:!1,zoom:1,currentPageIndex:0,selectedElementId:null,selectedElementIds:[],guides:[],testData:g.testData||{}}),g.watermark&&(e.watermark=Ee(g.watermark)),g.unit&&(e.unit=g.unit),e.setIsExporting(!0),document.body.classList.add("exporting"),await Xe(),await l(),await i(),requestAnimationFrame(()=>{n("print-renderer-rendered")})},u=g=>{if(g.origin!==s)return;const y=g.data;!y||y.type!=="print-renderer-payload"||y.token!==t||d(y.payload||{})};return We(()=>{document.body.style.margin="0",document.body.style.background="#ffffff",window.addEventListener("message",u),n("print-renderer-ready")}),Ge(()=>{window.removeEventListener("message",u)}),(g,y)=>(z(),F("div",Jx,[ce(Wl)]))}}),e5=Et(Qx,[["__scopeId","data-v-e32c25e7"]]),t5=Pe({__name:"App",setup(r){const e=new URLSearchParams(window.location.search).get("print")==="1";return(t,s)=>e?(z(),ze(e5,{key:0})):(z(),ze(Zx,{key:1}))}}),r5=Yl(),zo=Xl(t5),n5=()=>{const r=localStorage.getItem("print-designer-brand-vars");if(r)try{const e=JSON.parse(r);if(!e||typeof e!="object")return;const t=document.documentElement;Object.entries(e).forEach(([s,n])=>{t.style.setProperty(s,n)})}catch{}};n5();zo.use(r5);zo.use(li);zo.mount("#app");
